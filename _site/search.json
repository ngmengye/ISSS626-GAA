[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS626-GAA",
    "section": "",
    "text": "Welcome to ISSS626 Geospatial Analytics and Applications. In this website, you will find my coursework prepared for this course."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex02/data/MPSZ-2019.html",
    "href": "In-class_Ex/In-class_Ex02/data/MPSZ-2019.html",
    "title": "ISSS626-GAA",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex03/Hands-on_ex03.html",
    "href": "Hands-on_exercise/Hands-on_ex03/Hands-on_ex03.html",
    "title": "Hands on Exercise 03",
    "section": "",
    "text": "pacman::p_load(sf,spNetwork,tmap,tidyverse)\n\n\nnetwork &lt;- st_read(dsn=\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex03/data/geospatial\",\n                   layer = \"Punggol_St\") %&gt;% \n              st_transform(crs = 3414)\n\nReading layer `Punggol_St' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex03\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2642 features and 2 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: 34038.56 ymin: 40941.11 xmax: 38882.85 ymax: 44801.27\nProjected CRS: SVY21 / Singapore TM\n\n\n\nchildcare &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex03/data/geospatial\",\n                     layer = \"Punggol_CC\") %&gt;% \n              st_transform(crs = 3414)\n\nReading layer `Punggol_CC' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex03\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 61 features and 1 field\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 34423.98 ymin: 41503.6 xmax: 37619.47 ymax: 44685.77\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\n\n\n\nchildcare &lt;- st_zm(childcare)\n\n\nchildcare\n\nSimple feature collection with 61 features and 1 field\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 34423.98 ymin: 41503.6 xmax: 37619.47 ymax: 44685.77\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n      Name                  geometry\n1   kml_10 POINT (36173.81 42550.33)\n2   kml_99 POINT (36479.56 42405.21)\n3  kml_100 POINT (36618.72 41989.13)\n4  kml_101 POINT (36285.37 42261.42)\n5  kml_122  POINT (35414.54 42625.1)\n6  kml_161 POINT (36545.16 42580.09)\n7  kml_172 POINT (35289.44 44083.57)\n8  kml_188 POINT (36520.56 42844.74)\n9  kml_205  POINT (36924.01 41503.6)\n10 kml_222 POINT (37141.76 42326.36)\n\n\n\nplot(st_geometry(network))\nplot(childcare,add=T,col='red',pch = 19)\n\n\n\n\n\n\n\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(childcare) + \n  tm_dots() + \n  tm_shape(network) +\n  tm_lines()\n\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nlixels &lt;- lixelize_lines(network, \n                         700, \n                         mindist = 375)\n\n\nsamples &lt;- lines_center(lixels) \n\n\ndensities &lt;- nkde(network, \n                  events = childcare,\n                  w = rep(1, nrow(childcare)),\n                  samples = samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nsamples$density &lt;- densities\nlixels$density &lt;- densities\n\n# rescaling to help the mapping\nsamples$density &lt;- samples$density*1000\nlixels$density &lt;- lixels$density*1000\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(lixels)+\n  tm_lines(col=\"density\")+\ntm_shape(childcare)+\n  tm_dots()\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nkfun_childcare &lt;- kfunctions(network, \n                             childcare,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05)\n\n\nkfun_childcare$plotk"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex01/Hands-on_Ex01.html",
    "href": "Hands-on_exercise/Hands-on_ex01/Hands-on_Ex01.html",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "#sf = simple features for importing, managing, and processing geospatial data #tidyverse for performing data science tasks such as importing #wrangling and visualizing data\n\npacman::p_load(sf,tidyverse)\n# \nmpsz = st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\ncyclingpath = st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/geospatial\", layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3138 features and 2 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11854.32 ymin: 28347.98 xmax: 42644.17 ymax: 48948.15\nProjected CRS: SVY21\n\n# \npreschool = st_read(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex01\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n# \n#st_geometry = extract or replace geometry column #geometry column contains the spatial data \nst_geometry(preschool)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nPOINT Z (103.8072 1.299333 0)\n\n\nPOINT Z (103.826 1.312839 0)\n\n\nPOINT Z (103.8409 1.348843 0)\n\n\nPOINT Z (103.8048 1.435024 0)\n\n\nPOINT Z (103.839 1.33315 0)\n\nglimpse(cyclingpath)\n\nRows: 3,138\nColumns: 3\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\nhead(mpsz,n=5) \n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n\n\n\nplot(mpsz) \n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\n\nplot(st_geometry(mpsz))\n\n\n\n\n\n\n\n\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\n\n\nplot is meant for quick look, use tmap instead\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nmpsz3414 &lt;- st_set_crs(mpsz, 3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nfrom GCS to PCS\n\nst_geometry(preschool) \n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nPOINT Z (103.8072 1.299333 0)\n\n\nPOINT Z (103.826 1.312839 0)\n\n\nPOINT Z (103.8409 1.348843 0)\n\n\nPOINT Z (103.8048 1.435024 0)\n\n\nPOINT Z (103.839 1.33315 0)\n\npreschool3414 &lt;- st_transform(preschool, crs = 3414)\nst_geometry(preschool3414)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)\n\n# \nlistings &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/aspatial/listings.csv\")\n\nRows: 3540 Columns: 75\n\n\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (26): listing_url, source, name, description, neighborhood_overview, pi...\ndbl  (38): id, scrape_id, host_id, host_listings_count, host_total_listings_...\nlgl   (6): host_is_superhost, host_has_profile_pic, host_identity_verified, ...\ndate  (5): last_scraped, host_since, calendar_last_scraped, first_review, la...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# \nlist(listings)\n\n[[1]]\n# A tibble: 3,540 × 75\n       id listing_url            scrape_id last_scraped source name  description\n    &lt;dbl&gt; &lt;chr&gt;                      &lt;dbl&gt; &lt;date&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      \n 1  71609 https://www.airbnb.co…   2.02e13 2024-06-29   previ… Ensu… For 3 room…\n 2  71896 https://www.airbnb.co…   2.02e13 2024-06-29   city … B&B … &lt;NA&gt;       \n 3  71903 https://www.airbnb.co…   2.02e13 2024-06-29   city … Room… Like your …\n 4 275343 https://www.airbnb.co…   2.02e13 2024-06-29   city … 10mi… **IMPORTAN…\n 5 275344 https://www.airbnb.co…   2.02e13 2024-06-29   city … 15 m… Lovely hom…\n 6 289234 https://www.airbnb.co…   2.02e13 2024-06-29   previ… Book… This whole…\n 7 294281 https://www.airbnb.co…   2.02e13 2024-06-29   city … 5 mi… I have 3 b…\n 8 324945 https://www.airbnb.co…   2.02e13 2024-06-29   city … Comf… **IMPORTAN…\n 9 330095 https://www.airbnb.co…   2.02e13 2024-06-29   city … Rela… **IMPORTAN…\n10 344803 https://www.airbnb.co…   2.02e13 2024-06-29   city … Budg… Direct bus…\n# ℹ 3,530 more rows\n# ℹ 68 more variables: neighborhood_overview &lt;chr&gt;, picture_url &lt;chr&gt;,\n#   host_id &lt;dbl&gt;, host_url &lt;chr&gt;, host_name &lt;chr&gt;, host_since &lt;date&gt;,\n#   host_location &lt;chr&gt;, host_about &lt;chr&gt;, host_response_time &lt;chr&gt;,\n#   host_response_rate &lt;chr&gt;, host_acceptance_rate &lt;chr&gt;,\n#   host_is_superhost &lt;lgl&gt;, host_thumbnail_url &lt;chr&gt;, host_picture_url &lt;chr&gt;,\n#   host_neighbourhood &lt;chr&gt;, host_listings_count &lt;dbl&gt;, …\n\n# \nlistings_sf &lt;- st_as_sf(listings, coords = c(\"longitude\", \"latitude\"), crs=4326) %&gt;% st_transform(crs = 3414)\n# \nglimpse(listings_sf)\n\nRows: 3,540\nColumns: 74\n$ id                                           &lt;dbl&gt; 71609, 71896, 71903, 2753…\n$ listing_url                                  &lt;chr&gt; \"https://www.airbnb.com/r…\n$ scrape_id                                    &lt;dbl&gt; 2.024063e+13, 2.024063e+1…\n$ last_scraped                                 &lt;date&gt; 2024-06-29, 2024-06-29, …\n$ source                                       &lt;chr&gt; \"previous scrape\", \"city …\n$ name                                         &lt;chr&gt; \"Ensuite Room (Room 1 & 2…\n$ description                                  &lt;chr&gt; \"For 3 rooms.Book room 1 …\n$ neighborhood_overview                        &lt;chr&gt; NA, NA, \"Quiet and view o…\n$ picture_url                                  &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_id                                      &lt;dbl&gt; 367042, 367042, 367042, 1…\n$ host_url                                     &lt;chr&gt; \"https://www.airbnb.com/u…\n$ host_name                                    &lt;chr&gt; \"Belinda\", \"Belinda\", \"Be…\n$ host_since                                   &lt;date&gt; 2011-01-29, 2011-01-29, …\n$ host_location                                &lt;chr&gt; \"Singapore\", \"Singapore\",…\n$ host_about                                   &lt;chr&gt; \"Hi My name is Belinda -H…\n$ host_response_time                           &lt;chr&gt; \"within an hour\", \"within…\n$ host_response_rate                           &lt;chr&gt; \"100%\", \"100%\", \"100%\", \"…\n$ host_acceptance_rate                         &lt;chr&gt; \"N/A\", \"N/A\", \"N/A\", \"99%…\n$ host_is_superhost                            &lt;lgl&gt; FALSE, FALSE, FALSE, FALS…\n$ host_thumbnail_url                           &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_picture_url                             &lt;chr&gt; \"https://a0.muscache.com/…\n$ host_neighbourhood                           &lt;chr&gt; \"Tampines\", \"Tampines\", \"…\n$ host_listings_count                          &lt;dbl&gt; 6, 6, 6, 49, 49, 6, 7, 49…\n$ host_total_listings_count                    &lt;dbl&gt; 11, 11, 11, 73, 73, 11, 8…\n$ host_verifications                           &lt;chr&gt; \"['email', 'phone']\", \"['…\n$ host_has_profile_pic                         &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ host_identity_verified                       &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ neighbourhood                                &lt;chr&gt; NA, NA, \"Singapore, Singa…\n$ neighbourhood_cleansed                       &lt;chr&gt; \"Tampines\", \"Tampines\", \"…\n$ neighbourhood_group_cleansed                 &lt;chr&gt; \"East Region\", \"East Regi…\n$ property_type                                &lt;chr&gt; \"Private room in villa\", …\n$ room_type                                    &lt;chr&gt; \"Private room\", \"Private …\n$ accommodates                                 &lt;dbl&gt; 3, 1, 2, 1, 1, 4, 2, 1, 1…\n$ bathrooms                                    &lt;dbl&gt; NA, 0.5, 0.5, 2.0, 2.5, N…\n$ bathrooms_text                               &lt;chr&gt; \"1 private bath\", \"Shared…\n$ bedrooms                                     &lt;dbl&gt; 2, 1, 1, 1, 1, 3, 2, 1, 1…\n$ beds                                         &lt;dbl&gt; NA, 1, 2, 1, 1, NA, 1, 1,…\n$ amenities                                    &lt;chr&gt; \"[\\\"Free parking on premi…\n$ price                                        &lt;chr&gt; NA, \"$80.00\", \"$80.00\", \"…\n$ minimum_nights                               &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_nights                               &lt;dbl&gt; 365, 365, 365, 999, 999, …\n$ minimum_minimum_nights                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_minimum_nights                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ minimum_maximum_nights                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ maximum_maximum_nights                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ minimum_nights_avg_ntm                       &lt;dbl&gt; 92, 92, 92, 180, 180, 92,…\n$ maximum_nights_avg_ntm                       &lt;dbl&gt; 1125, 1125, 1125, 1125, 1…\n$ calendar_updated                             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, N…\n$ has_availability                             &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, T…\n$ availability_30                              &lt;dbl&gt; 30, 30, 30, 28, 0, 29, 30…\n$ availability_60                              &lt;dbl&gt; 59, 53, 60, 58, 0, 58, 60…\n$ availability_90                              &lt;dbl&gt; 89, 83, 90, 62, 0, 88, 90…\n$ availability_365                             &lt;dbl&gt; 89, 148, 90, 62, 0, 88, 3…\n$ calendar_last_scraped                        &lt;date&gt; 2024-06-29, 2024-06-29, …\n$ number_of_reviews                            &lt;dbl&gt; 19, 24, 46, 20, 16, 12, 1…\n$ number_of_reviews_ltm                        &lt;dbl&gt; 0, 0, 0, 0, 2, 0, 0, 1, 1…\n$ number_of_reviews_l30d                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ first_review                                 &lt;date&gt; 2011-12-19, 2011-07-30, …\n$ last_review                                  &lt;date&gt; 2020-01-17, 2019-10-13, …\n$ review_scores_rating                         &lt;dbl&gt; 4.44, 4.16, 4.41, 4.40, 4…\n$ review_scores_accuracy                       &lt;dbl&gt; 4.37, 4.22, 4.39, 4.16, 4…\n$ review_scores_cleanliness                    &lt;dbl&gt; 4.00, 4.09, 4.52, 4.26, 4…\n$ review_scores_checkin                        &lt;dbl&gt; 4.63, 4.43, 4.63, 4.47, 4…\n$ review_scores_communication                  &lt;dbl&gt; 4.78, 4.43, 4.64, 4.42, 4…\n$ review_scores_location                       &lt;dbl&gt; 4.26, 4.17, 4.50, 4.53, 4…\n$ review_scores_value                          &lt;dbl&gt; 4.32, 4.04, 4.36, 4.63, 4…\n$ license                                      &lt;chr&gt; NA, NA, NA, \"S0399\", \"S03…\n$ instant_bookable                             &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE…\n$ calculated_host_listings_count               &lt;dbl&gt; 6, 6, 6, 49, 49, 6, 7, 49…\n$ calculated_host_listings_count_entire_homes  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0…\n$ calculated_host_listings_count_private_rooms &lt;dbl&gt; 6, 6, 6, 49, 49, 6, 6, 49…\n$ calculated_host_listings_count_shared_rooms  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ reviews_per_month                            &lt;dbl&gt; 0.12, 0.15, 0.29, 0.15, 0…\n$ geometry                                     &lt;POINT [m]&gt; POINT (41972.5 3639…\n\n# \nbuffer_cycling &lt;- st_buffer(cyclingpath, dist=5, nQuadSegs = 30)\n# \nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\nsum(buffer_cycling$AREA)\n\n2218855 [m^2]\n\n# \nmpsz3414$`PreSch Count`&lt;- lengths(st_intersects(mpsz3414, preschool3414))\n\nsummary(mpsz3414$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n# \ntop_n(mpsz3414,1,'PreSch Count')\n\nSimple feature collection with 323 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1         1          1    MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2         2          1    PEARL'S HILL    OTSZ01      Y          OUTRAM\n3         3          3       BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4         4          8  HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5         5          3         REDHILL    BMSZ03      N     BUKIT MERAH\n6         6          7  ALEXANDRA HILL    BMSZ07      N     BUKIT MERAH\n7         7          9   BUKIT HO SWEE    BMSZ09      N     BUKIT MERAH\n8         8          2     CLARKE QUAY    SRSZ02      Y SINGAPORE RIVER\n9         9         13 PASIR PANJANG 1    QTSZ13      N      QUEENSTOWN\n10       10          7       QUEENSWAY    QTSZ07      N      QUEENSTOWN\n   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1          MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2          OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3          SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4          BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5          BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n6          BM CENTRAL REGION       CR 9D286521EF5E3B59 2014-12-05 25358.82\n7          BM CENTRAL REGION       CR 7839A8577144EFE2 2014-12-05 27680.06\n8          SR CENTRAL REGION       CR 48661DC0FBA09F7A 2014-12-05 29253.21\n9          QT CENTRAL REGION       CR 1F721290C421BFAB 2014-12-05 22077.34\n10         QT CENTRAL REGION       CR 3580D2AFFBEE914C 2014-12-05 24168.31\n     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry PreSch Count\n1  29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...            0\n2  29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...            6\n3  29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...            0\n4  29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...            5\n5  30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...            3\n6  29991.38   4428.913  1030378.8 MULTIPOLYGON (((25899.7 297...           13\n7  30230.86   3275.312   551732.0 MULTIPOLYGON (((27746.95 30...            5\n8  30222.86   2208.619   290184.7 MULTIPOLYGON (((29351.26 29...            1\n9  29893.78   6571.323  1084792.3 MULTIPOLYGON (((20996.49 30...           11\n10 30104.18   3454.239   631644.3 MULTIPOLYGON (((24472.11 29...            1\n\n# \nmpsz3414$Area &lt;- mpsz3414 %&gt;% st_area()\n# \nmpsz3414 &lt;- mpsz3414 %&gt;% mutate(`PreSch Density` = `PreSch Count`/Area * 1000000)\n# \nhist(mpsz3414$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nggplot(data=mpsz3414, \n       aes(x= as.numeric(`PreSch Density`)))+\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"Are pre-school even distributed in Singapore?\",\n       subtitle= \"There are many planning sub-zones with a single pre-school, on the other hand, \\nthere are two planning sub-zones with at least 20 pre-schools\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\n\n\n\n\nggplot(data=mpsz3414, \n       aes(y = `PreSch Count`, \n           x= as.numeric(`PreSch Density`)))+\n  geom_point(color=\"black\", \n             fill=\"light blue\") +\n  xlim(0, 40) +\n  ylim(0, 40) +\n  labs(title = \"\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\n\npacman::p_load(sf, tmap, tidyverse)\n\n\nmpsz &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n# \npopdata &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/aspatial/respopagesextod2011to2020.csv\")\n\nRows: 984656 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\npopdata\n\n# A tibble: 984,656 × 7\n   PA         SZ                     AG     Sex     TOD                Pop  Time\n   &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;\n 1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   HDB 1- and 2-Ro…     0  2011\n 2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   HDB 3-Room Flats    10  2011\n 3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   HDB 4-Room Flats    30  2011\n 4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   HDB 5-Room and …    50  2011\n 5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   HUDC Flats (exc…     0  2011\n 6 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   Landed Properti…     0  2011\n 7 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   Condominiums an…    40  2011\n 8 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males   Others               0  2011\n 9 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Females HDB 1- and 2-Ro…     0  2011\n10 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Females HDB 3-Room Flats    10  2011\n# ℹ 984,646 more rows\n\n# \npopdata2020 &lt;- popdata %&gt;%\n  filter(Time == 2020) %&gt;%\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP` = sum(`Pop`)) %&gt;%\n  ungroup()%&gt;%\n  pivot_wider(names_from=AG, \n              values_from=POP) %&gt;%\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[14])) %&gt;%\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\nrowSums(.[13:15]))%&gt;%\nmutate(`AGED`=rowSums(.[16:21])) %&gt;%\nmutate(`TOTAL`=rowSums(.[3:21])) %&gt;%  \nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n/`ECONOMY ACTIVE`) %&gt;%\n  select(`PA`, `SZ`, `YOUNG`, \n       `ECONOMY ACTIVE`, `AGED`, \n       `TOTAL`, `DEPENDENCY`)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\n# \npopdata2020 &lt;- popdata2020 %&gt;%\n  mutate_at(.vars = vars(PA, SZ), \n          .funs = list(toupper)) %&gt;%\n  filter(`ECONOMY ACTIVE` &gt; 0)\n\n\nmpsz_pop2020 &lt;- left_join(mpsz, popdata2020,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n# \nwrite_rds(mpsz_pop2020, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex01/data/rds/mpszpop2020.rds\")\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nqtm(mpsz_pop2020, \n    fill = \"DEPENDENCY\")\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Dependency ratio\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020) +\n  tm_polygons()\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_polygons(\"DEPENDENCY\")\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\")\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\") +\n  tm_borders(lwd = 0.1,  alpha = 1)\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          n = 6,\n          style = \"quantile\",\n          palette = \"Blues\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"-Greens\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"jenks\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            legend.outside = FALSE,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"-Greens\") +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"classic\")\n\ntmap style set to \"classic\"\n\n\nother available styles are: \"white\", \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"watercolor\" \n\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"No. of persons\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(c(\"YOUNG\", \"AGED\"),\n          style = \"equal\", \n          palette = \"Blues\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"white\")\n\ntmap style set to \"white\"\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\" \n\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+ \n  tm_polygons(c(\"DEPENDENCY\",\"AGED\"),\n          style = c(\"equal\", \"quantile\"), \n          palette = list(\"Blues\",\"Greens\")) +\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020) +\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"Blues\",\n          thres.poly = 0) + \n  tm_facets(by=\"REGION_N\", \n            free.coords=TRUE, \n            drop.shapes=TRUE) +\n  tm_layout(legend.show = FALSE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(alpha = 0.5)\n\nWarning: The argument drop.shapes has been renamed to drop.units, and is\ntherefore deprecated\n\n\n\n\n\n\n\n\n\n\nyoungmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"YOUNG\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\nagedmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"AGED\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020[mpsz_pop2020$REGION_N==\"CENTRAL REGION\", ])+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(legend.outside = TRUE,\n            legend.height = 0.45, \n            legend.width = 5.0,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\nWarning in pre_process_gt(x, interactive = interactive, orig_crs =\ngm$shape.orig_crs): legend.width controls the width of the legend within a map.\nPlease use legend.outside.size to control the width of the outside legend"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex02/Hands-on_Ex02.html",
    "href": "Hands-on_exercise/Hands-on_ex02/Hands-on_Ex02.html",
    "title": "Hands-on_Ex02",
    "section": "",
    "text": "pacman::p_load(sf,raster,spatstat,tmap,tidyverse,sp,maptools)\n\n\nchildcare_sf &lt;- st_read('C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex02/data/child-care-services-geojson.geojson')\n\nReading layer `child-care-services-geojson' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex02\\data\\child-care-services-geojson.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1545 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6824 ymin: 1.248403 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\nst_crs(childcare_sf)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\n\n\nchildcare_sf &lt;- st_read('C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex02/data/child-care-services-geojson.geojson') %&gt;% \n  st_transform(crs=3414)\n\nReading layer `child-care-services-geojson' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex02\\data\\child-care-services-geojson.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1545 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6824 ymin: 1.248403 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\nsg_sf &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex02/data\", layer=\"CostalOutline\")%&gt;% \n  st_transform(crs=3414)\n\nReading layer `CostalOutline' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex02\\data' \n  using driver `ESRI Shapefile'\nSimple feature collection with 60 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 2663.926 ymin: 16357.98 xmax: 56047.79 ymax: 50244.03\nProjected CRS: SVY21\n\n\n\nst_crs(sg_sf)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nmpsz_sf &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex02/data\", layer=\"MP14_SUBZONE_WEB_PL\")%&gt;% \n  st_transform(crs=3414)\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex02\\data' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nst_crs(mpsz_sf)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz_sf) + tm_polygons() + \n  tm_shape(childcare_sf) + tm_dots() \n\n\n\n\n\n\n\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(childcare_sf)+\n  tm_dots()\n\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nchildcare &lt;- as_Spatial(childcare_sf)\nmpsz &lt;- as_Spatial(mpsz_sf)\nsg &lt;- as_Spatial(sg_sf)\n\n\nchildcare\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1545 \nextent      : 11203.01, 45404.24, 25667.6, 49300.88  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 2\nnames       :    Name,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Description \nmin values  :   kml_1, &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;018989&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;1, MARINA BOULEVARD, #B1 - 01, ONE MARINA BOULEVARD, SINGAPORE 018989&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;THE LITTLE SKOOL-HOUSE INTERNATIONAL PTE. LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;08F73931F4A691F4&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20200826094036&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; \nmax values  : kml_999,                  &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSBLOCKHOUSENUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSBUILDINGNAME&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSPOSTALCODE&lt;/th&gt; &lt;td&gt;829646&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSSTREETNAME&lt;/th&gt; &lt;td&gt;200, PONGGOL SEVENTEENTH AVENUE, SINGAPORE 829646&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSTYPE&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;DESCRIPTION&lt;/th&gt; &lt;td&gt;Child Care Services&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;HYPERLINK&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;LANDXADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;LANDYADDRESSPOINT&lt;/th&gt; &lt;td&gt;0&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;td&gt;RAFFLES KIDZ @ PUNGGOL PTE LTD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;PHOTOURL&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;ADDRESSFLOORNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;379D017BF244B0FA&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20200826094036&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;ADDRESSUNITNUMBER&lt;/th&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; \n\n\n\nmpsz\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 323 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 15\nnames       : OBJECTID, SUBZONE_NO, SUBZONE_N, SUBZONE_C, CA_IND, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C,          INC_CRC, FMEL_UPD_D,     X_ADDR,     Y_ADDR,    SHAPE_Leng,    SHAPE_Area \nmin values  :        1,          1, ADMIRALTY,    AMSZ01,      N, ANG MO KIO,         AM, CENTRAL REGION,       CR, 00F5E30B5C9B7AD8,      16409,  5092.8949,  19579.069, 871.554887798, 39437.9352703 \nmax values  :      323,         17,    YUNNAN,    YSSZ09,      Y,     YISHUN,         YS,    WEST REGION,       WR, FFCCF172717C2EAF,      16409, 50424.7923, 49552.7904, 68083.9364708,  69748298.792 \n\n\n\nsg\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 60 \nextent      : 2663.926, 56047.79, 16357.98, 50244.03  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 4\nnames       : GDO_GID, MSLINK, MAPID,              COSTAL_NAM \nmin values  :       1,      1,     0,             ISLAND LINK \nmax values  :      60,     67,     0, SINGAPORE - MAIN ISLAND \n\n\n\nchildcare_sp &lt;- as(childcare, \"SpatialPoints\")\nsg_sp &lt;- as(sg, \"SpatialPolygons\")\n\n\nchildcare_ppp &lt;- as.ppp(childcare_sf)\n\nWarning in as.ppp.sf(childcare_sf): only first attribute column is used for\nmarks\n\nchildcare_ppp\n\nMarked planar point pattern: 1545 points\nmarks are of storage type  'character'\nwindow: rectangle = [11203.01, 45404.24] x [25667.6, 49300.88] units\n\n\n\nplot(childcare_ppp)\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 1545 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\n\n\nsummary(childcare_ppp)\n\nMarked planar point pattern:  1545 points\nAverage intensity 1.91145e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nmarks are of type 'character'\nSummary:\n   Length     Class      Mode \n     1545 character character \n\nWindow: rectangle = [11203.01, 45404.24] x [25667.6, 49300.88] units\n                    (34200 x 23630 units)\nWindow area = 808287000 square units\n\n\n\nany(duplicated(childcare_ppp))\n\n[1] FALSE\n\n\n\nmultiplicity(childcare_ppp)\n\n   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [297] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [371] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [408] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [445] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [482] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [519] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [556] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [593] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [630] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [667] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [704] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [741] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [778] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [815] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [852] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [889] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [926] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [963] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1000] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1037] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1074] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1111] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1148] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1185] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1222] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1259] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1296] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1333] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1370] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1407] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1444] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1481] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[1518] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\n\n\nsum(multiplicity(childcare_ppp) &gt; 1)\n\n[1] 0\n\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(childcare) +\n  tm_dots(alpha=0.4, \n          size=0.05)\n\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nchildcare_ppp_jit &lt;- rjitter(childcare_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n\n\nany(duplicated(childcare_ppp_jit))\n\n[1] FALSE\n\n\n\nsg_owin &lt;- as.owin(sg_sf)\n\n\nplot(sg_owin)\n\n\n\n\n\n\n\n\n\nsummary(sg_owin)\n\nWindow: polygonal boundary\n50 separate polygons (1 hole)\n                 vertices         area relative.area\npolygon 1 (hole)       30     -7081.18     -9.76e-06\npolygon 2              55     82537.90      1.14e-04\npolygon 3              90    415092.00      5.72e-04\npolygon 4              49     16698.60      2.30e-05\npolygon 5              38     24249.20      3.34e-05\npolygon 6             976  23344700.00      3.22e-02\npolygon 7             721   1927950.00      2.66e-03\npolygon 8            1992   9992170.00      1.38e-02\npolygon 9             330   1118960.00      1.54e-03\npolygon 10            175    925904.00      1.28e-03\npolygon 11            115    928394.00      1.28e-03\npolygon 12             24      6352.39      8.76e-06\npolygon 13            190    202489.00      2.79e-04\npolygon 14             37     10170.50      1.40e-05\npolygon 15             25     16622.70      2.29e-05\npolygon 16             10      2145.07      2.96e-06\npolygon 17             66     16184.10      2.23e-05\npolygon 18           5195 636837000.00      8.78e-01\npolygon 19             76    312332.00      4.31e-04\npolygon 20            627  31891300.00      4.40e-02\npolygon 21             20     32842.00      4.53e-05\npolygon 22             42     55831.70      7.70e-05\npolygon 23             67   1313540.00      1.81e-03\npolygon 24            734   4690930.00      6.47e-03\npolygon 25             16      3194.60      4.40e-06\npolygon 26             15      4872.96      6.72e-06\npolygon 27             15      4464.20      6.15e-06\npolygon 28             14      5466.74      7.54e-06\npolygon 29             37      5261.94      7.25e-06\npolygon 30            111    662927.00      9.14e-04\npolygon 31             69     56313.40      7.76e-05\npolygon 32            143    145139.00      2.00e-04\npolygon 33            397   2488210.00      3.43e-03\npolygon 34             90    115991.00      1.60e-04\npolygon 35             98     62682.90      8.64e-05\npolygon 36            165    338736.00      4.67e-04\npolygon 37            130     94046.50      1.30e-04\npolygon 38             93    430642.00      5.94e-04\npolygon 39             16      2010.46      2.77e-06\npolygon 40            415   3253840.00      4.49e-03\npolygon 41             30     10838.20      1.49e-05\npolygon 42             53     34400.30      4.74e-05\npolygon 43             26      8347.58      1.15e-05\npolygon 44             74     58223.40      8.03e-05\npolygon 45            327   2169210.00      2.99e-03\npolygon 46            177    467446.00      6.44e-04\npolygon 47             46    699702.00      9.65e-04\npolygon 48              6     16841.00      2.32e-05\npolygon 49             13     70087.30      9.66e-05\npolygon 50              4      9459.63      1.30e-05\nenclosing rectangle: [2663.93, 56047.79] x [16357.98, 50244.03] units\n                     (53380 x 33890 units)\nWindow area = 725376000 square units\nFraction of frame area: 0.401\n\n\n\nchildcareSG_ppp = childcare_ppp[sg_owin]\n\n\nsummary(childcareSG_ppp)\n\nMarked planar point pattern:  1545 points\nAverage intensity 2.129929e-06 points per square unit\n\nCoordinates are given to 11 decimal places\n\nmarks are of type 'character'\nSummary:\n   Length     Class      Mode \n     1545 character character \n\nWindow: polygonal boundary\n50 separate polygons (1 hole)\n                 vertices         area relative.area\npolygon 1 (hole)       30     -7081.18     -9.76e-06\npolygon 2              55     82537.90      1.14e-04\npolygon 3              90    415092.00      5.72e-04\npolygon 4              49     16698.60      2.30e-05\npolygon 5              38     24249.20      3.34e-05\npolygon 6             976  23344700.00      3.22e-02\npolygon 7             721   1927950.00      2.66e-03\npolygon 8            1992   9992170.00      1.38e-02\npolygon 9             330   1118960.00      1.54e-03\npolygon 10            175    925904.00      1.28e-03\npolygon 11            115    928394.00      1.28e-03\npolygon 12             24      6352.39      8.76e-06\npolygon 13            190    202489.00      2.79e-04\npolygon 14             37     10170.50      1.40e-05\npolygon 15             25     16622.70      2.29e-05\npolygon 16             10      2145.07      2.96e-06\npolygon 17             66     16184.10      2.23e-05\npolygon 18           5195 636837000.00      8.78e-01\npolygon 19             76    312332.00      4.31e-04\npolygon 20            627  31891300.00      4.40e-02\npolygon 21             20     32842.00      4.53e-05\npolygon 22             42     55831.70      7.70e-05\npolygon 23             67   1313540.00      1.81e-03\npolygon 24            734   4690930.00      6.47e-03\npolygon 25             16      3194.60      4.40e-06\npolygon 26             15      4872.96      6.72e-06\npolygon 27             15      4464.20      6.15e-06\npolygon 28             14      5466.74      7.54e-06\npolygon 29             37      5261.94      7.25e-06\npolygon 30            111    662927.00      9.14e-04\npolygon 31             69     56313.40      7.76e-05\npolygon 32            143    145139.00      2.00e-04\npolygon 33            397   2488210.00      3.43e-03\npolygon 34             90    115991.00      1.60e-04\npolygon 35             98     62682.90      8.64e-05\npolygon 36            165    338736.00      4.67e-04\npolygon 37            130     94046.50      1.30e-04\npolygon 38             93    430642.00      5.94e-04\npolygon 39             16      2010.46      2.77e-06\npolygon 40            415   3253840.00      4.49e-03\npolygon 41             30     10838.20      1.49e-05\npolygon 42             53     34400.30      4.74e-05\npolygon 43             26      8347.58      1.15e-05\npolygon 44             74     58223.40      8.03e-05\npolygon 45            327   2169210.00      2.99e-03\npolygon 46            177    467446.00      6.44e-04\npolygon 47             46    699702.00      9.65e-04\npolygon 48              6     16841.00      2.32e-05\npolygon 49             13     70087.30      9.66e-05\npolygon 50              4      9459.63      1.30e-05\nenclosing rectangle: [2663.93, 56047.79] x [16357.98, 50244.03] units\n                     (53380 x 33890 units)\nWindow area = 725376000 square units\nFraction of frame area: 0.401\n\n\n\nplot(childcareSG_ppp)\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 1545 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\n\n\nkde_childcareSG_bw &lt;- density(childcareSG_ppp,\n                              sigma=bw.diggle,\n                              edge=TRUE,\n                            kernel=\"gaussian\") \n\n\nplot(kde_childcareSG_bw)\n\n\n\n\n\n\n\n\n\nbw &lt;- bw.diggle(childcareSG_ppp)\nbw\n\n   sigma \n298.4095 \n\n\n\nchildcareSG_ppp.km &lt;- rescale.ppp(childcareSG_ppp, 1000, \"km\")\n\n\nkde_childcareSG.bw &lt;- density(childcareSG_ppp.km, sigma=bw.diggle, edge=TRUE, kernel=\"gaussian\")\nplot(kde_childcareSG.bw)\n\n\n\n\n\n\n\n\n\nbw.CvL(childcareSG_ppp.km)\n\n   sigma \n4.543278 \n\n\n\nbw.scott(childcareSG_ppp.km)\n\n sigma.x  sigma.y \n2.224898 1.450966 \n\n\n\nbw.ppl(childcareSG_ppp.km)\n\n    sigma \n0.3897114 \n\n\n\nbw.diggle(childcareSG_ppp.km)\n\n    sigma \n0.2984095 \n\n\n\nkde_childcareSG.ppl &lt;- density(childcareSG_ppp.km, \n                               sigma=bw.ppl, \n                               edge=TRUE,\n                               kernel=\"gaussian\")\npar(mfrow=c(1,2))\nplot(kde_childcareSG.bw, main = \"bw.diggle\")\nplot(kde_childcareSG.ppl, main = \"bw.ppl\")\n\n\n\n\n\n\n\n\n\npar(mfrow=c(2,2))\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"Gaussian\")\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"epanechnikov\"), \n     main=\"Epanechnikov\")\n\nWarning in density.ppp(childcareSG_ppp.km, sigma = bw.ppl, edge = TRUE, :\nBandwidth selection will be based on Gaussian kernel\n\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"quartic\"), \n     main=\"Quartic\")\n\nWarning in density.ppp(childcareSG_ppp.km, sigma = bw.ppl, edge = TRUE, :\nBandwidth selection will be based on Gaussian kernel\n\nplot(density(childcareSG_ppp.km, \n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"disc\"), \n     main=\"Disc\")\n\nWarning in density.ppp(childcareSG_ppp.km, sigma = bw.ppl, edge = TRUE, :\nBandwidth selection will be based on Gaussian kernel\n\n\n\n\n\n\n\n\n\n\nkde_childcareSG_600 &lt;- density(childcareSG_ppp.km, sigma=0.6, edge=TRUE, kernel=\"gaussian\")\nplot(kde_childcareSG_600)\n\n\n\n\n\n\n\n\n\nkde_childcareSG_adaptive &lt;- adaptive.density(childcareSG_ppp.km, method=\"kernel\")\nplot(kde_childcareSG_adaptive)\n\n\n\n\n\n\n\n\n\n# install.packages(\"maptools\", repos = \"https://packagemanager.posit.co/cran/2023-10-13\")\n\n\ngridded_kde_childcareSG_bw &lt;- as.SpatialGridDataFrame.im(kde_childcareSG.bw)\n\nspplot(gridded_kde_childcareSG_bw)\n\n\n\n\n\n\n\n\n\nkde_childcareSG_bw_raster &lt;- raster(kde_childcareSG.bw)\n\n\nkde_childcareSG_bw_raster\n\nclass      : RasterLayer \ndimensions : 128, 128, 16384  (nrow, ncol, ncell)\nresolution : 0.4170614, 0.2647348  (x, y)\nextent     : 2.663926, 56.04779, 16.35798, 50.24403  (xmin, xmax, ymin, ymax)\ncrs        : NA \nsource     : memory\nnames      : layer \nvalues     : -8.476185e-15, 28.51831  (min, max)\n\n\n\nprojection(kde_childcareSG_bw_raster) &lt;- CRS(\"+init=EPSG:3414\")\nkde_childcareSG_bw_raster\n\nclass      : RasterLayer \ndimensions : 128, 128, 16384  (nrow, ncol, ncell)\nresolution : 0.4170614, 0.2647348  (x, y)\nextent     : 2.663926, 56.04779, 16.35798, 50.24403  (xmin, xmax, ymin, ymax)\ncrs        : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs \nsource     : memory\nnames      : layer \nvalues     : -8.476185e-15, 28.51831  (min, max)\n\n\n\ntm_shape(kde_childcareSG_bw_raster) + \n  tm_raster(\"layer\", palette = \"viridis\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\"), frame = FALSE)\n\n\n\n\n\n\n\n\n\npg &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"PUNGGOL\")\ntm &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"TAMPINES\")\nck &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"CHOA CHU KANG\")\njw &lt;- mpsz_sf %&gt;%\n  filter(PLN_AREA_N == \"JURONG WEST\")\n\n\npar(mfrow=c(2,2))\nplot(pg, main = \"Ponggol\")\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\n\nplot(tm, main = \"Tampines\")\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\n\nplot(ck, main = \"Choa Chu Kang\")\n\nWarning: plotting the first 10 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\n\nplot(jw, main = \"Jurong West\")\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\n\npg_owin = as.owin(pg)\ntm_owin = as.owin(tm)\nck_owin = as.owin(ck)\njw_owin = as.owin(jw)\n\n\nchildcare_pg_ppp = childcare_ppp_jit[pg_owin]\nchildcare_tm_ppp = childcare_ppp_jit[tm_owin]\nchildcare_ck_ppp = childcare_ppp_jit[ck_owin]\nchildcare_jw_ppp = childcare_ppp_jit[jw_owin]\n\n\nchildcare_pg_ppp.km = rescale.ppp(childcare_pg_ppp, 1000, \"km\")\nchildcare_tm_ppp.km = rescale.ppp(childcare_tm_ppp, 1000, \"km\")\nchildcare_ck_ppp.km = rescale.ppp(childcare_ck_ppp, 1000, \"km\")\nchildcare_jw_ppp.km = rescale.ppp(childcare_jw_ppp, 1000, \"km\")\n\n\npar(mfrow=c(2,2))\nplot(childcare_pg_ppp.km, main=\"Punggol\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 61 symbols are shown in the symbol map\n\nplot(childcare_tm_ppp.km, main=\"Tampines\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 89 symbols are shown in the symbol map\n\nplot(childcare_ck_ppp.km, main=\"Choa Chu Kang\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 61 symbols are shown in the symbol map\n\nplot(childcare_jw_ppp.km, main=\"Jurong West\")\n\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n\n\nWarning: Only 10 out of 88 symbols are shown in the symbol map\n\n\n\n\n\n\n\n\n\n\npar(mfrow=c(2,2))\nplot(density(childcare_pg_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Punggol\")\nplot(density(childcare_tm_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Tampines\")\nplot(density(childcare_ck_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Choa Chu Kang\")\nplot(density(childcare_jw_ppp.km, \n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"JUrong West\")\n\n\n\n\n\n\n\n\n\npar(mfrow=c(2,2))\nplot(density(childcare_ck_ppp.km, \n             sigma=0.25, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Chou Chu Kang\")\nplot(density(childcare_jw_ppp.km, \n             sigma=0.25, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"JUrong West\")\nplot(density(childcare_pg_ppp.km, \n             sigma=0.25, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Punggol\")\nplot(density(childcare_tm_ppp.km, \n             sigma=0.25, \n             edge=TRUE, \n             kernel=\"gaussian\"),\n     main=\"Tampines\")\n\n\n\n\n\n\n\n\n\nclarkevans.test(childcareSG_ppp,\n                correction=\"none\",\n                clipregion=\"sg_owin\",\n                alternative=c(\"clustered\"),\n                nsim=99)\n\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  childcareSG_ppp\nR = 0.55631, p-value &lt; 2.2e-16\nalternative hypothesis: clustered (R &lt; 1)\n\n\n\nclarkevans.test(childcare_ck_ppp,\n                correction=\"none\",\n                clipregion=NULL,\n                alternative=c(\"two.sided\"),\n                nsim=999)\n\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  childcare_ck_ppp\nR = 0.93008, p-value = 0.2961\nalternative hypothesis: two-sided\n\n\n\nclarkevans.test(childcare_tm_ppp,\n                correction=\"none\",\n                clipregion=NULL,\n                alternative=c(\"two.sided\"),\n                nsim=999)\n\n\n    Clark-Evans test\n    No edge correction\n    Z-test\n\ndata:  childcare_tm_ppp\nR = 0.79603, p-value = 0.0002321\nalternative hypothesis: two-sided\n\n\n\nG_CK = Gest(childcare_ck_ppp, correction = \"border\")\nplot(G_CK, xlim=c(0,500))\n\n\n\n\n\n\n\n\n\nG_CK.csr &lt;- envelope(childcare_ck_ppp, Gest, nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\n\nplot(G_CK.csr)\n\n\n\n\n\n\n\n\n\nG_tm = Gest(childcare_tm_ppp, correction = \"best\")\nplot(G_tm)\n\n\n\n\n\n\n\n\n\nG_tm.csr &lt;- envelope(childcare_tm_ppp, Gest, correction = \"all\", nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\n\nplot(G_tm.csr)\n\n\n\n\n\n\n\n\n\nF_CK = Fest(childcare_ck_ppp)\nplot(F_CK)\n\n\n\n\n\n\n\n\n\nF_CK.csr &lt;- envelope(childcare_ck_ppp, Fest, nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\n\nplot(F_CK.csr)\n\n\n\n\n\n\n\n\n\nF_tm = Fest(childcare_tm_ppp, correction = \"best\")\nplot(F_tm)\n\n\n\n\n\n\n\n\n\nF_tm.csr &lt;- envelope(childcare_tm_ppp, Fest, correction = \"all\", nsim = 999)\n\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n\n\n\nplot(F_tm.csr)\n\n\n\n\n\n\n\n\n\nK_ck = Kest(childcare_ck_ppp, correction = \"Ripley\")\nplot(K_ck, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n\n\n\n\n\n\n\n\n\nK_ck.csr &lt;- envelope(childcare_ck_ppp, Kest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\n\nplot(K_ck.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n\n\n\n\n\n\n\n\n\nK_tm = Kest(childcare_tm_ppp, correction = \"Ripley\")\nplot(K_tm, . -r ~ r, \n     ylab= \"K(d)-r\", xlab = \"d(m)\", \n     xlim=c(0,1000))\n\n\n\n\n\n\n\n\n\nK_tm.csr &lt;- envelope(childcare_tm_ppp, Kest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\n\nplot(K_tm.csr, . - r ~ r, \n     xlab=\"d\", ylab=\"K(d)-r\", xlim=c(0,500))\n\n\n\n\n\n\n\n\n\nL_ck = Lest(childcare_ck_ppp, correction = \"Ripley\")\nplot(L_ck, . -r ~ r, \n     ylab= \"L(d)-r\", xlab = \"d(m)\")\n\n\n\n\n\n\n\n\n\nL_ck.csr &lt;- envelope(childcare_ck_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\n\nplot(L_ck.csr, . - r ~ r, xlab=\"d\", ylab=\"L(d)-r\")\n\n\n\n\n\n\n\n\n\nL_tm = Lest(childcare_tm_ppp, correction = \"Ripley\")\nplot(L_tm, . -r ~ r, \n     ylab= \"L(d)-r\", xlab = \"d(m)\", \n     xlim=c(0,1000))\n\n\n\n\n\n\n\n\n\nL_tm.csr &lt;- envelope(childcare_tm_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)\n\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n\n\n\nplot(L_tm.csr, . - r ~ r, \n     xlab=\"d\", ylab=\"L(d)-r\", xlim=c(0,500))"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex01/In-class_Ex01.html",
    "href": "In-class_Ex/In-class_Ex01/In-class_Ex01.html",
    "title": "In-class_Ex01",
    "section": "",
    "text": "pacman::p_load(tidyverse, sf, tmap, ggstatsplot)\n\n\nmpsz14_shp &lt;- st_read(dsn = \"data/\",\n                layer = \"MP14_SUBZONE_WEB_PL\")    \n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex01\\data' using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nmpsz14_kml &lt;- st_read(“C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex01/data/MasterPlan2014SubzoneBoundaryWebKML.kml”)\n\nst_write(mpsz14_shp, \n         \"data/MP14_SUBZONE_WEB_PL.kml\",\n         delete_dsn = TRUE)\n\nDeleting source `data/MP14_SUBZONE_WEB_PL.kml' using driver `KML'\nWriting layer `MP14_SUBZONE_WEB_PL' to data source \n  `data/MP14_SUBZONE_WEB_PL.kml' using driver `KML'\nWriting 323 features with 15 fields and geometry type Multi Polygon.\n\n\n\npreschool_kml &lt;- st_read(\"data/PreschoolsLocation.kml\")%&gt;% \n  st_transform(crs=3414)\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex01\\data\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\npreschool_geojson &lt;- st_read(\"data/PreschoolsLocation.geojson\")\n\nReading layer `PreSchoolsLocation' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex01\\data\\PreSchoolsLocation.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\nmpsz19_shp &lt;- st_read(dsn=\"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex02/data/\",\n                layer = \"MPSZ-2019\") %&gt;% \n  st_transform(crs=3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex02\\data' using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz19_kml &lt;- st_read(\"data/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\nReading layer `URA_MP19_SUBZONE_NO_SEA_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex01\\data\\MasterPlan2019SubzoneBoundaryNoSeaKML.kml' \n  using driver `KML'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY, XYZ\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\nst_crs(mpsz19_shp)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nst_crs(mpsz19_kml)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\n\n\nst_crs(preschool_geojson)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\n\n\nst_crs(preschool_kml)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nst_crs(mpsz14_shp)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\n\npreschool &lt;- st_read(\"data/PreSchoolsLocation.kml\") %&gt;% \n  st_transform(crs=3414)\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex01\\data\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\nst_crs(preschool)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nintersect_list &lt;- st_intersects(mpsz19_shp, preschool)\nprint(intersect_list)\n\nSparse geometry binary predicate list of length 332, where the\npredicate was `intersects'\nfirst 10 elements:\n 1: (empty)\n 2: 669\n 3: 68, 188, 405, 1263, 1661, 1982\n 4: (empty)\n 5: (empty)\n 6: (empty)\n 7: (empty)\n 8: (empty)\n 9: (empty)\n 10: 367, 670, 1585, 2113\n\n\n\nintersect_lengths &lt;- lengths(intersect_list)\nprint(intersect_lengths)\n\n  [1]  0  1  6  0  0  0  0  0  0  4  0  1  0  5  3  0  2  4  1  7  2 12  7  0  0\n [26]  4  4 10  1  3  0  6  0  3  1  0  6  0  5  3 13  5  1 11  1  4  2  8  1  0\n [51] 11  3  1  4  9  1  5  0  3 11  0  0  1  0 22  3  1  2  0  3  0  4  1  9  4\n [76]  0  2  1  2  0  0  1  4  1  2  7  0  0  2  0  0 10  0 14  0  5  5  0 10 23\n[101]  3  3  9  3 38 18  5  5 11  9  8  0  3  8  1  0  2  1  0  0  0  6  6  3  0\n[126]  0  8  5  5  8  6  5  7  3  4  0  0  4 21  0 36 14  3 16 11  0  3  2  2 29\n[151] 18 21  0 11 13 38 11  0  0  0 13 16  9 17  5  1  3 22  4 12  4  9  3  0 17\n[176]  8  5  5 72 25  3  8  4  0  6  6  0  2  8  6  0  3 24  0  7 18 11 10 28 13\n[201] 21 19  8 20 13  5  7  9 12  9  0  4 32  7 30  1  0  0  3  0  0 22  6  8  5\n[226]  6 10  4  0 15  0 12  4 11 23 16  0  7  0 15 26  6 23 13  6 13  5 12 10  7\n[251]  6  7  1  8  9 16 27  0  0 33 20  0 16 22 16  0 13 23  0  2 15  0  0  1  0\n[276]  0  4  0  0  0  0  0  0  0  0  0  0  0  0  8  2  0 14 40  0  0 14 21 20  1\n[301]  0 22  2  0  0 20 19  9 12  0  0 54 27  1 10  0  0 10  0  0  0 12  0  4  0\n[326]  1  0 18  9 10 19  0\n\n\n\n# Mutate `mpsz19_shp` to add the \"PreSch Count\" column\nmpsz19_shp &lt;- mpsz19_shp %&gt;%\n  mutate(`PreSch Count` = intersect_lengths)\n\n\nmpsz19_shp &lt;- mpsz19_shp %&gt;%\n  mutate(Area = units::drop_units(\n    st_area(.)),\n    `PreSch Density` = `PreSch Count` / Area * 1000000\n  )\n\n\nmpsz19_shp$`PreSch Density` &lt;- as.numeric(as.character(mpsz19_shp$`PreSch Density`))\n\nmpsz19_shp$`PreSch Count` &lt;- as.numeric(as.character(mpsz19_shp$`PreSch Count`))\n\nmpsz19_shp_1 &lt;- as.data.frame(mpsz19_shp)\n\nstr(mpsz19_shp_1)\n\n'data.frame':   332 obs. of  10 variables:\n $ SUBZONE_N     : chr  \"MARINA EAST\" \"INSTITUTION HILL\" \"ROBERTSON QUAY\" \"JURONG ISLAND AND BUKOM\" ...\n $ SUBZONE_C     : chr  \"MESZ01\" \"RVSZ05\" \"SRSZ01\" \"WISZ01\" ...\n $ PLN_AREA_N    : chr  \"MARINA EAST\" \"RIVER VALLEY\" \"SINGAPORE RIVER\" \"WESTERN ISLANDS\" ...\n $ PLN_AREA_C    : chr  \"ME\" \"RV\" \"SR\" \"WI\" ...\n $ REGION_N      : chr  \"CENTRAL REGION\" \"CENTRAL REGION\" \"CENTRAL REGION\" \"WEST REGION\" ...\n $ REGION_C      : chr  \"CR\" \"CR\" \"CR\" \"WR\" ...\n $ geometry      :sfc_MULTIPOLYGON of length 332; first list element: List of 1\n  ..$ :List of 1\n  .. ..$ : num [1:300, 1:2] 33223 33223 33222 33222 33221 ...\n  ..- attr(*, \"class\")= chr [1:3] \"XY\" \"MULTIPOLYGON\" \"sfg\"\n $ PreSch Count  : num  0 1 6 0 0 0 0 0 0 4 ...\n $ Area          : num  1844042 392563 506589 36639387 388733 ...\n $ PreSch Density: num  0 2.55 11.84 0 0 ...\n - attr(*, \"sf_column\")= chr \"geometry\"\n - attr(*, \"agr\")= Factor w/ 3 levels \"constant\",\"aggregate\",..: NA NA NA NA NA NA NA NA NA\n  ..- attr(*, \"names\")= chr [1:9] \"SUBZONE_N\" \"SUBZONE_C\" \"PLN_AREA_N\" \"PLN_AREA_C\" ...\n\n\n\nggscatterstats(\n  data = mpsz19_shp_1,\n  x = `PreSch Density`,\n  y = `PreSch Count`,\n  type = 'parametric',\n  label.var = SUBZONE_N,  # Column to be used for labeling\n  label.expression = `PreSch Count` &gt; 50 & `PreSch Density` &gt; 10  # \n)\n\nRegistered S3 method overwritten by 'ggside':\n  method from   \n  +.gg   ggplot2\n\n\n`stat_xsidebin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_ysidebin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\n\npopdata &lt;- read_csv(\"data/respopagesextod2023.csv\")\n\nRows: 100928 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\npopdata2023 &lt;- popdata %&gt;% \n  group_by(PA,SZ,AG) %&gt;% \n  summarise(`POP`=sum(`Pop`)) %&gt;% \n  ungroup() %&gt;% \n  pivot_wider(names_from = AG,\n              values_from = POP)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\n\n\npopdata2023 &lt;- popdata2023 %&gt;%\n  mutate(YOUNG=rowSums(.[3:6]) # Aged 0 - 24, 10 - 24\n         +rowSums(.[14])) %&gt;% # Aged 5 - 9\n  mutate(`ECONOMY ACTIVE` = rowSums(.[7:13])+ # Aged 25 - 59\n  rowSums(.[15])) %&gt;%  # Aged 60 -64\n  mutate(`AGED`=rowSums(.[16:21])) %&gt;%\n  mutate(`TOTAL`=rowSums(.[3:21])) %&gt;%\n  mutate(`DEPENDENCY`=(`YOUNG` + `AGED`)\n  / `ECONOMY ACTIVE`) %&gt;% \n  select(`PA`, `SZ`, `YOUNG`, \n         `ECONOMY ACTIVE`, `AGED`,\n         `TOTAL`, `DEPENDENCY`)\n\n\npopdata2023 &lt;- popdata2023 %&gt;%\n  mutate_at(.vars = vars(PA, SZ), \n          .funs = list(toupper)) \n\n\nmpsz_pop2023 &lt;- left_join(mpsz19_shp, popdata2023,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n\n\npop2023_mpsz &lt;- left_join(popdata2023, mpsz19_shp, \n                          by = c(\"SZ\" = \"SUBZONE_N\"))\n\n\nmpsz_pop2023 &lt;- mpsz_pop2023 %&gt;% \n  drop_na()\n\n\nget.var &lt;- function(vname,df) {\n  v &lt;- df[vname] %&gt;% \n    st_set_geometry(NULL)\n  v &lt;- unname(v[,1])\n  return(v)\n}\n\n\npercentmap &lt;- function(vnam, df, legtitle=NA, mtitle=\"Percentile Map\"){\n  percent &lt;- c(0,.01,.1,.5,.9,.99,1)\n  var &lt;- get.var(vnam, df)\n  bperc &lt;- quantile(var, percent)\n  tm_shape(mpsz_pop2023) +\n  tm_polygons() +\n  tm_shape(df) +\n     tm_fill(vnam,\n             title=legtitle,\n             breaks=bperc,\n             palette=\"Blues\",\n          labels=c(\"&lt; 1%\", \"1% - 10%\", \"10% - 50%\", \"50% - 90%\", \"90% - 99%\", \"&gt; 99%\"))  +\n  tm_borders() +\n  tm_layout(main.title = mtitle, \n            title.position = c(\"right\",\"bottom\"))\n}\n\n\npercentmap(\"DEPENDENCY\",mpsz_pop2023)\n\n\n\n\n\n\n\n\n\nggplot(data = mpsz_pop2023,\n       aes(x = \"\",\n           y = DEPENDENCY)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n\nboxbreaks &lt;- function(v,mult=1.5) {\n  qv &lt;- unname(quantile(v))\n  iqr &lt;- qv[4] - qv[2]\n  upfence &lt;- qv[4] + mult * iqr\n  lofence &lt;- qv[2] - mult * iqr\n  # initialize break points vector\n  bb &lt;- vector(mode=\"numeric\",length=7)\n  # logic for lower and upper fences\n  if (lofence &lt; qv[1]) {  # no lower outliers\n    bb[1] &lt;- lofence\n    bb[2] &lt;- floor(qv[1])\n  } else {\n    bb[2] &lt;- lofence\n    bb[1] &lt;- qv[1]\n  }\n  if (upfence &gt; qv[5]) { # no upper outliers\n    bb[7] &lt;- upfence\n    bb[6] &lt;- ceiling(qv[5])\n  } else {\n    bb[6] &lt;- upfence\n    bb[7] &lt;- qv[5]\n  }\n  bb[3:5] &lt;- qv[2:4]\n  return(bb)\n}\n\n\nget.var &lt;- function(vname,df) {\n  v &lt;- df[vname] %&gt;% st_set_geometry(NULL)\n  v &lt;- unname(v[,1])\n  return(v)\n}\n\n\nboxmap &lt;- function(vnam, df, \n                   legtitle=NA,\n                   mtitle=\"Box Map\",\n                   mult=1.5){\n  var &lt;- get.var(vnam,df)\n  bb &lt;- boxbreaks(var)\n  tm_shape(df) +\n    tm_polygons() +\n  tm_shape(df) +\n     tm_fill(vnam,title=legtitle,\n             breaks=bb,\n             palette=\"Blues\",\n          labels = c(\"lower outlier\", \n                     \"&lt; 25%\", \n                     \"25% - 50%\", \n                     \"50% - 75%\",\n                     \"&gt; 75%\", \n                     \"upper outlier\"))  +\n  tm_borders() +\n  tm_layout(main.title = mtitle, \n            title.position = c(\"left\",\n                               \"top\"))\n}\n\n\nboxmap(\"DEPENDENCY\", mpsz_pop2023)\n\n\n\n\n\n\n\n\n\ntmap_options(check.and.fix = TRUE)\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\nboxmap(\"DEPENDENCY\", mpsz_pop2023)\n\nWarning: The shape df is invalid (after reprojection). See sf::st_is_valid\nWarning: The shape df is invalid (after reprojection). See sf::st_is_valid"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex02/In-class_Ex02.html",
    "href": "In-class_Ex/In-class_Ex02/In-class_Ex02.html",
    "title": "In-class Exercise 02",
    "section": "",
    "text": "install.packages(\"maptools\", repos = \"https://packagemanager.posit.co/cran/2023-10-13\")\n\n\n# set_seed(1234)\npacman::p_load(sf,raster,spatstat,tmap,tidyverse,sp,maptools)\n\n\n# filter out NA or missing data of longitude and latitude\n# check how many missing values (make sure less than 25%)\nrdacc_sf &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex02/data/thai_road_accident_2019_2022.csv\") %&gt;% \n  filter(!is.na(longitude) & longitude != \"\",\n         !is.na(latitude)& latitude != \"\") %&gt;% \n  st_as_sf(coords = c(\n    \"longitude\", \"latitude\"),\n    crs = 4326) %&gt;% \n  st_transform(crs = 32647)\n\nRows: 81735 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (10): province_th, province_en, agency, route, vehicle_type, presumed_c...\ndbl   (6): acc_code, number_of_vehicles_involved, number_of_fatalities, numb...\ndttm  (2): incident_datetime, report_datetime\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nview(rdacc_sf)\n\nacled_sg %&gt;% filter"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "",
    "text": "Thailand’s roads are the deadliest in Southeast Asia and among the worst in the world, according to the World Health Organisation. About 20,000 people die in road accidents each year, or about 56 deaths a day (WHO)."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#overview",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#overview",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "",
    "text": "Thailand’s roads are the deadliest in Southeast Asia and among the worst in the world, according to the World Health Organisation. About 20,000 people die in road accidents each year, or about 56 deaths a day (WHO)."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#objectives",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#objectives",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "2 Objectives",
    "text": "2 Objectives\nIn view of this, we need discover factors affecting road traffic accidents in the Bangkok Metropolitan Region BMR by employing both spatial spatio-temporal point patterns analysis methods.\nThe specific objectives of this take-home exercise are as follows:\n\nTo visualize the spatio-temporal dynamics of road traffic accidents in BMR using appropriate statistical graphics and geovisualization methods.\nTo conduct detailed spatial analysis of road traffic accidents using appropriate Network Spatial Point Patterns Analysis methods.\nTo conduct detailed spatio-temporal analysis of road traffic accidents using appropriate Temporal Network Spatial Point Patterns Analysis methods.\n\n\nset.seed(1234)\npacman::p_load(sf,raster,spatstat,tmap,tidyverse,sp,maptools)\n\n\n# filter out NA or missing data of longitude and latitude\n# check how many missing values (make sure less than 25%)\nrdacc_sf &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex01/data/thai_road_accident_2019_2022.csv\") %&gt;% \n  filter(!is.na(longitude) & longitude != \"\",\n         !is.na(latitude)& latitude != \"\") %&gt;% \n  st_as_sf(coords = c(\n    \"longitude\", \"latitude\"),\n    crs = 4326) %&gt;% \n  st_transform(crs = 32647)\n\nRows: 81735 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (10): province_th, province_en, agency, route, vehicle_type, presumed_c...\ndbl   (6): acc_code, number_of_vehicles_involved, number_of_fatalities, numb...\ndttm  (2): incident_datetime, report_datetime\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nst_geometry(rdacc_sf)\n\nGeometry set for 81376 features \nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -16183190 ymin: -936.228 xmax: 1200243 ymax: 4918525\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 5 geometries:\n\n\nPOINT (701480.8 1654653)\n\n\nPOINT (1130617 1690121)\n\n\nPOINT (598703.8 1368107)\n\n\nPOINT (479343.9 2056771)\n\n\nPOINT (670249 1754802)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#getting-started",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#getting-started",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "2 Getting Started",
    "text": "2 Getting Started\n\n2.1 Objectives\nIn view of this, we need discover factors affecting road traffic accidents in the Bangkok Metropolitan Region BMR by employing both spatial spatio-temporal point patterns analysis methods.\nThe specific objectives of this take-home exercise are as follows:\n\nTo visualize the spatio-temporal dynamics of road traffic accidents in BMR using appropriate statistical graphics and geovisualization methods.\nTo conduct detailed spatial analysis of road traffic accidents using appropriate Network Spatial Point Patterns Analysis methods.\nTo conduct detailed spatio-temporal analysis of road traffic accidents using appropriate Temporal Network Spatial Point Patterns Analysis methods.\n\n\n\n2.2 The Study Area\nThe focus of this study would in the Bangkok Metropolitan Region BMR, which includes the provinces:\n\nBangkok\nNonthaburi\nNakhon Pathom\nPathum Thani\nSamut Prakan\nSamut Sakhon"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-preparation",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-preparation",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "3 Data Preparation",
    "text": "3 Data Preparation\n\n3.1 Geospatial\nThese data sets are in shp format\n\nThailand Roads, available publicly from HDX\nThailand - Subnational Administrative Boundaries, available publicly from HDX\n\nThis data sets are in csv format\n\nThailand Road Accident [2019-2022], available publicly from Kaggle\n\n\nset.seed(1234)\npacman::p_load(sf,raster,spatstat,tmap,tidyverse,sp,maptools,spNetwork)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-wrangling",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-wrangling",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "4 Data Wrangling",
    "text": "4 Data Wrangling\n\n4.1 Thailand Road Accident 2019-2022\n\n4.1.1 Importing Attribute Data into R\nWe will import thai_road_accident_2019_2022.csv file into RStudio and save the file into an R dataframe called rdacc\n\nrdacc &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex01/data/aspatial/thai_road_accident_2019_2022.csv\")\n\nRows: 81735 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (10): province_th, province_en, agency, route, vehicle_type, presumed_c...\ndbl   (6): acc_code, number_of_vehicles_involved, number_of_fatalities, numb...\ndttm  (2): incident_datetime, report_datetime\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n4.1.2 Filtering missing values\nTo define the geometry of each point, we need to use the latitude and longitude coordinates. Before converting the data frame to an sf object, we need to ensure that there are no missing values in the latitude and longitude columns.\nSince only 359 out of 81,735 rows have missing values, it is reasonable to remove them.\n\nlat_na &lt;- sum(is.na(rdacc$latitude))\nlong_na &lt;- sum(is.na(rdacc$longitude))\n\ntotal_rows &lt;- nrow(rdacc)\n\nlat_na_pct &lt;- (lat_na / total_rows) * 100\nlong_na_pct &lt;- (long_na / total_rows) * 100\n\ncat(\"Missing values in Latitude:\", lat_na, \"(\", round(lat_na_pct, 2), \"% )\\n\")\n\nMissing values in Latitude: 359 ( 0.44 % )\n\ncat(\"Missing values in Longitude:\", long_na, \"(\", round(long_na_pct, 2), \"% )\\n\")\n\nMissing values in Longitude: 359 ( 0.44 % )\n\n\n\n\n4.1.3 Creating a simple feature data frame from an aspatial data frame\nThe code chunk below converts rdacc data frame into a simple feature data frame by using st_as_st() of sf packages\n\nrdacc_sf &lt;- rdacc %&gt;% \n  filter(!is.na(longitude) & longitude != \"\",\n         !is.na(latitude)& latitude != \"\") %&gt;% \n  st_as_sf(coords = c(\n    \"longitude\", \"latitude\"),\n    crs = 4326) %&gt;% \n  st_transform(crs = 32647)\n\nThe code chunk below shows that there are 81376 observations in rdacc_sf\n\nnrow(rdacc_sf)\n\n[1] 81376\n\n\nTo reduce the computational load and improve code execution speed, we should filter the rdacc_sf data to include only cases where the weather condition is clear and the accident type is rear-end collision.\nA high frequency of rear-end collisions under clear conditions may indicate potential issues with road design, traffic signal timing, or congestion, rather than being caused by weather-related factors.\n\nrdacc_sf_2 &lt;- rdacc_sf[rdacc_sf$weather_condition == \"clear\" & rdacc_sf$accident_type == \"rear-end collision\", ]\n\n\n\n\n\n\n\n4.2 Correcting the projection\n\n\n\nEPSG: 4326 is wgs84 Geographic Coordinate System and EPSG: 32647 refers to the WGS 84 / UTM zone 47N Projected Coordinate System, which is specifically used for areas in Thailand.\n\n\n\n\n4.2.1 Plotting the Aspatial Data\nWe use st_geometry to display basic information of the feature class such as type of geometry. It looks like the plot is showing points scattered across a wide area, which suggests that your data includes locations outside the Bangkok Metropolitan Region (BMR).\n\nplot(st_geometry(rdacc_sf_2))\n\n\n\n\n\n\n\n\nTo focus only on data within the BMR, we need to filter the dataset for coordinates that fall within the region.\n\nrdacc_bmr_sf &lt;- rdacc_sf_2 %&gt;%\n  filter(province_en %in% c(\"Bangkok\", \"Nonthaburi\", \"Nakhon Pathom\", \"Pathum Thani\", \"Samut Prakan\", \"Samut Sakhon\"))\n\nOur plot now shows road accident points within the Bangkok Metropolitan Region (BMR) overlaid on the road network. This looks much better than the previous scattered points across a broader region.\n\nplot(st_geometry(rdacc_bmr_sf))\n\n\n\n\n\n\n\n\n\n\n\n4.3 Thailand Roads\n\n4.3.1 Importing Geospatial Data\nWe will import hotosm_tha_roads_lines shapefile into RStudio as sf data frames.\n\nnetwork &lt;- st_read(dsn=\"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex01/data/geospatial\", \n                   layer=\"hotosm_tha_roads_lines_shp\")\n\nReading layer `hotosm_tha_roads_lines_shp' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Take-home_Ex\\Take-home_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2792590 features and 14 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 97.34457 ymin: 5.643645 xmax: 105.6528 ymax: 20.47168\nCRS:           NA\n\n\nThe Coordinate Reference System, CRS is showing NA. Without a CRS, it’s unclear how the coordinates relate to the earth, which can lead to errors when performing spatial analysis.\nSet the CRS of network to WGS 84 (EPSG: 4326).\n\nnetwork &lt;- st_set_crs(network, 4326)\n\nTransform the CRS of network to UTM Zone 47N (EPSG: 32647).\n\nnetwork32647 &lt;- st_transform(network,32647)\n\n\nst_geometry(network32647)\n\nGeometry set for 2792590 features \nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 325313.7 ymin: 624248.4 xmax: 1215576 ymax: 2263968\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 5 geometries:\n\n\nMULTILINESTRING ((693686.1 1519792, 693669.9 15...\n\n\nMULTILINESTRING ((693358 1519300, 693298.9 1519...\n\n\nMULTILINESTRING ((692949.1 1518860, 693039.6 15...\n\n\nMULTILINESTRING ((693256 1519184, 693240.4 1519...\n\n\nMULTILINESTRING ((692810.8 1518630, 692853.4 15...\n\n\nThe code chunk above indicates network32647 with CRS: WGS 84 / UTM zone 47N.\nThere are 2792590 observations, let’s check what the highway types available in the network32647.\n\nunique_values &lt;- unique(network32647$highway)\n\nprint(unique_values)\n\n [1] \"secondary\"      \"residential\"    \"secondary_link\" \"service\"       \n [5] \"tertiary\"       \"path\"           \"footway\"        \"track\"         \n [9] \"unclassified\"   \"trunk\"          \"trunk_link\"     \"primary\"       \n[13] \"primary_link\"   \"steps\"          \"motorway_link\"  \"cycleway\"      \n[17] \"pedestrian\"     \"tertiary_link\"  \"motorway\"       \"construction\"  \n[21] \"road\"           \"raceway\"        \"corridor\"       \"living_street\" \n[25] \"escape\"         \"proposed\"       \"busway\"         \"bridleway\"     \n[29] \"abandoned\"      \"parth\"          \"barrier\"        \"paved\"         \n\n\nAccording to Highway classification on WikiProject Thailand, we should only include intercity roads:\n1 secondary\n2 tertiary\n3 trunk\n4 primary\n5 motorway\n6 unclassified\n\nFilter network32647 data accordingly into a new dataset filtered_network\n\nhighway_types &lt;- c(\n\"secondary\", \"tertiary\",\"trunk\", \"primary\", \"motorway\", \"unclassified\"\n)\n\nfiltered_network &lt;- network32647 %&gt;%\n  filter(highway %in% highway_types)\n\nThe filtered_network now has 203029 observations.\n\nnrow(filtered_network)\n\n[1] 203029\n\n\n\n\n\n4.4 Thailand - Subnational Administrative Boundaries\n\n4.4.1 Importing Geospatial Data\nThailand administrative level 0 (country), 1 (province), 2 (district), and 3 (sub-district, tambon) boundaries. Since we focus on Bangkok Metropolitan Region, we should import level 1 (province) data. We will import tha_admbnda_adm1_rtsd_20220121 shapefile into RStudio as sf data frames.\n\nthai_map &lt;- st_read(dsn=\"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex01/data/geospatial\", \n                   layer=\"tha_admbnda_adm1_rtsd_20220121\")\n\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Take-home_Ex\\Take-home_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n\n\nTransform CRS of thai_map to UTM Zone 47N (EPSG: 32647) as dataset thai_map_32647.\n\nthai_map_32647 &lt;- st_transform(thai_map, crs = 32647)\n\nthai_map_32647 shows projected CRS: WGS 84 / UTM zone 47N, same as filtered_network.\n\nst_geometry(thai_map_32647)\n\nGeometry set for 77 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((674339.8 1543300, 674382.3 1543...\n\n\nMULTIPOLYGON (((687139.8 1517113, 687147.1 1517...\n\n\nMULTIPOLYGON (((644817.9 1559286, 644817.5 1559...\n\n\nMULTIPOLYGON (((704086 1575736, 704089.9 157550...\n\n\nMULTIPOLYGON (((662941.6 1620856, 662957.5 1620...\n\n\nThe thai_map_32647 dataset covers the entire Thailand region.\nFor this study, we are specifically focusing on the Bangkok Metropolitan Region (BMR). Accordingly, we will filter the dataset to include only the BMR area.”\n\nthaiBMR &lt;- thai_map_32647 %&gt;%\n  filter(ADM1_EN %in% c(\"Bangkok\", \"Nonthaburi\", \"Nakhon Pathom\", \"Pathum Thani\", \"Samut Prakan\", \"Samut Sakhon\"))\n\nThaiBMR dataset only consists of the 6 provinces in BMR.\n\nthaiBMR\n\nSimple feature collection with 6 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 587893.5 ymin: 1484414 xmax: 712440.5 ymax: 1579076\nProjected CRS: WGS 84 / UTM zone 47N\n  Shape_Leng Shape_Area       ADM1_EN      ADM1_TH ADM1_PCODE ADM1_REF\n1   2.417227 0.13133873       Bangkok กรุงเทพมหานคร       TH10     &lt;NA&gt;\n2   1.695100 0.07926199  Samut Prakan   สมุทรปราการ       TH11     &lt;NA&gt;\n3   1.251111 0.05323766    Nonthaburi        นนทบุรี       TH12     &lt;NA&gt;\n4   1.884945 0.12698345  Pathum Thani       ปทุมธานี       TH13     &lt;NA&gt;\n5   2.463030 0.17891420 Nakhon Pathom       นครปฐม       TH73     &lt;NA&gt;\n6   1.566369 0.07155983  Samut Sakhon     สมุทรสาคร       TH74     &lt;NA&gt;\n  ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH ADM0_PCODE\n1       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n2       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n3       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n4       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n5       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n6       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n        date    validOn    validTo                       geometry\n1 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((674339.8 15...\n2 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((687139.8 15...\n3 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((644817.9 15...\n4 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((704086 1575...\n5 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((631987.6 15...\n6 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((641549.1 15...\n\n\n\n\n4.4.2 Visualizing the Geospatial Data\nWe will visual the distribution of road accidents in BMR below using the datasets thaiBMR and rdacc_bmr_sf.\n\nplot(st_geometry(thaiBMR), col = \"lightblue\", main = \"BMR with Road Accidents\")\n\nplot(rdacc_bmr_sf$geometry, col = \"red\", pch = 19, add = TRUE)\n\n\n\n\n\n\n\n\nThe filtered_network dataset covers all Thailand region. We can use st_intersection() function to find the geometric intersection of thaiBMR. The new dataset will be BMR_network that only consists BMR networks.\n\nBMR_network &lt;- st_intersection(filtered_network,thaiBMR)\n\nThe BMR_network consists of 26725 observations.\n\nst_geometry(BMR_network)\n\nGeometry set for 26725 features \nGeometry type: GEOMETRY\nDimension:     XY\nBounding box:  xmin: 590124.8 ymin: 1484506 xmax: 712235 ymax: 1579041\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 5 geometries:\n\n\nLINESTRING (693686.1 1519792, 693669.9 1519740,...\n\n\nLINESTRING (692810.8 1518630, 692853.4 1518630,...\n\n\nLINESTRING (668360.2 1522450, 668339 1522391, 6...\n\n\nLINESTRING (667716.6 1522782, 667687.5 1522728,...\n\n\nLINESTRING (667485.1 1522102, 667517.7 1522086,...\n\n\nWe visualize the distribution of the road accidents within the network in BMR using BMR_network, thaiBMR and rdacc_bmr_sf.\n\nplot(st_geometry(thaiBMR), col = \"lightblue\", main = \"BMR with Highways\")\nplot(st_geometry(BMR_network), col = \"black\", add = TRUE)\n\nplot(rdacc_bmr_sf, add = TRUE, col = 'red', pch = 19, cex = 0.5)  # cex = 0.5 \n\n\n\n\n\n\n\n\nThis map of the Bangkok Metropolitan Region (BMR) shows the distribution of rear-end collisions that occurred under clear weather conditions. The highlighted road network includes highways classified as secondary, tertiary, trunk, primary, motorway, and unclassified types."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex04/Hands-on_ex04.html",
    "href": "Hands-on_exercise/Hands-on_ex04/Hands-on_ex04.html",
    "title": "Hands-on_ex04",
    "section": "",
    "text": "pacman::p_load(sf,spdep,tmap,tidyverse,knitr)\n\n\nhunan &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex04/data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex04\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\nplot(st_geometry(hunan))\n\n\n\n\n\n\n\n\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(hunan) + tm_polygons()\n\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nhunan2012 &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex04/data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nhunan &lt;- left_join(hunan,hunan2012)\n\nJoining with `by = join_by(County)`\n\nhunan &lt;- select(hunan,1:4,7,15)\n\n\nbasemap &lt;- tm_shape(hunan) +\n  tm_polygons() +\n  tm_text(\"NAME_3\", size=0.5)\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nwm_q &lt;- poly2nb(hunan)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\nwm_q[[1]]\n\n[1]  2  3  4 57 85\n\n\n\nhunan$NAME_2[1]\n\n[1] \"Changde\"\n\nhunan$County[1]\n\n[1] \"Anxiang\"\n\n\n\nhunan$NAME_3[c(2,3,4,57,85)]\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\n\nstr(wm_q)\n\nList of 88\n $ : int [1:5] 2 3 4 57 85\n $ : int [1:5] 1 57 58 78 85\n $ : int [1:4] 1 4 5 85\n $ : int [1:4] 1 3 5 6\n $ : int [1:4] 3 4 6 85\n $ : int [1:5] 4 5 69 75 85\n $ : int [1:4] 67 71 74 84\n $ : int [1:7] 9 46 47 56 78 80 86\n $ : int [1:6] 8 66 68 78 84 86\n $ : int [1:8] 16 17 19 20 22 70 72 73\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:3] 11 15 17\n $ : int [1:4] 13 14 17 83\n $ : int [1:5] 10 17 22 72 83\n $ : int [1:7] 10 11 14 15 16 72 83\n $ : int [1:5] 20 22 23 77 83\n $ : int [1:6] 10 20 21 73 74 86\n $ : int [1:7] 10 18 19 21 22 23 82\n $ : int [1:5] 19 20 35 82 86\n $ : int [1:5] 10 16 18 20 83\n $ : int [1:7] 18 20 38 41 77 79 82\n $ : int [1:5] 25 28 31 32 54\n $ : int [1:5] 24 28 31 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:3] 26 29 42\n $ : int [1:5] 24 25 33 49 54\n $ : int [1:3] 27 37 42\n $ : int 33\n $ : int [1:8] 24 25 32 36 39 40 56 81\n $ : int [1:8] 24 31 50 54 55 56 75 85\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 47 80 82 86\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:4] 29 42 43 44\n $ : int [1:4] 23 44 77 79\n $ : int [1:5] 31 40 42 43 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:7] 26 27 29 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:4] 37 38 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:3] 8 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:5] 32 48 52 54 55\n $ : int [1:3] 48 49 52\n $ : int [1:5] 48 49 50 51 54\n $ : int [1:3] 48 55 75\n $ : int [1:6] 24 28 32 49 50 52\n $ : int [1:5] 32 48 50 53 75\n $ : int [1:7] 8 31 32 36 78 80 85\n $ : int [1:6] 1 2 58 64 76 85\n $ : int [1:5] 2 57 68 76 78\n $ : int [1:4] 60 61 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:7] 12 59 60 62 63 77 87\n $ : int [1:3] 61 77 87\n $ : int [1:4] 12 61 77 83\n $ : int [1:2] 57 76\n $ : int 76\n $ : int [1:5] 9 67 68 76 84\n $ : int [1:4] 7 66 76 84\n $ : int [1:5] 9 58 66 76 78\n $ : int [1:3] 6 75 85\n $ : int [1:3] 10 72 73\n $ : int [1:3] 7 73 74\n $ : int [1:5] 10 11 16 17 70\n $ : int [1:5] 10 19 70 71 74\n $ : int [1:6] 7 19 71 73 84 86\n $ : int [1:6] 6 32 53 55 69 85\n $ : int [1:7] 57 58 64 65 66 67 68\n $ : int [1:7] 18 23 38 61 62 63 83\n $ : int [1:7] 2 8 9 56 58 68 85\n $ : int [1:7] 23 38 40 41 43 44 45\n $ : int [1:8] 8 34 35 36 41 45 47 56\n $ : int [1:6] 25 26 31 33 39 42\n $ : int [1:5] 20 21 23 35 41\n $ : int [1:9] 12 13 15 16 17 18 22 63 77\n $ : int [1:6] 7 9 66 67 74 86\n $ : int [1:11] 1 2 3 5 6 32 56 57 69 75 ...\n $ : int [1:9] 8 9 19 21 35 46 47 74 84\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language poly2nb(pl = hunan)\n - attr(*, \"type\")= chr \"queen\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\nwm_r &lt;- poly2nb(hunan, queen=FALSE)\nsummary(wm_r)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\nhead(coords)\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863\n\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\n\n\n\n\n\n\n\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\n\n\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"Queen Contiguity\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\nplot(hunan$geometry, border=\"lightgrey\", main=\"Rook Contiguity\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\n\n\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\nstr(wm_d62)\n\nList of 88\n $ : int [1:5] 3 4 5 57 64\n $ : int [1:4] 57 58 78 85\n $ : int [1:4] 1 4 5 57\n $ : int [1:3] 1 3 5\n $ : int [1:4] 1 3 4 85\n $ : int 69\n $ : int [1:2] 67 84\n $ : int [1:4] 9 46 47 78\n $ : int [1:4] 8 46 68 84\n $ : int [1:4] 16 22 70 72\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:2] 11 17\n $ : int 13\n $ : int [1:4] 10 17 22 83\n $ : int [1:3] 11 14 16\n $ : int [1:3] 20 22 63\n $ : int [1:5] 20 21 73 74 82\n $ : int [1:5] 18 19 21 22 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:4] 10 16 18 20\n $ : int [1:3] 41 77 82\n $ : int [1:4] 25 28 31 54\n $ : int [1:4] 24 28 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:2] 26 29\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:2] 27 37\n $ : int 33\n $ : int [1:2] 24 36\n $ : int 50\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:5] 31 34 45 56 80\n $ : int [1:2] 29 42\n $ : int [1:3] 44 77 79\n $ : int [1:4] 40 42 43 81\n $ : int [1:3] 39 45 79\n $ : int [1:5] 23 35 45 79 82\n $ : int [1:5] 26 37 39 43 81\n $ : int [1:3] 39 42 44\n $ : int [1:2] 38 43\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:5] 8 9 35 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:4] 48 49 50 52\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:2] 48 55\n $ : int [1:5] 24 28 49 50 52\n $ : int [1:4] 48 50 53 75\n $ : int 36\n $ : int [1:5] 1 2 3 58 64\n $ : int [1:5] 2 57 64 66 68\n $ : int [1:3] 60 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:5] 12 60 62 63 87\n $ : int [1:4] 61 63 77 87\n $ : int [1:5] 12 18 61 62 83\n $ : int [1:4] 1 57 58 76\n $ : int 76\n $ : int [1:5] 58 67 68 76 84\n $ : int [1:2] 7 66\n $ : int [1:4] 9 58 66 84\n $ : int [1:2] 6 75\n $ : int [1:3] 10 72 73\n $ : int [1:2] 73 74\n $ : int [1:3] 10 11 70\n $ : int [1:4] 19 70 71 74\n $ : int [1:5] 19 21 71 73 86\n $ : int [1:2] 55 69\n $ : int [1:3] 64 65 66\n $ : int [1:3] 23 38 62\n $ : int [1:2] 2 8\n $ : int [1:4] 38 40 41 45\n $ : int [1:5] 34 35 36 45 47\n $ : int [1:5] 25 26 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:4] 12 13 16 63\n $ : int [1:4] 7 9 66 68\n $ : int [1:2] 2 5\n $ : int [1:4] 21 46 47 74\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language dnearneigh(x = coords, d1 = 0, d2 = 62, longlat = TRUE)\n - attr(*, \"dnn\")= num [1:2] 0 62\n - attr(*, \"bounds\")= chr [1:2] \"GE\" \"LE\"\n - attr(*, \"nbtype\")= chr \"distance\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\ntable(hunan$County, card(wm_d62))\n\n               \n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\n\n\nn_comp &lt;- n.comp.nb(wm_d62)\nn_comp$nc\n\n[1] 1\n\n\n\ntable(n_comp$comp.id)\n\n\n 1 \n88 \n\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_d62, coords, add=TRUE)\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\n\n\n\n\n\n\n\n\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"1st nearest neighbours\")\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\nplot(hunan$geometry, border=\"lightgrey\", main=\"Distance link\")\nplot(wm_d62, coords, add=TRUE, pch = 19, cex = 0.6)\n\n\n\n\n\n\n\n\n\nknn6 &lt;- knn2nb(knearneigh(coords, k=6))\nknn6\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\n\n\nstr(knn6)\n\nList of 88\n $ : int [1:6] 2 3 4 5 57 64\n $ : int [1:6] 1 3 57 58 78 85\n $ : int [1:6] 1 2 4 5 57 85\n $ : int [1:6] 1 3 5 6 69 85\n $ : int [1:6] 1 3 4 6 69 85\n $ : int [1:6] 3 4 5 69 75 85\n $ : int [1:6] 9 66 67 71 74 84\n $ : int [1:6] 9 46 47 78 80 86\n $ : int [1:6] 8 46 66 68 84 86\n $ : int [1:6] 16 19 22 70 72 73\n $ : int [1:6] 10 14 16 17 70 72\n $ : int [1:6] 13 15 60 61 63 83\n $ : int [1:6] 12 15 60 61 63 83\n $ : int [1:6] 11 15 16 17 72 83\n $ : int [1:6] 12 13 14 17 60 83\n $ : int [1:6] 10 11 17 22 72 83\n $ : int [1:6] 10 11 14 16 72 83\n $ : int [1:6] 20 22 23 63 77 83\n $ : int [1:6] 10 20 21 73 74 82\n $ : int [1:6] 18 19 21 22 23 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:6] 10 16 18 19 20 83\n $ : int [1:6] 18 20 41 77 79 82\n $ : int [1:6] 25 28 31 52 54 81\n $ : int [1:6] 24 28 31 33 54 81\n $ : int [1:6] 25 27 29 33 42 81\n $ : int [1:6] 26 29 30 37 42 81\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:6] 26 27 37 42 43 81\n $ : int [1:6] 26 27 28 33 49 81\n $ : int [1:6] 24 25 36 39 40 54\n $ : int [1:6] 24 31 50 54 55 56\n $ : int [1:6] 25 26 28 30 49 81\n $ : int [1:6] 36 40 41 45 56 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:6] 26 27 29 42 43 44\n $ : int [1:6] 23 43 44 62 77 79\n $ : int [1:6] 25 40 42 43 44 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:6] 26 27 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:6] 37 38 39 42 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:6] 8 9 35 47 78 86\n $ : int [1:6] 8 21 35 46 80 86\n $ : int [1:6] 49 50 51 52 53 55\n $ : int [1:6] 28 33 48 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:6] 28 48 49 50 52 54\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:6] 48 50 51 52 55 75\n $ : int [1:6] 24 28 49 50 51 52\n $ : int [1:6] 32 48 50 52 53 75\n $ : int [1:6] 32 34 36 78 80 85\n $ : int [1:6] 1 2 3 58 64 68\n $ : int [1:6] 2 57 64 66 68 78\n $ : int [1:6] 12 13 60 61 87 88\n $ : int [1:6] 12 13 59 61 63 87\n $ : int [1:6] 12 13 60 62 63 87\n $ : int [1:6] 12 38 61 63 77 87\n $ : int [1:6] 12 18 60 61 62 83\n $ : int [1:6] 1 3 57 58 68 76\n $ : int [1:6] 58 64 66 67 68 76\n $ : int [1:6] 9 58 67 68 76 84\n $ : int [1:6] 7 65 66 68 76 84\n $ : int [1:6] 9 57 58 66 78 84\n $ : int [1:6] 4 5 6 32 75 85\n $ : int [1:6] 10 16 19 22 72 73\n $ : int [1:6] 7 19 73 74 84 86\n $ : int [1:6] 10 11 14 16 17 70\n $ : int [1:6] 10 19 21 70 71 74\n $ : int [1:6] 19 21 71 73 84 86\n $ : int [1:6] 6 32 50 53 55 69\n $ : int [1:6] 58 64 65 66 67 68\n $ : int [1:6] 18 23 38 61 62 63\n $ : int [1:6] 2 8 9 46 58 68\n $ : int [1:6] 38 40 41 43 44 45\n $ : int [1:6] 34 35 36 41 45 47\n $ : int [1:6] 25 26 28 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:6] 12 13 15 16 22 63\n $ : int [1:6] 7 9 66 68 71 74\n $ : int [1:6] 2 3 4 5 56 69\n $ : int [1:6] 8 9 21 46 47 74\n $ : int [1:6] 59 60 61 62 63 88\n $ : int [1:6] 59 60 61 62 63 87\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language knearneigh(x = coords, k = 6)\n - attr(*, \"sym\")= logi FALSE\n - attr(*, \"type\")= chr \"knn\"\n - attr(*, \"knn-k\")= num 6\n - attr(*, \"class\")= chr \"nb\"\n\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\n\n\n\ndist &lt;- nbdists(wm_q, coords, longlat = TRUE)\nids &lt;- lapply(dist, function(x) 1/(x))\nids\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n[[2]]\n[1] 0.01535405 0.01764308 0.01925924 0.02323898 0.01719350\n\n[[3]]\n[1] 0.03916350 0.02822040 0.03695795 0.01395765\n\n[[4]]\n[1] 0.01820896 0.02822040 0.03414741 0.01539065\n\n[[5]]\n[1] 0.03695795 0.03414741 0.01524598 0.01618354\n\n[[6]]\n[1] 0.015390649 0.015245977 0.021748129 0.011883901 0.009810297\n\n[[7]]\n[1] 0.01708612 0.01473997 0.01150924 0.01872915\n\n[[8]]\n[1] 0.02022144 0.03453056 0.02529256 0.01036340 0.02284457 0.01500600 0.01515314\n\n[[9]]\n[1] 0.02022144 0.01574888 0.02109502 0.01508028 0.02902705 0.01502980\n\n[[10]]\n[1] 0.02281552 0.01387777 0.01538326 0.01346650 0.02100510 0.02631658 0.01874863\n[8] 0.01500046\n\n[[11]]\n[1] 0.01882869 0.02243492 0.02247473\n\n[[12]]\n[1] 0.02779227 0.02419652 0.02333385 0.02986130 0.02335429\n\n[[13]]\n[1] 0.02779227 0.02650020 0.02670323 0.01714243\n\n[[14]]\n[1] 0.01882869 0.01233868 0.02098555\n\n[[15]]\n[1] 0.02650020 0.01233868 0.01096284 0.01562226\n\n[[16]]\n[1] 0.02281552 0.02466962 0.02765018 0.01476814 0.01671430\n\n[[17]]\n[1] 0.01387777 0.02243492 0.02098555 0.01096284 0.02466962 0.01593341 0.01437996\n\n[[18]]\n[1] 0.02039779 0.02032767 0.01481665 0.01473691 0.01459380\n\n[[19]]\n[1] 0.01538326 0.01926323 0.02668415 0.02140253 0.01613589 0.01412874\n\n[[20]]\n[1] 0.01346650 0.02039779 0.01926323 0.01723025 0.02153130 0.01469240 0.02327034\n\n[[21]]\n[1] 0.02668415 0.01723025 0.01766299 0.02644986 0.02163800\n\n[[22]]\n[1] 0.02100510 0.02765018 0.02032767 0.02153130 0.01489296\n\n[[23]]\n[1] 0.01481665 0.01469240 0.01401432 0.02246233 0.01880425 0.01530458 0.01849605\n\n[[24]]\n[1] 0.02354598 0.01837201 0.02607264 0.01220154 0.02514180\n\n[[25]]\n[1] 0.02354598 0.02188032 0.01577283 0.01949232 0.02947957\n\n[[26]]\n[1] 0.02155798 0.01745522 0.02212108 0.02220532\n\n[[27]]\n[1] 0.02155798 0.02490625 0.01562326\n\n[[28]]\n[1] 0.01837201 0.02188032 0.02229549 0.03076171 0.02039506\n\n[[29]]\n[1] 0.02490625 0.01686587 0.01395022\n\n[[30]]\n[1] 0.02090587\n\n[[31]]\n[1] 0.02607264 0.01577283 0.01219005 0.01724850 0.01229012 0.01609781 0.01139438\n[8] 0.01150130\n\n[[32]]\n[1] 0.01220154 0.01219005 0.01712515 0.01340413 0.01280928 0.01198216 0.01053374\n[8] 0.01065655\n\n[[33]]\n[1] 0.01949232 0.01745522 0.02229549 0.02090587 0.01979045\n\n[[34]]\n[1] 0.03113041 0.03589551 0.02882915\n\n[[35]]\n[1] 0.01766299 0.02185795 0.02616766 0.02111721 0.02108253 0.01509020\n\n[[36]]\n[1] 0.01724850 0.03113041 0.01571707 0.01860991 0.02073549 0.01680129\n\n[[37]]\n[1] 0.01686587 0.02234793 0.01510990 0.01550676\n\n[[38]]\n[1] 0.01401432 0.02407426 0.02276151 0.01719415\n\n[[39]]\n[1] 0.01229012 0.02172543 0.01711924 0.02629732 0.01896385\n\n[[40]]\n[1] 0.01609781 0.01571707 0.02172543 0.01506473 0.01987922 0.01894207\n\n[[41]]\n[1] 0.02246233 0.02185795 0.02205991 0.01912542 0.01601083 0.01742892\n\n[[42]]\n[1] 0.02212108 0.01562326 0.01395022 0.02234793 0.01711924 0.01836831 0.01683518\n\n[[43]]\n[1] 0.01510990 0.02629732 0.01506473 0.01836831 0.03112027 0.01530782\n\n[[44]]\n[1] 0.01550676 0.02407426 0.03112027 0.01486508\n\n[[45]]\n[1] 0.03589551 0.01860991 0.01987922 0.02205991 0.02107101 0.01982700\n\n[[46]]\n[1] 0.03453056 0.04033752 0.02689769\n\n[[47]]\n[1] 0.02529256 0.02616766 0.04033752 0.01949145 0.02181458\n\n[[48]]\n[1] 0.02313819 0.03370576 0.02289485 0.01630057 0.01818085\n\n[[49]]\n[1] 0.03076171 0.02138091 0.02394529 0.01990000\n\n[[50]]\n[1] 0.01712515 0.02313819 0.02551427 0.02051530 0.02187179\n\n[[51]]\n[1] 0.03370576 0.02138091 0.02873854\n\n[[52]]\n[1] 0.02289485 0.02394529 0.02551427 0.02873854 0.03516672\n\n[[53]]\n[1] 0.01630057 0.01979945 0.01253977\n\n[[54]]\n[1] 0.02514180 0.02039506 0.01340413 0.01990000 0.02051530 0.03516672\n\n[[55]]\n[1] 0.01280928 0.01818085 0.02187179 0.01979945 0.01882298\n\n[[56]]\n[1] 0.01036340 0.01139438 0.01198216 0.02073549 0.01214479 0.01362855 0.01341697\n\n[[57]]\n[1] 0.028079221 0.017643082 0.031423501 0.029114131 0.013520292 0.009903702\n\n[[58]]\n[1] 0.01925924 0.03142350 0.02722997 0.01434859 0.01567192\n\n[[59]]\n[1] 0.01696711 0.01265572 0.01667105 0.01785036\n\n[[60]]\n[1] 0.02419652 0.02670323 0.01696711 0.02343040\n\n[[61]]\n[1] 0.02333385 0.01265572 0.02343040 0.02514093 0.02790764 0.01219751 0.02362452\n\n[[62]]\n[1] 0.02514093 0.02002219 0.02110260\n\n[[63]]\n[1] 0.02986130 0.02790764 0.01407043 0.01805987\n\n[[64]]\n[1] 0.02911413 0.01689892\n\n[[65]]\n[1] 0.02471705\n\n[[66]]\n[1] 0.01574888 0.01726461 0.03068853 0.01954805 0.01810569\n\n[[67]]\n[1] 0.01708612 0.01726461 0.01349843 0.01361172\n\n[[68]]\n[1] 0.02109502 0.02722997 0.03068853 0.01406357 0.01546511\n\n[[69]]\n[1] 0.02174813 0.01645838 0.01419926\n\n[[70]]\n[1] 0.02631658 0.01963168 0.02278487\n\n[[71]]\n[1] 0.01473997 0.01838483 0.03197403\n\n[[72]]\n[1] 0.01874863 0.02247473 0.01476814 0.01593341 0.01963168\n\n[[73]]\n[1] 0.01500046 0.02140253 0.02278487 0.01838483 0.01652709\n\n[[74]]\n[1] 0.01150924 0.01613589 0.03197403 0.01652709 0.01342099 0.02864567\n\n[[75]]\n[1] 0.011883901 0.010533736 0.012539774 0.018822977 0.016458383 0.008217581\n\n[[76]]\n[1] 0.01352029 0.01434859 0.01689892 0.02471705 0.01954805 0.01349843 0.01406357\n\n[[77]]\n[1] 0.014736909 0.018804247 0.022761507 0.012197506 0.020022195 0.014070428\n[7] 0.008440896\n\n[[78]]\n[1] 0.02323898 0.02284457 0.01508028 0.01214479 0.01567192 0.01546511 0.01140779\n\n[[79]]\n[1] 0.01530458 0.01719415 0.01894207 0.01912542 0.01530782 0.01486508 0.02107101\n\n[[80]]\n[1] 0.01500600 0.02882915 0.02111721 0.01680129 0.01601083 0.01982700 0.01949145\n[8] 0.01362855\n\n[[81]]\n[1] 0.02947957 0.02220532 0.01150130 0.01979045 0.01896385 0.01683518\n\n[[82]]\n[1] 0.02327034 0.02644986 0.01849605 0.02108253 0.01742892\n\n[[83]]\n[1] 0.023354289 0.017142433 0.015622258 0.016714303 0.014379961 0.014593799\n[7] 0.014892965 0.018059871 0.008440896\n\n[[84]]\n[1] 0.01872915 0.02902705 0.01810569 0.01361172 0.01342099 0.01297994\n\n[[85]]\n [1] 0.011451133 0.017193502 0.013957649 0.016183544 0.009810297 0.010656545\n [7] 0.013416965 0.009903702 0.014199260 0.008217581 0.011407794\n\n[[86]]\n[1] 0.01515314 0.01502980 0.01412874 0.02163800 0.01509020 0.02689769 0.02181458\n[8] 0.02864567 0.01297994\n\n[[87]]\n[1] 0.01667105 0.02362452 0.02110260 0.02058034\n\n[[88]]\n[1] 0.01785036 0.02058034\n\n\n\nrswm_q &lt;- nb2listw(wm_q, style=\"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\n\nrswm_q$weights[10]\n\n[[1]]\n[1] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125\n\n\n\nrswm_ids &lt;- nb2listw(wm_q, glist=ids, style=\"B\", zero.policy=TRUE)\nrswm_ids\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn       S0        S1     S2\nB 88 7744 8.786867 0.3776535 3.8137\n\n\n\nrswm_ids$weights[1]\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n\n\nsummary(unlist(rswm_ids$weights))\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.008218 0.015088 0.018739 0.019614 0.022823 0.040338 \n\n\n\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\n\nlag.list &lt;- list(hunan$NAME_3, lag.listw(rswm_q, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag.list)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag GDPPC\")\nhunan &lt;- left_join(hunan,lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3  County GDPPC lag GDPPC\n1 Changde 21098 Anxiang      County Anxiang 23667  24847.20\n2 Changde 21100 Hanshou      County Hanshou 20981  22724.80\n3 Changde 21101  Jinshi County City  Jinshi 34592  24143.25\n4 Changde 21102      Li      County      Li 24473  27737.50\n5 Changde 21103   Linli      County   Linli 25554  27270.25\n6 Changde 21104  Shimen      County  Shimen 27137  21248.80\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_gdppc &lt;- qtm(hunan, \"lag GDPPC\")\ntmap_arrange(gdppc, lag_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\nb_weights2 &lt;- nb2listw(wm_q, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\n\nlag_sum &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag_sum)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag_sum GDPPC\")\n\n\nlag_sum\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\n\n\nhunan &lt;- left_join(hunan, lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum GDPPC\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nwm_qs &lt;- include.self(wm_q)\n\n\nwm_qs[[1]]\n\n[1]  1  2  3  4 57 85\n\n\n\nwm_qs &lt;- nb2listw(wm_qs)\nwm_qs\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\n\n\nlag_w_avg_gpdpc &lt;- lag.listw(wm_qs, \n                             hunan$GDPPC)\nlag_w_avg_gpdpc\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\n\nlag.list.wm_qs &lt;- list(hunan$NAME_3, lag.listw(wm_qs, hunan$GDPPC))\nlag_wm_qs.res &lt;- as.data.frame(lag.list.wm_qs)\ncolnames(lag_wm_qs.res) &lt;- c(\"NAME_3\", \"lag_window_avg GDPPC\")\n\n\nhunan &lt;- left_join(hunan, lag_wm_qs.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\n\nhunan %&gt;%\n  select(\"County\", \n         \"lag GDPPC\", \n         \"lag_window_avg GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag GDPPC\nlag_window_avg GDPPC\ngeometry\n\n\n\n\nAnxiang\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n32671.00\n26627.50\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n20810.00\n22690.17\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n25711.50\n25366.40\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n30672.33\n25825.75\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n33457.75\n30329.00\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n31689.20\n32682.83\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n20269.00\n25948.62\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n23901.60\n23987.67\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n25126.17\n25463.14\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n21903.43\n21904.38\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n22718.60\n23127.50\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n25918.80\n25949.83\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n20307.00\n20018.75\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n20023.80\n19524.17\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n16576.80\n18955.00\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n18667.00\n17800.40\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n14394.67\n15883.00\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n19848.80\n18831.33\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n15516.33\n14832.50\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518.00\n17965.00\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n17572.00\n17159.89\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n15200.12\n16199.44\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n18413.80\n18764.50\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n14419.33\n26878.75\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n24094.50\n23188.86\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n22019.83\n20788.14\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n12923.50\n12365.20\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n14756.00\n15985.00\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n13869.80\n13764.83\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n12296.67\n11907.43\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n15775.17\n17128.14\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n14382.86\n14593.62\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n11566.33\n11644.29\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n13199.50\n12706.00\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n23412.00\n21712.29\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n39541.00\n43548.25\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n36186.60\n35049.00\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n16559.60\n16226.83\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n20772.50\n19294.40\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n19471.20\n18156.00\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n19827.33\n19954.75\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n15466.80\n18145.17\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n12925.67\n12132.75\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n18577.17\n18419.29\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n14943.00\n14050.83\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n24913.00\n23619.75\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n25093.00\n24552.71\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n24428.80\n24733.67\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n17003.00\n16762.60\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n21143.75\n20932.60\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n20435.00\n19467.75\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n17131.33\n18334.00\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n24569.75\n22541.00\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n23835.50\n26028.00\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360.00\n29128.50\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n47383.40\n46569.00\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n55157.75\n47576.60\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n37058.00\n36545.50\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n21546.67\n20838.50\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n23348.67\n22531.00\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n42323.67\n42115.50\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n28938.60\n27619.00\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n25880.80\n27611.33\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n47345.67\n44523.29\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n18711.33\n18127.43\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n29087.29\n28746.38\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n20748.29\n20734.50\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n35933.71\n33880.62\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n15439.71\n14716.38\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n29787.50\n28516.22\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n18145.00\n18086.14\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n21617.00\n21244.50\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n29203.89\n29568.80\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n41363.67\n48119.71\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n22259.09\n22310.75\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n44939.56\n43151.60\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n16902.00\n17133.40\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n16930.00\n17009.33\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\n\nw_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg GDPPC\")\ntmap_arrange(lag_gdppc, w_avg_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nwm_qs &lt;- include.self(wm_q)\nwm_qs\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\n\n\nb_weights &lt;- lapply(wm_qs, function(x) 0*x + 1)\nb_weights[1]\n\n[[1]]\n[1] 1 1 1 1 1 1\n\n\n\nb_weights2 &lt;- nb2listw(wm_qs, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 536 1072 14160\n\n\n\nw_sum_gdppc &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nw_sum_gdppc\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 147903 134605 131165 135423 134635 133381 238106 297281 344573 268982\n[11] 106510 136141 126832 103303 151645 196097 207589 143926 178242 175235\n[21] 138765 155699 160150 117145 113730  89002  63532 112988  59330  35930\n[31] 154439 145795 112587 107515 162322 145517  61826  79925  82589  83352\n[41] 119897 116749  81510  63530 151986 174193 210294  97361  96472 108936\n[51]  79819 108871  48531 128935  84305 188958 171869 148402  83813 104663\n[61] 155742  73336 112705  78084  58257 279414 237883 219273  83354  90124\n[71] 168462 165714 165668 311663 126892 229971 165876 271045 117731 256646\n[81] 126603 127467 295688 336838 267729 431516  85667  51028\n\n\n\nw_sum_gdppc.res &lt;- as.data.frame(w_sum_gdppc)\ncolnames(w_sum_gdppc.res) &lt;- c(\"NAME_3\", \"w_sum GDPPC\")\n\n\nhunan &lt;- left_join(hunan, w_sum_gdppc.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\n\nhunan %&gt;%\n  select(\"County\", \"lag_sum GDPPC\", \"w_sum GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag_sum GDPPC\nw_sum GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n147903\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n134605\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n131165\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n135423\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n134635\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n133381\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n238106\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n297281\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n344573\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n268982\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n98013\n106510\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n104050\n136141\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n102846\n126832\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n92017\n103303\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n133831\n151645\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n158446\n196097\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n141883\n207589\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n119508\n143926\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n150757\n178242\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n153324\n175235\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n113593\n138765\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n129594\n155699\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n142149\n160150\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n100119\n117145\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n82884\n113730\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n74668\n89002\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n43184\n63532\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n99244\n112988\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n46549\n59330\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518\n35930\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n140576\n154439\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n121601\n145795\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n92069\n112587\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n43258\n107515\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n144567\n162322\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n132119\n145517\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n51694\n61826\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n59024\n79925\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n69349\n82589\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n73780\n83352\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n94651\n119897\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n100680\n116749\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n69398\n81510\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n52798\n63530\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n140472\n151986\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n118623\n174193\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n180933\n210294\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n82798\n97361\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n83090\n96472\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n97356\n108936\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n59482\n79819\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n77334\n108871\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n38777\n48531\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n111463\n128935\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n74715\n84305\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n174391\n188958\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n150558\n171869\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n122144\n148402\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n68012\n83813\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n84575\n104663\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n143045\n155742\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n51394\n73336\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n98279\n112705\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n47671\n78084\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360\n58257\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n236917\n279414\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n220631\n237883\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n185290\n219273\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n64640\n83354\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n70046\n90124\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n126971\n168462\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n144693\n165714\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n129404\n165668\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n284074\n311663\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n112268\n126892\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n203611\n229971\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n145238\n165876\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n251536\n271045\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n108078\n117731\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n238300\n256646\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n108870\n126603\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n108085\n127467\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n262835\n295688\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n248182\n336838\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n244850\n267729\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n404456\n431516\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n67608\n85667\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n33860\n51028\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\n\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum GDPPC\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex04/In-class_Ex04.html",
    "href": "In-class_Ex/In-class_Ex04/In-class_Ex04.html",
    "title": "In-class exercise 04",
    "section": "",
    "text": "pacman::p_load(sf,spdep,tmap,tidyverse,knitr,GWmodel,ggstatsplot)\n\nno need to perform transform to projected coordinate system ideally we should have the projection it is polygon instead of multipolygon, no island\n\nhunan_sf &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex04/data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex04\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\nplease dont use read.csv which is base R\n\nhunan2012 &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex04/data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\ncombine spatial and aspatial data using left_join in reality, need to have common identifier, the values must be identical cannot be one lowercase and other is uppercase, the code chunk can use by\n\nhunan_sf &lt;- left_join(hunan_sf,hunan2012)\n\nJoining with `by = join_by(County)`\n\nhunan_sf &lt;- select(hunan_sf,1:3,7,15,16,31,32)\n\n\nwm_q &lt;- poly2nb(hunan_sf)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nconvert sf to sp because of GWmodel\n\nhunan_sp &lt;- hunan_sf %&gt;% \n  as_Spatial()\n\nDetermine adaptive bandwith using bw.gwr, linear regression model dependent and independent variables. abitrary number = 1 which is independent variable, just to provide the lrm requirements adaptive false = fixed bandwidth kernel = not much effect, can use others longlat = T, great circle calculation, convert to km\n\nbw_CV &lt;- bw.gwr(GDPPC ~ 1,\n              data = hunan_sp,\n              approach = \"CV\",\n              adaptive = TRUE,\n              kernel = \"bisquare\",\n              longlat = T)\n\nAdaptive bandwidth: 62 CV score: 15515442343 \nAdaptive bandwidth: 46 CV score: 14937956887 \nAdaptive bandwidth: 36 CV score: 14408561608 \nAdaptive bandwidth: 29 CV score: 14198527496 \nAdaptive bandwidth: 26 CV score: 13898800611 \nAdaptive bandwidth: 22 CV score: 13662299974 \nAdaptive bandwidth: 22 CV score: 13662299974 \n\n\n\nbw_CV\n\n[1] 22\n\n\n\nbw_AIC &lt;- bw.gwr(GDPPC ~ 1,\n              data = hunan_sp,\n              approach = \"AIC\",\n              adaptive = TRUE,\n              kernel = \"bisquare\",\n              longlat = T)\n\nAdaptive bandwidth (number of nearest neighbours): 62 AICc value: 1923.156 \nAdaptive bandwidth (number of nearest neighbours): 46 AICc value: 1920.469 \nAdaptive bandwidth (number of nearest neighbours): 36 AICc value: 1917.324 \nAdaptive bandwidth (number of nearest neighbours): 29 AICc value: 1916.661 \nAdaptive bandwidth (number of nearest neighbours): 26 AICc value: 1914.897 \nAdaptive bandwidth (number of nearest neighbours): 22 AICc value: 1914.045 \nAdaptive bandwidth (number of nearest neighbours): 22 AICc value: 1914.045 \n\n\n\nbw_AIC\n\n[1] 22\n\n\n22 means optimum number of neighbours the bandwidth is in kilometre, adaptive is always the best\n\nbw_AIC2 &lt;- bw.gwr(GDPPC ~ 1,\n              data = hunan_sp,\n              approach = \"AIC\",\n              adaptive = FALSE,\n              kernel = \"bisquare\",\n              longlat = T)\n\nFixed bandwidth: 357.4897 AICc value: 1927.631 \nFixed bandwidth: 220.985 AICc value: 1921.547 \nFixed bandwidth: 136.6204 AICc value: 1919.993 \nFixed bandwidth: 84.48025 AICc value: 1940.603 \nFixed bandwidth: 168.8448 AICc value: 1919.457 \nFixed bandwidth: 188.7606 AICc value: 1920.007 \nFixed bandwidth: 156.5362 AICc value: 1919.41 \nFixed bandwidth: 148.929 AICc value: 1919.527 \nFixed bandwidth: 161.2377 AICc value: 1919.392 \nFixed bandwidth: 164.1433 AICc value: 1919.403 \nFixed bandwidth: 159.4419 AICc value: 1919.393 \nFixed bandwidth: 162.3475 AICc value: 1919.394 \nFixed bandwidth: 160.5517 AICc value: 1919.391 \n\n\n\nbw_AIC2\n\n[1] 160.5517\n\n\n\nbw_CV2 &lt;- bw.gwr(GDPPC ~ 1,\n              data = hunan_sp,\n              approach = \"CV\",\n              adaptive = FALSE,\n              kernel = \"bisquare\",\n              longlat = T)\n\nFixed bandwidth: 357.4897 CV score: 16265191728 \nFixed bandwidth: 220.985 CV score: 14954930931 \nFixed bandwidth: 136.6204 CV score: 14134185837 \nFixed bandwidth: 84.48025 CV score: 13693362460 \nFixed bandwidth: 52.25585 CV score: Inf \nFixed bandwidth: 104.396 CV score: 13891052305 \nFixed bandwidth: 72.17162 CV score: 13577893677 \nFixed bandwidth: 64.56447 CV score: 14681160609 \nFixed bandwidth: 76.8731 CV score: 13444716890 \nFixed bandwidth: 79.77877 CV score: 13503296834 \nFixed bandwidth: 75.07729 CV score: 13452450771 \nFixed bandwidth: 77.98296 CV score: 13457916138 \nFixed bandwidth: 76.18716 CV score: 13442911302 \nFixed bandwidth: 75.76323 CV score: 13444600639 \nFixed bandwidth: 76.44916 CV score: 13442994078 \nFixed bandwidth: 76.02523 CV score: 13443285248 \nFixed bandwidth: 76.28724 CV score: 13442844774 \nFixed bandwidth: 76.34909 CV score: 13442864995 \nFixed bandwidth: 76.24901 CV score: 13442855596 \nFixed bandwidth: 76.31086 CV score: 13442847019 \nFixed bandwidth: 76.27264 CV score: 13442846793 \nFixed bandwidth: 76.29626 CV score: 13442844829 \nFixed bandwidth: 76.28166 CV score: 13442845238 \nFixed bandwidth: 76.29068 CV score: 13442844678 \nFixed bandwidth: 76.29281 CV score: 13442844691 \nFixed bandwidth: 76.28937 CV score: 13442844698 \nFixed bandwidth: 76.2915 CV score: 13442844676 \nFixed bandwidth: 76.292 CV score: 13442844679 \nFixed bandwidth: 76.29119 CV score: 13442844676 \nFixed bandwidth: 76.29099 CV score: 13442844676 \nFixed bandwidth: 76.29131 CV score: 13442844676 \nFixed bandwidth: 76.29138 CV score: 13442844676 \nFixed bandwidth: 76.29126 CV score: 13442844676 \nFixed bandwidth: 76.29123 CV score: 13442844676 \n\n\n\nbw_CV2\n\n[1] 76.29126\n\n\nmake sure kernel, adaptive and longlat is the same as the bw requirement\n\ngwstat &lt;- gwss(data=hunan_sp,\n               vars = \"GDPPC\",\n               bw = bw_AIC,\n               kernel = 'bisquare',\n               adaptive = TRUE,\n               longlat = T)\n\nSDF= spatial data frame LM = local mean every 22 neighbours, calculate the local mean\nLSD = standard deviation 88 area = 88 standard deviation\nLSKe = standard estimate\nLCV = correlation variance\nall take 22 neighbours, from the bandwidth\n\ngwstat\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n\n   ***********************Calibration information*************************\n\n   Local summary statistics calculated for variables:\n    GDPPC\n   Number of summary points: 88\n   Kernel function: bisquare \n   Summary points: the same locations as observations are used.\n   Adaptive bandwidth: 22 (number of nearest neighbours)\n   Distance metric: Great Circle distance metric is used.\n\n   ************************Local Summary Statistics:**********************\n   Summary information for Local means:\nGDPPC_LM \n    Min.  1st Qu.   Median  3rd Qu.     Max. \n13688.70 17995.43 23408.07 27865.12 49005.84 \n   Summary information for local standard deviation :\nGDPPC_LSD \n     Min.   1st Qu.    Median   3rd Qu.      Max. \n 4282.599  6297.788  8281.756 16315.028 22568.841 \n   Summary information for local variance :\nGDPPC_LVar \n     Min.   1st Qu.    Median   3rd Qu.      Max. \n 18340656  39662960  68633859 266187788 509352591 \n   Summary information for Local skewness:\nGDPPC_LSKe \n      Min.    1st Qu.     Median    3rd Qu.       Max. \n-0.2150599  0.9900027  1.3714638  1.8387524  3.7525953 \n   Summary information for localized coefficient of variation:\nGDPPC_LCV \n     Min.   1st Qu.    Median   3rd Qu.      Max. \n0.2000503 0.3107774 0.3829294 0.5129959 0.8018153 \n\n   ************************************************************************\n\n\n\ngwstat_df &lt;- as.data.frame(gwstat$SDF)\n\ngwstat dont have common identifier use cbind because the sequence is the same as gwstat and hunan_sf as long no sorting is used, can just cbind, because it just append blindly\n\nhunan_gstat &lt;- cbind(hunan_sf,gwstat_df)\n\nn = 5, classes\n\ntm_shape(hunan_gstat) + \n  tm_fill(\"GDPPC_LM\",\n          n = 5,\n          style = \"quantile\") + \n  tm_borders(alpha = 0.5) + \n  tm_layout(main.title = \"Distribution of geographically weighted mean\",\n            main.title.position = \"center\",\n            main.title.size = 1.0,\n            legend.text.size= 0.4,\n            legend.height = 0.4,\n            legend.width = 0.4,\n            frame = TRUE)\n\n\n\n\n\n\n\n\n\nggscatterstats(\n  data = hunan2012, \n  x = Agri, \n  y = GDPPC,\n  xlab = \"Gross Agriculture Output\", ## label for the x-axis\n  ylab = \"GDP per capita\", \n  label.var = County, \n  label.expression = Agri &gt; 10000 & GDPPC &gt; 50000, \n  point.label.args = list(alpha = 0.7, size = 4, color = \"grey50\"),\n  xfill = \"#CC79A7\", \n  yfill = \"#009E73\", \n  title = \"Relationship between GDP PC and Gross Agriculture Output\")\n\nRegistered S3 method overwritten by 'ggside':\n  method from   \n  +.gg   ggplot2\n\n\n`stat_xsidebin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_ysidebin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\n\nBusiness question: Is there any relationship between GDP per capita and Gross Industry Output?\nThere is a moderate positive relationship between GDP per capita and Gross Agriculture Output in this dataset. This suggests that regions with higher agricultural output tend to have higher GDP per capita\n\nbw &lt;- bw.gwr(GDPPC ~ GIO, \n             data = hunan_sp, \n             approach = \"AICc\", \n             adaptive = TRUE)\n\nAdaptive bandwidth (number of nearest neighbours): 62 AICc value: 1870.235 \nAdaptive bandwidth (number of nearest neighbours): 46 AICc value: 1870.852 \nAdaptive bandwidth (number of nearest neighbours): 72 AICc value: 1869.744 \nAdaptive bandwidth (number of nearest neighbours): 78 AICc value: 1869.713 \nAdaptive bandwidth (number of nearest neighbours): 82 AICc value: 1869.604 \nAdaptive bandwidth (number of nearest neighbours): 84 AICc value: 1869.537 \nAdaptive bandwidth (number of nearest neighbours): 86 AICc value: 1869.647 \nAdaptive bandwidth (number of nearest neighbours): 83 AICc value: 1869.567 \nAdaptive bandwidth (number of nearest neighbours): 84 AICc value: 1869.537 \n\n\n\ngwstats &lt;- gwss(hunan_sp, \n                vars = c(\"GDPPC\", \"GIO\"), \n                bw = bw,\n                kernel = \"bisquare\",\n                adaptive = TRUE, \n                longlat = T)\n\n\ngwstat_df &lt;- as.data.frame(gwstats$SDF) %&gt;%\n  select(c(12,13)) %&gt;%\n  rename(gwCorr = Corr_GDPPC.GIO,\n         gwSpearman = Spearman_rho_GDPPC.GIO)\n\n\nhunan_Corr &lt;- cbind(hunan_sf, gwstat_df)\n\n\ntm_shape(hunan_Corr) +\n  tm_fill(\"gwSpearman\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Local Spearman Rho\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.text.size = 0.6,\n            legend.height = 1.50, \n            legend.width = 1.50,\n            frame = TRUE)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html",
    "href": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html",
    "title": "Hands-on_ex05",
    "section": "",
    "text": "If development are evenly distributed geographically? No -&gt; is there sign of spatial clustering? Yes -&gt; where are these clusters?\npacman::p_load(sf, spdep, tmap, tidyverse)\nhunan &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex05/data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nhunan2012 &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex04/data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\nequal interval = equal range of values\nquantile = equal number of observations\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)\nwm_q &lt;- poly2nb(hunan,\n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\ns0: sum of all weights in the spatial weights matrix\ns1: sum of squared weights for each region’s links. rows sums\ns2: sum of squared weights of all the elements in the weights matrix\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex03/In-class_Ex03.html",
    "href": "In-class_Ex/In-class_Ex03/In-class_Ex03.html",
    "title": "In-class Exercise 03",
    "section": "",
    "text": "pacman::p_load(sf, spNetwork, tmap, tidyverse)\n\n\nnetwork &lt;- st_read(dsn=\"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex03/data/geospatial\",\n                   layer = \"Punggol_St\")\n\nReading layer `Punggol_St' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex03\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2642 features and 2 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: 34038.56 ymin: 40941.11 xmax: 38882.85 ymax: 44801.27\nProjected CRS: SVY21 / Singapore TM\n\n\n\nchildcare &lt;- st_read(dsn=\"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex03/data/geospatial\",\n                   layer = \"Punggol_CC\")\n\nReading layer `Punggol_CC' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex03\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 61 features and 1 field\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 34423.98 ymin: 41503.6 xmax: 37619.47 ymax: 44685.77\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\n\n\n\nchildcare\n\nSimple feature collection with 61 features and 1 field\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 34423.98 ymin: 41503.6 xmax: 37619.47 ymax: 44685.77\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n      Name                      geometry\n1   kml_10 POINT Z (36173.81 42550.33 0)\n2   kml_99 POINT Z (36479.56 42405.21 0)\n3  kml_100 POINT Z (36618.72 41989.13 0)\n4  kml_101 POINT Z (36285.37 42261.42 0)\n5  kml_122  POINT Z (35414.54 42625.1 0)\n6  kml_161 POINT Z (36545.16 42580.09 0)\n7  kml_172 POINT Z (35289.44 44083.57 0)\n8  kml_188 POINT Z (36520.56 42844.74 0)\n9  kml_205  POINT Z (36924.01 41503.6 0)\n10 kml_222 POINT Z (37141.76 42326.36 0)\n\n\n\nchildcare &lt;- st_zm(childcare)\n\n\nnetwork\n\nSimple feature collection with 2642 features and 2 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: 34038.56 ymin: 40941.11 xmax: 38882.85 ymax: 44801.27\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n     LINK_ID                   ST_NAME                       geometry\n1  116130894                PUNGGOL RD LINESTRING (36546.89 44574....\n2  116130897 PONGGOL TWENTY-FOURTH AVE LINESTRING (36546.89 44574....\n3  116130901   PONGGOL SEVENTEENTH AVE LINESTRING (36012.73 44154....\n4  116130902   PONGGOL SEVENTEENTH AVE LINESTRING (36062.81 44197....\n5  116130907           PUNGGOL CENTRAL LINESTRING (36131.85 42755....\n6  116130908                PUNGGOL RD LINESTRING (36112.93 42752....\n7  116130909           PUNGGOL CENTRAL LINESTRING (36127.4 42744.5...\n8  116130910               PUNGGOL FLD LINESTRING (35994.98 42428....\n9  116130911               PUNGGOL FLD LINESTRING (35984.97 42407....\n10 116130912            EDGEFIELD PLNS LINESTRING (36200.87 42219....\n\n\n\nplot(st_geometry(network))\nplot(childcare,add=T,col='red',pch = 19)\n\n\n\n\n\n\n\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(childcare) + \n  tm_dots() + \n  tm_shape(network) +\n  tm_lines()\n\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nlixels &lt;- lixelize_lines(network, \n                         700, \n                         mindist = 375)\n\n\nsamples &lt;- lines_center(lixels) \n\n\ndensities &lt;- nkde(network, \n                  events = childcare,\n                  w = rep(1, nrow(childcare)),\n                  samples = samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nsamples$density &lt;- densities\nlixels$density &lt;- densities\n\n\n# rescaling to help the mapping\nsamples$density &lt;- samples$density*1000\nlixels$density &lt;- lixels$density*1000\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(lixels)+\n  tm_lines(col=\"density\")+\ntm_shape(childcare)+\n  tm_dots()\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\n\nkfun_childcare &lt;- kfunctions(network, \n                             childcare,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05)\n\n\nkfun_childcare$plotk"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html#morans-i",
    "href": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html#morans-i",
    "title": "Hands-on_ex05",
    "section": "Moran’s I",
    "text": "Moran’s I\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\nNull Hypothesis (H0): The GDPPC values are evenly distributed geographically, with no spatial autocorrelation (random pattern).\nAlternative Hypothesis (H1): The GDPPC values are not evenly distributed geographically, indicating positive spatial autocorrelation (clusters of similar values).\np-value &lt; 0.05, we reject null hypothesis (H0).\nStandard deviate (Z value) = 4.7351, positive: clustered, observations tend to be similar\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\nThe Monte Carlo simulation you ran provides a way to assess the significance of the observed Moran’s I value.\nWe reject the null hypothesis and conclude that there is significant positive spatial autocorrelation in the GDPPC values across the regions in the hunan dataset.\n\nVisualize Monte Carlo Moran’s I\nres = expected value under random spatial distribution, close to orginal expectation -0.011494253\nThe observed Moran’s I statistic (0.300749970) being significantly different from the expected value under randomness (-0.01504572) indicates that there is spatial autocorrelation in your data.\nWhy Calculate This Mean? Calculating the mean of the simulated Moran’s I values helps to understand the distribution of Moran’s I under the null hypothesis of spatial randomness. It gives you an idea of what the Moran’s I would typically be if there were no spatial autocorrelation present in the data.\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n\n\n\n\n\nQuestion: What statistical observation can you draw from the output above?\nThe observed Moran’s I value is much larger than the values expected under the null hypothesis (as seen in the histogram), provides a strong evidence that the data has significant positive spatial autocorrelation\n\n\nChallenge: Instead of using Base Graph to plot the values, plot the values by using ggplot2 package\n\nlibrary(ggplot2)\n\n# Convert the simulated Moran's I values to a data frame\nmoran_res_df &lt;- data.frame(simulated_moran = bperm$res[1:999])  # Use only the simulated values\n\n# Create the histogram with ggplot\nggplot(moran_res_df, aes(x = simulated_moran)) +\n  geom_histogram(bins = 20, fill = \"lightblue\", color = \"black\", alpha = 0.7) +  # Histogram with 20 bins\n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\") +  # Add vertical line at 0\n  labs(\n    x = \"Simulated Moran's I\",\n    y = \"Frequency\",\n    title = \"Histogram of Simulated Moran's I Values\"\n  ) +\n  theme_minimal()  # Use a minimal theme for a clean look\n\n\n\n\n\n\n\n\n\n\n\nGeary’s C test\nlike Moran’s I, but it focuses more on detecting local differences or dissimilarities between neighbouring values on a map.\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q   \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n\nQuestion: What statistical conclusion can you draw from the output above?\nGeary C statistic 0.69 less than 1 indicates positive spatial autocorrelation, meaning neighbouring regions tend to have similar GDPPC values. The p-value 0.0002 is less than significant level 0.05, we can reject the null hypothesis of no spatial autocorrelation\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nQuestion: What statistical conclusion can you draw from the output above?\nThe observed Geary’s C value of 0.69072 indicates positive spatial autocorrelation (neighboring regions tend to have similar GDPPC values).\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.007436493\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\") \n\n\n\n\n\n\n\n\n\n\nQuestion: What statistical observation can you draw from the output?\nThe distribution centers around 1, which is expected because Geary’s C equals 1 when there is no spatial autocorrelation (randomness). The histogram shows that the observed Geary’s C statistic (around 0.69) is much lower than the expected value under randomness (centered around 1), indicating positive spatial autocorrelation.\n\n\n\nSpatial Correlogram\nIt is a plot of the spatial autocorrelation coefficient on the y-axis and the distance (or spatial lag) on the x-axis.\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\n\n\n\n\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nQuestion: What statistical observation can you draw from the plot above?\nLag 1 has the highest Moran’s value (0.3007500)\nLags 1, 2, 3, 5, and 6 have significant Moran’s I values, meaning the spatial autocorrelation at these distances is statistically significant and not random.\nLag 4 has a positive Moran’s I value (0.0299470), but it is not statistically significant, suggesting that the spatial autocorrelation at this distance is weak and might be due to random variation.\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nQuestion: What statistical observation can you draw from the plot above?\nLags 1, 2, and 5 have statistically significant Geary’s C values, meaning the spatial autocorrelation at these distances is strong and not random.\nLag 1 and 2: Positive spatial autocorrelation (clusters of similar values).\nLag 5: Negative spatial autocorrelation (dissimilar values are neighbors).\nLags 3, 4, and 6 are not statistically significant, indicating weak or random spatial autocorrelation at these distances.\n\n\n\nLocal Measures (LMSA)\nFocus on identifying patterns at a local level rather than across the entire dataset or study area\n\n\nComputing local Moran’s I\n\nfips &lt;- order(hunan$County)\nlocalMI &lt;- localmoran(hunan$GDPPC, rswm_q)\nhead(localMI)\n\n            Ii          E.Ii       Var.Ii        Z.Ii Pr(z != E(Ii))\n1 -0.001468468 -2.815006e-05 4.723841e-04 -0.06626904      0.9471636\n2  0.025878173 -6.061953e-04 1.016664e-02  0.26266425      0.7928094\n3 -0.011987646 -5.366648e-03 1.133362e-01 -0.01966705      0.9843090\n4  0.001022468 -2.404783e-07 5.105969e-06  0.45259801      0.6508382\n5  0.014814881 -6.829362e-05 1.449949e-03  0.39085814      0.6959021\n6 -0.038793829 -3.860263e-04 6.475559e-03 -0.47728835      0.6331568\n\n\nRegion 1 close to 0 = no strong pattern Region 6 weak negative spatial autocorrelation\nZ.li = Z score Positive z score = positive spatial autocorrelation\nPr() = p-value\n\nfips\n\n [1] 56 10  1 48 70 18 84 37 24 69 87 38 39 49 11 83 50  2 19 20 21 82 81 64 51\n[26] 26 12 59 88 27  3 52 60 22 34  4 80 71  5 13 65  7 40 53 54 28 66 57  8 61\n[51] 67 23 77 14 75 41 46 79  6 35 62 42 78 85 29  9 43 86 47 68 36 30 44 45 63\n[76] 31 72 15 55 16 73 58 32 76 33 25 74 17\n\n\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=hunan$County[fips]),\n  check.names=FALSE)\n\n                       Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..\nAnhua         -2.2493e-02 -5.0048e-03  5.8235e-02 -7.2467e-02         0.9422\nAnren         -3.9932e-01 -7.0111e-03  7.0348e-02 -1.4791e+00         0.1391\nAnxiang       -1.4685e-03 -2.8150e-05  4.7238e-04 -6.6269e-02         0.9472\nBaojing        3.4737e-01 -5.0089e-03  8.3636e-02  1.2185e+00         0.2230\nChaling        2.0559e-02 -9.6812e-04  2.7711e-02  1.2932e-01         0.8971\nChangning     -2.9868e-05 -9.0010e-09  1.5105e-07 -7.6828e-02         0.9388\nChangsha       4.9022e+00 -2.1348e-01  2.3194e+00  3.3590e+00         0.0008\nChengbu        7.3725e-01 -1.0534e-02  2.2132e-01  1.5895e+00         0.1119\nChenxi         1.4544e-01 -2.8156e-03  4.7116e-02  6.8299e-01         0.4946\nCili           7.3176e-02 -1.6747e-03  4.7902e-02  3.4200e-01         0.7324\nDao            2.1420e-01 -2.0824e-03  4.4123e-02  1.0297e+00         0.3032\nDongan         1.5210e-01 -6.3485e-04  1.3471e-02  1.3159e+00         0.1882\nDongkou        5.2918e-01 -6.4461e-03  1.0748e-01  1.6338e+00         0.1023\nFenghuang      1.8013e-01 -6.2832e-03  1.3257e-01  5.1198e-01         0.6087\nGuidong       -5.9160e-01 -1.3086e-02  3.7003e-01 -9.5104e-01         0.3416\nGuiyang        1.8240e-01 -3.6908e-03  3.2610e-02  1.0305e+00         0.3028\nGuzhang        2.8466e-01 -8.5054e-03  1.4152e-01  7.7931e-01         0.4358\nHanshou        2.5878e-02 -6.0620e-04  1.0167e-02  2.6266e-01         0.7928\nHengdong       9.9964e-03 -4.9063e-04  6.7742e-03  1.2742e-01         0.8986\nHengnan        2.8064e-02 -3.2160e-04  3.7597e-03  4.6294e-01         0.6434\nHengshan      -5.8201e-03 -3.0437e-05  5.1076e-04 -2.5618e-01         0.7978\nHengyang       6.2997e-02 -1.3046e-03  2.1865e-02  4.3486e-01         0.6637\nHongjiang      1.8790e-01 -2.3019e-03  3.1725e-02  1.0678e+00         0.2856\nHuarong       -1.5389e-02 -1.8667e-03  8.1030e-02 -4.7503e-02         0.9621\nHuayuan        8.3772e-02 -8.5569e-04  2.4495e-02  5.4072e-01         0.5887\nHuitong        2.5997e-01 -5.2447e-03  1.1077e-01  7.9685e-01         0.4255\nJiahe         -1.2431e-01 -3.0550e-03  5.1111e-02 -5.3633e-01         0.5917\nJianghua       2.8651e-01 -3.8280e-03  8.0968e-02  1.0204e+00         0.3076\nJiangyong      2.4337e-01 -2.7082e-03  1.1746e-01  7.1800e-01         0.4728\nJingzhou       1.8270e-01 -8.5106e-04  2.4363e-02  1.1759e+00         0.2396\nJinshi        -1.1988e-02 -5.3666e-03  1.1334e-01 -1.9667e-02         0.9843\nJishou        -2.8680e-01 -2.6305e-03  4.4028e-02 -1.3543e+00         0.1756\nLanshan        6.3334e-02 -9.6365e-04  2.0441e-02  4.4972e-01         0.6529\nLeiyang        1.1581e-02 -1.4948e-04  2.5082e-03  2.3422e-01         0.8148\nLengshuijiang -1.7903e+00 -8.2129e-02  2.1598e+00 -1.1623e+00         0.2451\nLi             1.0225e-03 -2.4048e-07  5.1060e-06  4.5260e-01         0.6508\nLianyuan      -1.4672e-01 -1.8983e-03  1.9145e-02 -1.0467e+00         0.2952\nLiling         1.3774e+00 -1.5097e-02  4.2601e-01  2.1335e+00         0.0329\nLinli          1.4815e-02 -6.8294e-05  1.4499e-03  3.9086e-01         0.6959\nLinwu         -2.4621e-03 -9.0703e-06  1.9258e-04 -1.7676e-01         0.8597\nLinxiang       6.5904e-02 -2.9028e-03  2.5470e-01  1.3634e-01         0.8916\nLiuyang        3.3688e+00 -7.7502e-02  1.5180e+00  2.7972e+00         0.0052\nLonghui        8.0801e-01 -1.1377e-02  1.5538e-01  2.0787e+00         0.0376\nLongshan       7.5663e-01 -1.1100e-02  3.1449e-01  1.3690e+00         0.1710\nLuxi           1.8177e-01 -2.4855e-03  3.4249e-02  9.9561e-01         0.3194\nMayang         2.1852e-01 -5.8773e-03  9.8049e-02  7.1663e-01         0.4736\nMiluo          1.8704e+00 -1.6927e-02  2.7925e-01  3.5715e+00         0.0004\nNan           -9.5789e-03 -4.9497e-04  6.8341e-03 -1.0988e-01         0.9125\nNingxiang      1.5607e+00 -7.3878e-02  8.0012e-01  1.8274e+00         0.0676\nNingyuan       2.0910e-01 -7.0884e-03  8.2306e-02  7.5356e-01         0.4511\nPingjiang     -9.8964e-01 -2.6457e-03  5.6027e-02 -4.1698e+00         0.0000\nQidong         1.1806e-01 -2.1207e-03  2.4747e-02  7.6396e-01         0.4449\nQiyang         6.1966e-02 -7.3374e-04  8.5743e-03  6.7712e-01         0.4983\nRucheng       -3.6992e-01 -8.8999e-03  2.5272e-01 -7.1814e-01         0.4727\nSangzhi        2.5053e-01 -4.9470e-03  6.8000e-02  9.7972e-01         0.3272\nShaodong      -3.2659e-02 -3.6592e-05  5.0546e-04 -1.4510e+00         0.1468\nShaoshan       2.1223e+00 -5.0227e-02  1.3668e+00  1.8583e+00         0.0631\nShaoyang       5.9499e-01 -1.1253e-02  1.3012e-01  1.6807e+00         0.0928\nShimen        -3.8794e-02 -3.8603e-04  6.4756e-03 -4.7729e-01         0.6332\nShuangfeng     9.2835e-03 -2.2867e-03  3.1516e-02  6.5174e-02         0.9480\nShuangpai      8.0591e-02 -3.1366e-04  8.9838e-03  8.5358e-01         0.3933\nSuining        3.7585e-01 -3.5933e-03  4.1870e-02  1.8544e+00         0.0637\nTaojiang      -2.5394e-01 -1.2395e-03  1.4477e-02 -2.1002e+00         0.0357\nTaoyuan        1.4729e-02 -1.2039e-04  8.5103e-04  5.0903e-01         0.6107\nTongdao        4.6482e-01 -6.9870e-03  1.9879e-01  1.0582e+00         0.2900\nWangcheng      4.4220e+00 -1.1067e-01  1.3596e+00  3.8873e+00         0.0001\nWugang         7.1003e-01 -7.8144e-03  1.0710e-01  2.1935e+00         0.0283\nXiangtan       2.4530e-01 -3.6457e-04  3.2319e-03  4.3213e+00         0.0000\nXiangxiang     2.6271e-01 -1.2703e-03  2.1290e-02  1.8092e+00         0.0704\nXiangyin       5.4525e-01 -4.7442e-03  7.9236e-02  1.9539e+00         0.0507\nXinhua         1.1810e-01 -6.2649e-03  8.6001e-02  4.2409e-01         0.6715\nXinhuang       1.5725e-01 -4.1820e-03  3.6648e-01  2.6667e-01         0.7897\nXinning        6.8928e-01 -9.6674e-03  2.0328e-01  1.5502e+00         0.1211\nXinshao        5.7578e-02 -8.5932e-03  1.1769e-01  1.9289e-01         0.8470\nXintian       -7.4050e-03 -5.1493e-03  1.0877e-01 -6.8395e-03         0.9945\nXupu           3.2406e-01 -5.7468e-03  5.7735e-02  1.3726e+00         0.1699\nYanling       -6.9021e-02 -5.9211e-04  9.9306e-03 -6.8667e-01         0.4923\nYizhang       -2.6844e-01 -2.2463e-03  4.7588e-02 -1.2202e+00         0.2224\nYongshun       6.3064e-01 -1.1350e-02  1.8830e-01  1.4795e+00         0.1390\nYongxing       4.3411e-01 -9.0735e-03  1.5088e-01  1.1409e+00         0.2539\nYou            7.8750e-02 -7.2728e-03  1.2116e-01  2.4714e-01         0.8048\nYuanjiang      2.0004e-04 -1.7760e-04  2.9798e-03  6.9181e-03         0.9945\nYuanling       8.7298e-03 -2.2981e-06  2.3221e-05  1.8121e+00         0.0700\nYueyang        4.1189e-02 -1.9768e-04  2.3113e-03  8.6085e-01         0.3893\nZhijiang       1.0476e-01 -7.8123e-04  1.3100e-02  9.2214e-01         0.3565\nZhongfang     -2.2685e-01 -2.1455e-03  3.5927e-02 -1.1855e+00         0.2358\nZhuzhou        3.2864e-01 -5.2432e-04  7.2391e-03  3.8688e+00         0.0001\nZixing        -7.6849e-01 -8.8210e-02  9.4057e-01 -7.0144e-01         0.4830\n\n\n\nhunan.localMI &lt;- cbind(hunan,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nDark blue = strong positive spatial autocorrelation\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html#creating-a-lisa-cluster-map",
    "href": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html#creating-a-lisa-cluster-map",
    "title": "Hands-on_ex05",
    "section": "Creating a LISA cluster map",
    "text": "Creating a LISA cluster map\nFirst, plot the Moran scatter plot\n\nnci &lt;- moran.plot(hunan$GDPPC, rswm_q,\n                  labels=as.character(hunan$County), \n                  xlab=\"GDPPC 2012\", \n                  ylab=\"Spatially Lag GDPPC 2012\")\n\n\n\n\n\n\n\n\nPlot Moran scatterplot with standardized variable\n\nhunan$Z.GDPPC &lt;- scale(hunan$GDPPC) %&gt;% \n  as.vector \n\n\nnci2 &lt;- moran.plot(hunan$Z.GDPPC, rswm_q,\n                   labels=as.character(hunan$County),\n                   xlab=\"z-GDPPC 2012\", \n                   ylab=\"Spatially Lag z-GDPPC 2012\")\n\n\n\n\n\n\n\n\nPreparing LISA map clasess\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\n\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \n\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\n\nsignif &lt;- 0.05       \n\n\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4      \n\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \nLM_I &lt;- localMI[,1]   \nsignif &lt;- 0.05       \nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\n\n\n\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\nLISAmap &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\ntmap_arrange(gdppc, LISAmap, \n             asp=1, ncol=2)\n\n\n\n\n\n\n\n\n\nQuestion: What statistical observations can you draw from the LISA map above?\nThe red areas are referred to as hot spots The blue areas are referred to as cold spots"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html#hot-spot-and-cold-spot-analysis",
    "href": "Hands-on_exercise/Hands-on_ex05/Hands-on_ex05.html#hot-spot-and-cold-spot-analysis",
    "title": "Hands-on_ex05",
    "section": "Hot spot and Cold spot analysis",
    "text": "Hot spot and Cold spot analysis\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B')\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \nLink number distribution:\n\n 1  2  3  4  5  6 \n 6 15 14 26 20  7 \n6 least connected regions:\n6 15 30 32 56 65 with 1 link\n7 most connected regions:\n21 28 35 45 50 52 82 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1   S2\nB 88 7744 324 648 5440\n\n\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\n\n\n\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 704 1300 23014\n\n\n\nfips &lt;- order(hunan$County)\ngi.fixed &lt;- localG(hunan$GDPPC, wm62_lw)\ngi.fixed\n\n [1]  0.436075843 -0.265505650 -0.073033665  0.413017033  0.273070579\n [6] -0.377510776  2.863898821  2.794350420  5.216125401  0.228236603\n[11]  0.951035346 -0.536334231  0.176761556  1.195564020 -0.033020610\n[16]  1.378081093 -0.585756761 -0.419680565  0.258805141  0.012056111\n[21] -0.145716531 -0.027158687 -0.318615290 -0.748946051 -0.961700582\n[26] -0.796851342 -1.033949773 -0.460979158 -0.885240161 -0.266671512\n[31] -0.886168613 -0.855476971 -0.922143185 -1.162328599  0.735582222\n[36] -0.003358489 -0.967459309 -1.259299080 -1.452256513 -1.540671121\n[41] -1.395011407 -1.681505286 -1.314110709 -0.767944457 -0.192889342\n[46]  2.720804542  1.809191360 -1.218469473 -0.511984469 -0.834546363\n[51] -0.908179070 -1.541081516 -1.192199867 -1.075080164 -1.631075961\n[56] -0.743472246  0.418842387  0.832943753 -0.710289083 -0.449718820\n[61] -0.493238743 -1.083386776  0.042979051  0.008596093  0.136337469\n[66]  2.203411744  2.690329952  4.453703219 -0.340842743 -0.129318589\n[71]  0.737806634 -1.246912658  0.666667559  1.088613505 -0.985792573\n[76]  1.233609606 -0.487196415  1.626174042 -1.060416797  0.425361422\n[81] -0.837897118 -0.314565243  0.371456331  4.424392623 -0.109566928\n[86]  1.364597995 -1.029658605 -0.718000620\nattr(,\"internals\")\n               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))\n [1,] 0.064192949 0.05747126 2.375922e-04  0.436075843   6.627817e-01\n [2,] 0.042300020 0.04597701 1.917951e-04 -0.265505650   7.906200e-01\n [3,] 0.044961480 0.04597701 1.933486e-04 -0.073033665   9.417793e-01\n [4,] 0.039475779 0.03448276 1.461473e-04  0.413017033   6.795941e-01\n [5,] 0.049767939 0.04597701 1.927263e-04  0.273070579   7.847990e-01\n [6,] 0.008825335 0.01149425 4.998177e-05 -0.377510776   7.057941e-01\n [7,] 0.050807266 0.02298851 9.435398e-05  2.863898821   4.184617e-03\n [8,] 0.083966739 0.04597701 1.848292e-04  2.794350420   5.200409e-03\n [9,] 0.115751554 0.04597701 1.789361e-04  5.216125401   1.827045e-07\n[10,] 0.049115587 0.04597701 1.891013e-04  0.228236603   8.194623e-01\n[11,] 0.045819180 0.03448276 1.420884e-04  0.951035346   3.415864e-01\n[12,] 0.049183846 0.05747126 2.387633e-04 -0.536334231   5.917276e-01\n[13,] 0.048429181 0.04597701 1.924532e-04  0.176761556   8.596957e-01\n[14,] 0.034733752 0.02298851 9.651140e-05  1.195564020   2.318667e-01\n[15,] 0.011262043 0.01149425 4.945294e-05 -0.033020610   9.736582e-01\n[16,] 0.065131196 0.04597701 1.931870e-04  1.378081093   1.681783e-01\n[17,] 0.027587075 0.03448276 1.385862e-04 -0.585756761   5.580390e-01\n[18,] 0.029409313 0.03448276 1.461397e-04 -0.419680565   6.747188e-01\n[19,] 0.061466754 0.05747126 2.383385e-04  0.258805141   7.957856e-01\n[20,] 0.057656917 0.05747126 2.371303e-04  0.012056111   9.903808e-01\n[21,] 0.066518379 0.06896552 2.820326e-04 -0.145716531   8.841452e-01\n[22,] 0.045599896 0.04597701 1.928108e-04 -0.027158687   9.783332e-01\n[23,] 0.030646753 0.03448276 1.449523e-04 -0.318615290   7.500183e-01\n[24,] 0.035635552 0.04597701 1.906613e-04 -0.748946051   4.538897e-01\n[25,] 0.032606647 0.04597701 1.932888e-04 -0.961700582   3.362000e-01\n[26,] 0.035001352 0.04597701 1.897172e-04 -0.796851342   4.255374e-01\n[27,] 0.012746354 0.02298851 9.812587e-05 -1.033949773   3.011596e-01\n[28,] 0.061287917 0.06896552 2.773884e-04 -0.460979158   6.448136e-01\n[29,] 0.014277403 0.02298851 9.683314e-05 -0.885240161   3.760271e-01\n[30,] 0.009622875 0.01149425 4.924586e-05 -0.266671512   7.897221e-01\n[31,] 0.014258398 0.02298851 9.705244e-05 -0.886168613   3.755267e-01\n[32,] 0.005453443 0.01149425 4.986245e-05 -0.855476971   3.922871e-01\n[33,] 0.043283712 0.05747126 2.367109e-04 -0.922143185   3.564539e-01\n[34,] 0.020763514 0.03448276 1.393165e-04 -1.162328599   2.451020e-01\n[35,] 0.081261843 0.06896552 2.794398e-04  0.735582222   4.619850e-01\n[36,] 0.057419907 0.05747126 2.338437e-04 -0.003358489   9.973203e-01\n[37,] 0.013497133 0.02298851 9.624821e-05 -0.967459309   3.333145e-01\n[38,] 0.019289310 0.03448276 1.455643e-04 -1.259299080   2.079223e-01\n[39,] 0.025996272 0.04597701 1.892938e-04 -1.452256513   1.464303e-01\n[40,] 0.016092694 0.03448276 1.424776e-04 -1.540671121   1.233968e-01\n[41,] 0.035952614 0.05747126 2.379439e-04 -1.395011407   1.630124e-01\n[42,] 0.031690963 0.05747126 2.350604e-04 -1.681505286   9.266481e-02\n[43,] 0.018750079 0.03448276 1.433314e-04 -1.314110709   1.888090e-01\n[44,] 0.015449080 0.02298851 9.638666e-05 -0.767944457   4.425202e-01\n[45,] 0.065760689 0.06896552 2.760533e-04 -0.192889342   8.470456e-01\n[46,] 0.098966900 0.05747126 2.326002e-04  2.720804542   6.512325e-03\n[47,] 0.085415780 0.05747126 2.385746e-04  1.809191360   7.042128e-02\n[48,] 0.038816536 0.05747126 2.343951e-04 -1.218469473   2.230456e-01\n[49,] 0.038931873 0.04597701 1.893501e-04 -0.511984469   6.086619e-01\n[50,] 0.055098610 0.06896552 2.760948e-04 -0.834546363   4.039732e-01\n[51,] 0.033405005 0.04597701 1.916312e-04 -0.908179070   3.637836e-01\n[52,] 0.043040784 0.06896552 2.829941e-04 -1.541081516   1.232969e-01\n[53,] 0.011297699 0.02298851 9.615920e-05 -1.192199867   2.331829e-01\n[54,] 0.040968457 0.05747126 2.356318e-04 -1.075080164   2.823388e-01\n[55,] 0.023629663 0.04597701 1.877170e-04 -1.631075961   1.028743e-01\n[56,] 0.006281129 0.01149425 4.916619e-05 -0.743472246   4.571958e-01\n[57,] 0.063918654 0.05747126 2.369553e-04  0.418842387   6.753313e-01\n[58,] 0.070325003 0.05747126 2.381374e-04  0.832943753   4.048765e-01\n[59,] 0.025947288 0.03448276 1.444058e-04 -0.710289083   4.775249e-01\n[60,] 0.039752578 0.04597701 1.915656e-04 -0.449718820   6.529132e-01\n[61,] 0.049934283 0.05747126 2.334965e-04 -0.493238743   6.218439e-01\n[62,] 0.030964195 0.04597701 1.920248e-04 -1.083386776   2.786368e-01\n[63,] 0.058129184 0.05747126 2.343319e-04  0.042979051   9.657182e-01\n[64,] 0.046096514 0.04597701 1.932637e-04  0.008596093   9.931414e-01\n[65,] 0.012459080 0.01149425 5.008051e-05  0.136337469   8.915545e-01\n[66,] 0.091447733 0.05747126 2.377744e-04  2.203411744   2.756574e-02\n[67,] 0.049575872 0.02298851 9.766513e-05  2.690329952   7.138140e-03\n[68,] 0.107907212 0.04597701 1.933581e-04  4.453703219   8.440175e-06\n[69,] 0.019616151 0.02298851 9.789454e-05 -0.340842743   7.332220e-01\n[70,] 0.032923393 0.03448276 1.454032e-04 -0.129318589   8.971056e-01\n[71,] 0.030317663 0.02298851 9.867859e-05  0.737806634   4.606320e-01\n[72,] 0.019437582 0.03448276 1.455870e-04 -1.246912658   2.124295e-01\n[73,] 0.055245460 0.04597701 1.932838e-04  0.666667559   5.049845e-01\n[74,] 0.074278054 0.05747126 2.383538e-04  1.088613505   2.763244e-01\n[75,] 0.013269580 0.02298851 9.719982e-05 -0.985792573   3.242349e-01\n[76,] 0.049407829 0.03448276 1.463785e-04  1.233609606   2.173484e-01\n[77,] 0.028605749 0.03448276 1.455139e-04 -0.487196415   6.261191e-01\n[78,] 0.039087662 0.02298851 9.801040e-05  1.626174042   1.039126e-01\n[79,] 0.031447120 0.04597701 1.877464e-04 -1.060416797   2.889550e-01\n[80,] 0.064005294 0.05747126 2.359641e-04  0.425361422   6.705732e-01\n[81,] 0.044606529 0.05747126 2.357330e-04 -0.837897118   4.020885e-01\n[82,] 0.063700493 0.06896552 2.801427e-04 -0.314565243   7.530918e-01\n[83,] 0.051142205 0.04597701 1.933560e-04  0.371456331   7.102977e-01\n[84,] 0.102121112 0.04597701 1.610278e-04  4.424392623   9.671399e-06\n[85,] 0.021901462 0.02298851 9.843172e-05 -0.109566928   9.127528e-01\n[86,] 0.064931813 0.04597701 1.929430e-04  1.364597995   1.723794e-01\n[87,] 0.031747344 0.04597701 1.909867e-04 -1.029658605   3.031703e-01\n[88,] 0.015893319 0.02298851 9.765131e-05 -0.718000620   4.727569e-01\nattr(,\"cluster\")\n [1] Low  Low  High High High High High High High Low  Low  High Low  Low  Low \n[16] High High High High Low  High High Low  Low  High Low  Low  Low  Low  Low \n[31] Low  Low  Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low \n[46] High High Low  Low  Low  Low  High Low  Low  Low  Low  Low  High Low  Low \n[61] Low  Low  Low  High High High Low  High Low  Low  High Low  High High Low \n[76] High Low  Low  Low  Low  Low  Low  High High Low  High Low  Low \nLevels: Low High\nattr(,\"gstari\")\n[1] FALSE\nattr(,\"call\")\nlocalG(x = hunan$GDPPC, listw = wm62_lw)\nattr(,\"class\")\n[1] \"localG\"\n\n\n\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.fixed)) %&gt;%\n  rename(gstat_fixed = as.matrix.gi.fixed.)\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;-tm_shape(hunan.gi) +\n  tm_fill(col = \"gstat_fixed\", \n          style = \"pretty\",\n          palette=\"-RdBu\",\n          title = \"local Gi\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, Gimap, asp=1, ncol=2)\n\nVariable(s) \"gstat_fixed\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\nfips &lt;- order(hunan$County)\ngi.adaptive &lt;- localG(hunan$GDPPC, knn_lw)\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.adaptive)) %&gt;%\n  rename(gstat_adaptive = as.matrix.gi.adaptive.)\n\n\ngdppc&lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;- tm_shape(hunan.gi) + \n  tm_fill(col = \"gstat_adaptive\", \n          style = \"pretty\", \n          palette=\"-RdBu\", \n          title = \"local Gi\") + \n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, \n             Gimap, \n             asp=1, \n             ncol=2)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\nQuestion: What statistical observation can you draw from the Gi map above?\nThe regions shaded in red represent hot spots. The regions shaded in dark blue represent cold spots. The regions shaded in light peach do not show significant clustering patterns."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#network-constrained-spatial-point-patterns-analysis",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#network-constrained-spatial-point-patterns-analysis",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "5 Network Constrained Spatial Point Patterns Analysis",
    "text": "5 Network Constrained Spatial Point Patterns Analysis\n\n5.1 Bangkok NKDE Analysis\nPreparing the lixels objects\n\nBMR_network_bangkok &lt;- BMR_network[BMR_network$ADM1_EN == \"Bangkok\", ]\n\nBMR_network_bangkok_linestring &lt;- st_cast(BMR_network_bangkok, \"LINESTRING\")\n\n\nbangkok_lixels &lt;- lixelize_lines(BMR_network_bangkok_linestring, 700, mindist = 375)\n\nGenerating the line centre points\n\nbangkok_samples &lt;- lines_center(bangkok_lixels) \n\n\nrdacc_bangkok &lt;- rdacc_bmr_sf[rdacc_bmr_sf$province_en == \"Bangkok\", ]\n\nWe use simple method with big datasets.\n\ndensities &lt;- nkde(BMR_network_bangkok_linestring, \n                  events = rdacc_bangkok,\n                  w = rep(1, nrow(rdacc_bangkok)),\n                  samples = bangkok_samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nbangkok_samples$density &lt;- densities\nbangkok_lixels$density &lt;- densities\n\n\n# rescaling to help the mapping# rescaling to help the mapping\nbangkok_samples$density &lt;- bangkok_samples$density*1000\nbangkok_lixels$density &lt;- bangkok_lixels$density*1000\n\n\ncol_range &lt;- colorRampPalette(c(\"lightblue\", \"red\"))(100) \nplot(st_geometry(bangkok_lixels), col = col_range[cut(bangkok_lixels$density, breaks = 100)], main = \"Bangkok NKDE Visualization\")\n\n\n\n\n\n\n\n\n\n\n5.2 Nonthaburi NKDE Analysis\nPreparing the lixels objects\n\nBMR_network_nonthaburi &lt;- BMR_network[BMR_network$ADM1_EN == \"Nonthaburi\", ]\nBMR_network_nonthaburi_linestring &lt;- st_cast(BMR_network_nonthaburi, \"LINESTRING\")\n\n\nnonthaburi_lixels &lt;- lixelize_lines(BMR_network_nonthaburi_linestring, 700, mindist = 375)\n\nGenerating the line centre points\n\nnonthaburi_samples &lt;- lines_center(nonthaburi_lixels) \n\n\nrdacc_nonthaburi &lt;- rdacc_bmr_sf[rdacc_bmr_sf$province_en == \"Nonthaburi\", ]\n\n\ndensities &lt;- nkde(BMR_network_nonthaburi_linestring, \n                  events = rdacc_nonthaburi,\n                  w = rep(1, nrow(rdacc_nonthaburi)),\n                  samples = nonthaburi_samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nnonthaburi_samples$density &lt;- densities\nnonthaburi_lixels$density &lt;- densities\n\n\n# rescaling to help the mapping# rescaling to help the mapping\nnonthaburi_samples$density &lt;- nonthaburi_samples$density*1000\nnonthaburi_lixels$density &lt;- nonthaburi_lixels$density*1000\n\n\ncol_range &lt;- colorRampPalette(c(\"lightblue\", \"red\"))(100) \nplot(st_geometry(nonthaburi_lixels), col = col_range[cut(nonthaburi_lixels$density, breaks = 100)], main = \"Nonthaburi NKDE Visualization\")\n\n\n\n\n\n\n\n\n\n\n5.3 Nakhon Pathom NKDE Analysis\nPreparing the lixels objects\n\nBMR_network_nakhonpathom &lt;- BMR_network[BMR_network$ADM1_EN == \"Nakhon Pathom\", ]\nBMR_network_nakhonpathom_linestring &lt;- st_cast(BMR_network_nakhonpathom, \"LINESTRING\")\n\n\nnakhonpathom_lixels &lt;- lixelize_lines(BMR_network_nakhonpathom_linestring, 700, mindist = 375)\n\nGenerating the line centre points\n\nnakhonpathom_samples &lt;- lines_center(nakhonpathom_lixels) \n\n\nrdacc_nakhonpathom &lt;- rdacc_bmr_sf[rdacc_bmr_sf$province_en == \"Nakhon Pathom\", ]\n\n\ndensities &lt;- nkde(BMR_network_nakhonpathom_linestring, \n                  events = rdacc_nakhonpathom,\n                  w = rep(1, nrow(rdacc_nakhonpathom)),\n                  samples = nakhonpathom_samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nnakhonpathom_samples$density &lt;- densities\nnakhonpathom_lixels$density &lt;- densities\n\n\n# rescaling to help the mapping# rescaling to help the mapping\nnakhonpathom_samples$density &lt;- nakhonpathom_samples$density*1000\nnakhonpathom_lixels$density &lt;- nakhonpathom_lixels$density*1000\n\n\ncol_range &lt;- colorRampPalette(c(\"lightblue\", \"red\"))(100) \nplot(st_geometry(nakhonpathom_lixels), col = col_range[cut(nakhonpathom_lixels$density, breaks = 100)], main = \"Nakhon Pathom NKDE Visualization\")\n\n\n\n\n\n\n\n\n\n\n5.4 Pathum Thani NKDE Analysis\nPreparing the lixels objects\n\nBMR_network_pathumthani &lt;- BMR_network[BMR_network$ADM1_EN == \"Pathum Thani\", ]\nBMR_network_pathumthani_linestring &lt;- st_cast(BMR_network_pathumthani, \"LINESTRING\")\n\n\npathumthani_lixels &lt;- lixelize_lines(BMR_network_pathumthani_linestring, 700, mindist = 375)\n\nGenerating the line centre points\n\npathumthani_samples &lt;- lines_center(pathumthani_lixels) \n\n\nrdacc_pathumthani &lt;- rdacc_bmr_sf[rdacc_bmr_sf$province_en == \"Pathum Thani\", ]\n\n\ndensities &lt;- nkde(BMR_network_pathumthani_linestring, \n                  events = rdacc_pathumthani,\n                  w = rep(1, nrow(rdacc_pathumthani)),\n                  samples = pathumthani_samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\npathumthani_samples$density &lt;- densities\npathumthani_lixels$density &lt;- densities\n\n\n# rescaling to help the mapping# rescaling to help the mapping\npathumthani_samples$density &lt;- pathumthani_samples$density*1000\npathumthani_lixels$density &lt;- pathumthani_lixels$density*1000\n\n\ncol_range &lt;- colorRampPalette(c(\"lightblue\", \"red\"))(100) \nplot(st_geometry(pathumthani_lixels), col = col_range[cut(pathumthani_lixels$density, breaks = 100)], main = \"Pathum Thani NKDE Visualization\")\n\n\n\n\n\n\n\n\n\n\n5.5 Samut Prakan NKDE Analysis\nPreparing the lixels objects\n\nBMR_network_samutprakan &lt;- BMR_network[BMR_network$ADM1_EN == \"Samut Prakan\", ]\nBMR_network_samutprakan_linestring &lt;- st_cast(BMR_network_samutprakan, \"LINESTRING\")\n\n\nsamutprakan_lixels &lt;- lixelize_lines(BMR_network_samutprakan_linestring, 700, mindist = 375)\n\nGenerating the line centre points\n\nsamutprakan_samples &lt;- lines_center(samutprakan_lixels) \n\n\nrdacc_samutprakan &lt;- rdacc_bmr_sf[rdacc_bmr_sf$province_en == \"Samut Prakan\", ]\n\n\ndensities &lt;- nkde(BMR_network_samutprakan_linestring, \n                  events = rdacc_samutprakan,\n                  w = rep(1, nrow(rdacc_samutprakan)),\n                  samples = samutprakan_samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nsamutprakan_samples$density &lt;- densities\nsamutprakan_lixels$density &lt;- densities\n\n\n# rescaling to help the mapping# rescaling to help the mapping\nsamutprakan_samples$density &lt;- samutprakan_samples$density*1000\nsamutprakan_lixels$density &lt;- samutprakan_lixels$density*1000\n\n\ncol_range &lt;- colorRampPalette(c(\"lightblue\", \"red\"))(100) \nplot(st_geometry(samutprakan_lixels), col = col_range[cut(samutprakan_lixels$density, breaks = 100)], main = \"Samut Prakan NKDE Visualization\")\n\n\n\n\n\n\n\n\n\n\n5.6 Samut Sakhon NKDE Analysis\nPreparing the lixels objects\n\nBMR_network_samutsakhon &lt;- BMR_network[BMR_network$ADM1_EN == \"Samut Sakhon\", ]\nBMR_network_samutsakhon_linestring &lt;- st_cast(BMR_network_samutsakhon, \"LINESTRING\")\n\n\nsamutsakhon_lixels &lt;- lixelize_lines(BMR_network_samutsakhon_linestring, 700, mindist = 375)\n\nGenerating the line centre points\n\nsamutsakhon_samples &lt;- lines_center(samutsakhon_lixels) \n\n\nrdacc_samutsakhon &lt;- rdacc_bmr_sf[rdacc_bmr_sf$province_en == \"Samut Sakhon\", ]\n\n\ndensities &lt;- nkde(BMR_network_samutsakhon_linestring, \n                  events = rdacc_samutsakhon,\n                  w = rep(1, nrow(rdacc_samutsakhon)),\n                  samples = samutsakhon_samples,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, \n                  sparse = TRUE,\n                  verbose = FALSE)\n\n\nsamutsakhon_samples$density &lt;- densities\nsamutsakhon_lixels$density &lt;- densities\n\n\n# rescaling to help the mapping# rescaling to help the mapping\nsamutsakhon_samples$density &lt;- samutsakhon_samples$density*1000\nsamutsakhon_lixels$density &lt;- samutsakhon_lixels$density*1000\n\n\ncol_range &lt;- colorRampPalette(c(\"lightblue\", \"red\"))(100) \nplot(st_geometry(samutsakhon_lixels), col = col_range[cut(samutsakhon_lixels$density, breaks = 100)], main = \"Samut Sakhon NKDE Visualization\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#network-constrained-g--and-k-function-analysis",
    "href": "Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html#network-constrained-g--and-k-function-analysis",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "6 Network Constrained G- and K-function Analysis",
    "text": "6 Network Constrained G- and K-function Analysis\n\n6.1 Bangkok\n\nkfun_rdacc_bangkok &lt;- kfunctions(BMR_network_bangkok_linestring, \n                             rdacc_bangkok,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05,\n                             agg = 10)\n\n\nkfun_rdacc_bangkok$plotk + ggtitle(\"Bangkok\")\n\n\n\n\n\n\n\n\nThe blue line is above the dashed black line and confidence envelope for most of the plot, which suggests that road accidents in Bangkok are clustered rather than randomly distributed.\n\n\n6.2 Nonthaburi\n\nkfun_rdacc_nonthaburi &lt;- kfunctions(BMR_network_nonthaburi_linestring, \n                             rdacc_nonthaburi,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05,\n                             agg = 320)\n\n\nkfun_rdacc_nonthaburi$plotk+ ggtitle(\"Nonthaburi\")\n\n\n\n\n\n\n\n\nUnlike in Bangkok (where we saw clear clustering), road accidents in Nonthaburi resemble regular pattern at the distance of 50 to 575m.\n\n\n6.3 Nakhon Pathom\n\nkfun_rdacc_nakhonpathom &lt;- kfunctions(BMR_network_nakhonpathom_linestring, \n                             rdacc_nakhonpathom,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05,\n                             agg = 170)\n\n\nkfun_rdacc_nakhonpathom$plotk + ggtitle(\"Nakhon Pathom\")\n\n\n\n\n\n\n\n\nRoad accidents in Nakhon Pathom resemble clustered pattern at the distance of 250 to 1000m.\n\n\n6.4 Pathum Thani\n\nkfun_rdacc_pathumthani &lt;- kfunctions(BMR_network_pathumthani_linestring, \n                             rdacc_pathumthani,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05,\n                             agg = 10)\n\n\nkfun_rdacc_pathumthani$plotk + ggtitle(\"Pathum Thani\")\n\n\n\n\n\n\n\n\nRoad accidents in Pathum Thani resemble clustered pattern at the distance of 0 to 1000m.\n\n\n6.5 Samut Prakan\n\nkfun_rdacc_samutprakan &lt;- kfunctions(BMR_network_samutprakan_linestring, \n                             rdacc_samutprakan,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05,\n                             agg = 10)\n\n\nkfun_rdacc_samutprakan$plotk + ggtitle(\"Samut Prakan\")\n\n\n\n\n\n\n\n\nRoad accidents in Samut Prakan resemble clustered pattern at the distance of 0 to 1000m.\n\n\n6.6 Samut Sakhon\n\nkfun_rdacc_samutsakhon &lt;- kfunctions(BMR_network_samutsakhon_linestring, \n                             rdacc_samutsakhon,\n                             start = 0, \n                             end = 1000, \n                             step = 50, \n                             width = 50, \n                             nsim = 50, \n                             resolution = 50,\n                             verbose = FALSE, \n                             conf_int = 0.05,\n                             agg = 10)\n\n\nkfun_rdacc_samutsakhon$plotk + ggtitle(\"Samut Sakhon\")\n\n\n\n\n\n\n\n\nRoad accidents in Samut Sakhon resemble clustered pattern at the distance of 0 to 1000m."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In-class_Ex05.html",
    "href": "In-class_Ex/In-class_Ex05/In-class_Ex05.html",
    "title": "In-class exercise 05",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, sfdep)\n\n\n\n\n\nhunan &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex05/data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\nhunan2012 &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex04/data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nall the rows from the first data frame hunan are kept. The result will contain all rows from hunan, along with matching data from hunan2012\n\nhunan_GDPPC &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n\n\n\n\n\n\n\nCaution\n\n\n\nIn order to retain the geospatial properties, the left data frame must the sf data.frame (i.e. hunan)\n\n\n\n\n\nequal interval = equal range of values\nquantile = equal number of observations\n\nequal &lt;- tm_shape(hunan_GDPPC) +\n  tm_fill(\"GDPPC\",\n          title = \"GDPPC by equal interval\",\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of GDP per capita by county, Hunan Province\",\n            main.title.size = 0.8)\n\nquantile &lt;- tm_shape(hunan_GDPPC) +\n  tm_fill(\"GDPPC\",\n          title = \"GDPPC by equal quantile\",\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of GDP per capita by county, Hunan Province\",\n            main.title.size = 0.8)\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hunan_GDPPC) +\n  tm_fill(\"GDPPC\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"GDPPC\") +\n  tm_layout(main.title = \"Distribution of GDP per capita by county, Hunan Province\",\n            main.title.position = \"center\",\n            main.title.size = 0.6,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwm_q &lt;- hunan_GDPPC %&gt;%\n  mutate(nb=st_contiguity(geometry),\n         wt=st_weights(nb,\n                        style = \"W\"),\n         .before = 1)\n\nW = row standardized weights nb = every neighbours wt = weights for each neighbours, 4 neighbours = 1/4\nisland dont have neighbours, allow zero as lagged value to avoid missing value before = 1 brings the 2 new columns in front of the table\nif we use poly2nb, we will not get the simple feature\n\nwm_q\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                               nb\n1                 2, 3, 4, 57, 85\n2               1, 57, 58, 78, 85\n3                     1, 4, 5, 85\n4                      1, 3, 5, 6\n5                     3, 4, 6, 85\n6                4, 5, 69, 75, 85\n7                  67, 71, 74, 84\n8       9, 46, 47, 56, 78, 80, 86\n9           8, 66, 68, 78, 84, 86\n10 16, 17, 19, 20, 22, 70, 72, 73\n                                                                            wt\n1                                                      0.2, 0.2, 0.2, 0.2, 0.2\n2                                                      0.2, 0.2, 0.2, 0.2, 0.2\n3                                                       0.25, 0.25, 0.25, 0.25\n4                                                       0.25, 0.25, 0.25, 0.25\n5                                                       0.25, 0.25, 0.25, 0.25\n6                                                      0.2, 0.2, 0.2, 0.2, 0.2\n7                                                       0.25, 0.25, 0.25, 0.25\n8  0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571\n9             0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667\n10                      0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125\n     NAME_2  ID_3    NAME_3   ENGTYPE_3    County GDPPC\n1   Changde 21098   Anxiang      County   Anxiang 23667\n2   Changde 21100   Hanshou      County   Hanshou 20981\n3   Changde 21101    Jinshi County City    Jinshi 34592\n4   Changde 21102        Li      County        Li 24473\n5   Changde 21103     Linli      County     Linli 25554\n6   Changde 21104    Shimen      County    Shimen 27137\n7  Changsha 21109   Liuyang County City   Liuyang 63118\n8  Changsha 21110 Ningxiang      County Ningxiang 62202\n9  Changsha 21111 Wangcheng      County Wangcheng 70666\n10 Chenzhou 21112     Anren      County     Anren 12761\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734...\n\n\n\n\n\n\nglobal_moran_test(wm_q$GDPPC,\n                        wm_q$nb,\n                        wm_q$wt,\n              )\n\n\n    Moran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\np-value &lt;0.05, reject null hypothesis. There are spatial autocorrelation either positive or negative.\nMoran I = 0.300749970 relative weak positive spatial autocorrelation\n\n\n\n\nset.seed(1234)\nglobal_moran_perm(wm_q$GDPPC,\n                        wm_q$nb,\n                        wm_q$wt,\n                  nsim = 99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = 0.30075, observed rank = 100, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\n\n\nThe statistical report on previous tab shows that the p-value is smaller than alpha value of 0.05. Hence, we have enough statistical evidence to reject the null hypothesis that the spatial distribution of GPD per capita are resemble random distribution (i.e. independent from spatial). Because the Moran’s I statistics is greater than 0. We can infer that the spatial distribution shows sign of clustering.\n\n\n\n\n\n\nTip\n\n\n\nThe number of simulation is always equal to nsim + 1. This means in nsim = 99, 100 simulation will be performed.\n\n\n\n\n\n\nOutliers: High-Low & Low-High Clusters: High-High & Low-Low\n\n\n\nlisa &lt;- wm_q %&gt;%\n  mutate(local_moran=local_moran(\n    GDPPC, nb,wt,nsim=99),\n    .before = 1) %&gt;%\n  unnest(local_moran)\n\nColumns:\n\nii: local moran statistics, positive = clustering\neii: expectation of local moran statistic under the assumption of spatial randomness\nvar_ii: variance of local moran statistic, high = more psread out\nz_ii: standard deviate of local moran statistic, positive = cluster of similar values\nskewness: Positive = more extreme values above the mean\nkurtosis: High kurtosis = more extreme outlier\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"p_ii_sim\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\nmap2 &lt;- tm_shape(lisa) +\n  tm_fill(\"p_ii\", breaks = c(0,0.001,0.01,0.05,1),labels = c(\"0.001\",\"0.01\",\"0.05\",\"Not Sig\")) +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"p-value of Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\nlisa_sig &lt;- lisa  %&gt;%\n  filter(p_ii_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n\n\n\n\n\nUse Getis to identify clusters of high values (hot spots) and low values (cold spots)\n\n\n\nwm_idw &lt;- hunan_GDPPC %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wts = st_inverse_distance(nb, \n                              geometry, \n                              scale = 1,\n                              alpha = 1),\n         .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wts = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\n\n\n\n\n\nHCSA &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    GDPPC, nb, wts, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA\n\nSimple feature collection with 88 features and 18 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n# A tibble: 88 × 19\n    gi_star cluster     e_gi  var_gi std_dev p_value p_sim p_folded_sim skewness\n      &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1  0.261   Low     0.00126  1.07e-7  0.283  7.78e-1  0.66         0.33    0.783\n 2 -0.276   Low     0.000969 4.76e-8 -0.123  9.02e-1  0.98         0.49    0.713\n 3  0.00573 High    0.00156  2.53e-7 -0.0571 9.54e-1  0.78         0.39    0.972\n 4  0.528   High    0.00155  2.97e-7  0.321  7.48e-1  0.56         0.28    0.942\n 5  0.466   High    0.00137  2.76e-7  0.386  7.00e-1  0.52         0.26    1.32 \n 6 -0.445   High    0.000992 7.08e-8 -0.588  5.57e-1  0.68         0.34    0.692\n 7  2.99    High    0.000700 4.05e-8  3.13   1.74e-3  0.04         0.02    0.975\n 8  2.04    High    0.00152  1.58e-7  1.77   7.59e-2  0.16         0.08    1.26 \n 9  4.42    High    0.00130  1.18e-7  4.22   2.39e-5  0.02         0.01    1.20 \n10  1.21    Low     0.00175  1.25e-7  1.49   1.36e-1  0.18         0.09    0.408\n# ℹ 78 more rows\n# ℹ 10 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, NAME_2 &lt;chr&gt;,\n#   ID_3 &lt;int&gt;, NAME_3 &lt;chr&gt;, ENGTYPE_3 &lt;chr&gt;, County &lt;chr&gt;, GDPPC &lt;dbl&gt;,\n#   geometry &lt;POLYGON [°]&gt;\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nDark green areas indicates strong positive spatial autocorrelation\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"Gi* of GDPPC\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(HCSA) +\n  tm_fill(\"p_value\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of Gi*\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\nHCSA_sig &lt;- HCSA  %&gt;%\n  filter(p_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig) +\n  tm_fill(\"cluster\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#queens-contiguity-weights",
    "href": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#queens-contiguity-weights",
    "title": "In-class exercise 05",
    "section": "Queen’s contiguity weights",
    "text": "Queen’s contiguity weights\n\nwm_q &lt;- hunan_GDPPC %&gt;%\n  mutate(nb=st_contiguity(geometry),\n         wt=st_weights(nb,\n                        style = \"W\"),\n         .before = 1)\n\nW = row standardized weights nb = every neighbours wt = weights for each neighbours, 4 neighbours = 1/4\nisland dont have neighbours, allow zero as lagged value to avoid missing value before = 1 brings the 2 new columns in front of the table\nif we use poly2nb, we will not get the simple feature\n\nwm_q\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                               nb\n1                 2, 3, 4, 57, 85\n2               1, 57, 58, 78, 85\n3                     1, 4, 5, 85\n4                      1, 3, 5, 6\n5                     3, 4, 6, 85\n6                4, 5, 69, 75, 85\n7                  67, 71, 74, 84\n8       9, 46, 47, 56, 78, 80, 86\n9           8, 66, 68, 78, 84, 86\n10 16, 17, 19, 20, 22, 70, 72, 73\n                                                                            wt\n1                                                      0.2, 0.2, 0.2, 0.2, 0.2\n2                                                      0.2, 0.2, 0.2, 0.2, 0.2\n3                                                       0.25, 0.25, 0.25, 0.25\n4                                                       0.25, 0.25, 0.25, 0.25\n5                                                       0.25, 0.25, 0.25, 0.25\n6                                                      0.2, 0.2, 0.2, 0.2, 0.2\n7                                                       0.25, 0.25, 0.25, 0.25\n8  0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571\n9             0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667\n10                      0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125\n     NAME_2  ID_3    NAME_3   ENGTYPE_3    County GDPPC\n1   Changde 21098   Anxiang      County   Anxiang 23667\n2   Changde 21100   Hanshou      County   Hanshou 20981\n3   Changde 21101    Jinshi County City    Jinshi 34592\n4   Changde 21102        Li      County        Li 24473\n5   Changde 21103     Linli      County     Linli 25554\n6   Changde 21104    Shimen      County    Shimen 27137\n7  Changsha 21109   Liuyang County City   Liuyang 63118\n8  Changsha 21110 Ningxiang      County Ningxiang 62202\n9  Changsha 21111 Wangcheng      County Wangcheng 70666\n10 Chenzhou 21112     Anren      County     Anren 12761\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734...\n\n\n\nPerforming Global Moran’s I test\n\nglobal_moran_test(wm_q$GDPPC,\n                        wm_q$nb,\n                        wm_q$wt,\n              )\n\n\n    Moran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\np-value &lt;0.05, reject null hypothesis. There are spatial autocorrelation either positive or negative.\nMoran I = 0.300749970 relative weak positive spatial autocorrelation\n\n\nPerforming Global Moran’s I permutation test\n\nset.seed(1234)\nglobal_moran_perm(wm_q$GDPPC,\n                        wm_q$nb,\n                        wm_q$wt,\n                  nsim = 99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = 0.30075, observed rank = 100, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\n\n\nThe statistical report on previous tab shows that the p-value is smaller than alpha value of 0.05. Hence, we have enough statistical evidence to reject the null hypothesis that the spatial distribution of GPD per capita are resemble random distribution (i.e. independent from spatial). Because the Moran’s I statistics is greater than 0. We can infer that the spatial distribution shows sign of clustering.\n\n\n\n\n\n\nTip\n\n\n\nThe number of simulation is always equal to nsim + 1. This means in nsim = 99, 100 simulation will be performed."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#lisa-map",
    "href": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#lisa-map",
    "title": "In-class exercise 05",
    "section": "",
    "text": "Outliers: High-Low & Low-High Clusters: High-High & Low-Low\n\n\n\nlisa &lt;- wm_q %&gt;%\n  mutate(local_moran=local_moran(\n    GDPPC, nb,wt,nsim=99),\n    .before = 1) %&gt;%\n  unnest(local_moran)\n\nColumns:\n\nii: local moran statistics, positive = clustering\neii: expectation of local moran statistic under the assumption of spatial randomness\nvar_ii: variance of local moran statistic, high = more psread out\nz_ii: standard deviate of local moran statistic, positive = cluster of similar values\nskewness: Positive = more extreme values above the mean\nkurtosis: High kurtosis = more extreme outlier\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"p_ii_sim\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\nmap2 &lt;- tm_shape(lisa) +\n  tm_fill(\"p_ii\", breaks = c(0,0.001,0.01,0.05,1),labels = c(\"0.001\",\"0.01\",\"0.05\",\"Not Sig\")) +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"p-value of Moran's I of GDPPC\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\nlisa_sig &lt;- lisa  %&gt;%\n  filter(p_ii_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#hot-spot-and-cold-spot-area-analysis-hcsa",
    "href": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#hot-spot-and-cold-spot-area-analysis-hcsa",
    "title": "In-class exercise 05",
    "section": "",
    "text": "Use Getis to identify clusters of high values (hot spots) and low values (cold spots)\n\n\n\nwm_idw &lt;- hunan_GDPPC %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wts = st_inverse_distance(nb, \n                              geometry, \n                              scale = 1,\n                              alpha = 1),\n         .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wts = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\n\n\n\n\n\nHCSA &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    GDPPC, nb, wts, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA\n\nSimple feature collection with 88 features and 18 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n# A tibble: 88 × 19\n    gi_star cluster     e_gi  var_gi std_dev p_value p_sim p_folded_sim skewness\n      &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1  0.261   Low     0.00126  1.07e-7  0.283  7.78e-1  0.66         0.33    0.783\n 2 -0.276   Low     0.000969 4.76e-8 -0.123  9.02e-1  0.98         0.49    0.713\n 3  0.00573 High    0.00156  2.53e-7 -0.0571 9.54e-1  0.78         0.39    0.972\n 4  0.528   High    0.00155  2.97e-7  0.321  7.48e-1  0.56         0.28    0.942\n 5  0.466   High    0.00137  2.76e-7  0.386  7.00e-1  0.52         0.26    1.32 \n 6 -0.445   High    0.000992 7.08e-8 -0.588  5.57e-1  0.68         0.34    0.692\n 7  2.99    High    0.000700 4.05e-8  3.13   1.74e-3  0.04         0.02    0.975\n 8  2.04    High    0.00152  1.58e-7  1.77   7.59e-2  0.16         0.08    1.26 \n 9  4.42    High    0.00130  1.18e-7  4.22   2.39e-5  0.02         0.01    1.20 \n10  1.21    Low     0.00175  1.25e-7  1.49   1.36e-1  0.18         0.09    0.408\n# ℹ 78 more rows\n# ℹ 10 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, NAME_2 &lt;chr&gt;,\n#   ID_3 &lt;int&gt;, NAME_3 &lt;chr&gt;, ENGTYPE_3 &lt;chr&gt;, County &lt;chr&gt;, GDPPC &lt;dbl&gt;,\n#   geometry &lt;POLYGON [°]&gt;\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nDark green areas indicates strong positive spatial autocorrelation\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"Gi* of GDPPC\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(HCSA) +\n  tm_fill(\"p_value\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of Gi*\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\n\n\nHCSA_sig &lt;- HCSA  %&gt;%\n  filter(p_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig) +\n  tm_fill(\"cluster\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#getting-started",
    "href": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#getting-started",
    "title": "In-class exercise 05",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, sfdep)\n\n\n\n\n\nhunan &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex05/data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex05\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\nhunan2012 &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex04/data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nall the rows from the first data frame hunan are kept. The result will contain all rows from hunan, along with matching data from hunan2012\n\nhunan_GDPPC &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n\n\n\n\n\n\n\nCaution\n\n\n\nIn order to retain the geospatial properties, the left data frame must the sf data.frame (i.e. hunan)\n\n\n\n\n\nequal interval = equal range of values\nquantile = equal number of observations\n\nequal &lt;- tm_shape(hunan_GDPPC) +\n  tm_fill(\"GDPPC\",\n          title = \"GDPPC by equal interval\",\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of GDP per capita by county, Hunan Province\",\n            main.title.size = 0.8)\n\nquantile &lt;- tm_shape(hunan_GDPPC) +\n  tm_fill(\"GDPPC\",\n          title = \"GDPPC by equal quantile\",\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of GDP per capita by county, Hunan Province\",\n            main.title.size = 0.8)\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hunan_GDPPC) +\n  tm_fill(\"GDPPC\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"GDPPC\") +\n  tm_layout(main.title = \"Distribution of GDP per capita by county, Hunan Province\",\n            main.title.position = \"center\",\n            main.title.size = 0.6,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#global-measures-of-spatial-association",
    "href": "In-class_Ex/In-class_Ex05/In-class_Ex05.html#global-measures-of-spatial-association",
    "title": "In-class exercise 05",
    "section": "",
    "text": "wm_q &lt;- hunan_GDPPC %&gt;%\n  mutate(nb=st_contiguity(geometry),\n         wt=st_weights(nb,\n                        style = \"W\"),\n         .before = 1)\n\nW = row standardized weights nb = every neighbours wt = weights for each neighbours, 4 neighbours = 1/4\nisland dont have neighbours, allow zero as lagged value to avoid missing value before = 1 brings the 2 new columns in front of the table\nif we use poly2nb, we will not get the simple feature\n\nwm_q\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                               nb\n1                 2, 3, 4, 57, 85\n2               1, 57, 58, 78, 85\n3                     1, 4, 5, 85\n4                      1, 3, 5, 6\n5                     3, 4, 6, 85\n6                4, 5, 69, 75, 85\n7                  67, 71, 74, 84\n8       9, 46, 47, 56, 78, 80, 86\n9           8, 66, 68, 78, 84, 86\n10 16, 17, 19, 20, 22, 70, 72, 73\n                                                                            wt\n1                                                      0.2, 0.2, 0.2, 0.2, 0.2\n2                                                      0.2, 0.2, 0.2, 0.2, 0.2\n3                                                       0.25, 0.25, 0.25, 0.25\n4                                                       0.25, 0.25, 0.25, 0.25\n5                                                       0.25, 0.25, 0.25, 0.25\n6                                                      0.2, 0.2, 0.2, 0.2, 0.2\n7                                                       0.25, 0.25, 0.25, 0.25\n8  0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571\n9             0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667\n10                      0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125\n     NAME_2  ID_3    NAME_3   ENGTYPE_3    County GDPPC\n1   Changde 21098   Anxiang      County   Anxiang 23667\n2   Changde 21100   Hanshou      County   Hanshou 20981\n3   Changde 21101    Jinshi County City    Jinshi 34592\n4   Changde 21102        Li      County        Li 24473\n5   Changde 21103     Linli      County     Linli 25554\n6   Changde 21104    Shimen      County    Shimen 27137\n7  Changsha 21109   Liuyang County City   Liuyang 63118\n8  Changsha 21110 Ningxiang      County Ningxiang 62202\n9  Changsha 21111 Wangcheng      County Wangcheng 70666\n10 Chenzhou 21112     Anren      County     Anren 12761\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734...\n\n\n\n\n\n\nglobal_moran_test(wm_q$GDPPC,\n                        wm_q$nb,\n                        wm_q$wt,\n              )\n\n\n    Moran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\np-value &lt;0.05, reject null hypothesis. There are spatial autocorrelation either positive or negative.\nMoran I = 0.300749970 relative weak positive spatial autocorrelation\n\n\n\n\nset.seed(1234)\nglobal_moran_perm(wm_q$GDPPC,\n                        wm_q$nb,\n                        wm_q$wt,\n                  nsim = 99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = 0.30075, observed rank = 100, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\n\n\nThe statistical report on previous tab shows that the p-value is smaller than alpha value of 0.05. Hence, we have enough statistical evidence to reject the null hypothesis that the spatial distribution of GPD per capita are resemble random distribution (i.e. independent from spatial). Because the Moran’s I statistics is greater than 0. We can infer that the spatial distribution shows sign of clustering.\n\n\n\n\n\n\nTip\n\n\n\nThe number of simulation is always equal to nsim + 1. This means in nsim = 99, 100 simulation will be performed."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "A technique used to divide geographic areas into meaningful, non-overlapping regions or clusters based on both attribute data and their spatial proximity\n\n\n\n\nHomogeneuous regions refer to areas that are similar in certain characteristics. The purpose of this exercise is to group or segment Shan State into areas where people have similar levels of access to different forms of communication and technology.\n\n\n\n\npacman::p_load(spdep, tmap, sf, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, tidyverse, GGally)\n\nMyanmar Township Boundary Data\n\nshan_sf &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/geospatial\", \n                   layer = \"myanmar_township_boundaries\") %&gt;%\n  filter(ST %in% c(\"Shan (East)\", \"Shan (North)\", \"Shan (South)\")) %&gt;%\n  select(c(2:7))\n\nReading layer `myanmar_township_boundaries' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex06\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 330 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\n\n\nshan_sf\n\nSimple feature collection with 55 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 96.15107 ymin: 19.29932 xmax: 101.1699 ymax: 24.15907\nGeodetic CRS:  WGS 84\nFirst 10 features:\n             ST ST_PCODE       DT   DT_PCODE        TS  TS_PCODE\n1  Shan (North)   MMR015  Mongmit MMR015D008   Mongmit MMR015017\n2  Shan (South)   MMR014 Taunggyi MMR014D001   Pindaya MMR014006\n3  Shan (South)   MMR014 Taunggyi MMR014D001   Ywangan MMR014007\n4  Shan (South)   MMR014 Taunggyi MMR014D001  Pinlaung MMR014009\n5  Shan (North)   MMR015  Mongmit MMR015D008    Mabein MMR015018\n6  Shan (South)   MMR014 Taunggyi MMR014D001     Kalaw MMR014005\n7  Shan (South)   MMR014 Taunggyi MMR014D001     Pekon MMR014010\n8  Shan (South)   MMR014 Taunggyi MMR014D001  Lawksawk MMR014008\n9  Shan (North)   MMR015  Kyaukme MMR015D003 Nawnghkio MMR015013\n10 Shan (North)   MMR015  Kyaukme MMR015D003   Kyaukme MMR015012\n                         geometry\n1  MULTIPOLYGON (((96.96001 23...\n2  MULTIPOLYGON (((96.7731 21....\n3  MULTIPOLYGON (((96.78483 21...\n4  MULTIPOLYGON (((96.49518 20...\n5  MULTIPOLYGON (((96.66306 24...\n6  MULTIPOLYGON (((96.49518 20...\n7  MULTIPOLYGON (((97.14738 19...\n8  MULTIPOLYGON (((96.94981 22...\n9  MULTIPOLYGON (((96.75648 22...\n10 MULTIPOLYGON (((96.95498 22...\n\n\n\nglimpse(shan_sf)\n\nRows: 55\nColumns: 7\n$ ST       &lt;chr&gt; \"Shan (North)\", \"Shan (South)\", \"Shan (South)\", \"Shan (South)…\n$ ST_PCODE &lt;chr&gt; \"MMR015\", \"MMR014\", \"MMR014\", \"MMR014\", \"MMR015\", \"MMR014\", \"…\n$ DT       &lt;chr&gt; \"Mongmit\", \"Taunggyi\", \"Taunggyi\", \"Taunggyi\", \"Mongmit\", \"Ta…\n$ DT_PCODE &lt;chr&gt; \"MMR015D008\", \"MMR014D001\", \"MMR014D001\", \"MMR014D001\", \"MMR0…\n$ TS       &lt;chr&gt; \"Mongmit\", \"Pindaya\", \"Ywangan\", \"Pinlaung\", \"Mabein\", \"Kalaw…\n$ TS_PCODE &lt;chr&gt; \"MMR015017\", \"MMR014006\", \"MMR014007\", \"MMR014009\", \"MMR01501…\n$ geometry &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((96.96001 23..., MULTIPOLYGON (((…\n\n\nShan-ICT.csv\n\nict &lt;- read_csv (\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/aspatial/Shan-ICT.csv\")\n\nRows: 55 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): District Pcode, District Name, Township Pcode, Township Name\ndbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nsummary(ict)\n\n District Pcode     District Name      Township Pcode     Township Name     \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n Total households     Radio         Television    Land line phone \n Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685    Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  \n  Mobile phone      Computer      Internet at home\n Min.   :  150   Min.   :  20.0   Min.   :   8.0  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  \n Median : 3559   Median : 244.0   Median : 316.0  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0  \n\n\nThere are total of 11 fields and 55 observations in the tibble data.frame\n\n\n\nWhy? townships with relatively higher total number of households will also have higher number of households owning radio, TV, etc.\n\nict_derived &lt;- ict %&gt;%\n  mutate(`RADIO_PR` = `Radio`/`Total households`*1000) %&gt;%\n  mutate(`TV_PR` = `Television`/`Total households`*1000) %&gt;%\n  mutate(`LLPHONE_PR` = `Land line phone`/`Total households`*1000) %&gt;%\n  mutate(`MPHONE_PR` = `Mobile phone`/`Total households`*1000) %&gt;%\n  mutate(`COMPUTER_PR` = `Computer`/`Total households`*1000) %&gt;%\n  mutate(`INTERNET_PR` = `Internet at home`/`Total households`*1000) %&gt;%\n  rename(`DT_PCODE` =`District Pcode`,`DT`=`District Name`,\n         `TS_PCODE`=`Township Pcode`, `TS`=`Township Name`,\n         `TT_HOUSEHOLDS`=`Total households`,\n         `RADIO`=`Radio`, `TV`=`Television`, \n         `LLPHONE`=`Land line phone`, `MPHONE`=`Mobile phone`,\n         `COMPUTER`=`Computer`, `INTERNET`=`Internet at home`) \n\n\nsummary(ict_derived)\n\n   DT_PCODE              DT              TS_PCODE              TS           \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n TT_HOUSEHOLDS       RADIO             TV           LLPHONE      \n Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685   Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  \n     MPHONE         COMPUTER         INTERNET         RADIO_PR     \n Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 21.05  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:138.95  \n Median : 3559   Median : 244.0   Median : 316.0   Median :210.95  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :215.68  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:268.07  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :484.52  \n     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    \n Min.   :116.0   Min.   :  2.78   Min.   : 36.42   Min.   : 3.278  \n 1st Qu.:450.2   1st Qu.: 22.84   1st Qu.:190.14   1st Qu.:11.832  \n Median :517.2   Median : 37.59   Median :305.27   Median :18.970  \n Mean   :509.5   Mean   : 51.09   Mean   :314.05   Mean   :24.393  \n 3rd Qu.:606.4   3rd Qu.: 69.72   3rd Qu.:428.43   3rd Qu.:29.897  \n Max.   :842.5   Max.   :181.49   Max.   :735.43   Max.   :92.402  \n  INTERNET_PR     \n Min.   :  1.041  \n 1st Qu.:  8.617  \n Median : 22.829  \n Mean   : 30.644  \n 3rd Qu.: 41.281  \n Max.   :117.985  \n\n\nThere are total of 17 fields and 55 observations in the tibble data.frame\n\n\n\n\n\n\n\nggplot(data=ict_derived, \n       aes(x=`RADIO`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\n\n\n\n\n\n\n\n\n\nuse to detect outliers\n\nggplot(data=ict_derived, \n       aes(x=`RADIO`)) +\n  geom_boxplot(color=\"black\", \n               fill=\"light blue\")\n\n\n\n\n\n\n\n\nRadio Penetration rate\n\nggplot(data=ict_derived, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\n\n\n\n\n\n\n\nggplot(data=ict_derived, \n       aes(x=`RADIO_PR`)) +\n  geom_boxplot(color=\"black\", \n               fill=\"light blue\")\n\n\n\n\n\n\n\n\n\n\n\n\nradio &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ntv &lt;- ggplot(data=ict_derived, \n             aes(x= `TV_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\nllphone &lt;- ggplot(data=ict_derived, \n             aes(x= `LLPHONE_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\nmphone &lt;- ggplot(data=ict_derived, \n             aes(x= `MPHONE_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ncomputer &lt;- ggplot(data=ict_derived, \n             aes(x= `COMPUTER_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ninternet &lt;- ggplot(data=ict_derived, \n             aes(x= `INTERNET_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\nggarrange(radio, tv, llphone, mphone, computer, internet, \n          ncol = 3, \n          nrow = 2)\n\n\n\n\n\n\n\n\n\n\n\nNeed to combine both the geospatial shan_sf & aspatial data ict_derived Unique identifier to join both = TS_PCODE\n\nshan_sf &lt;- left_join(shan_sf, \n                     ict_derived, by=c(\"TS_PCODE\"=\"TS_PCODE\"))\n  \nwrite_rds(shan_sf, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/rds/shan_sf.rds\")\n\n\nshan_sf &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/rds/shan_sf.rds\")\n\n\nqtm(shan_sf, \"RADIO_PR\")\n\n\n\n\n\n\n\n\nTo reveal the distribution shown in the choropleth map above are bias to the underlying total number of households at the townships.\n\nTT_HOUSEHOLDS.map &lt;- tm_shape(shan_sf) + \n  tm_fill(col = \"TT_HOUSEHOLDS\",\n          n = 5,\n          style = \"jenks\", \n          title = \"Total households\") + \n  tm_borders(alpha = 0.5) \n\nRADIO.map &lt;- tm_shape(shan_sf) + \n  tm_fill(col = \"RADIO\",\n          n = 5,\n          style = \"jenks\",\n          title = \"Number Radio \") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(TT_HOUSEHOLDS.map, RADIO.map,\n             asp=NA, ncol=2)\n\n\n\n\n\n\n\n\nTownships with relatively larger number of households are showing relatively higher number of radio ownership\n\ntm_shape(shan_sf) +\n    tm_polygons(c(\"TT_HOUSEHOLDS\", \"RADIO_PR\"),\n                style=\"jenks\",\n                title = c(\"Total households\",\"Radio Penetration Rate\")) +\n    tm_facets(sync = TRUE, ncol = 2) +\n  tm_legend(legend.position = c(\"right\", \"bottom\"))+\n  tm_layout(outer.margins=0, asp=0)\n\n\n\n\n\n\n\n\n\n\n\n\nEnsure the cluster variables are not highly correlated before we perform cluster analysis\n\ncluster_vars.cor = cor(ict_derived[,12:17])\ncorrplot.mixed(cluster_vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n\n\n\n\n\n\n\n\nCOMPUTER_PR and INTERNET_PR are highly correlated. Only use one of them\n\n\n\n\n\nExtract clustering variables from the shan_sf simple feature object into data.frame\n\ncluster_vars &lt;- shan_sf %&gt;%\n  st_set_geometry(NULL) %&gt;%\n  select(\"TS.x\", \"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \"MPHONE_PR\", \"COMPUTER_PR\")\nhead(cluster_vars,10)\n\n        TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\n1    Mongmit 286.1852 554.1313   35.30618  260.6944    12.15939\n2    Pindaya 417.4647 505.1300   19.83584  162.3917    12.88190\n3    Ywangan 484.5215 260.5734   11.93591  120.2856     4.41465\n4   Pinlaung 231.6499 541.7189   28.54454  249.4903    13.76255\n5     Mabein 449.4903 708.6423   72.75255  392.6089    16.45042\n6      Kalaw 280.7624 611.6204   42.06478  408.7951    29.63160\n7      Pekon 318.6118 535.8494   39.83270  214.8476    18.97032\n8   Lawksawk 387.1017 630.0035   31.51366  320.5686    21.76677\n9  Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465\n10   Kyaukme 210.9548 601.1773   39.58267  372.4930    30.94709\n\n\nINTERNET_PR is not included because it is highly correlated with variable COMPUTER_PR\nChange the rows by township name instead of row number\n\nrow.names(cluster_vars) &lt;- cluster_vars$\"TS.x\"\nhead(cluster_vars,10)\n\n               TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\nMongmit     Mongmit 286.1852 554.1313   35.30618  260.6944    12.15939\nPindaya     Pindaya 417.4647 505.1300   19.83584  162.3917    12.88190\nYwangan     Ywangan 484.5215 260.5734   11.93591  120.2856     4.41465\nPinlaung   Pinlaung 231.6499 541.7189   28.54454  249.4903    13.76255\nMabein       Mabein 449.4903 708.6423   72.75255  392.6089    16.45042\nKalaw         Kalaw 280.7624 611.6204   42.06478  408.7951    29.63160\nPekon         Pekon 318.6118 535.8494   39.83270  214.8476    18.97032\nLawksawk   Lawksawk 387.1017 630.0035   31.51366  320.5686    21.76677\nNawnghkio Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465\nKyaukme     Kyaukme 210.9548 601.1773   39.58267  372.4930    30.94709\n\n\nDelete the TS.x field\n\nshan_ict &lt;- select(cluster_vars, c(2:6))\nhead(shan_ict, 10)\n\n          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\nMongmit   286.1852 554.1313   35.30618  260.6944    12.15939\nPindaya   417.4647 505.1300   19.83584  162.3917    12.88190\nYwangan   484.5215 260.5734   11.93591  120.2856     4.41465\nPinlaung  231.6499 541.7189   28.54454  249.4903    13.76255\nMabein    449.4903 708.6423   72.75255  392.6089    16.45042\nKalaw     280.7624 611.6204   42.06478  408.7951    29.63160\nPekon     318.6118 535.8494   39.83270  214.8476    18.97032\nLawksawk  387.1017 630.0035   31.51366  320.5686    21.76677\nNawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465\nKyaukme   210.9548 601.1773   39.58267  372.4930    30.94709\n\n\nStandardize the data, it is not unusual the variables values range are different.\nMin-max method\n\nshan_ict.std &lt;- normalize(shan_ict)\nsummary(shan_ict.std)\n\n    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.2544   1st Qu.:0.4600   1st Qu.:0.1123   1st Qu.:0.2199  \n Median :0.4097   Median :0.5523   Median :0.1948   Median :0.3846  \n Mean   :0.4199   Mean   :0.5416   Mean   :0.2703   Mean   :0.3972  \n 3rd Qu.:0.5330   3rd Qu.:0.6750   3rd Qu.:0.3746   3rd Qu.:0.5608  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n  COMPUTER_PR     \n Min.   :0.00000  \n 1st Qu.:0.09598  \n Median :0.17607  \n Mean   :0.23692  \n 3rd Qu.:0.29868  \n Max.   :1.00000  \n\n\nZ-scores method\n\nshan_ict.z &lt;- scale(shan_ict)\ndescribe(shan_ict.z)\n\n            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis\nRADIO_PR       1 55    0  1  -0.04   -0.06 0.94 -1.85 2.55  4.40  0.48    -0.27\nTV_PR          2 55    0  1   0.05    0.04 0.78 -2.47 2.09  4.56 -0.38    -0.23\nLLPHONE_PR     3 55    0  1  -0.33   -0.15 0.68 -1.19 3.20  4.39  1.37     1.49\nMPHONE_PR      4 55    0  1  -0.05   -0.06 1.01 -1.58 2.40  3.98  0.48    -0.34\nCOMPUTER_PR    5 55    0  1  -0.26   -0.18 0.64 -1.03 3.31  4.34  1.80     2.96\n              se\nRADIO_PR    0.13\nTV_PR       0.13\nLLPHONE_PR  0.13\nMPHONE_PR   0.13\nCOMPUTER_PR 0.13\n\n\n\n\n\n\n\n\nWarning\n\n\n\nWarning: Z-score standardisation method should only be used if we would assume all variables come from some normal distribution.\n\n\nVisualizing the standardized clustering variables\n\nr &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Raw values without standardisation\")\n\nshan_ict_s_df &lt;- as.data.frame(shan_ict.std)\ns &lt;- ggplot(data=shan_ict_s_df, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Min-Max Standardisation\")\n\nshan_ict_z_df &lt;- as.data.frame(shan_ict.z)\nz &lt;- ggplot(data=shan_ict_z_df, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Z-score Standardisation\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n\n\n\n\n\n\n\n\nWhat statistical conclusion can you draw from the histograms above?\nIn summary, the variable RADIO_PR is right-skewed in all three cases. Standardization (either Min-Max or Z-score) does not affect the distribution’s skewness but makes the values more comparable by rescaling them to a uniform range or to units of standard deviation.\n\nr &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"light blue\") +\n  ggtitle(\"Raw values without standardisation\")\n\nshan_ict_s_df &lt;- as.data.frame(shan_ict.std)\ns &lt;- ggplot(data=shan_ict_s_df, \n       aes(x=`RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"light blue\") +\n  ggtitle(\"Min-Max Standardisation\")\n\nshan_ict_z_df &lt;- as.data.frame(shan_ict.z)\nz &lt;- ggplot(data=shan_ict_z_df, \n       aes(x=`RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"light blue\") +\n  ggtitle(\"Z-score Standardisation\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n\n\n\n\n\n\n\n\n\n\n\nCompute the proximity matrix by using dist() of R.\nIt supports: euclidean, maximum, manhattan, canberra, binary and minkowski\nWhy? To group similar observations together based on their proximity.\n\nproxmat &lt;- dist(shan_ict, method = 'euclidean')\n\n\nproxmat\n\n             Mongmit   Pindaya   Ywangan  Pinlaung    Mabein     Kalaw\nPindaya    171.86828                                                  \nYwangan    381.88259 257.31610                                        \nPinlaung    57.46286 208.63519 400.05492                              \nMabein     263.37099 313.45776 529.14689 312.66966                    \nKalaw      160.05997 302.51785 499.53297 181.96406 198.14085          \nPekon       59.61977 117.91580 336.50410  94.61225 282.26877 211.91531\nLawksawk   140.11550 204.32952 432.16535 192.57320 130.36525 140.01101\nNawnghkio   89.07103 180.64047 377.87702 139.27495 204.63154 127.74787\nKyaukme    144.02475 311.01487 505.89191 139.67966 264.88283  79.42225\nMuse       563.01629 704.11252 899.44137 571.58335 453.27410 412.46033\nLaihka     141.87227 298.61288 491.83321 101.10150 345.00222 197.34633\nMongnai    115.86190 258.49346 422.71934  64.52387 358.86053 200.34668\nMawkmai    434.92968 437.99577 397.03752 398.11227 693.24602 562.59200\nKutkai      97.61092 212.81775 360.11861  78.07733 340.55064 204.93018\nMongton    192.67961 283.35574 361.23257 163.42143 425.16902 267.87522\nMongyai    256.72744 287.41816 333.12853 220.56339 516.40426 386.74701\nMongkaing  503.61965 481.71125 364.98429 476.29056 747.17454 625.24500\nLashio     251.29457 398.98167 602.17475 262.51735 231.28227 106.69059\nMongpan    193.32063 335.72896 483.68125 192.78316 301.52942 114.69105\nMatman     401.25041 354.39039 255.22031 382.40610 637.53975 537.63884\nTachileik  529.63213 635.51774 807.44220 555.01039 365.32538 373.64459\nNarphan    406.15714 474.50209 452.95769 371.26895 630.34312 463.53759\nMongkhet   349.45980 391.74783 408.97731 305.86058 610.30557 465.52013\nHsipaw     118.18050 245.98884 388.63147  76.55260 366.42787 212.36711\nMonghsat   214.20854 314.71506 432.98028 160.44703 470.48135 317.96188\nMongmao    242.54541 402.21719 542.85957 217.58854 384.91867 195.18913\nNansang    104.91839 275.44246 472.77637  85.49572 287.92364 124.30500\nLaukkaing  568.27732 726.85355 908.82520 563.81750 520.67373 427.77791\nPangsang   272.67383 428.24958 556.82263 244.47146 418.54016 224.03998\nNamtu      179.62251 225.40822 444.66868 170.04533 366.16094 307.27427\nMonghpyak  177.76325 221.30579 367.44835 222.20020 212.69450 167.08436\nKonkyan    403.39082 500.86933 528.12533 365.44693 613.51206 444.75859\nMongping   265.12574 310.64850 337.94020 229.75261 518.16310 375.64739\nHopong     136.93111 223.06050 352.85844  98.14855 398.00917 264.16294\nNyaungshwe  99.38590 216.52463 407.11649 138.12050 210.21337  95.66782\nHsihseng   131.49728 172.00796 342.91035 111.61846 381.20187 287.11074\nMongla     384.30076 549.42389 728.16301 372.59678 406.09124 260.26411\nHseni      189.37188 337.98982 534.44679 204.47572 213.61240  38.52842\nKunlong    224.12169 355.47066 531.63089 194.76257 396.61508 273.01375\nHopang     281.05362 443.26362 596.19312 265.96924 368.55167 185.14704\nNamhkan    386.02794 543.81859 714.43173 382.78835 379.56035 246.39577\nKengtung   246.45691 385.68322 573.23173 263.48638 219.47071  88.29335\nLangkho    164.26299 323.28133 507.78892 168.44228 253.84371  67.19580\nMonghsu    109.15790 198.35391 340.42789  80.86834 367.19820 237.34578\nTaunggyi   399.84278 503.75471 697.98323 429.54386 226.24011 252.26066\nPangwaun   381.51246 512.13162 580.13146 356.37963 523.44632 338.35194\nKyethi     202.92551 175.54012 287.29358 189.47065 442.07679 360.17247\nLoilen     145.48666 293.61143 469.51621  91.56527 375.06406 217.19877\nManton     430.64070 402.42888 306.16379 405.83081 674.01120 560.16577\nMongyang   309.51302 475.93982 630.71590 286.03834 411.88352 233.56349\nKunhing    173.50424 318.23811 449.67218 141.58836 375.82140 197.63683\nMongyawng  214.21738 332.92193 570.56521 235.55497 193.49994 173.43078\nTangyan    195.92520 208.43740 324.77002 169.50567 448.59948 348.06617\nNamhsan    237.78494 228.41073 286.16305 214.33352 488.33873 385.88676\n               Pekon  Lawksawk Nawnghkio   Kyaukme      Muse    Laihka\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk   157.51129                                                  \nNawnghkio  113.15370  90.82891                                        \nKyaukme    202.12206 186.29066 157.04230                              \nMuse       614.56144 510.13288 533.68806 434.75768                    \nLaihka     182.23667 246.74469 211.88187 128.24979 526.65211          \nMongnai    151.60031 241.71260 182.21245 142.45669 571.97975 100.53457\nMawkmai    416.00669 567.52693 495.15047 512.02846 926.93007 429.96554\nKutkai     114.98048 224.64646 147.44053 170.93318 592.90743 144.67198\nMongton    208.14888 311.07742 225.81118 229.28509 634.71074 212.07320\nMongyai    242.52301 391.26989 319.57938 339.27780 763.91399 264.13364\nMongkaing  480.23965 625.18712 546.69447 586.05094 995.66496 522.96309\nLashio     303.80011 220.75270 230.55346 129.95255 313.15288 238.64533\nMongpan    243.30037 228.54223 172.84425 110.37831 447.49969 210.76951\nMatman     368.25761 515.39711 444.05061 505.52285 929.11283 443.25453\nTachileik  573.39528 441.82621 470.45533 429.15493 221.19950 549.08985\nNarphan    416.84901 523.69580 435.59661 420.30003 770.40234 392.32592\nMongkhet   342.08722 487.41102 414.10280 409.03553 816.44931 324.97428\nHsipaw     145.37542 249.35081 176.09570 163.95741 591.03355 128.42987\nMonghsat   225.64279 352.31496 289.83220 253.25370 663.76026 158.93517\nMongmao    293.70625 314.64777 257.76465 146.09228 451.82530 185.99082\nNansang    160.37607 188.78869 151.13185  60.32773 489.35308  78.78999\nLaukkaing  624.82399 548.83928 552.65554 428.74978 149.26996 507.39700\nPangsang   321.81214 345.91486 287.10769 175.35273 460.24292 214.19291\nNamtu      165.02707 260.95300 257.52713 270.87277 659.16927 185.86794\nMonghpyak  190.93173 142.31691  93.03711 217.64419 539.43485 293.22640\nKonkyan    421.48797 520.31264 439.34272 393.79911 704.86973 351.75354\nMongping   259.68288 396.47081 316.14719 330.28984 744.44948 272.82761\nHopong     138.86577 274.91604 204.88286 218.84211 648.68011 157.48857\nNyaungshwe 139.31874 104.17830  43.26545 126.50414 505.88581 201.71653\nHsihseng   105.30573 257.11202 209.88026 250.27059 677.66886 175.89761\nMongla     441.20998 393.18472 381.40808 241.58966 256.80556 315.93218\nHseni      243.98001 171.50398 164.05304  81.20593 381.30567 204.49010\nKunlong    249.36301 318.30406 285.04608 215.63037 547.24297 122.68682\nHopang     336.38582 321.16462 279.84188 154.91633 377.44407 230.78652\nNamhkan    442.77120 379.41126 367.33575 247.81990 238.67060 342.43665\nKengtung   297.67761 209.38215 208.29647 136.23356 330.08211 258.23950\nLangkho    219.21623 190.30257 156.51662  51.67279 413.64173 160.94435\nMonghsu    113.84636 242.04063 170.09168 200.77712 633.21624 163.28926\nTaunggyi   440.66133 304.96838 344.79200 312.60547 250.81471 425.36916\nPangwaun   423.81347 453.02765 381.67478 308.31407 541.97887 351.78203\nKyethi     162.43575 317.74604 267.21607 328.14177 757.16745 255.83275\nLoilen     181.94596 265.29318 219.26405 146.92675 560.43400  59.69478\nManton     403.82131 551.13000 475.77296 522.86003 941.49778 458.30232\nMongyang   363.58788 363.37684 323.32123 188.59489 389.59919 229.71502\nKunhing    213.46379 278.68953 206.15773 145.00266 533.00162 142.03682\nMongyawng  248.43910 179.07229 220.61209 181.55295 422.37358 211.99976\nTangyan    167.79937 323.14701 269.07880 306.78359 736.93741 224.29176\nNamhsan    207.16559 362.84062 299.74967 347.85944 778.52971 273.79672\n             Mongnai   Mawkmai    Kutkai   Mongton   Mongyai Mongkaing\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai    374.50873                                                  \nKutkai      91.15307 364.95519                                        \nMongton    131.67061 313.35220 107.06341                              \nMongyai    203.23607 178.70499 188.94166 159.79790                    \nMongkaing  456.00842 133.29995 428.96133 365.50032 262.84016          \nLashio     270.86983 638.60773 289.82513 347.11584 466.36472 708.65819\nMongpan    178.09554 509.99632 185.18173 200.31803 346.39710 563.56780\nMatman     376.33870 147.83545 340.86349 303.04574 186.95158 135.51424\nTachileik  563.95232 919.38755 568.99109 608.76740 750.29555 967.14087\nNarphan    329.31700 273.75350 314.27683 215.97925 248.82845 285.65085\nMongkhet   275.76855 115.58388 273.91673 223.22828 104.98924 222.60577\nHsipaw      52.68195 351.34601  51.46282  90.69766 177.33790 423.77868\nMonghsat   125.25968 275.09705 154.32012 150.98053 127.35225 375.60376\nMongmao    188.29603 485.52853 204.69232 206.57001 335.61300 552.31959\nNansang     92.79567 462.41938 130.04549 199.58124 288.55962 542.16609\nLaukkaing  551.56800 882.51110 580.38112 604.66190 732.68347 954.11795\nPangsang   204.25746 484.14757 228.33583 210.77938 343.30638 548.40662\nNamtu      209.35473 427.95451 225.28268 308.71751 278.02761 525.04057\nMonghpyak  253.26470 536.71695 206.61627 258.04282 370.01575 568.21089\nKonkyan    328.82831 339.01411 310.60810 248.25265 287.87384 380.92091\nMongping   202.99615 194.31049 182.75266 119.86993  65.38727 257.18572\nHopong      91.53795 302.84362  73.45899 106.21031 124.62791 379.37916\nNyaungshwe 169.63695 502.99026 152.15482 219.72196 327.13541 557.32112\nHsihseng   142.36728 329.29477 128.21054 194.64317 162.27126 411.59788\nMongla     354.10985 686.88950 388.40984 411.06668 535.28615 761.48327\nHseni      216.81639 582.53670 229.37894 286.75945 408.23212 648.04408\nKunlong    202.92529 446.53763 204.54010 270.02165 299.36066 539.91284\nHopang     243.00945 561.24281 263.31986 273.50305 408.73288 626.17673\nNamhkan    370.05669 706.47792 392.48568 414.53594 550.62819 771.39688\nKengtung   272.28711 632.54638 279.19573 329.38387 460.39706 692.74693\nLangkho    174.67678 531.08019 180.51419 236.70878 358.95672 597.42714\nMonghsu     84.11238 332.07962  62.60859 107.04894 154.86049 400.71816\nTaunggyi   448.55282 810.74692 450.33382 508.40925 635.94105 866.21117\nPangwaun   312.13429 500.68857 321.80465 257.50434 394.07696 536.95736\nKyethi     210.50453 278.85535 184.23422 222.52947 137.79420 352.06533\nLoilen      58.41263 388.73386 131.56529 176.16001 224.79239 482.18190\nManton     391.54062 109.08779 361.82684 310.20581 195.59882  81.75337\nMongyang   260.39387 558.83162 285.33223 295.60023 414.31237 631.91325\nKunhing    110.55197 398.43973 108.84990 114.03609 238.99570 465.03971\nMongyawng  275.77546 620.04321 281.03383 375.22688 445.78964 700.98284\nTangyan    180.37471 262.66006 166.61820 198.88460 109.08506 348.56123\nNamhsan    218.10003 215.19289 191.32762 196.76188  77.35900 288.66231\n              Lashio   Mongpan    Matman Tachileik   Narphan  Mongkhet\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan    172.33279                                                  \nMatman     628.11049 494.81014                                        \nTachileik  311.95286 411.03849 890.12935                              \nNarphan    525.63854 371.13393 312.05193 760.29566                    \nMongkhet   534.44463 412.17123 203.02855 820.50164 217.28718          \nHsipaw     290.86435 179.52054 344.45451 576.18780 295.40170 253.80950\nMonghsat   377.86793 283.30992 313.59911 677.09508 278.21548 167.98445\nMongmao    214.23677 131.59966 501.59903 472.95568 331.42618 375.35820\nNansang    184.47950 144.77393 458.06573 486.77266 398.13308 360.99219\nLaukkaing  334.65738 435.58047 903.72094 325.06329 708.82887 769.06406\nPangsang   236.72516 140.23910 506.29940 481.31907 316.30314 375.58139\nNamtu      365.88437 352.91394 416.65397 659.56458 494.36143 355.99713\nMonghpyak  262.09281 187.85699 470.46845 444.04411 448.40651 462.63265\nKonkyan    485.51312 365.87588 392.40306 730.92980 158.82353 254.24424\nMongping   454.52548 318.47482 201.65224 727.08969 188.64567 113.80917\nHopong     345.31042 239.43845 291.84351 632.45718 294.40441 212.99485\nNyaungshwe 201.58191 137.29734 460.91883 445.81335 427.94086 417.08639\nHsihseng   369.00833 295.87811 304.02806 658.87060 377.52977 256.70338\nMongla     179.95877 253.20001 708.17595 347.33155 531.46949 574.40292\nHseni       79.41836 120.66550 564.64051 354.90063 474.12297 481.88406\nKunlong    295.23103 288.03320 468.27436 595.70536 413.07823 341.68641\nHopang     170.63913 135.62913 573.55355 403.82035 397.85908 451.51070\nNamhkan    173.27153 240.34131 715.42102 295.91660 536.85519 596.19944\nKengtung    59.85893 142.21554 613.01033 295.90429 505.40025 531.35998\nLangkho    115.18145  94.98486 518.86151 402.33622 420.65204 428.08061\nMonghsu    325.71557 216.25326 308.13805 605.02113 311.92379 247.73318\nTaunggyi   195.14541 319.81385 778.45810 150.84117 684.20905 712.80752\nPangwaun   362.45608 232.52209 523.43600 540.60474 264.64997 407.02947\nKyethi     447.10266 358.89620 233.83079 728.87329 374.90376 233.25039\nLoilen     268.92310 207.25000 406.56282 573.75476 354.79137 284.76895\nManton     646.66493 507.96808  59.52318 910.23039 280.26395 181.33894\nMongyang   209.33700 194.93467 585.61776 448.79027 401.39475 445.40621\nKunhing    255.10832 137.85278 403.66587 532.26397 281.62645 292.49814\nMongyawng  172.70139 275.15989 601.80824 432.10118 572.76394 522.91815\nTangyan    429.84475 340.39128 242.78233 719.84066 348.84991 201.49393\nNamhsan    472.04024 364.77086 180.09747 754.03913 316.54695 170.90848\n              Hsipaw  Monghsat   Mongmao   Nansang Laukkaing  Pangsang\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat   121.78922                                                  \nMongmao    185.99483 247.17708                                        \nNansang    120.24428 201.92690 164.99494                              \nLaukkaing  569.06099 626.44910 404.00848 480.60074                    \nPangsang   205.04337 256.37933  57.60801 193.36162 408.04016          \nNamtu      229.44658 231.78673 365.03882 217.61884 664.06286 392.97391\nMonghpyak  237.67919 356.84917 291.88846 227.52638 565.84279 315.11651\nKonkyan    296.74316 268.25060 281.87425 374.70456 635.92043 274.81900\nMongping   168.92101 140.95392 305.57166 287.36626 708.13447 308.33123\nHopong      62.86179 100.45714 244.16253 167.66291 628.48557 261.51075\nNyaungshwe 169.92664 286.37238 230.45003 131.18943 520.24345 257.77823\nHsihseng   136.54610 153.49551 311.98001 193.53779 670.74564 335.52974\nMongla     373.47509 429.00536 216.24705 289.45119 202.55831 217.88123\nHseni      231.48538 331.22632 184.67099 136.45492 391.74585 214.66375\nKunlong    205.10051 202.31862 224.43391 183.01388 521.88657 258.49342\nHopang     248.72536 317.64824  78.29342 196.47091 331.67199  92.57672\nNamhkan    382.79302 455.10875 223.32205 302.89487 196.46063 231.38484\nKengtung   284.08582 383.72138 207.58055 193.67980 351.48520 229.85484\nLangkho    183.05109 279.52329 134.50170  99.39859 410.41270 167.65920\nMonghsu     58.55724 137.24737 242.43599 153.59962 619.01766 260.52971\nTaunggyi   462.31183 562.88102 387.33906 365.04897 345.98041 405.59730\nPangwaun   298.12447 343.53898 187.40057 326.12960 470.63605 157.48757\nKyethi     195.17677 190.50609 377.89657 273.02385 749.99415 396.89963\nLoilen      98.04789 118.65144 190.26490  94.23028 535.57527 207.94433\nManton     359.60008 317.15603 503.79786 476.55544 907.38406 504.75214\nMongyang   267.10497 312.64797  91.06281 218.49285 326.19219 108.37735\nKunhing     90.77517 165.38834 103.91040 128.20940 500.41640 123.18870\nMongyawng  294.70967 364.40429 296.40789 191.11990 454.80044 336.16703\nTangyan    167.69794 144.59626 347.14183 249.70235 722.40954 364.76893\nNamhsan    194.47928 169.56962 371.71448 294.16284 760.45960 385.65526\n               Namtu Monghpyak   Konkyan  Mongping    Hopong Nyaungshwe\nPindaya                                                                \nYwangan                                                                \nPinlaung                                                               \nMabein                                                                 \nKalaw                                                                  \nPekon                                                                  \nLawksawk                                                               \nNawnghkio                                                              \nKyaukme                                                                \nMuse                                                                   \nLaihka                                                                 \nMongnai                                                                \nMawkmai                                                                \nKutkai                                                                 \nMongton                                                                \nMongyai                                                                \nMongkaing                                                              \nLashio                                                                 \nMongpan                                                                \nMatman                                                                 \nTachileik                                                              \nNarphan                                                                \nMongkhet                                                               \nHsipaw                                                                 \nMonghsat                                                               \nMongmao                                                                \nNansang                                                                \nLaukkaing                                                              \nPangsang                                                               \nNamtu                                                                  \nMonghpyak  346.57799                                                   \nKonkyan    478.37690 463.39594                                         \nMongping   321.66441 354.76537 242.02901                               \nHopong     206.82668 267.95563 304.49287 134.00139                     \nNyaungshwe 271.41464 103.97300 432.35040 319.32583 209.32532           \nHsihseng   131.89940 285.37627 383.49700 199.64389  91.65458  225.80242\nMongla     483.49434 408.03397 468.09747 512.61580 432.31105  347.60273\nHseni      327.41448 200.26876 448.84563 395.58453 286.41193  130.86310\nKunlong    233.60474 357.44661 329.11433 309.05385 219.06817  285.13095\nHopang     408.24516 304.26577 348.18522 379.27212 309.77356  247.19891\nNamhkan    506.32466 379.50202 481.59596 523.74815 444.13246  333.32428\nKengtung   385.33554 221.47613 474.82621 442.80821 340.47382  177.75714\nLangkho    305.03473 200.27496 386.95022 343.96455 239.63685  128.26577\nMonghsu    209.64684 232.17823 331.72187 158.90478  43.40665  173.82799\nTaunggyi   518.72748 334.17439 650.56905 621.53039 513.76415  325.09619\nPangwaun   517.03554 381.95144 263.97576 340.37881 346.00673  352.92324\nKyethi     186.90932 328.16234 400.10989 187.43974 136.49038  288.06872\nLoilen     194.24075 296.99681 334.19820 231.99959 124.74445  206.40432\nManton     448.58230 502.20840 366.66876 200.48082 310.58885  488.79874\nMongyang   413.26052 358.17599 329.39338 387.80686 323.35704  294.29500\nKunhing    296.43996 250.74435 253.74202 212.59619 145.15617  189.97131\nMongyawng  262.24331 285.56475 522.38580 455.59190 326.59925  218.12104\nTangyan    178.69483 335.26416 367.46064 161.67411 106.82328  284.14692\nNamhsan    240.95555 352.70492 352.20115 130.23777 132.70541  315.91750\n            Hsihseng    Mongla     Hseni   Kunlong    Hopang   Namhkan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla     478.66210                                                  \nHseni      312.74375 226.82048                                        \nKunlong    231.85967 346.46200 276.19175                              \nHopang     370.01334 147.02444 162.80878 271.34451                    \nNamhkan    492.09476  77.21355 212.11323 375.73885 146.18632          \nKengtung   370.72441 202.45004  66.12817 317.14187 164.29921 175.63015\nLangkho    276.27441 229.01675  66.66133 224.52741 134.24847 224.40029\nMonghsu     97.82470 424.51868 262.28462 239.89665 301.84458 431.32637\nTaunggyi   528.14240 297.09863 238.19389 471.29032 329.95252 257.29147\nPangwaun   433.06326 319.18643 330.70182 392.45403 206.98364 310.44067\nKyethi      84.04049 556.02500 388.33498 298.55859 440.48114 567.86202\nLoilen     158.84853 338.67408 227.10984 166.53599 242.89326 364.90647\nManton     334.87758 712.51416 584.63341 479.76855 577.52046 721.86149\nMongyang   382.59743 146.66661 210.19929 247.22785  69.25859 167.72448\nKunhing    220.15490 306.47566 206.47448 193.77551 172.96164 314.92119\nMongyawng  309.51462 315.57550 173.86004 240.39800 290.51360 321.21112\nTangyan     70.27241 526.80849 373.07575 268.07983 412.22167 542.64078\nNamhsan    125.74240 564.02740 411.96125 310.40560 440.51555 576.42717\n            Kengtung   Langkho   Monghsu  Taunggyi  Pangwaun    Kyethi\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho    107.16213                                                  \nMonghsu    316.91914 221.84918                                        \nTaunggyi   186.28225 288.27478 486.91951                              \nPangwaun   337.48335 295.38434 343.38498 497.61245                    \nKyethi     444.26274 350.91512 146.61572 599.57407 476.62610          \nLoilen     282.22935 184.10672 131.55208 455.91617 331.69981 232.32965\nManton     631.99123 535.95620 330.76503 803.08034 510.79265 272.03299\nMongyang   217.08047 175.35413 323.95988 374.58247 225.25026 453.86726\nKunhing    245.95083 146.38284 146.78891 429.98509 229.09986 278.95182\nMongyawng  203.87199 186.11584 312.85089 287.73864 475.33116 387.71518\nTangyan    429.95076 332.02048 127.42203 592.65262 447.05580  47.79331\nNamhsan    466.20497 368.20978 153.22576 631.49232 448.58030  68.67929\n              Loilen    Manton  Mongyang   Kunhing Mongyawng   Tangyan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho                                                               \nMonghsu                                                               \nTaunggyi                                                              \nPangwaun                                                              \nKyethi                                                                \nLoilen                                                                \nManton     419.06087                                                  \nMongyang   246.76592 585.70558                                        \nKunhing    130.39336 410.49230 188.89405                              \nMongyawng  261.75211 629.43339 304.21734 295.35984                    \nTangyan    196.60826 271.82672 421.06366 249.74161 377.52279          \nNamhsan    242.15271 210.48485 450.97869 270.79121 430.02019  63.67613\n\n\n\n\n\nUse hclust() of R\n\nhclust_ward &lt;- hclust(proxmat, method = 'ward.D')\n\n\nplot(hclust_ward, cex = 0.6)\n\n\n\n\n\n\n\n\n\n\n\nOne of the challenges: identify stronger clustering structures Closer to 1 suggest strong clustering structure\n\nm &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\nnames(m) &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\n\nac &lt;- function(x) {\n  agnes(shan_ict, method = x)$ac\n}\n\nmap_dbl(m, ac)\n\n  average    single  complete      ward \n0.8131144 0.6628705 0.8950702 0.9427730 \n\n\nUseWard's method since it provides the strongest clustering structure.\n\n\n\nOne of the challenges: determine the optimal clusters to retain\nGap Statistic Method\n\nset.seed(12345)\ngap_stat &lt;- clusGap(shan_ict, \n                    FUN = hcut, \n                    nstart = 25, \n                    K.max = 10, \n                    B = 50)\n# Print the result\nprint(gap_stat, method = \"firstmax\")\n\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)\nB=50 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --&gt; Number of clusters (method 'firstmax'): 1\n          logW   E.logW       gap     SE.sim\n [1,] 8.407129 8.680794 0.2736651 0.04460994\n [2,] 8.130029 8.350712 0.2206824 0.03880130\n [3,] 7.992265 8.202550 0.2102844 0.03362652\n [4,] 7.862224 8.080655 0.2184311 0.03784781\n [5,] 7.756461 7.978022 0.2215615 0.03897071\n [6,] 7.665594 7.887777 0.2221833 0.03973087\n [7,] 7.590919 7.806333 0.2154145 0.04054939\n [8,] 7.526680 7.731619 0.2049390 0.04198644\n [9,] 7.458024 7.660795 0.2027705 0.04421874\n[10,] 7.377412 7.593858 0.2164465 0.04540947\n\n\n\nfviz_gap_stat(gap_stat)\n\n\n\n\n\n\n\n\nThe recommended number of cluster to retain is 1. However, it is not logical to retain only one cluster. 6-cluster gives the latest gap statistic and should be next best cluster to pick.\nDraw borders using rect.hclust()\n\nplot(hclust_ward, cex = 0.6)\nrect.hclust(hclust_ward, \n            k = 6, \n            border = 2:5)\n\n\n\n\n\n\n\n\nThe higher the height of the fusion, the less similar the observations are.\n\n\n\nUse heatmaply to build both highly interactive cluster heatmap or static cluster heatmap\nTHe data was loaded into a data frame, transform into data matrix using data.matrix\n\nshan_ict_mat &lt;- data.matrix(shan_ict)\n\n\nheatmaply(normalize(shan_ict_mat),\n          Colv=NA,\n          dist_method = \"euclidean\",\n          hclust_method = \"ward.D\",\n          seriate = \"OLO\",\n          colors = Blues,\n          k_row = 6,\n          margins = c(NA,200,60,NA),\n          fontsize_row = 4,\n          fontsize_col = 5,\n          main=\"Geographic Segmentation of Shan State by ICT indicators\",\n          xlab = \"ICT Indicators\",\n          ylab = \"Townships of Shan State\"\n          )\n\n\n\n\n\nretain six clusters using cutree()\n\ngroups &lt;- as.factor(cutree(hclust_ward, k=6))\n\n\nshan_sf_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER`=`as.matrix.groups.`)\n\n\nqtm(shan_sf_cluster, \"CLUSTER\")\n\n\n\n\n\n\n\n\nThe choropleth map above reveals the clusters are very fragmented. The is one of the major limitation when non-spatial clustering algorithm such as hierarchical cluster analysis method is used.\n\n\n\n\nNeighbor list = defines the possible connections between geographic units\nMinimum Spanning Tree MST = link all regions together in the most efficient way possible based on both geographic proximity and attribute similarity\nEdge costs = calculated based on the dissimilarity between the attribute values of connected regions. If 2 neighboring regions have very different ICT measures, the edge cost between them will be higher.\nConverting into SpatialPolygonsDataFrame\n\nshan_sp &lt;- as_Spatial(shan_sf)\n\nComputing Neighbour List using poly2nb\n\nshan.nb &lt;- poly2nb(shan_sp)\nsummary(shan.nb)\n\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\n\n\ncoords &lt;- st_coordinates(\n  st_centroid(st_geometry(shan_sf)))\n\n\nplot(st_geometry(shan_sf), \n     border=grey(.5))\nplot(shan.nb,\n     coords, \n     col=\"blue\", \n     add=TRUE)\n\n\n\n\n\n\n\n\ncalculating edge costs using nbcosts() cost of each edge = the distance between each nodes.\n\nlcosts &lt;- nbcosts(shan.nb, shan_ict)\n\nWhy Incorporate Costs into a Weights Object nb2listw The weights object combines information about spatial adjacency (from the neighbor list) and attribute similarity (from the edge costs).\n\nshan.w &lt;- nb2listw(shan.nb, \n                   lcosts, \n                   style=\"B\")\nsummary(shan.w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\nWeights style: B \nWeights constants summary:\n   n   nn       S0       S1        S2\nB 55 3025 76267.65 58260785 522016004\n\n\nComputing minimum spanning tree using mstree().\nmstree() takes a weights object shan.w.\n\nshan.mst &lt;- mstree(shan.w)\n\nClass of the MST object.\n\nclass(shan.mst)\n\n[1] \"mst\"    \"matrix\"\n\n\nDimensions of the MST 54 rows and 3 columns rows: edges (connections) between the regions\ncolumn 1: The first region (or node) connected by the edge\nColumn 2: The second region (or node) connected by the edge\nColumn 3: The cost of the edge, which represent how different the 2 connected regions are in terms of their attribute\n\ndim(shan.mst)\n\n[1] 54  3\n\n\nFirst row: Region 8 is connected to Region 9, and the cost (dissimilarity) of this connection is 90.82891.\n\nhead(shan.mst)\n\n     [,1] [,2]      [,3]\n[1,]   54   48  47.79331\n[2,]   54   17 109.08506\n[3,]   54   45 127.42203\n[4,]   45   52 146.78891\n[5,]   52   13 110.55197\n[6,]   13   28  92.79567\n\n\n\nplot(st_geometry(shan_sf), \n                 border=gray(.5))\nplot.mst(shan.mst, \n         coords, \n         col=\"blue\", \n         cex.lab=0.7, \n         cex.circles=0.005, \n         add=TRUE)\n\n\n\n\n\n\n\n\nuse skater() to compute the spatially constrained cluster.\n\nclust6 &lt;- spdep::skater(edges = shan.mst[,1:2], \n                 data = shan_ict, \n                 method = \"euclidean\", \n                 ncuts = 5)\n\n\nstr(clust6)\n\nList of 8\n $ groups      : num [1:55] 3 3 6 3 3 3 3 3 3 3 ...\n $ edges.groups:List of 6\n  ..$ :List of 3\n  .. ..$ node: num [1:22] 13 48 54 55 45 37 34 16 25 52 ...\n  .. ..$ edge: num [1:21, 1:3] 48 55 54 37 34 16 45 25 13 13 ...\n  .. ..$ ssw : num 3423\n  ..$ :List of 3\n  .. ..$ node: num [1:18] 47 27 53 38 42 15 41 51 43 32 ...\n  .. ..$ edge: num [1:17, 1:3] 53 15 42 38 41 51 15 27 15 43 ...\n  .. ..$ ssw : num 3759\n  ..$ :List of 3\n  .. ..$ node: num [1:11] 2 6 8 1 36 4 10 9 46 5 ...\n  .. ..$ edge: num [1:10, 1:3] 6 1 8 36 4 6 8 10 10 9 ...\n  .. ..$ ssw : num 1458\n  ..$ :List of 3\n  .. ..$ node: num [1:2] 44 20\n  .. ..$ edge: num [1, 1:3] 44 20 95\n  .. ..$ ssw : num 95\n  ..$ :List of 3\n  .. ..$ node: num 23\n  .. ..$ edge: num[0 , 1:3] \n  .. ..$ ssw : num 0\n  ..$ :List of 3\n  .. ..$ node: num 3\n  .. ..$ edge: num[0 , 1:3] \n  .. ..$ ssw : num 0\n $ not.prune   : NULL\n $ candidates  : int [1:6] 1 2 3 4 5 6\n $ ssto        : num 12613\n $ ssw         : num [1:6] 12613 10977 9962 9540 9123 ...\n $ crit        : num [1:2] 1 Inf\n $ vec.crit    : num [1:55] 1 1 1 1 1 1 1 1 1 1 ...\n - attr(*, \"class\")= chr \"skater\"\n\n\n\nccs6 &lt;- clust6$groups\nccs6\n\n [1] 3 3 6 3 3 3 3 3 3 3 2 1 1 1 2 1 1 1 2 4 1 2 5 1 1 1 2 1 2 2 1 2 2 1 1 3 1 2\n[39] 2 2 2 2 2 4 1 3 2 1 1 1 2 1 2 1 1\n\n\n\ntable(ccs6)\n\nccs6\n 1  2  3  4  5  6 \n22 18 11  2  1  1 \n\n\n\nplot(st_geometry(shan_sf), \n     border=gray(.5))\nplot(clust6, \n     coords, \n     cex.lab=.7,\n     groups.colors=c(\"red\",\"green\",\"blue\", \"brown\", \"pink\"),\n     cex.circles=0.005, \n     add=TRUE)\n\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\n\n\n\n\n\n\n\n\n\nVisualizing the cluster in choropleth map.\n\ngroups_mat &lt;- as.matrix(clust6$groups)\nshan_sf_spatialcluster &lt;- cbind(shan_sf_cluster, as.factor(groups_mat)) %&gt;%\n  rename(`SP_CLUSTER`=`as.factor.groups_mat.`)\nqtm(shan_sf_spatialcluster, \"SP_CLUSTER\")\n\n\n\n\n\n\n\n\n\nhclust.map &lt;- qtm(shan_sf_cluster,\n                  \"CLUSTER\") + \n  tm_borders(alpha = 0.5) \n\nshclust.map &lt;- qtm(shan_sf_spatialcluster,\n                   \"SP_CLUSTER\") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(hclust.map, shclust.map,\n             asp=NA, ncol=2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n\n\n\n\nTo perform\n\nNon-spatially constrained hierarchical cluster analysis\nSpatially constrained cluster analysis\n\n\n\nUse hclustgeo(), just need to provide the function a dissimilarity matrix proxmat, which must be the class dist\n\nnongeo_cluster &lt;- hclustgeo(proxmat)\nplot(nongeo_cluster, cex = 0.5)\nrect.hclust(nongeo_cluster, \n            k = 6, \n            border = 2:5)\n\n\n\n\n\n\n\n\n\ngroups &lt;- as.factor(cutree(nongeo_cluster, k=6))\n\n\nshan_sf_ngeo_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\n\n\nqtm(shan_sf_ngeo_cluster, \"CLUSTER\")\n\n\n\n\n\n\n\n\n\n\n\nUsing st_distance() of sf package to derive a spatial distance\n\ndist &lt;- st_distance(shan_sf, shan_sf)\ndistmat &lt;- as.dist(dist)\n\nUsing choicealpha() to determine a suitable value for mixing parameter alpha\n\ncr &lt;- choicealpha(proxmat, distmat, range.alpha = seq(0, 1, 0.1), K=6, graph = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclustG &lt;- hclustgeo(proxmat, distmat, alpha = 0.3)\n\n\ngroups &lt;- as.factor(cutree(clustG, k=6))\n\n\nshan_sf_Gcluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\n\n\nqtm(shan_sf_Gcluster, \"CLUSTER\")\n\n\n\n\n\n\n\n\n\n\n\nReveal the distribution of a clustering variable (RADIO_PR) by cluster Cluster 3 has the highest mean Radio Ownership Per Thousand Household.\n\nggplot(data = shan_sf_ngeo_cluster,\n       aes(x = CLUSTER, y = RADIO_PR)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\nUse parallel coordinate plot can be used to reveal clustering variables by cluster very effectively.\nCluster 4 townships tend to own the highest number of TV and mobile phone.\nCluster 5 tends to own the lowest of all the five ICT\nscale of ggparcoord, no one best scaling method to use. You should explore\n\nggparcoord(data = shan_sf_ngeo_cluster, \n           columns = c(17:21), \n           scale = \"globalminmax\",\n           alphaLines = 0.2,\n           boxplot = TRUE, \n           title = \"Multiple Parallel Coordinates Plots of ICT Variables by Cluster\") +\n  facet_grid(~ CLUSTER) + \n  theme(axis.text.x = element_text(angle = 30))\n\n\n\n\n\n\n\n\nUse group_by() and summarize() of dplyr are used to derive mean values of the clustering variables.\n\nshan_sf_ngeo_cluster %&gt;% \n  st_set_geometry(NULL) %&gt;%\n  group_by(CLUSTER) %&gt;%\n  summarise(mean_RADIO_PR = mean(RADIO_PR),\n            mean_TV_PR = mean(TV_PR),\n            mean_LLPHONE_PR = mean(LLPHONE_PR),\n            mean_MPHONE_PR = mean(MPHONE_PR),\n            mean_COMPUTER_PR = mean(COMPUTER_PR))\n\n# A tibble: 6 × 6\n  CLUSTER mean_RADIO_PR mean_TV_PR mean_LLPHONE_PR mean_MPHONE_PR\n  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1 1               221.        521.            44.2           246.\n2 2               237.        402.            23.9           134.\n3 3               300.        611.            52.2           392.\n4 4               196.        744.            99.0           651.\n5 5               124.        224.            38.0           132.\n6 6                98.6       499.            74.5           468.\n# ℹ 1 more variable: mean_COMPUTER_PR &lt;dbl&gt;"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#getting-started",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#getting-started",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "Homogeneuous regions refer to areas that are similar in certain characteristics. The purpose of this exercise is to group or segment Shan State into areas where people have similar levels of access to different forms of communication and technology.\n\n\n\n\npacman::p_load(spdep, tmap, sf, ClustGeo, \n               ggpubr, cluster, factoextra, NbClust,\n               heatmaply, corrplot, psych, tidyverse, GGally)\n\nMyanmar Township Boundary Data\n\nshan_sf &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/geospatial\", \n                   layer = \"myanmar_township_boundaries\") %&gt;%\n  filter(ST %in% c(\"Shan (East)\", \"Shan (North)\", \"Shan (South)\")) %&gt;%\n  select(c(2:7))\n\nReading layer `myanmar_township_boundaries' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex06\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 330 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554\nGeodetic CRS:  WGS 84\n\n\n\nshan_sf\n\nSimple feature collection with 55 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 96.15107 ymin: 19.29932 xmax: 101.1699 ymax: 24.15907\nGeodetic CRS:  WGS 84\nFirst 10 features:\n             ST ST_PCODE       DT   DT_PCODE        TS  TS_PCODE\n1  Shan (North)   MMR015  Mongmit MMR015D008   Mongmit MMR015017\n2  Shan (South)   MMR014 Taunggyi MMR014D001   Pindaya MMR014006\n3  Shan (South)   MMR014 Taunggyi MMR014D001   Ywangan MMR014007\n4  Shan (South)   MMR014 Taunggyi MMR014D001  Pinlaung MMR014009\n5  Shan (North)   MMR015  Mongmit MMR015D008    Mabein MMR015018\n6  Shan (South)   MMR014 Taunggyi MMR014D001     Kalaw MMR014005\n7  Shan (South)   MMR014 Taunggyi MMR014D001     Pekon MMR014010\n8  Shan (South)   MMR014 Taunggyi MMR014D001  Lawksawk MMR014008\n9  Shan (North)   MMR015  Kyaukme MMR015D003 Nawnghkio MMR015013\n10 Shan (North)   MMR015  Kyaukme MMR015D003   Kyaukme MMR015012\n                         geometry\n1  MULTIPOLYGON (((96.96001 23...\n2  MULTIPOLYGON (((96.7731 21....\n3  MULTIPOLYGON (((96.78483 21...\n4  MULTIPOLYGON (((96.49518 20...\n5  MULTIPOLYGON (((96.66306 24...\n6  MULTIPOLYGON (((96.49518 20...\n7  MULTIPOLYGON (((97.14738 19...\n8  MULTIPOLYGON (((96.94981 22...\n9  MULTIPOLYGON (((96.75648 22...\n10 MULTIPOLYGON (((96.95498 22...\n\n\n\nglimpse(shan_sf)\n\nRows: 55\nColumns: 7\n$ ST       &lt;chr&gt; \"Shan (North)\", \"Shan (South)\", \"Shan (South)\", \"Shan (South)…\n$ ST_PCODE &lt;chr&gt; \"MMR015\", \"MMR014\", \"MMR014\", \"MMR014\", \"MMR015\", \"MMR014\", \"…\n$ DT       &lt;chr&gt; \"Mongmit\", \"Taunggyi\", \"Taunggyi\", \"Taunggyi\", \"Mongmit\", \"Ta…\n$ DT_PCODE &lt;chr&gt; \"MMR015D008\", \"MMR014D001\", \"MMR014D001\", \"MMR014D001\", \"MMR0…\n$ TS       &lt;chr&gt; \"Mongmit\", \"Pindaya\", \"Ywangan\", \"Pinlaung\", \"Mabein\", \"Kalaw…\n$ TS_PCODE &lt;chr&gt; \"MMR015017\", \"MMR014006\", \"MMR014007\", \"MMR014009\", \"MMR01501…\n$ geometry &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((96.96001 23..., MULTIPOLYGON (((…\n\n\nShan-ICT.csv\n\nict &lt;- read_csv (\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/aspatial/Shan-ICT.csv\")\n\nRows: 55 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): District Pcode, District Name, Township Pcode, Township Name\ndbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nsummary(ict)\n\n District Pcode     District Name      Township Pcode     Township Name     \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n Total households     Radio         Television    Land line phone \n Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685    Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  \n  Mobile phone      Computer      Internet at home\n Min.   :  150   Min.   :  20.0   Min.   :   8.0  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  \n Median : 3559   Median : 244.0   Median : 316.0  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0  \n\n\nThere are total of 11 fields and 55 observations in the tibble data.frame\n\n\n\nWhy? townships with relatively higher total number of households will also have higher number of households owning radio, TV, etc.\n\nict_derived &lt;- ict %&gt;%\n  mutate(`RADIO_PR` = `Radio`/`Total households`*1000) %&gt;%\n  mutate(`TV_PR` = `Television`/`Total households`*1000) %&gt;%\n  mutate(`LLPHONE_PR` = `Land line phone`/`Total households`*1000) %&gt;%\n  mutate(`MPHONE_PR` = `Mobile phone`/`Total households`*1000) %&gt;%\n  mutate(`COMPUTER_PR` = `Computer`/`Total households`*1000) %&gt;%\n  mutate(`INTERNET_PR` = `Internet at home`/`Total households`*1000) %&gt;%\n  rename(`DT_PCODE` =`District Pcode`,`DT`=`District Name`,\n         `TS_PCODE`=`Township Pcode`, `TS`=`Township Name`,\n         `TT_HOUSEHOLDS`=`Total households`,\n         `RADIO`=`Radio`, `TV`=`Television`, \n         `LLPHONE`=`Land line phone`, `MPHONE`=`Mobile phone`,\n         `COMPUTER`=`Computer`, `INTERNET`=`Internet at home`) \n\n\nsummary(ict_derived)\n\n   DT_PCODE              DT              TS_PCODE              TS           \n Length:55          Length:55          Length:55          Length:55         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n TT_HOUSEHOLDS       RADIO             TV           LLPHONE      \n Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  \n 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  \n Median :13685   Median : 2497   Median : 6117   Median : 695.0  \n Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  \n 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  \n Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  \n     MPHONE         COMPUTER         INTERNET         RADIO_PR     \n Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 21.05  \n 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:138.95  \n Median : 3559   Median : 244.0   Median : 316.0   Median :210.95  \n Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :215.68  \n 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:268.07  \n Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :484.52  \n     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    \n Min.   :116.0   Min.   :  2.78   Min.   : 36.42   Min.   : 3.278  \n 1st Qu.:450.2   1st Qu.: 22.84   1st Qu.:190.14   1st Qu.:11.832  \n Median :517.2   Median : 37.59   Median :305.27   Median :18.970  \n Mean   :509.5   Mean   : 51.09   Mean   :314.05   Mean   :24.393  \n 3rd Qu.:606.4   3rd Qu.: 69.72   3rd Qu.:428.43   3rd Qu.:29.897  \n Max.   :842.5   Max.   :181.49   Max.   :735.43   Max.   :92.402  \n  INTERNET_PR     \n Min.   :  1.041  \n 1st Qu.:  8.617  \n Median : 22.829  \n Mean   : 30.644  \n 3rd Qu.: 41.281  \n Max.   :117.985  \n\n\nThere are total of 17 fields and 55 observations in the tibble data.frame"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#exploratory-data-analysis-eda",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#exploratory-data-analysis-eda",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "ggplot(data=ict_derived, \n       aes(x=`RADIO`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\n\n\n\n\n\n\n\n\n\nuse to detect outliers\n\nggplot(data=ict_derived, \n       aes(x=`RADIO`)) +\n  geom_boxplot(color=\"black\", \n               fill=\"light blue\")\n\n\n\n\n\n\n\n\nRadio Penetration rate\n\nggplot(data=ict_derived, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\n\n\n\n\n\n\n\nggplot(data=ict_derived, \n       aes(x=`RADIO_PR`)) +\n  geom_boxplot(color=\"black\", \n               fill=\"light blue\")\n\n\n\n\n\n\n\n\n\n\n\n\nradio &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ntv &lt;- ggplot(data=ict_derived, \n             aes(x= `TV_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\nllphone &lt;- ggplot(data=ict_derived, \n             aes(x= `LLPHONE_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\nmphone &lt;- ggplot(data=ict_derived, \n             aes(x= `MPHONE_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ncomputer &lt;- ggplot(data=ict_derived, \n             aes(x= `COMPUTER_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\ninternet &lt;- ggplot(data=ict_derived, \n             aes(x= `INTERNET_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\")\n\n\nggarrange(radio, tv, llphone, mphone, computer, internet, \n          ncol = 3, \n          nrow = 2)\n\n\n\n\n\n\n\n\n\n\n\nNeed to combine both the geospatial shan_sf & aspatial data ict_derived Unique identifier to join both = TS_PCODE\n\nshan_sf &lt;- left_join(shan_sf, \n                     ict_derived, by=c(\"TS_PCODE\"=\"TS_PCODE\"))\n  \nwrite_rds(shan_sf, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/rds/shan_sf.rds\")\n\n\nshan_sf &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex06/data/rds/shan_sf.rds\")\n\n\nqtm(shan_sf, \"RADIO_PR\")\n\n\n\n\n\n\n\n\nTo reveal the distribution shown in the choropleth map above are bias to the underlying total number of households at the townships.\n\nTT_HOUSEHOLDS.map &lt;- tm_shape(shan_sf) + \n  tm_fill(col = \"TT_HOUSEHOLDS\",\n          n = 5,\n          style = \"jenks\", \n          title = \"Total households\") + \n  tm_borders(alpha = 0.5) \n\nRADIO.map &lt;- tm_shape(shan_sf) + \n  tm_fill(col = \"RADIO\",\n          n = 5,\n          style = \"jenks\",\n          title = \"Number Radio \") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(TT_HOUSEHOLDS.map, RADIO.map,\n             asp=NA, ncol=2)\n\n\n\n\n\n\n\n\nTownships with relatively larger number of households are showing relatively higher number of radio ownership\n\ntm_shape(shan_sf) +\n    tm_polygons(c(\"TT_HOUSEHOLDS\", \"RADIO_PR\"),\n                style=\"jenks\",\n                title = c(\"Total households\",\"Radio Penetration Rate\")) +\n    tm_facets(sync = TRUE, ncol = 2) +\n  tm_legend(legend.position = c(\"right\", \"bottom\"))+\n  tm_layout(outer.margins=0, asp=0)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#correlation-analysis",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#correlation-analysis",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "Ensure the cluster variables are not highly correlated before we perform cluster analysis\n\ncluster_vars.cor = cor(ict_derived[,12:17])\ncorrplot.mixed(cluster_vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n\n\n\n\n\n\n\n\nCOMPUTER_PR and INTERNET_PR are highly correlated. Only use one of them"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#hierarchy-cluster-analysis",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#hierarchy-cluster-analysis",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "Extract clustering variables from the shan_sf simple feature object into data.frame\n\ncluster_vars &lt;- shan_sf %&gt;%\n  st_set_geometry(NULL) %&gt;%\n  select(\"TS.x\", \"RADIO_PR\", \"TV_PR\", \"LLPHONE_PR\", \"MPHONE_PR\", \"COMPUTER_PR\")\nhead(cluster_vars,10)\n\n        TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\n1    Mongmit 286.1852 554.1313   35.30618  260.6944    12.15939\n2    Pindaya 417.4647 505.1300   19.83584  162.3917    12.88190\n3    Ywangan 484.5215 260.5734   11.93591  120.2856     4.41465\n4   Pinlaung 231.6499 541.7189   28.54454  249.4903    13.76255\n5     Mabein 449.4903 708.6423   72.75255  392.6089    16.45042\n6      Kalaw 280.7624 611.6204   42.06478  408.7951    29.63160\n7      Pekon 318.6118 535.8494   39.83270  214.8476    18.97032\n8   Lawksawk 387.1017 630.0035   31.51366  320.5686    21.76677\n9  Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465\n10   Kyaukme 210.9548 601.1773   39.58267  372.4930    30.94709\n\n\nINTERNET_PR is not included because it is highly correlated with variable COMPUTER_PR\nChange the rows by township name instead of row number\n\nrow.names(cluster_vars) &lt;- cluster_vars$\"TS.x\"\nhead(cluster_vars,10)\n\n               TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\nMongmit     Mongmit 286.1852 554.1313   35.30618  260.6944    12.15939\nPindaya     Pindaya 417.4647 505.1300   19.83584  162.3917    12.88190\nYwangan     Ywangan 484.5215 260.5734   11.93591  120.2856     4.41465\nPinlaung   Pinlaung 231.6499 541.7189   28.54454  249.4903    13.76255\nMabein       Mabein 449.4903 708.6423   72.75255  392.6089    16.45042\nKalaw         Kalaw 280.7624 611.6204   42.06478  408.7951    29.63160\nPekon         Pekon 318.6118 535.8494   39.83270  214.8476    18.97032\nLawksawk   Lawksawk 387.1017 630.0035   31.51366  320.5686    21.76677\nNawnghkio Nawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465\nKyaukme     Kyaukme 210.9548 601.1773   39.58267  372.4930    30.94709\n\n\nDelete the TS.x field\n\nshan_ict &lt;- select(cluster_vars, c(2:6))\nhead(shan_ict, 10)\n\n          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR\nMongmit   286.1852 554.1313   35.30618  260.6944    12.15939\nPindaya   417.4647 505.1300   19.83584  162.3917    12.88190\nYwangan   484.5215 260.5734   11.93591  120.2856     4.41465\nPinlaung  231.6499 541.7189   28.54454  249.4903    13.76255\nMabein    449.4903 708.6423   72.75255  392.6089    16.45042\nKalaw     280.7624 611.6204   42.06478  408.7951    29.63160\nPekon     318.6118 535.8494   39.83270  214.8476    18.97032\nLawksawk  387.1017 630.0035   31.51366  320.5686    21.76677\nNawnghkio 349.3359 547.9456   38.44960  323.0201    15.76465\nKyaukme   210.9548 601.1773   39.58267  372.4930    30.94709\n\n\nStandardize the data, it is not unusual the variables values range are different.\nMin-max method\n\nshan_ict.std &lt;- normalize(shan_ict)\nsummary(shan_ict.std)\n\n    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.2544   1st Qu.:0.4600   1st Qu.:0.1123   1st Qu.:0.2199  \n Median :0.4097   Median :0.5523   Median :0.1948   Median :0.3846  \n Mean   :0.4199   Mean   :0.5416   Mean   :0.2703   Mean   :0.3972  \n 3rd Qu.:0.5330   3rd Qu.:0.6750   3rd Qu.:0.3746   3rd Qu.:0.5608  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n  COMPUTER_PR     \n Min.   :0.00000  \n 1st Qu.:0.09598  \n Median :0.17607  \n Mean   :0.23692  \n 3rd Qu.:0.29868  \n Max.   :1.00000  \n\n\nZ-scores method\n\nshan_ict.z &lt;- scale(shan_ict)\ndescribe(shan_ict.z)\n\n            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis\nRADIO_PR       1 55    0  1  -0.04   -0.06 0.94 -1.85 2.55  4.40  0.48    -0.27\nTV_PR          2 55    0  1   0.05    0.04 0.78 -2.47 2.09  4.56 -0.38    -0.23\nLLPHONE_PR     3 55    0  1  -0.33   -0.15 0.68 -1.19 3.20  4.39  1.37     1.49\nMPHONE_PR      4 55    0  1  -0.05   -0.06 1.01 -1.58 2.40  3.98  0.48    -0.34\nCOMPUTER_PR    5 55    0  1  -0.26   -0.18 0.64 -1.03 3.31  4.34  1.80     2.96\n              se\nRADIO_PR    0.13\nTV_PR       0.13\nLLPHONE_PR  0.13\nMPHONE_PR   0.13\nCOMPUTER_PR 0.13\n\n\n\n\n\n\n\n\nWarning\n\n\n\nWarning: Z-score standardisation method should only be used if we would assume all variables come from some normal distribution.\n\n\nVisualizing the standardized clustering variables\n\nr &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Raw values without standardisation\")\n\nshan_ict_s_df &lt;- as.data.frame(shan_ict.std)\ns &lt;- ggplot(data=shan_ict_s_df, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Min-Max Standardisation\")\n\nshan_ict_z_df &lt;- as.data.frame(shan_ict.z)\nz &lt;- ggplot(data=shan_ict_z_df, \n       aes(x=`RADIO_PR`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  ggtitle(\"Z-score Standardisation\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n\n\n\n\n\n\n\n\nWhat statistical conclusion can you draw from the histograms above?\nIn summary, the variable RADIO_PR is right-skewed in all three cases. Standardization (either Min-Max or Z-score) does not affect the distribution’s skewness but makes the values more comparable by rescaling them to a uniform range or to units of standard deviation.\n\nr &lt;- ggplot(data=ict_derived, \n             aes(x= `RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"light blue\") +\n  ggtitle(\"Raw values without standardisation\")\n\nshan_ict_s_df &lt;- as.data.frame(shan_ict.std)\ns &lt;- ggplot(data=shan_ict_s_df, \n       aes(x=`RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"light blue\") +\n  ggtitle(\"Min-Max Standardisation\")\n\nshan_ict_z_df &lt;- as.data.frame(shan_ict.z)\nz &lt;- ggplot(data=shan_ict_z_df, \n       aes(x=`RADIO_PR`)) +\n  geom_density(color=\"black\",\n               fill=\"light blue\") +\n  ggtitle(\"Z-score Standardisation\")\n\nggarrange(r, s, z,\n          ncol = 3,\n          nrow = 1)\n\n\n\n\n\n\n\n\n\n\n\nCompute the proximity matrix by using dist() of R.\nIt supports: euclidean, maximum, manhattan, canberra, binary and minkowski\nWhy? To group similar observations together based on their proximity.\n\nproxmat &lt;- dist(shan_ict, method = 'euclidean')\n\n\nproxmat\n\n             Mongmit   Pindaya   Ywangan  Pinlaung    Mabein     Kalaw\nPindaya    171.86828                                                  \nYwangan    381.88259 257.31610                                        \nPinlaung    57.46286 208.63519 400.05492                              \nMabein     263.37099 313.45776 529.14689 312.66966                    \nKalaw      160.05997 302.51785 499.53297 181.96406 198.14085          \nPekon       59.61977 117.91580 336.50410  94.61225 282.26877 211.91531\nLawksawk   140.11550 204.32952 432.16535 192.57320 130.36525 140.01101\nNawnghkio   89.07103 180.64047 377.87702 139.27495 204.63154 127.74787\nKyaukme    144.02475 311.01487 505.89191 139.67966 264.88283  79.42225\nMuse       563.01629 704.11252 899.44137 571.58335 453.27410 412.46033\nLaihka     141.87227 298.61288 491.83321 101.10150 345.00222 197.34633\nMongnai    115.86190 258.49346 422.71934  64.52387 358.86053 200.34668\nMawkmai    434.92968 437.99577 397.03752 398.11227 693.24602 562.59200\nKutkai      97.61092 212.81775 360.11861  78.07733 340.55064 204.93018\nMongton    192.67961 283.35574 361.23257 163.42143 425.16902 267.87522\nMongyai    256.72744 287.41816 333.12853 220.56339 516.40426 386.74701\nMongkaing  503.61965 481.71125 364.98429 476.29056 747.17454 625.24500\nLashio     251.29457 398.98167 602.17475 262.51735 231.28227 106.69059\nMongpan    193.32063 335.72896 483.68125 192.78316 301.52942 114.69105\nMatman     401.25041 354.39039 255.22031 382.40610 637.53975 537.63884\nTachileik  529.63213 635.51774 807.44220 555.01039 365.32538 373.64459\nNarphan    406.15714 474.50209 452.95769 371.26895 630.34312 463.53759\nMongkhet   349.45980 391.74783 408.97731 305.86058 610.30557 465.52013\nHsipaw     118.18050 245.98884 388.63147  76.55260 366.42787 212.36711\nMonghsat   214.20854 314.71506 432.98028 160.44703 470.48135 317.96188\nMongmao    242.54541 402.21719 542.85957 217.58854 384.91867 195.18913\nNansang    104.91839 275.44246 472.77637  85.49572 287.92364 124.30500\nLaukkaing  568.27732 726.85355 908.82520 563.81750 520.67373 427.77791\nPangsang   272.67383 428.24958 556.82263 244.47146 418.54016 224.03998\nNamtu      179.62251 225.40822 444.66868 170.04533 366.16094 307.27427\nMonghpyak  177.76325 221.30579 367.44835 222.20020 212.69450 167.08436\nKonkyan    403.39082 500.86933 528.12533 365.44693 613.51206 444.75859\nMongping   265.12574 310.64850 337.94020 229.75261 518.16310 375.64739\nHopong     136.93111 223.06050 352.85844  98.14855 398.00917 264.16294\nNyaungshwe  99.38590 216.52463 407.11649 138.12050 210.21337  95.66782\nHsihseng   131.49728 172.00796 342.91035 111.61846 381.20187 287.11074\nMongla     384.30076 549.42389 728.16301 372.59678 406.09124 260.26411\nHseni      189.37188 337.98982 534.44679 204.47572 213.61240  38.52842\nKunlong    224.12169 355.47066 531.63089 194.76257 396.61508 273.01375\nHopang     281.05362 443.26362 596.19312 265.96924 368.55167 185.14704\nNamhkan    386.02794 543.81859 714.43173 382.78835 379.56035 246.39577\nKengtung   246.45691 385.68322 573.23173 263.48638 219.47071  88.29335\nLangkho    164.26299 323.28133 507.78892 168.44228 253.84371  67.19580\nMonghsu    109.15790 198.35391 340.42789  80.86834 367.19820 237.34578\nTaunggyi   399.84278 503.75471 697.98323 429.54386 226.24011 252.26066\nPangwaun   381.51246 512.13162 580.13146 356.37963 523.44632 338.35194\nKyethi     202.92551 175.54012 287.29358 189.47065 442.07679 360.17247\nLoilen     145.48666 293.61143 469.51621  91.56527 375.06406 217.19877\nManton     430.64070 402.42888 306.16379 405.83081 674.01120 560.16577\nMongyang   309.51302 475.93982 630.71590 286.03834 411.88352 233.56349\nKunhing    173.50424 318.23811 449.67218 141.58836 375.82140 197.63683\nMongyawng  214.21738 332.92193 570.56521 235.55497 193.49994 173.43078\nTangyan    195.92520 208.43740 324.77002 169.50567 448.59948 348.06617\nNamhsan    237.78494 228.41073 286.16305 214.33352 488.33873 385.88676\n               Pekon  Lawksawk Nawnghkio   Kyaukme      Muse    Laihka\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk   157.51129                                                  \nNawnghkio  113.15370  90.82891                                        \nKyaukme    202.12206 186.29066 157.04230                              \nMuse       614.56144 510.13288 533.68806 434.75768                    \nLaihka     182.23667 246.74469 211.88187 128.24979 526.65211          \nMongnai    151.60031 241.71260 182.21245 142.45669 571.97975 100.53457\nMawkmai    416.00669 567.52693 495.15047 512.02846 926.93007 429.96554\nKutkai     114.98048 224.64646 147.44053 170.93318 592.90743 144.67198\nMongton    208.14888 311.07742 225.81118 229.28509 634.71074 212.07320\nMongyai    242.52301 391.26989 319.57938 339.27780 763.91399 264.13364\nMongkaing  480.23965 625.18712 546.69447 586.05094 995.66496 522.96309\nLashio     303.80011 220.75270 230.55346 129.95255 313.15288 238.64533\nMongpan    243.30037 228.54223 172.84425 110.37831 447.49969 210.76951\nMatman     368.25761 515.39711 444.05061 505.52285 929.11283 443.25453\nTachileik  573.39528 441.82621 470.45533 429.15493 221.19950 549.08985\nNarphan    416.84901 523.69580 435.59661 420.30003 770.40234 392.32592\nMongkhet   342.08722 487.41102 414.10280 409.03553 816.44931 324.97428\nHsipaw     145.37542 249.35081 176.09570 163.95741 591.03355 128.42987\nMonghsat   225.64279 352.31496 289.83220 253.25370 663.76026 158.93517\nMongmao    293.70625 314.64777 257.76465 146.09228 451.82530 185.99082\nNansang    160.37607 188.78869 151.13185  60.32773 489.35308  78.78999\nLaukkaing  624.82399 548.83928 552.65554 428.74978 149.26996 507.39700\nPangsang   321.81214 345.91486 287.10769 175.35273 460.24292 214.19291\nNamtu      165.02707 260.95300 257.52713 270.87277 659.16927 185.86794\nMonghpyak  190.93173 142.31691  93.03711 217.64419 539.43485 293.22640\nKonkyan    421.48797 520.31264 439.34272 393.79911 704.86973 351.75354\nMongping   259.68288 396.47081 316.14719 330.28984 744.44948 272.82761\nHopong     138.86577 274.91604 204.88286 218.84211 648.68011 157.48857\nNyaungshwe 139.31874 104.17830  43.26545 126.50414 505.88581 201.71653\nHsihseng   105.30573 257.11202 209.88026 250.27059 677.66886 175.89761\nMongla     441.20998 393.18472 381.40808 241.58966 256.80556 315.93218\nHseni      243.98001 171.50398 164.05304  81.20593 381.30567 204.49010\nKunlong    249.36301 318.30406 285.04608 215.63037 547.24297 122.68682\nHopang     336.38582 321.16462 279.84188 154.91633 377.44407 230.78652\nNamhkan    442.77120 379.41126 367.33575 247.81990 238.67060 342.43665\nKengtung   297.67761 209.38215 208.29647 136.23356 330.08211 258.23950\nLangkho    219.21623 190.30257 156.51662  51.67279 413.64173 160.94435\nMonghsu    113.84636 242.04063 170.09168 200.77712 633.21624 163.28926\nTaunggyi   440.66133 304.96838 344.79200 312.60547 250.81471 425.36916\nPangwaun   423.81347 453.02765 381.67478 308.31407 541.97887 351.78203\nKyethi     162.43575 317.74604 267.21607 328.14177 757.16745 255.83275\nLoilen     181.94596 265.29318 219.26405 146.92675 560.43400  59.69478\nManton     403.82131 551.13000 475.77296 522.86003 941.49778 458.30232\nMongyang   363.58788 363.37684 323.32123 188.59489 389.59919 229.71502\nKunhing    213.46379 278.68953 206.15773 145.00266 533.00162 142.03682\nMongyawng  248.43910 179.07229 220.61209 181.55295 422.37358 211.99976\nTangyan    167.79937 323.14701 269.07880 306.78359 736.93741 224.29176\nNamhsan    207.16559 362.84062 299.74967 347.85944 778.52971 273.79672\n             Mongnai   Mawkmai    Kutkai   Mongton   Mongyai Mongkaing\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai    374.50873                                                  \nKutkai      91.15307 364.95519                                        \nMongton    131.67061 313.35220 107.06341                              \nMongyai    203.23607 178.70499 188.94166 159.79790                    \nMongkaing  456.00842 133.29995 428.96133 365.50032 262.84016          \nLashio     270.86983 638.60773 289.82513 347.11584 466.36472 708.65819\nMongpan    178.09554 509.99632 185.18173 200.31803 346.39710 563.56780\nMatman     376.33870 147.83545 340.86349 303.04574 186.95158 135.51424\nTachileik  563.95232 919.38755 568.99109 608.76740 750.29555 967.14087\nNarphan    329.31700 273.75350 314.27683 215.97925 248.82845 285.65085\nMongkhet   275.76855 115.58388 273.91673 223.22828 104.98924 222.60577\nHsipaw      52.68195 351.34601  51.46282  90.69766 177.33790 423.77868\nMonghsat   125.25968 275.09705 154.32012 150.98053 127.35225 375.60376\nMongmao    188.29603 485.52853 204.69232 206.57001 335.61300 552.31959\nNansang     92.79567 462.41938 130.04549 199.58124 288.55962 542.16609\nLaukkaing  551.56800 882.51110 580.38112 604.66190 732.68347 954.11795\nPangsang   204.25746 484.14757 228.33583 210.77938 343.30638 548.40662\nNamtu      209.35473 427.95451 225.28268 308.71751 278.02761 525.04057\nMonghpyak  253.26470 536.71695 206.61627 258.04282 370.01575 568.21089\nKonkyan    328.82831 339.01411 310.60810 248.25265 287.87384 380.92091\nMongping   202.99615 194.31049 182.75266 119.86993  65.38727 257.18572\nHopong      91.53795 302.84362  73.45899 106.21031 124.62791 379.37916\nNyaungshwe 169.63695 502.99026 152.15482 219.72196 327.13541 557.32112\nHsihseng   142.36728 329.29477 128.21054 194.64317 162.27126 411.59788\nMongla     354.10985 686.88950 388.40984 411.06668 535.28615 761.48327\nHseni      216.81639 582.53670 229.37894 286.75945 408.23212 648.04408\nKunlong    202.92529 446.53763 204.54010 270.02165 299.36066 539.91284\nHopang     243.00945 561.24281 263.31986 273.50305 408.73288 626.17673\nNamhkan    370.05669 706.47792 392.48568 414.53594 550.62819 771.39688\nKengtung   272.28711 632.54638 279.19573 329.38387 460.39706 692.74693\nLangkho    174.67678 531.08019 180.51419 236.70878 358.95672 597.42714\nMonghsu     84.11238 332.07962  62.60859 107.04894 154.86049 400.71816\nTaunggyi   448.55282 810.74692 450.33382 508.40925 635.94105 866.21117\nPangwaun   312.13429 500.68857 321.80465 257.50434 394.07696 536.95736\nKyethi     210.50453 278.85535 184.23422 222.52947 137.79420 352.06533\nLoilen      58.41263 388.73386 131.56529 176.16001 224.79239 482.18190\nManton     391.54062 109.08779 361.82684 310.20581 195.59882  81.75337\nMongyang   260.39387 558.83162 285.33223 295.60023 414.31237 631.91325\nKunhing    110.55197 398.43973 108.84990 114.03609 238.99570 465.03971\nMongyawng  275.77546 620.04321 281.03383 375.22688 445.78964 700.98284\nTangyan    180.37471 262.66006 166.61820 198.88460 109.08506 348.56123\nNamhsan    218.10003 215.19289 191.32762 196.76188  77.35900 288.66231\n              Lashio   Mongpan    Matman Tachileik   Narphan  Mongkhet\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan    172.33279                                                  \nMatman     628.11049 494.81014                                        \nTachileik  311.95286 411.03849 890.12935                              \nNarphan    525.63854 371.13393 312.05193 760.29566                    \nMongkhet   534.44463 412.17123 203.02855 820.50164 217.28718          \nHsipaw     290.86435 179.52054 344.45451 576.18780 295.40170 253.80950\nMonghsat   377.86793 283.30992 313.59911 677.09508 278.21548 167.98445\nMongmao    214.23677 131.59966 501.59903 472.95568 331.42618 375.35820\nNansang    184.47950 144.77393 458.06573 486.77266 398.13308 360.99219\nLaukkaing  334.65738 435.58047 903.72094 325.06329 708.82887 769.06406\nPangsang   236.72516 140.23910 506.29940 481.31907 316.30314 375.58139\nNamtu      365.88437 352.91394 416.65397 659.56458 494.36143 355.99713\nMonghpyak  262.09281 187.85699 470.46845 444.04411 448.40651 462.63265\nKonkyan    485.51312 365.87588 392.40306 730.92980 158.82353 254.24424\nMongping   454.52548 318.47482 201.65224 727.08969 188.64567 113.80917\nHopong     345.31042 239.43845 291.84351 632.45718 294.40441 212.99485\nNyaungshwe 201.58191 137.29734 460.91883 445.81335 427.94086 417.08639\nHsihseng   369.00833 295.87811 304.02806 658.87060 377.52977 256.70338\nMongla     179.95877 253.20001 708.17595 347.33155 531.46949 574.40292\nHseni       79.41836 120.66550 564.64051 354.90063 474.12297 481.88406\nKunlong    295.23103 288.03320 468.27436 595.70536 413.07823 341.68641\nHopang     170.63913 135.62913 573.55355 403.82035 397.85908 451.51070\nNamhkan    173.27153 240.34131 715.42102 295.91660 536.85519 596.19944\nKengtung    59.85893 142.21554 613.01033 295.90429 505.40025 531.35998\nLangkho    115.18145  94.98486 518.86151 402.33622 420.65204 428.08061\nMonghsu    325.71557 216.25326 308.13805 605.02113 311.92379 247.73318\nTaunggyi   195.14541 319.81385 778.45810 150.84117 684.20905 712.80752\nPangwaun   362.45608 232.52209 523.43600 540.60474 264.64997 407.02947\nKyethi     447.10266 358.89620 233.83079 728.87329 374.90376 233.25039\nLoilen     268.92310 207.25000 406.56282 573.75476 354.79137 284.76895\nManton     646.66493 507.96808  59.52318 910.23039 280.26395 181.33894\nMongyang   209.33700 194.93467 585.61776 448.79027 401.39475 445.40621\nKunhing    255.10832 137.85278 403.66587 532.26397 281.62645 292.49814\nMongyawng  172.70139 275.15989 601.80824 432.10118 572.76394 522.91815\nTangyan    429.84475 340.39128 242.78233 719.84066 348.84991 201.49393\nNamhsan    472.04024 364.77086 180.09747 754.03913 316.54695 170.90848\n              Hsipaw  Monghsat   Mongmao   Nansang Laukkaing  Pangsang\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat   121.78922                                                  \nMongmao    185.99483 247.17708                                        \nNansang    120.24428 201.92690 164.99494                              \nLaukkaing  569.06099 626.44910 404.00848 480.60074                    \nPangsang   205.04337 256.37933  57.60801 193.36162 408.04016          \nNamtu      229.44658 231.78673 365.03882 217.61884 664.06286 392.97391\nMonghpyak  237.67919 356.84917 291.88846 227.52638 565.84279 315.11651\nKonkyan    296.74316 268.25060 281.87425 374.70456 635.92043 274.81900\nMongping   168.92101 140.95392 305.57166 287.36626 708.13447 308.33123\nHopong      62.86179 100.45714 244.16253 167.66291 628.48557 261.51075\nNyaungshwe 169.92664 286.37238 230.45003 131.18943 520.24345 257.77823\nHsihseng   136.54610 153.49551 311.98001 193.53779 670.74564 335.52974\nMongla     373.47509 429.00536 216.24705 289.45119 202.55831 217.88123\nHseni      231.48538 331.22632 184.67099 136.45492 391.74585 214.66375\nKunlong    205.10051 202.31862 224.43391 183.01388 521.88657 258.49342\nHopang     248.72536 317.64824  78.29342 196.47091 331.67199  92.57672\nNamhkan    382.79302 455.10875 223.32205 302.89487 196.46063 231.38484\nKengtung   284.08582 383.72138 207.58055 193.67980 351.48520 229.85484\nLangkho    183.05109 279.52329 134.50170  99.39859 410.41270 167.65920\nMonghsu     58.55724 137.24737 242.43599 153.59962 619.01766 260.52971\nTaunggyi   462.31183 562.88102 387.33906 365.04897 345.98041 405.59730\nPangwaun   298.12447 343.53898 187.40057 326.12960 470.63605 157.48757\nKyethi     195.17677 190.50609 377.89657 273.02385 749.99415 396.89963\nLoilen      98.04789 118.65144 190.26490  94.23028 535.57527 207.94433\nManton     359.60008 317.15603 503.79786 476.55544 907.38406 504.75214\nMongyang   267.10497 312.64797  91.06281 218.49285 326.19219 108.37735\nKunhing     90.77517 165.38834 103.91040 128.20940 500.41640 123.18870\nMongyawng  294.70967 364.40429 296.40789 191.11990 454.80044 336.16703\nTangyan    167.69794 144.59626 347.14183 249.70235 722.40954 364.76893\nNamhsan    194.47928 169.56962 371.71448 294.16284 760.45960 385.65526\n               Namtu Monghpyak   Konkyan  Mongping    Hopong Nyaungshwe\nPindaya                                                                \nYwangan                                                                \nPinlaung                                                               \nMabein                                                                 \nKalaw                                                                  \nPekon                                                                  \nLawksawk                                                               \nNawnghkio                                                              \nKyaukme                                                                \nMuse                                                                   \nLaihka                                                                 \nMongnai                                                                \nMawkmai                                                                \nKutkai                                                                 \nMongton                                                                \nMongyai                                                                \nMongkaing                                                              \nLashio                                                                 \nMongpan                                                                \nMatman                                                                 \nTachileik                                                              \nNarphan                                                                \nMongkhet                                                               \nHsipaw                                                                 \nMonghsat                                                               \nMongmao                                                                \nNansang                                                                \nLaukkaing                                                              \nPangsang                                                               \nNamtu                                                                  \nMonghpyak  346.57799                                                   \nKonkyan    478.37690 463.39594                                         \nMongping   321.66441 354.76537 242.02901                               \nHopong     206.82668 267.95563 304.49287 134.00139                     \nNyaungshwe 271.41464 103.97300 432.35040 319.32583 209.32532           \nHsihseng   131.89940 285.37627 383.49700 199.64389  91.65458  225.80242\nMongla     483.49434 408.03397 468.09747 512.61580 432.31105  347.60273\nHseni      327.41448 200.26876 448.84563 395.58453 286.41193  130.86310\nKunlong    233.60474 357.44661 329.11433 309.05385 219.06817  285.13095\nHopang     408.24516 304.26577 348.18522 379.27212 309.77356  247.19891\nNamhkan    506.32466 379.50202 481.59596 523.74815 444.13246  333.32428\nKengtung   385.33554 221.47613 474.82621 442.80821 340.47382  177.75714\nLangkho    305.03473 200.27496 386.95022 343.96455 239.63685  128.26577\nMonghsu    209.64684 232.17823 331.72187 158.90478  43.40665  173.82799\nTaunggyi   518.72748 334.17439 650.56905 621.53039 513.76415  325.09619\nPangwaun   517.03554 381.95144 263.97576 340.37881 346.00673  352.92324\nKyethi     186.90932 328.16234 400.10989 187.43974 136.49038  288.06872\nLoilen     194.24075 296.99681 334.19820 231.99959 124.74445  206.40432\nManton     448.58230 502.20840 366.66876 200.48082 310.58885  488.79874\nMongyang   413.26052 358.17599 329.39338 387.80686 323.35704  294.29500\nKunhing    296.43996 250.74435 253.74202 212.59619 145.15617  189.97131\nMongyawng  262.24331 285.56475 522.38580 455.59190 326.59925  218.12104\nTangyan    178.69483 335.26416 367.46064 161.67411 106.82328  284.14692\nNamhsan    240.95555 352.70492 352.20115 130.23777 132.70541  315.91750\n            Hsihseng    Mongla     Hseni   Kunlong    Hopang   Namhkan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla     478.66210                                                  \nHseni      312.74375 226.82048                                        \nKunlong    231.85967 346.46200 276.19175                              \nHopang     370.01334 147.02444 162.80878 271.34451                    \nNamhkan    492.09476  77.21355 212.11323 375.73885 146.18632          \nKengtung   370.72441 202.45004  66.12817 317.14187 164.29921 175.63015\nLangkho    276.27441 229.01675  66.66133 224.52741 134.24847 224.40029\nMonghsu     97.82470 424.51868 262.28462 239.89665 301.84458 431.32637\nTaunggyi   528.14240 297.09863 238.19389 471.29032 329.95252 257.29147\nPangwaun   433.06326 319.18643 330.70182 392.45403 206.98364 310.44067\nKyethi      84.04049 556.02500 388.33498 298.55859 440.48114 567.86202\nLoilen     158.84853 338.67408 227.10984 166.53599 242.89326 364.90647\nManton     334.87758 712.51416 584.63341 479.76855 577.52046 721.86149\nMongyang   382.59743 146.66661 210.19929 247.22785  69.25859 167.72448\nKunhing    220.15490 306.47566 206.47448 193.77551 172.96164 314.92119\nMongyawng  309.51462 315.57550 173.86004 240.39800 290.51360 321.21112\nTangyan     70.27241 526.80849 373.07575 268.07983 412.22167 542.64078\nNamhsan    125.74240 564.02740 411.96125 310.40560 440.51555 576.42717\n            Kengtung   Langkho   Monghsu  Taunggyi  Pangwaun    Kyethi\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho    107.16213                                                  \nMonghsu    316.91914 221.84918                                        \nTaunggyi   186.28225 288.27478 486.91951                              \nPangwaun   337.48335 295.38434 343.38498 497.61245                    \nKyethi     444.26274 350.91512 146.61572 599.57407 476.62610          \nLoilen     282.22935 184.10672 131.55208 455.91617 331.69981 232.32965\nManton     631.99123 535.95620 330.76503 803.08034 510.79265 272.03299\nMongyang   217.08047 175.35413 323.95988 374.58247 225.25026 453.86726\nKunhing    245.95083 146.38284 146.78891 429.98509 229.09986 278.95182\nMongyawng  203.87199 186.11584 312.85089 287.73864 475.33116 387.71518\nTangyan    429.95076 332.02048 127.42203 592.65262 447.05580  47.79331\nNamhsan    466.20497 368.20978 153.22576 631.49232 448.58030  68.67929\n              Loilen    Manton  Mongyang   Kunhing Mongyawng   Tangyan\nPindaya                                                               \nYwangan                                                               \nPinlaung                                                              \nMabein                                                                \nKalaw                                                                 \nPekon                                                                 \nLawksawk                                                              \nNawnghkio                                                             \nKyaukme                                                               \nMuse                                                                  \nLaihka                                                                \nMongnai                                                               \nMawkmai                                                               \nKutkai                                                                \nMongton                                                               \nMongyai                                                               \nMongkaing                                                             \nLashio                                                                \nMongpan                                                               \nMatman                                                                \nTachileik                                                             \nNarphan                                                               \nMongkhet                                                              \nHsipaw                                                                \nMonghsat                                                              \nMongmao                                                               \nNansang                                                               \nLaukkaing                                                             \nPangsang                                                              \nNamtu                                                                 \nMonghpyak                                                             \nKonkyan                                                               \nMongping                                                              \nHopong                                                                \nNyaungshwe                                                            \nHsihseng                                                              \nMongla                                                                \nHseni                                                                 \nKunlong                                                               \nHopang                                                                \nNamhkan                                                               \nKengtung                                                              \nLangkho                                                               \nMonghsu                                                               \nTaunggyi                                                              \nPangwaun                                                              \nKyethi                                                                \nLoilen                                                                \nManton     419.06087                                                  \nMongyang   246.76592 585.70558                                        \nKunhing    130.39336 410.49230 188.89405                              \nMongyawng  261.75211 629.43339 304.21734 295.35984                    \nTangyan    196.60826 271.82672 421.06366 249.74161 377.52279          \nNamhsan    242.15271 210.48485 450.97869 270.79121 430.02019  63.67613\n\n\n\n\n\nUse hclust() of R\n\nhclust_ward &lt;- hclust(proxmat, method = 'ward.D')\n\n\nplot(hclust_ward, cex = 0.6)\n\n\n\n\n\n\n\n\n\n\n\nOne of the challenges: identify stronger clustering structures Closer to 1 suggest strong clustering structure\n\nm &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\nnames(m) &lt;- c( \"average\", \"single\", \"complete\", \"ward\")\n\nac &lt;- function(x) {\n  agnes(shan_ict, method = x)$ac\n}\n\nmap_dbl(m, ac)\n\n  average    single  complete      ward \n0.8131144 0.6628705 0.8950702 0.9427730 \n\n\nUseWard's method since it provides the strongest clustering structure.\n\n\n\nOne of the challenges: determine the optimal clusters to retain\nGap Statistic Method\n\nset.seed(12345)\ngap_stat &lt;- clusGap(shan_ict, \n                    FUN = hcut, \n                    nstart = 25, \n                    K.max = 10, \n                    B = 50)\n# Print the result\nprint(gap_stat, method = \"firstmax\")\n\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)\nB=50 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --&gt; Number of clusters (method 'firstmax'): 1\n          logW   E.logW       gap     SE.sim\n [1,] 8.407129 8.680794 0.2736651 0.04460994\n [2,] 8.130029 8.350712 0.2206824 0.03880130\n [3,] 7.992265 8.202550 0.2102844 0.03362652\n [4,] 7.862224 8.080655 0.2184311 0.03784781\n [5,] 7.756461 7.978022 0.2215615 0.03897071\n [6,] 7.665594 7.887777 0.2221833 0.03973087\n [7,] 7.590919 7.806333 0.2154145 0.04054939\n [8,] 7.526680 7.731619 0.2049390 0.04198644\n [9,] 7.458024 7.660795 0.2027705 0.04421874\n[10,] 7.377412 7.593858 0.2164465 0.04540947\n\n\n\nfviz_gap_stat(gap_stat)\n\n\n\n\n\n\n\n\nThe recommended number of cluster to retain is 1. However, it is not logical to retain only one cluster. 6-cluster gives the latest gap statistic and should be next best cluster to pick.\nDraw borders using rect.hclust()\n\nplot(hclust_ward, cex = 0.6)\nrect.hclust(hclust_ward, \n            k = 6, \n            border = 2:5)\n\n\n\n\n\n\n\n\nThe higher the height of the fusion, the less similar the observations are.\n\n\n\nUse heatmaply to build both highly interactive cluster heatmap or static cluster heatmap\nTHe data was loaded into a data frame, transform into data matrix using data.matrix\n\nshan_ict_mat &lt;- data.matrix(shan_ict)\n\n\nheatmaply(normalize(shan_ict_mat),\n          Colv=NA,\n          dist_method = \"euclidean\",\n          hclust_method = \"ward.D\",\n          seriate = \"OLO\",\n          colors = Blues,\n          k_row = 6,\n          margins = c(NA,200,60,NA),\n          fontsize_row = 4,\n          fontsize_col = 5,\n          main=\"Geographic Segmentation of Shan State by ICT indicators\",\n          xlab = \"ICT Indicators\",\n          ylab = \"Townships of Shan State\"\n          )\n\n\n\n\n\nretain six clusters using cutree()\n\ngroups &lt;- as.factor(cutree(hclust_ward, k=6))\n\n\nshan_sf_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER`=`as.matrix.groups.`)\n\n\nqtm(shan_sf_cluster, \"CLUSTER\")\n\n\n\n\n\n\n\n\nThe choropleth map above reveals the clusters are very fragmented. The is one of the major limitation when non-spatial clustering algorithm such as hierarchical cluster analysis method is used."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#spatially-constrained-clustering-skater-approach",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#spatially-constrained-clustering-skater-approach",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "Neighbor list = defines the possible connections between geographic units\nMinimum Spanning Tree MST = link all regions together in the most efficient way possible based on both geographic proximity and attribute similarity\nEdge costs = calculated based on the dissimilarity between the attribute values of connected regions. If 2 neighboring regions have very different ICT measures, the edge cost between them will be higher.\nConverting into SpatialPolygonsDataFrame\n\nshan_sp &lt;- as_Spatial(shan_sf)\n\nComputing Neighbour List using poly2nb\n\nshan.nb &lt;- poly2nb(shan_sp)\nsummary(shan.nb)\n\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\n\n\ncoords &lt;- st_coordinates(\n  st_centroid(st_geometry(shan_sf)))\n\n\nplot(st_geometry(shan_sf), \n     border=grey(.5))\nplot(shan.nb,\n     coords, \n     col=\"blue\", \n     add=TRUE)\n\n\n\n\n\n\n\n\ncalculating edge costs using nbcosts() cost of each edge = the distance between each nodes.\n\nlcosts &lt;- nbcosts(shan.nb, shan_ict)\n\nWhy Incorporate Costs into a Weights Object nb2listw The weights object combines information about spatial adjacency (from the neighbor list) and attribute similarity (from the edge costs).\n\nshan.w &lt;- nb2listw(shan.nb, \n                   lcosts, \n                   style=\"B\")\nsummary(shan.w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 264 \nPercentage nonzero weights: 8.727273 \nAverage number of links: 4.8 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 5  9  7 21  4  3  5  1 \n5 least connected regions:\n3 5 7 9 47 with 2 links\n1 most connected region:\n8 with 9 links\n\nWeights style: B \nWeights constants summary:\n   n   nn       S0       S1        S2\nB 55 3025 76267.65 58260785 522016004\n\n\nComputing minimum spanning tree using mstree().\nmstree() takes a weights object shan.w.\n\nshan.mst &lt;- mstree(shan.w)\n\nClass of the MST object.\n\nclass(shan.mst)\n\n[1] \"mst\"    \"matrix\"\n\n\nDimensions of the MST 54 rows and 3 columns rows: edges (connections) between the regions\ncolumn 1: The first region (or node) connected by the edge\nColumn 2: The second region (or node) connected by the edge\nColumn 3: The cost of the edge, which represent how different the 2 connected regions are in terms of their attribute\n\ndim(shan.mst)\n\n[1] 54  3\n\n\nFirst row: Region 8 is connected to Region 9, and the cost (dissimilarity) of this connection is 90.82891.\n\nhead(shan.mst)\n\n     [,1] [,2]      [,3]\n[1,]   54   48  47.79331\n[2,]   54   17 109.08506\n[3,]   54   45 127.42203\n[4,]   45   52 146.78891\n[5,]   52   13 110.55197\n[6,]   13   28  92.79567\n\n\n\nplot(st_geometry(shan_sf), \n                 border=gray(.5))\nplot.mst(shan.mst, \n         coords, \n         col=\"blue\", \n         cex.lab=0.7, \n         cex.circles=0.005, \n         add=TRUE)\n\n\n\n\n\n\n\n\nuse skater() to compute the spatially constrained cluster.\n\nclust6 &lt;- spdep::skater(edges = shan.mst[,1:2], \n                 data = shan_ict, \n                 method = \"euclidean\", \n                 ncuts = 5)\n\n\nstr(clust6)\n\nList of 8\n $ groups      : num [1:55] 3 3 6 3 3 3 3 3 3 3 ...\n $ edges.groups:List of 6\n  ..$ :List of 3\n  .. ..$ node: num [1:22] 13 48 54 55 45 37 34 16 25 52 ...\n  .. ..$ edge: num [1:21, 1:3] 48 55 54 37 34 16 45 25 13 13 ...\n  .. ..$ ssw : num 3423\n  ..$ :List of 3\n  .. ..$ node: num [1:18] 47 27 53 38 42 15 41 51 43 32 ...\n  .. ..$ edge: num [1:17, 1:3] 53 15 42 38 41 51 15 27 15 43 ...\n  .. ..$ ssw : num 3759\n  ..$ :List of 3\n  .. ..$ node: num [1:11] 2 6 8 1 36 4 10 9 46 5 ...\n  .. ..$ edge: num [1:10, 1:3] 6 1 8 36 4 6 8 10 10 9 ...\n  .. ..$ ssw : num 1458\n  ..$ :List of 3\n  .. ..$ node: num [1:2] 44 20\n  .. ..$ edge: num [1, 1:3] 44 20 95\n  .. ..$ ssw : num 95\n  ..$ :List of 3\n  .. ..$ node: num 23\n  .. ..$ edge: num[0 , 1:3] \n  .. ..$ ssw : num 0\n  ..$ :List of 3\n  .. ..$ node: num 3\n  .. ..$ edge: num[0 , 1:3] \n  .. ..$ ssw : num 0\n $ not.prune   : NULL\n $ candidates  : int [1:6] 1 2 3 4 5 6\n $ ssto        : num 12613\n $ ssw         : num [1:6] 12613 10977 9962 9540 9123 ...\n $ crit        : num [1:2] 1 Inf\n $ vec.crit    : num [1:55] 1 1 1 1 1 1 1 1 1 1 ...\n - attr(*, \"class\")= chr \"skater\"\n\n\n\nccs6 &lt;- clust6$groups\nccs6\n\n [1] 3 3 6 3 3 3 3 3 3 3 2 1 1 1 2 1 1 1 2 4 1 2 5 1 1 1 2 1 2 2 1 2 2 1 1 3 1 2\n[39] 2 2 2 2 2 4 1 3 2 1 1 1 2 1 2 1 1\n\n\n\ntable(ccs6)\n\nccs6\n 1  2  3  4  5  6 \n22 18 11  2  1  1 \n\n\n\nplot(st_geometry(shan_sf), \n     border=gray(.5))\nplot(clust6, \n     coords, \n     cex.lab=.7,\n     groups.colors=c(\"red\",\"green\",\"blue\", \"brown\", \"pink\"),\n     cex.circles=0.005, \n     add=TRUE)\n\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\nWarning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1], coords[id2,\n: \"add\" is not a graphical parameter\n\n\n\n\n\n\n\n\n\nVisualizing the cluster in choropleth map.\n\ngroups_mat &lt;- as.matrix(clust6$groups)\nshan_sf_spatialcluster &lt;- cbind(shan_sf_cluster, as.factor(groups_mat)) %&gt;%\n  rename(`SP_CLUSTER`=`as.factor.groups_mat.`)\nqtm(shan_sf_spatialcluster, \"SP_CLUSTER\")\n\n\n\n\n\n\n\n\n\nhclust.map &lt;- qtm(shan_sf_cluster,\n                  \"CLUSTER\") + \n  tm_borders(alpha = 0.5) \n\nshclust.map &lt;- qtm(shan_sf_spatialcluster,\n                   \"SP_CLUSTER\") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(hclust.map, shclust.map,\n             asp=NA, ncol=2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#spatially-constrained-clustering-clustgeo-method",
    "href": "Hands-on_exercise/Hands-on_ex06/Hands-on_ex06.html#spatially-constrained-clustering-clustgeo-method",
    "title": "Hands-on Exercise 06",
    "section": "",
    "text": "To perform\n\nNon-spatially constrained hierarchical cluster analysis\nSpatially constrained cluster analysis\n\n\n\nUse hclustgeo(), just need to provide the function a dissimilarity matrix proxmat, which must be the class dist\n\nnongeo_cluster &lt;- hclustgeo(proxmat)\nplot(nongeo_cluster, cex = 0.5)\nrect.hclust(nongeo_cluster, \n            k = 6, \n            border = 2:5)\n\n\n\n\n\n\n\n\n\ngroups &lt;- as.factor(cutree(nongeo_cluster, k=6))\n\n\nshan_sf_ngeo_cluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\n\n\nqtm(shan_sf_ngeo_cluster, \"CLUSTER\")\n\n\n\n\n\n\n\n\n\n\n\nUsing st_distance() of sf package to derive a spatial distance\n\ndist &lt;- st_distance(shan_sf, shan_sf)\ndistmat &lt;- as.dist(dist)\n\nUsing choicealpha() to determine a suitable value for mixing parameter alpha\n\ncr &lt;- choicealpha(proxmat, distmat, range.alpha = seq(0, 1, 0.1), K=6, graph = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclustG &lt;- hclustgeo(proxmat, distmat, alpha = 0.3)\n\n\ngroups &lt;- as.factor(cutree(clustG, k=6))\n\n\nshan_sf_Gcluster &lt;- cbind(shan_sf, as.matrix(groups)) %&gt;%\n  rename(`CLUSTER` = `as.matrix.groups.`)\n\n\nqtm(shan_sf_Gcluster, \"CLUSTER\")\n\n\n\n\n\n\n\n\n\n\n\nReveal the distribution of a clustering variable (RADIO_PR) by cluster Cluster 3 has the highest mean Radio Ownership Per Thousand Household.\n\nggplot(data = shan_sf_ngeo_cluster,\n       aes(x = CLUSTER, y = RADIO_PR)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\nUse parallel coordinate plot can be used to reveal clustering variables by cluster very effectively.\nCluster 4 townships tend to own the highest number of TV and mobile phone.\nCluster 5 tends to own the lowest of all the five ICT\nscale of ggparcoord, no one best scaling method to use. You should explore\n\nggparcoord(data = shan_sf_ngeo_cluster, \n           columns = c(17:21), \n           scale = \"globalminmax\",\n           alphaLines = 0.2,\n           boxplot = TRUE, \n           title = \"Multiple Parallel Coordinates Plots of ICT Variables by Cluster\") +\n  facet_grid(~ CLUSTER) + \n  theme(axis.text.x = element_text(angle = 30))\n\n\n\n\n\n\n\n\nUse group_by() and summarize() of dplyr are used to derive mean values of the clustering variables.\n\nshan_sf_ngeo_cluster %&gt;% \n  st_set_geometry(NULL) %&gt;%\n  group_by(CLUSTER) %&gt;%\n  summarise(mean_RADIO_PR = mean(RADIO_PR),\n            mean_TV_PR = mean(TV_PR),\n            mean_LLPHONE_PR = mean(LLPHONE_PR),\n            mean_MPHONE_PR = mean(MPHONE_PR),\n            mean_COMPUTER_PR = mean(COMPUTER_PR))\n\n# A tibble: 6 × 6\n  CLUSTER mean_RADIO_PR mean_TV_PR mean_LLPHONE_PR mean_MPHONE_PR\n  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1 1               221.        521.            44.2           246.\n2 2               237.        402.            23.9           134.\n3 3               300.        611.            52.2           392.\n4 4               196.        744.            99.0           651.\n5 5               124.        224.            38.0           132.\n6 6                98.6       499.            74.5           468.\n# ℹ 1 more variable: mean_COMPUTER_PR &lt;dbl&gt;"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex06/In-class_Ex06.html",
    "href": "In-class_Ex/In-class_Ex06/In-class_Ex06.html",
    "title": "In-class Exercise 06",
    "section": "",
    "text": "Spatio-temporal refers anything that involves both space and time. Exploratory spatial data analysis\nHotter, cooling or are they staying the same?\n\nCalculate Gi* for each time period\nSeries of Gi* at each location is treated as a time-series\nEvaluate for a trend using the Mann-Kendall statistic\nGi* and the Mann-Kendall are compared together to create 17 unique classifications.\n\nGi* = identify hot and cold spots\nMann-Kendall test 1. non-parametric statistical test 2. assesses whether the values in a time series follow a consistent upward or downward trend over time. 3.\n\npacman::p_load(sf, tmap, tidyverse, sfdep, plotly, Kendall)\n\n\nGDPPC &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex06/data/aspatial/Hunan_GDPPC.csv\")\n\nRows: 1496 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): County\ndbl (2): Year, GDPPC\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nhunan &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/In-class_Ex/In-class_Ex06/data/geospatial\",\n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\In-class_Ex\\In-class_Ex06\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\nnumerical trend test: increasing or decreasing trend\n\n\nUse Getis to identify clusters of high values (hot spots) and low values (cold spots)\n\n\nloc_col = space, time_Col = time cannot use original time field, it is in continuous time form\nit is not in integer (must be in integer)\nexplicitly convert to integer, drop the time, to ensure continuous day, month, year. indicate number 1 as Jan, or year, must be in sequence, take note for take-home exercise 02 !!!!!!!\nCreating a time series cube Analyze how GDP per capita changes over both space and time Spacetime cube combines both dimensions to enable a deeper understanding of the dynamics of my data.\n\nGDPPC_st &lt;- spacetime(GDPPC, hunan,\n                      .loc_col = \"County\",\n                      .time_col = \"Year\")\n\nalways 3 dimension, only spacetime does not apply to trajectory, forest fire, flood, phenomena like dynamic space we cannot apply it\naccident occurence can use\n\nis_spacetime_cube(GDPPC_st)\n\n[1] TRUE\n\n\nuse inverse distance weight\ninclude self since we are using Gi star geometry = centroids\ndistance decal = demand for certain services will reduce significantly\nto avoid sorting sequence using set_nbs and set_wts\nFirst we create a neighbor list ensuring that the self is included and then create the weights list from the new neighbors list.\n\nGDPPC_nb &lt;- GDPPC_st %&gt;% \n  activate(\"geometry\") %&gt;% \n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb,\n                             geometry,\n                             scale = 1,\n                             alpha = 1),\n    .before=1) %&gt;% \n  set_nbs(\"nb\") %&gt;% \n  set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\n\nuse tidyr to unnest into a table data form\nWe calculate the local Gi* using local_gstar_perm on the GDPPC column which creates a new data frame column called gi_stars\n\ngi_stars &lt;- GDPPC_nb %&gt;% \n  group_by(Year) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    GDPPC, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\n2 types of analysis focus on individual area, MK test detect whether non-monotonic or sign of monotonic trend\nEvaluate a location for a trend\n\ncbg &lt;- gi_stars %&gt;% \n  ungroup() %&gt;% #must ungroup because it is a cube\n  filter(County == \"Changsha\") |&gt; #r version of %&gt;%  = |&gt;\n  select(County, Year, gi_star)\n\nPlot the result using ggplot2 functions\n\nggplot(data = cbg,\n       aes(x = Year,\n           y = gi_star))+\n  geom_line() +\n  theme_light()\n\n\n\n\n\n\n\n\nInteratcive Mann-Kendall Plot\n\np &lt;- ggplot(data = cbg,\n       aes(x = Year,\n           y = gi_star))+\n  geom_line() +\n  theme_light()\n\nggplotly(p)\n\n\n\n\n\nPrinting Mann-Kendall test report\n\ncbg %&gt;% \n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\n\n# A tibble: 1 × 5\n    tau      sl     S     D  varS\n  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.485 0.00742    66  136.  589.\n\n\nReject null hypothesis, tau 0.485, slight upward trend.\npositive negative and moderate trend for each for the graph\nApply the Mann-Kendall test for trend detection on the Gi* values for each county over time.\n\nehsa &lt;- gi_stars %&gt;% \n  group_by(County) %&gt;% #because 88 counties and observations\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\nhead(ehsa)\n\n# A tibble: 6 × 6\n  County        tau        sl     S     D  varS\n  &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Anhua      0.191  0.303        26  136.  589.\n2 Anren     -0.294  0.108       -40  136.  589.\n3 Anxiang    0      1             0  136.  589.\n4 Baojing   -0.691  0.000128    -94  136.  589.\n5 Chaling   -0.0882 0.650       -12  136.  589.\n6 Changning -0.750  0.0000318  -102  136.  589.\n\n\nSort the data based on the statistical significance and the strength of trends\n\nemerging &lt;- ehsa %&gt;% \n  arrange(sl, abs(tau)) %&gt;% \n  slice(1:10)\nhead(emerging)\n\n# A tibble: 6 × 6\n  County        tau         sl     S     D  varS\n  &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Shuangfeng  0.868 0.00000143   118  136.  589.\n2 Xiangtan    0.868 0.00000143   118  136.  589.\n3 Xiangxiang  0.868 0.00000143   118  136.  589.\n4 Chengbu    -0.824 0.00000482  -112  136.  589.\n5 Dongan     -0.824 0.00000482  -112  136.  589.\n6 Wugang     -0.809 0.00000712  -110  136.  589.\n\n\nPerforming Emerging hotspot analysis of GDPPC\n\nehsa &lt;- emerging_hotspot_analysis(\n  x = GDPPC_st,\n  .var = \"GDPPC\",\n  k = 1,\n  nsim = 99\n)\n\nkendall, without permutations\nemerging hotspot analysis run permutations\n\nggplot(data=ehsa,\n       aes(x=classification)) +\n  geom_bar()\n\n\n\n\n\n\n\n\n\nhunan_ehsa &lt;- hunan %&gt;% \n  left_join(ehsa,\n            by = join_by(County == location))\n\nEHSA Classes:\n\nehsa_sig &lt;- hunan_ehsa  %&gt;%\n  filter(p_value &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hunan_ehsa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_sig) +\n  tm_fill(\"classification\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex06/In-class_Ex06.html#hot-spot-and-cold-spot-area-analysis-hcsa",
    "href": "In-class_Ex/In-class_Ex06/In-class_Ex06.html#hot-spot-and-cold-spot-area-analysis-hcsa",
    "title": "In-class Exercise 06",
    "section": "",
    "text": "Use Getis to identify clusters of high values (hot spots) and low values (cold spots)\n\n\nloc_col = space, time_Col = time cannot use original time field, it is in continuous time form\nit is not in integer (must be in integer)\nexplicitly convert to integer, drop the time, to ensure continuous day, month, year. indicate number 1 as Jan, or year, must be in sequence, take note for take-home exercise 02 !!!!!!!\nCreating a time series cube Analyze how GDP per capita changes over both space and time Spacetime cube combines both dimensions to enable a deeper understanding of the dynamics of my data.\n\nGDPPC_st &lt;- spacetime(GDPPC, hunan,\n                      .loc_col = \"County\",\n                      .time_col = \"Year\")\n\nalways 3 dimension, only spacetime does not apply to trajectory, forest fire, flood, phenomena like dynamic space we cannot apply it\naccident occurence can use\n\nis_spacetime_cube(GDPPC_st)\n\n[1] TRUE\n\n\nuse inverse distance weight\ninclude self since we are using Gi star geometry = centroids\ndistance decal = demand for certain services will reduce significantly\nto avoid sorting sequence using set_nbs and set_wts\nFirst we create a neighbor list ensuring that the self is included and then create the weights list from the new neighbors list.\n\nGDPPC_nb &lt;- GDPPC_st %&gt;% \n  activate(\"geometry\") %&gt;% \n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb,\n                             geometry,\n                             scale = 1,\n                             alpha = 1),\n    .before=1) %&gt;% \n  set_nbs(\"nb\") %&gt;% \n  set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\n\nuse tidyr to unnest into a table data form\nWe calculate the local Gi* using local_gstar_perm on the GDPPC column which creates a new data frame column called gi_stars\n\ngi_stars &lt;- GDPPC_nb %&gt;% \n  group_by(Year) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    GDPPC, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\n2 types of analysis focus on individual area, MK test detect whether non-monotonic or sign of monotonic trend\nEvaluate a location for a trend\n\ncbg &lt;- gi_stars %&gt;% \n  ungroup() %&gt;% #must ungroup because it is a cube\n  filter(County == \"Changsha\") |&gt; #r version of %&gt;%  = |&gt;\n  select(County, Year, gi_star)\n\nPlot the result using ggplot2 functions\n\nggplot(data = cbg,\n       aes(x = Year,\n           y = gi_star))+\n  geom_line() +\n  theme_light()\n\n\n\n\n\n\n\n\nInteratcive Mann-Kendall Plot\n\np &lt;- ggplot(data = cbg,\n       aes(x = Year,\n           y = gi_star))+\n  geom_line() +\n  theme_light()\n\nggplotly(p)\n\n\n\n\n\nPrinting Mann-Kendall test report\n\ncbg %&gt;% \n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\n\n# A tibble: 1 × 5\n    tau      sl     S     D  varS\n  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.485 0.00742    66  136.  589.\n\n\nReject null hypothesis, tau 0.485, slight upward trend.\npositive negative and moderate trend for each for the graph\nApply the Mann-Kendall test for trend detection on the Gi* values for each county over time.\n\nehsa &lt;- gi_stars %&gt;% \n  group_by(County) %&gt;% #because 88 counties and observations\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\nhead(ehsa)\n\n# A tibble: 6 × 6\n  County        tau        sl     S     D  varS\n  &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Anhua      0.191  0.303        26  136.  589.\n2 Anren     -0.294  0.108       -40  136.  589.\n3 Anxiang    0      1             0  136.  589.\n4 Baojing   -0.691  0.000128    -94  136.  589.\n5 Chaling   -0.0882 0.650       -12  136.  589.\n6 Changning -0.750  0.0000318  -102  136.  589.\n\n\nSort the data based on the statistical significance and the strength of trends\n\nemerging &lt;- ehsa %&gt;% \n  arrange(sl, abs(tau)) %&gt;% \n  slice(1:10)\nhead(emerging)\n\n# A tibble: 6 × 6\n  County        tau         sl     S     D  varS\n  &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Shuangfeng  0.868 0.00000143   118  136.  589.\n2 Xiangtan    0.868 0.00000143   118  136.  589.\n3 Xiangxiang  0.868 0.00000143   118  136.  589.\n4 Chengbu    -0.824 0.00000482  -112  136.  589.\n5 Dongan     -0.824 0.00000482  -112  136.  589.\n6 Wugang     -0.809 0.00000712  -110  136.  589.\n\n\nPerforming Emerging hotspot analysis of GDPPC\n\nehsa &lt;- emerging_hotspot_analysis(\n  x = GDPPC_st,\n  .var = \"GDPPC\",\n  k = 1,\n  nsim = 99\n)\n\nkendall, without permutations\nemerging hotspot analysis run permutations\n\nggplot(data=ehsa,\n       aes(x=classification)) +\n  geom_bar()\n\n\n\n\n\n\n\n\n\nhunan_ehsa &lt;- hunan %&gt;% \n  left_join(ehsa,\n            by = join_by(County == location))\n\nEHSA Classes:\n\nehsa_sig &lt;- hunan_ehsa  %&gt;%\n  filter(p_value &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hunan_ehsa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_sig) +\n  tm_fill(\"classification\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "",
    "text": "Tourism is one of Thailand’s largest industries, accounting for some 20% of the gross domestic product (GDP). In 2019, Thailand earned 90 billion US$ from domestic and international tourism, but the COVID-19 pandemic caused revenues to crash to 24 billion US$ in 2020."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#overview",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#overview",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "",
    "text": "Tourism is one of Thailand’s largest industries, accounting for some 20% of the gross domestic product (GDP). In 2019, Thailand earned 90 billion US$ from domestic and international tourism, but the COVID-19 pandemic caused revenues to crash to 24 billion US$ in 2020."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#getting-started",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#getting-started",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "2 Getting Started",
    "text": "2 Getting Started\n\n2.1 Objectives\nIn view of this, we need to discover\n\nif the key indicators of tourism economy of Thailand are independent from space and space and time.\nIf the tourism economy is indeed spatial and spatio-temporal dependent, then, you would like to detect where are the clusters and outliers, and the emerging hot spot/cold spot areas\n\n\n\n2.2 The Study Area\nThe focus of this study would in the Thailand, at the province level."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#data-preparation",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#data-preparation",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "3 Data Preparation",
    "text": "3 Data Preparation\nSetting the analytical tools.\n\npacman::p_load(sf,spNetwork,raster,spatstat,tmap,tidyverse,sp,maptools,spNetwork,knitr,ggplot2,sfdep)\n\n\n3.1 Data Preparation\nThese data sets are in shp format\n\nThailand - Subnational Administrative Boundaries, available publicly from HDX\n\nThis data sets are in csv format\n\nThailand Domestic Tourism Statistics, available publicly from Kaggle"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#data-wrangling",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#data-wrangling",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "4 Data Wrangling",
    "text": "4 Data Wrangling\n\n4.1 Thailand Road Accident 2019-2023\n\n4.1.1 Importing Attribute Data into R\nWe will import thailand_domestic_tourism_2019_2023_ver2.csv file into RStudio and save the file into an R dataframe called thaitour\n\nthaitour &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex02/data/aspatial/thailand_domestic_tourism_2019_2023_ver2.csv\")\n\nRows: 30800 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): province_thai, province_eng, region_thai, region_eng, variable\ndbl  (1): value\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nhead(thaitour)\n\n# A tibble: 6 × 7\n  date       province_thai province_eng    region_thai region_eng variable value\n  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;\n1 2019-01-01 กรุงเทพมหานคร  Bangkok         ภาคกลาง     central    ratio_t…  93.4\n2 2019-01-01 ลพบุรี          Lopburi         ภาคกลาง     central    ratio_t…  61.3\n3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon Si… ภาคกลาง     central    ratio_t…  73.4\n4 2019-01-01 สระบุรี         Saraburi        ภาคกลาง     central    ratio_t…  67.3\n5 2019-01-01 ชัยนาท         Chainat         ภาคกลาง     central    ratio_t…  79.3\n6 2019-01-01 นครปฐม        Nakhon Pathom   ภาคกลาง     central    ratio_t…  71.7\n\n\nCheck if there are any missing values.\n\nsum(is.na(thaitour$value))\n\n[1] 0\n\n\nCheck if the values in the variable column are balanced or equally represented. All variables have equal 3850 counts.\n\ntable(thaitour$variable)\n\n\n    no_tourist_all no_tourist_foreign    no_tourist_stay    no_tourist_thai \n              3850               3850               3850               3850 \nratio_tourist_stay        revenue_all    revenue_foreign       revenue_thai \n              3850               3850               3850               3850 \n\n\n\n\n\n4.2 Thailand - Subnational Administrative Boundaries\nWe will import tha_admbnda_adm1_rtsd_20220121.csv file into RStudio and save the file into an R dataframe called thailand\n\nthailand &lt;-  st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex02/data/geospatial\",\n                 layer = \"tha_admbnda_adm1_rtsd_20220121\")\n\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Take-home_Ex\\Take-home_Ex02\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n\n\n\nthailand_32647 &lt;- st_transform(thailand, crs = 32647)\n\n\nst_geometry(thailand_32647)\n\nGeometry set for 77 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((674339.8 1543300, 674382.3 1543...\n\n\nMULTIPOLYGON (((687139.8 1517113, 687147.1 1517...\n\n\nMULTIPOLYGON (((644817.9 1559286, 644817.5 1559...\n\n\nMULTIPOLYGON (((704086 1575736, 704089.9 157550...\n\n\nMULTIPOLYGON (((662941.6 1620856, 662957.5 1620...\n\n\n\nplot(st_geometry(thailand_32647))\n\n\n\n\n\n\n\n\nKeep the time series at month and year levels.\n\nlibrary(lubridate)\n\n# Create a new column with month and year in the format like 'Jan-2019'\nthaitour &lt;- thaitour %&gt;%\n  mutate(month_year = format(as.Date(date), \"%b-%Y\"))\n\n# Filter the data to keep only 'no_tourist_all' and 'revenue_all'\nfiltered_data &lt;- thaitour %&gt;%\n  filter(variable %in% c(\"no_tourist_all\", \"revenue_all\")) %&gt;%\n  dplyr::select(province_eng, month_year, variable, value)\n\n# View the filtered data\nprint(filtered_data)\n\n# A tibble: 7,700 × 4\n   province_eng             month_year variable         value\n   &lt;chr&gt;                    &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;\n 1 Bangkok                  Jan-2019   no_tourist_all 5959075\n 2 Lopburi                  Jan-2019   no_tourist_all  268664\n 3 Phra Nakhon Si Ayutthaya Jan-2019   no_tourist_all  730329\n 4 Saraburi                 Jan-2019   no_tourist_all  207236\n 5 Chainat                  Jan-2019   no_tourist_all   79073\n 6 Nakhon Pathom            Jan-2019   no_tourist_all  296107\n 7 Sing Buri                Jan-2019   no_tourist_all   49438\n 8 Ang Thong                Jan-2019   no_tourist_all  104097\n 9 Nonthaburi               Jan-2019   no_tourist_all  323717\n10 Pathum Thani             Jan-2019   no_tourist_all  233295\n# ℹ 7,690 more rows\n\n\n\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(lubridate)\n\n# Ensure 'filtered_data' has only 'revenue_all' and group by 'month_year'\nmonthly_revenue &lt;- filtered_data %&gt;%\n  filter(variable == \"revenue_all\") %&gt;%\n  group_by(month_year) %&gt;%\n  summarise(total_revenue = sum(value, na.rm = TRUE))\n\n# Convert 'month_year' to a date format (assuming the first day of each month)\nmonthly_revenue &lt;- monthly_revenue %&gt;%\n  mutate(month_year_date = as.Date(paste0(\"01-\", month_year), format = \"%d-%b-%Y\"))\n\n# Plot the total monthly revenue with proper sorting\nggplot(monthly_revenue, aes(x = month_year_date, y = total_revenue)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  labs(title = \"Monthly Total Revenue from Tourism Industry, 2019-2023\",\n       x = \"Month-Year\",\n       y = \"Total Revenue\") +\n  theme_minimal() +\n  scale_x_date(date_labels = \"%b-%Y\", date_breaks = \"1 month\") +  # Proper x-axis labels\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability\n\n\n\n\n\n\n\n\nTo analyze the effects of the COVID-19 pandemic on tourism revenue, I have segmented the data into three distinct periods:\n\nPre-COVID (Year 2019): This period represents normal tourism activity before the pandemic.\nCOVID Period (Year 2020 to September 2021): This period captures the time when the pandemic was at its peak, and international travel restrictions were in place, significantly affecting tourism.\nPost-COVID (From October 2021 Onward): This period reflects the recovery phase as restrictions were lifted, and tourism began to recover.\n\nUsing this segmentation, I will create a new dataset, reshaped_data, based on the filtered_data. This dataset will include these defined periods, which will later be joined with the thailand_32647_sorted dataset for further spatial analysis.\n\nlibrary(lubridate)\n\n# Convert the 'month_year' to a date-like format for easier processing\nfiltered_data &lt;- filtered_data %&gt;%\n  mutate(month_year_date = parse_date_time(month_year, orders = \"b-Y\")) %&gt;%\n  mutate(year = year(month_year_date),\n         month = month(month_year_date))\n\n# Classify the periods: Pre-COVID, COVID, and Post-COVID\nfiltered_data &lt;- filtered_data %&gt;%\n  mutate(covid_period = case_when(\n    year == 2019 ~ \"pre_covid\",\n    year == 2020 | (year == 2021 & month &lt;= 9) ~ \"covid_period\",\n    (year &gt;= 2021 & month &gt; 9) | year &gt;= 2022 ~ \"post_covid\"\n  ))\n\n\n# Sum the values by province and covid_period for 'no_tourist_all' and 'revenue_all'\nreshaped_data &lt;- filtered_data %&gt;%\n  filter(variable %in% c(\"no_tourist_all\", \"revenue_all\")) %&gt;%\n  group_by(province_eng, covid_period, variable) %&gt;%\n  summarise(total_value = sum(value, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  unite(\"period_variable\", covid_period, variable, sep = \"_\") %&gt;%\n  pivot_wider(names_from = period_variable, values_from = total_value)\n\n`summarise()` has grouped output by 'province_eng', 'covid_period'. You can\noverride using the `.groups` argument.\n\n# Calculate the total from 2019 to 2023 for each province and variable\ntotal_data &lt;- filtered_data %&gt;%\n  filter(variable %in% c(\"no_tourist_all\", \"revenue_all\")) %&gt;%\n  group_by(province_eng, variable) %&gt;%\n  summarise(total_value = sum(value, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  pivot_wider(names_from = variable, values_from = total_value, names_prefix = \"total_\")\n\n`summarise()` has grouped output by 'province_eng'. You can override using the\n`.groups` argument.\n\n# Combine reshaped data with the total data\nreshaped_data &lt;- left_join(reshaped_data, total_data, by = \"province_eng\")\n\n# View the reshaped data\nprint(reshaped_data)\n\n# A tibble: 77 × 9\n   province_eng  covid_period_no_tourist_all covid_period_revenue_all\n   &lt;chr&gt;                               &lt;dbl&gt;                    &lt;dbl&gt;\n 1 Amnat Charoen                      224582                305450000\n 2 Ang Thong                          544825                618730000\n 3 Bangkok                          31815852             299362780000\n 4 Bueng Kan                          458552                728250000\n 5 Buriram                           1492297               2868260000\n 6 Chachoengsao                      2340584               3066410000\n 7 Chainat                            590187                770900000\n 8 Chaiyaphum                        1093318               1292740000\n 9 Chanthaburi                       1812809               5557010000\n10 Chiang Mai                        7930163              62552310000\n# ℹ 67 more rows\n# ℹ 6 more variables: post_covid_no_tourist_all &lt;dbl&gt;,\n#   post_covid_revenue_all &lt;dbl&gt;, pre_covid_no_tourist_all &lt;dbl&gt;,\n#   pre_covid_revenue_all &lt;dbl&gt;, total_no_tourist_all &lt;dbl&gt;,\n#   total_revenue_all &lt;dbl&gt;\n\n\n\n# Sort 'thailand_32647' by 'ADM1_EN' in alphabetical order\nthailand_32647_sorted &lt;- thailand_32647 %&gt;%\n  arrange(ADM1_EN)\n\n# Sort the 'reshaped_data' by 'province_eng' to ensure matching order\nreshaped_data_sorted &lt;- reshaped_data %&gt;%\n  arrange(province_eng)\n\n# Create a comparison table with 'ADM1_EN' and 'province_eng' side by side\ncomparison_table &lt;- thailand_32647_sorted %&gt;%\n  dplyr::select(ADM1_EN) %&gt;%\n  bind_cols(reshaped_data_sorted %&gt;% dplyr::select(province_eng))\n\nBased on the comparison table, we need to correct the value in ADM1_EN before we join both datasets.\n\n\n\nBefore\nAfter\n\n\n\n\nBuri Ram\nBuriram\n\n\nChai Nat\nChainat\n\n\nChon Buri\nChonburi\n\n\nLop Buri\nLopburi\n\n\nNong Bua Lam Phu\nNong Bua Lamphu\n\n\nPhangnga\nPhang Nga\n\n\nPrachin Buri\nPrachinburi\n\n\nSi Sa Ket\nSisaket\n\n\n\n\n# Replace specific values in the ADM1_EN column based on the mapping you provided\nthailand_32647_sorted &lt;- thailand_32647_sorted %&gt;%\n  mutate(ADM1_EN = case_when(\n    ADM1_EN == \"Buri Ram\" ~ \"Buriram\",\n    ADM1_EN == \"Chai Nat\" ~ \"Chainat\",\n    ADM1_EN == \"Chon Buri\" ~ \"Chonburi\",\n    ADM1_EN == \"Lop Buri\" ~ \"Lopburi\",\n    ADM1_EN == \"Nong Bua Lam Phu\" ~ \"Nong Bua Lamphu\",\n    ADM1_EN == \"Phangnga\" ~ \"Phang Nga\",\n    ADM1_EN == \"Prachin Buri\" ~ \"Prachinburi\",\n    ADM1_EN == \"Si Sa Ket\" ~ \"Sisaket\",\n    TRUE ~ ADM1_EN  # Keep all other values as they are\n  ))\n\n# View the updated table to ensure the replacements have been made\nprint(thailand_32647_sorted)\n\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 10 features:\n   Shape_Leng Shape_Area       ADM1_EN      ADM1_TH ADM1_PCODE ADM1_REF\n1    3.927244 0.27531267 Amnat Charoen    อำนาจเจริญ       TH37     &lt;NA&gt;\n2    1.739908 0.07920961     Ang Thong       อ่างทอง       TH15     &lt;NA&gt;\n3    2.417227 0.13133873       Bangkok กรุงเทพมหานคร       TH10     &lt;NA&gt;\n4    4.414998 0.34078403     Bueng Kan        บึงกาฬ       TH38     &lt;NA&gt;\n5    8.701860 0.84453704       Buriram        บุรีรัมย์       TH31     &lt;NA&gt;\n6    4.941453 0.43148401  Chachoengsao    ฉะเชิงเทรา       TH24     &lt;NA&gt;\n7    2.896316 0.20907828       Chainat        ชัยนาท       TH18     &lt;NA&gt;\n8    7.055513 1.06531930    Chaiyaphum         ชัยภูมิ       TH36     &lt;NA&gt;\n9    5.130273 0.53331644   Chanthaburi        จันทบุรี       TH22     &lt;NA&gt;\n10  13.346345 1.90054644    Chiang Mai      เชียงใหม่       TH50     &lt;NA&gt;\n   ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH ADM0_PCODE\n1        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n2        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n3        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n4        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n5        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n6        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n7        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n8        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n9        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n10       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย         TH\n         date    validOn    validTo                       geometry\n1  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((1137720 180...\n2  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((643472.8 16...\n3  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((674339.8 15...\n4  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((965496 2045...\n5  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((921217 1750...\n6  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((722656.1 15...\n7  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((620165.4 17...\n8  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((772997.4 18...\n9  2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((853764.8 13...\n10 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((554883.3 22...\n\n\n\n# Perform the left join with 'reshaped_data' on 'ADM1_TH' and 'province_eng'\nthailand &lt;- left_join(thailand_32647_sorted, reshaped_data_sorted, by = c(\"ADM1_EN\" = \"province_eng\")) %&gt;% \n  dplyr::select(1:3,17:25)\n\n# View the merged data\nhead(thailand)\n\nSimple feature collection with 6 features and 11 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 628303 ymin: 1458481 xmax: 1149111 ymax: 2045538\nProjected CRS: WGS 84 / UTM zone 47N\n  Shape_Leng Shape_Area       ADM1_EN covid_period_no_tourist_all\n1   3.927244 0.27531267 Amnat Charoen                      224582\n2   1.739908 0.07920961     Ang Thong                      544825\n3   2.417227 0.13133873       Bangkok                    31815852\n4   4.414998 0.34078403     Bueng Kan                      458552\n5   8.701860 0.84453704       Buriram                     1492297\n6   4.941453 0.43148401  Chachoengsao                     2340584\n  covid_period_revenue_all post_covid_no_tourist_all post_covid_revenue_all\n1                305450000                    310168              330360000\n2                618730000                    920069              924400000\n3             299362780000                  52570086           479790890000\n4                728250000                    911779             1192090000\n5               2868260000                   3747431             7497610000\n6               3066410000                   6387965             7150640000\n  pre_covid_no_tourist_all pre_covid_revenue_all total_no_tourist_all\n1                   306727          4.392900e+08               841477\n2                   828556          1.013520e+09              2293450\n3                 66966562          1.067814e+12            151352500\n4                   606194          1.070360e+09              1976525\n5                  2330523          4.703950e+09              7570251\n6                  3466731          5.085780e+09             12195280\n  total_revenue_all                       geometry\n1      1.075100e+09 MULTIPOLYGON (((1137720 180...\n2      2.556650e+09 MULTIPOLYGON (((643472.8 16...\n3      1.846967e+12 MULTIPOLYGON (((674339.8 15...\n4      2.990700e+09 MULTIPOLYGON (((965496 2045...\n5      1.506982e+10 MULTIPOLYGON (((921217 1750...\n6      1.530283e+10 MULTIPOLYGON (((722656.1 15..."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#exploratory-data-analysis",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#exploratory-data-analysis",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "5 Exploratory Data Analysis",
    "text": "5 Exploratory Data Analysis\nGenerate the statistics summary of the variable.\n\nsummary_by_variable &lt;- thaitour %&gt;%\n  group_by(variable) %&gt;%\n  summarise(\n    count = n(),\n    mean = mean(value, na.rm = TRUE),\n    std = sd(value, na.rm = TRUE),\n    min = min(value, na.rm = TRUE),\n    Q1 = quantile(value, 0.25, na.rm = TRUE),\n    median = median(value, na.rm = TRUE),\n    Q3 = quantile(value, 0.75, na.rm = TRUE),\n    max = max(value, na.rm = TRUE)\n  )\n\n# Print the summary table\nprint(summary_by_variable)\n\n# A tibble: 8 × 9\n  variable           count        mean    std   min     Q1 median     Q3     max\n  &lt;chr&gt;              &lt;int&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;\n1 no_tourist_all      3850      2.06e5 4.54e5     0 3.91e4 9.21e4 2.04e5 6.13e 6\n2 no_tourist_foreign  3850      3.24e4 1.70e5     0 4.93e1 5.53e2 5.19e3 2.47e 6\n3 no_tourist_stay     3850      1.05e5 2.52e5     0 1.63e4 4.46e4 9.09e4 3.34e 6\n4 no_tourist_thai     3850      1.74e5 3.18e5     0 3.72e4 8.88e4 1.84e5 4.09e 6\n5 ratio_tourist_stay  3850      3.89e1 2.27e1     0 2.02e1 4.18e1 5.62e1 9.59e 1\n6 revenue_all         3850      1.34e9 6.57e9     0 6.33e7 1.95e8 5.06e8 1.10e11\n7 revenue_foreign     3850      6.80e8 4.65e9 -4250 1.10e5 1.54e6 1.74e7 8.50e10\n8 revenue_thai        3850      6.64e8 2.28e9     0 5.92e7 1.77e8 4.60e8 4.51e10\n\n\nGenerate the boxplot for the variables.\n\nfirst_group &lt;- thaitour %&gt;%\n  filter(variable %in% c(\"no_tourist_all\", \"no_tourist_foreign\", \"no_tourist_stay\", \"ratio_tourist_stay\"))\n\nggplot(first_group, aes(x = variable, y = value)) +\n  geom_boxplot(fill = \"lightblue\", color = \"black\") +\n  labs(title = \"Boxplots for Tourist-Related Variables\",\n       x = \"Variable\",\n       y = \"Value\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nsecond_group &lt;- thaitour %&gt;%\n  filter(variable %in% c(\"revenue_all\", \"revenue_foreign\", \"revenue_thai\"))\n\nggplot(second_group, aes(x = variable, y = value)) +\n  geom_boxplot(fill = \"lightgreen\", color = \"black\") +\n  labs(title = \"Boxplots for Revenue-Related Variables\",\n       x = \"Variable\",\n       y = \"Value\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  \n\n\n\n\n\n\n\n\nThe current boxplot shows that the presence of outliers distorts the scale, making it difficult to observe the distribution of the data. To address this issue and better visualize the central tendency and spread of the data, I created another boxplot that excludes the outliers\n\n# First group: Tourist-related variables\nfirst_group &lt;- thaitour %&gt;%\n  filter(variable %in% c(\"no_tourist_all\", \"no_tourist_foreign\", \"no_tourist_stay\", \"ratio_tourist_stay\"))\n\nggplot(first_group, aes(x = variable, y = value)) +\n  geom_boxplot(fill = \"lightblue\", color = \"black\", outlier.shape = NA) + \n  coord_cartesian(ylim = c(0, 250000)) +# Remove outliers\n  labs(title = \"Boxplots for Tourist-Related Variables\",\n       x = \"Variable\",\n       y = \"Value\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n# Second group: Revenue-related variables\nsecond_group &lt;- thaitour %&gt;%\n  filter(variable %in% c(\"revenue_all\", \"revenue_foreign\", \"revenue_thai\"))\n\nggplot(second_group, aes(x = variable, y = value)) +\n  geom_boxplot(fill = \"lightgreen\", color = \"black\", outlier.shape = NA) +\n  coord_cartesian(ylim = c(0, 600000000))+\n  labs(title = \"Boxplots for Revenue-Related Variables\",\n       x = \"Variable\",\n       y = \"Value\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\nGenerate the boxplot of no_tourist_all and revenue_all by year.\n\n# First, ensure that the year is extracted from the 'date' column\nthaitour &lt;- thaitour %&gt;%\n  mutate(year = as.numeric(format(as.Date(date), \"%Y\")))\n\n# Filter for the variable 'no_tourist_all' for years 2019 to 2023\ndata_no_tourist &lt;- thaitour %&gt;%\n  filter(variable == \"no_tourist_all\", year %in% c(2019, 2020, 2021, 2022, 2023))\n\n# Create a boxplot for 'no_tourist_all'\nggplot(data_no_tourist, aes(x = factor(year), y = value)) +\n  geom_boxplot(fill = \"skyblue\", color = \"black\") +\n  labs(title = \"Boxplot of No_Tourist_All by Year\",\n       x = \"Year\",\n       y = \"Number of Tourists (All)\") +\n  theme_minimal()\n\n\n\n\n\n\n\ndata_revenue &lt;- thaitour %&gt;%\n  filter(variable == \"revenue_all\", year %in% c(2019, 2020, 2021, 2022, 2023))\n\n# Create a boxplot for 'revenue_all'\nggplot(data_revenue, aes(x = factor(year), y = value)) +\n  geom_boxplot(fill = \"lightgreen\", color = \"black\") +\n  labs(title = \"Boxplot of Revenue_All by Year\",\n       x = \"Year\",\n       y = \"Revenue (All)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nThe current boxplot shows that the presence of outliers distorts the scale, making it difficult to observe the distribution of the data. To address this issue and better visualize the central tendency and spread of the data, I created another boxplot that excludes the outliers.\n\nthaitour &lt;- thaitour %&gt;%\n  mutate(year = as.numeric(format(as.Date(date), \"%Y\")))\n\n# Filter for 'no_tourist_all' variable for the years 2019 to 2023\ndata_no_tourist &lt;- thaitour %&gt;%\n  filter(variable == \"no_tourist_all\", year %in% c(2019, 2020, 2021, 2022, 2023))\n\n# Adjust the scale range for 'no_tourist_all' and create boxplot\nggplot(data_no_tourist, aes(x = factor(year), y = value)) +\n  geom_boxplot(fill = \"skyblue\", color = \"black\", outlier.shape = NA) +\n  coord_cartesian(ylim = c(0, 400000)) +  # Adjust this range as necessary\n  labs(title = \"Boxplot of No_Tourist_All by Year (Without Outliers)\",\n       x = \"Year\",\n       y = \"Number of Tourists (All)\") +\n  theme_minimal()\n\n\n\n\n\n\n\ndata_revenue &lt;- thaitour %&gt;%\n  filter(variable == \"revenue_all\", year %in% c(2019, 2020, 2021, 2022, 2023))\n\n# Adjust the scale range for 'revenue_all' and create boxplot\nggplot(data_revenue, aes(x = factor(year), y = value)) +\n  geom_boxplot(fill = \"lightgreen\", color = \"black\", outlier.shape = NA) +\n  coord_cartesian(ylim = c(0, 1300000000)) +  # Adjust this range as necessary\n  labs(title = \"Boxplot of Revenue_All by Year (Without Outliers)\",\n       x = \"Year\",\n       y = \"Revenue (All)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nPlot the horizontal bar chart that shows the total revenue by province in 2019.\n\n# Ensure filtered_data has only 'revenue_all' and is filtered for 2019\nbar_data &lt;- filtered_data %&gt;%\n  filter(variable == \"revenue_all\" & grepl(\"2019\", month_year)) %&gt;%\n  dplyr::select(province_eng, value) %&gt;%\n  group_by(province_eng) %&gt;%\n  summarise(total_revenue_2019 = sum(value, na.rm = TRUE))\n\n# Create a horizontal bar chart with provinces ordered by total revenue in descending order\nggplot(bar_data, aes(x = total_revenue_2019, y = reorder(province_eng, total_revenue_2019))) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  labs(title = \"Total Revenue by Province in 2019\",\n       x = \"Total Revenue\",\n       y = \"Province\") +\n  theme_minimal() +\n  theme(axis.text.y = element_text(size = 8))  # Adjust font size of y-axis labels\n\n\n\n\n\n\n\n# Save the plot with increased dimensions\nggsave(\"total_revenue_2019.png\", width = 10, height = 15)\n\n Plot the horizontal bar chart that shows the total tourists by province in 2019.\n\n# Assuming reshaped_data is already created with 2019_revenue_all as one of the columns\nbar_data &lt;- reshaped_data %&gt;%\n  dplyr::select(province_eng, `covid_period_no_tourist_all`)\n\n# Create a horizontal bar chart with provinces ordered by revenue in descending order\nggplot(bar_data, aes(x = `covid_period_no_tourist_all`, y = reorder(province_eng, `covid_period_no_tourist_all`))) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  labs(title = \"Total Tourists by Province in 2019\",\n       x = \"Total Revenue\",\n       y = \"Province\") +\n  theme_minimal() +\n  theme(axis.text.y = element_text(size = 8))  # Adjust font size of y-axis labels\n\n\n\n\n\n\n\n# Save the plot with increased dimensions\nggsave(\"total_tourist_2019.png\", width = 10, height = 15)\n\n\n\n\n\n\n\nbasemap &lt;- tm_shape(thailand) +\n  tm_polygons() +\n  tm_text(\"ADM1_EN\", size=0.5)\n\nrevenue &lt;- qtm(thailand, \"covid_period_no_tourist_all\")\ntmap_arrange(basemap, revenue, asp=1, ncol=2)\n\n\n\n\n\n\n\n\nPlot choropleth map to see the distribution of tourism revenue\n\nequal &lt;- tm_shape(thailand) +\n  tm_fill(\"total_revenue_all\",\n          title = \"Revenue by equal interval\",\n          style = \"equal\") +\n  tm_borders(alpha = 0.5)+\n  tm_layout(main.title = \"Distribution of tourism revenue by province in Thailand\",\n            main.title.size = 0.8)\n\nquantile &lt;- tm_shape(thailand) +\n  tm_fill(\"total_revenue_all\",\n          title = \"Revenue by equal quantile\",\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of tourism revenue by province in Thailand\",\n            main.title.size = 0.8)\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)\n\nSome legend labels were too wide. These labels have been resized to 0.64, 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\nPlot choropleth map to see the distribution of tourism receipt\n\nequal &lt;- tm_shape(thailand) +\n  tm_fill(\"total_no_tourist_all\",\n          title = \"Tourist receipt by equal interval\",\n          style = \"equal\") +\n  tm_borders(alpha = 0.5)+\n  tm_layout(main.title = \"Distribution of tourist by province in Thailand\",\n            main.title.size = 0.8)\n\nquantile &lt;- tm_shape(thailand) +\n  tm_fill(\"total_no_tourist_all\",\n          title = \"Tourist receipt  by equal quantile\",\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of tourist by province in Thailand\",\n            main.title.size = 0.8)\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#global-spatial-autocorrelation-analysis",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#global-spatial-autocorrelation-analysis",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "6 Global Spatial Autocorrelation Analysis",
    "text": "6 Global Spatial Autocorrelation Analysis\n\nDerive Queen’s contiguity weights: sfdep methods\nThe code chunk below is used to compute Queen contiguity weight matrix.\n\n# Load necessary libraries\nwm_q &lt;- thailand %&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb,\n                         style = \"W\",\n                         allow_zero=TRUE),\n         .before = 1) \n\n\nwm_q\n\nSimple feature collection with 77 features and 13 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 10 features:\n                             nb\n1                    25, 72, 77\n2                22, 46, 63, 66\n3         6, 27, 36, 37, 57, 58\n4                    28, 35, 56\n5            17, 24, 29, 55, 68\n6  3, 9, 12, 26, 37, 49, 55, 57\n7                30, 63, 66, 74\n8                17, 22, 29, 42\n9             6, 12, 53, 55, 71\n10           11, 19, 20, 23, 69\n                                                                 wt Shape_Leng\n1                                   0.3333333, 0.3333333, 0.3333333   3.927244\n2                                            0.25, 0.25, 0.25, 0.25   1.739908\n3  0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667   2.417227\n4                                   0.3333333, 0.3333333, 0.3333333   4.414998\n5                                           0.2, 0.2, 0.2, 0.2, 0.2   8.701860\n6            0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125   4.941453\n7                                            0.25, 0.25, 0.25, 0.25   2.896316\n8                                            0.25, 0.25, 0.25, 0.25   7.055513\n9                                           0.2, 0.2, 0.2, 0.2, 0.2   5.130273\n10                                          0.2, 0.2, 0.2, 0.2, 0.2  13.346345\n   Shape_Area       ADM1_EN covid_period_no_tourist_all\n1  0.27531267 Amnat Charoen                      224582\n2  0.07920961     Ang Thong                      544825\n3  0.13133873       Bangkok                    31815852\n4  0.34078403     Bueng Kan                      458552\n5  0.84453704       Buriram                     1492297\n6  0.43148401  Chachoengsao                     2340584\n7  0.20907828       Chainat                      590187\n8  1.06531930    Chaiyaphum                     1093318\n9  0.53331644   Chanthaburi                     1812809\n10 1.90054644    Chiang Mai                     7930163\n   covid_period_revenue_all post_covid_no_tourist_all post_covid_revenue_all\n1                 305450000                    310168              330360000\n2                 618730000                    920069              924400000\n3              299362780000                  52570086           479790890000\n4                 728250000                    911779             1192090000\n5                2868260000                   3747431             7497610000\n6                3066410000                   6387965             7150640000\n7                 770900000                   1069507             1350840000\n8                1292740000                   1423871             1963350000\n9                5557010000                   2171561             7238050000\n10              62552310000                  12666680            86823060000\n   pre_covid_no_tourist_all pre_covid_revenue_all total_no_tourist_all\n1                    306727          4.392900e+08               841477\n2                    828556          1.013520e+09              2293450\n3                  66966562          1.067814e+12            151352500\n4                    606194          1.070360e+09              1976525\n5                   2330523          4.703950e+09              7570251\n6                   3466731          5.085780e+09             12195280\n7                    853942          1.336560e+09              2513636\n8                   1804320          2.203120e+09              4321509\n9                   2484480          8.713840e+09              6468850\n10                 11165860          1.106703e+11             31762703\n   total_revenue_all                       geometry\n1       1.075100e+09 MULTIPOLYGON (((1137720 180...\n2       2.556650e+09 MULTIPOLYGON (((643472.8 16...\n3       1.846967e+12 MULTIPOLYGON (((674339.8 15...\n4       2.990700e+09 MULTIPOLYGON (((965496 2045...\n5       1.506982e+10 MULTIPOLYGON (((921217 1750...\n6       1.530283e+10 MULTIPOLYGON (((722656.1 15...\n7       3.458300e+09 MULTIPOLYGON (((620165.4 17...\n8       5.459210e+09 MULTIPOLYGON (((772997.4 18...\n9       2.150890e+10 MULTIPOLYGON (((853764.8 13...\n10      2.600457e+11 MULTIPOLYGON (((554883.3 22...\n\n\nBased on wm_q, Phuket has zero neighbours as shown below because it is an island.\n\nwm_q$ADM1_EN[[48]]\n\n[1] \"Phuket\"\n\n\n\nwm_q$nb[[48]]\n\n[1] 0\n\n\nUse tmap to view the Phuket location\n\n# Set tmap to interactive mode ('view')\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\n# Plot the geometry and add province names\ntm_shape(thailand) + \n  tm_polygons() +\n  tm_text(\"ADM1_EN\", size = 0.7)  # Adjust size as necessary\n\n\n\n\n\nUse tmap to view Phuket boundary.\n\nlibrary(tmap)\nlibrary(dplyr)\n\n# Filter the thailand dataset to keep only the row for Phuket\nphuket &lt;- thailand %&gt;%\n  filter(ADM1_EN == \"Phuket\")\n\n# Set tmap to interactive mode ('view')\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\n# Plot only Phuket\ntm_shape(phuket) + \n  tm_polygons() +\n  tm_text(\"ADM1_EN\", size = 1.2)  # Show province name if desired\n\n\n\n\n\n\ntmap_mode('plot')\n\ntmap mode set to plotting\n\n\nUse spdep to identify the neighbours list of Phuket\n\nlongitude &lt;- map_dbl(thailand$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude &lt;- map_dbl(thailand$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\nhead(coords)\n\n     longitude latitude\n[1,] 1115483.2  1765518\n[2,]  645239.0  1617118\n[3,]  675514.6  1523087\n[4,]  998785.3  2013040\n[5,]  925999.3  1642136\n[6,]  762475.6  1505514\n\n\n\nlibrary(spdep)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\n\nAttaching package: 'spData'\n\n\nThe following object is masked _by_ '.GlobalEnv':\n\n    coords\n\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  21548   51966   64530   63281   76823  110987 \n\n\nThe summary report shows that the largest first nearest neighbour distance is 11.0987 km\n\nwm_d120000 &lt;- dnearneigh(coords, 0, 120000)\nwm_d120000\n\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 412 \nPercentage nonzero weights: 6.948895 \nAverage number of links: 5.350649 \n2 disjoint connected subgraphs\n\n\n\nstr(wm_d120000)\n\nList of 77\n $ : int [1:4] 25 54 72 77\n $ : int [1:13] 3 7 22 26 27 30 36 37 46 58 ...\n $ : int [1:14] 2 6 12 26 27 36 37 46 49 52 ...\n $ : int [1:3] 28 35 56\n $ : int [1:2] 29 68\n $ : int [1:10] 3 9 12 26 36 37 49 53 55 57\n $ : int [1:7] 2 22 30 46 63 66 74\n $ : int [1:2] 17 42\n $ : int [1:5] 6 12 53 55 71\n $ : int [1:3] 19 20 23\n $ : int 41\n $ : int [1:10] 3 6 9 26 36 37 49 53 57 58\n $ : int 51\n $ : int [1:7] 17 24 25 54 56 73 77\n $ : int [1:5] 30 44 65 69 74\n $ : int [1:2] 66 74\n $ : int [1:5] 8 14 24 34 73\n $ : int [1:5] 31 39 48 67 70\n $ : int [1:4] 10 20 47 65\n $ : int [1:3] 10 19 47\n $ : int 34\n $ : int [1:8] 2 7 26 30 37 46 60 63\n $ : int 10\n $ : int [1:3] 14 17 54\n $ : int [1:6] 1 14 28 54 56 77\n $ : int [1:13] 2 3 6 12 22 27 36 37 46 49 ...\n $ : int [1:12] 2 3 26 36 37 46 52 57 58 59 ...\n $ : int [1:3] 4 25 56\n $ : int [1:2] 5 49\n $ : int [1:7] 2 7 15 22 44 63 74\n $ : int [1:4] 18 40 67 70\n $ : int [1:2] 41 47\n $ : int [1:2] 38 76\n $ : int [1:4] 17 21 35 73\n $ : int [1:3] 4 34 73\n $ : int [1:15] 2 3 6 12 26 27 37 46 52 57 ...\n $ : int [1:16] 2 3 6 12 22 26 27 36 46 49 ...\n $ : int [1:3] 33 64 76\n $ : int [1:3] 18 48 67\n $ : int [1:4] 31 61 64 70\n $ : int [1:3] 11 32 47\n $ : int [1:3] 8 44 45\n $ : int [1:4] 50 52 58 59\n $ : int [1:4] 15 30 42 45\n $ : int [1:4] 42 44 65 75\n $ : int [1:13] 2 3 7 22 26 27 36 37 57 58 ...\n $ : int [1:6] 19 20 32 41 65 75\n $ : int [1:2] 18 39\n $ : int [1:9] 3 6 12 26 29 37 55 57 60\n $ : int 43\n $ : int [1:2] 13 67\n $ : int [1:6] 3 27 36 43 58 59\n $ : int [1:4] 6 9 12 57\n $ : int [1:6] 1 14 24 25 68 77\n $ : int [1:3] 6 9 49\n $ : int [1:5] 4 14 25 28 73\n $ : int [1:13] 3 6 12 26 27 36 37 46 49 53 ...\n $ : int [1:11] 2 3 12 27 36 37 43 46 52 57 ...\n $ : int [1:8] 3 27 36 37 43 52 57 58\n $ : int [1:10] 2 3 22 26 36 37 46 49 57 63\n $ : int [1:3] 40 64 70\n $ : int [1:3] 68 72 77\n $ : int [1:12] 2 7 22 26 27 30 36 37 46 60 ...\n $ : int [1:4] 38 40 61 76\n $ : int [1:6] 15 19 45 47 69 75\n $ : int [1:9] 2 7 16 27 36 37 46 63 74\n $ : int [1:4] 18 31 39 51\n $ : int [1:3] 5 54 62\n $ : int [1:2] 15 65\n $ : int [1:4] 18 31 40 61\n $ : int 9\n $ : int [1:3] 1 62 77\n $ : int [1:5] 14 17 34 35 56\n $ : int [1:6] 7 15 16 30 63 66\n $ : int [1:3] 45 47 65\n $ : int [1:3] 33 38 64\n $ : int [1:6] 1 14 25 54 62 72\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:77] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language dnearneigh(x = coords, d1 = 0, d2 = 120000)\n - attr(*, \"dnn\")= num [1:2] 0 120000\n - attr(*, \"bounds\")= chr [1:2] \"GE\" \"LE\"\n - attr(*, \"nbtype\")= chr \"distance\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\ntable(thailand$ADM1_EN, card(wm_d120000))\n\n                          \n                           1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16\n  Amnat Charoen            0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Ang Thong                0 0 0 0 0 0 0 0 0  0  0  0  1  0  0  0\n  Bangkok                  0 0 0 0 0 0 0 0 0  0  0  0  0  1  0  0\n  Bueng Kan                0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Buriram                  0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Chachoengsao             0 0 0 0 0 0 0 0 0  1  0  0  0  0  0  0\n  Chainat                  0 0 0 0 0 0 1 0 0  0  0  0  0  0  0  0\n  Chaiyaphum               0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Chanthaburi              0 0 0 0 1 0 0 0 0  0  0  0  0  0  0  0\n  Chiang Mai               0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Chiang Rai               1 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Chonburi                 0 0 0 0 0 0 0 0 0  1  0  0  0  0  0  0\n  Chumphon                 1 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Kalasin                  0 0 0 0 0 0 1 0 0  0  0  0  0  0  0  0\n  Kamphaeng Phet           0 0 0 0 1 0 0 0 0  0  0  0  0  0  0  0\n  Kanchanaburi             0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Khon Kaen                0 0 0 0 1 0 0 0 0  0  0  0  0  0  0  0\n  Krabi                    0 0 0 0 1 0 0 0 0  0  0  0  0  0  0  0\n  Lampang                  0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Lamphun                  0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Loei                     1 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Lopburi                  0 0 0 0 0 0 0 1 0  0  0  0  0  0  0  0\n  Mae Hong Son             1 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Maha Sarakham            0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Mukdahan                 0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n  Nakhon Nayok             0 0 0 0 0 0 0 0 0  0  0  0  1  0  0  0\n  Nakhon Pathom            0 0 0 0 0 0 0 0 0  0  0  1  0  0  0  0\n  Nakhon Phanom            0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Nakhon Ratchasima        0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Nakhon Sawan             0 0 0 0 0 0 1 0 0  0  0  0  0  0  0  0\n  Nakhon Si Thammarat      0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Nan                      0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Narathiwat               0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Nong Bua Lamphu          0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Nong Khai                0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Nonthaburi               0 0 0 0 0 0 0 0 0  0  0  0  0  0  1  0\n  Pathum Thani             0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  1\n  Pattani                  0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Phang Nga                0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Phatthalung              0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Phayao                   0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Phetchabun               0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Phetchaburi              0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Phichit                  0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Phitsanulok              0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Phra Nakhon Si Ayutthaya 0 0 0 0 0 0 0 0 0  0  0  0  1  0  0  0\n  Phrae                    0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n  Phuket                   0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Prachinburi              0 0 0 0 0 0 0 0 1  0  0  0  0  0  0  0\n  Prachuap Khiri Khan      1 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Ranong                   0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Ratchaburi               0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n  Rayong                   0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Roi Et                   0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n  Sa Kaeo                  0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Sakon Nakhon             0 0 0 0 1 0 0 0 0  0  0  0  0  0  0  0\n  Samut Prakan             0 0 0 0 0 0 0 0 0  0  0  0  1  0  0  0\n  Samut Sakhon             0 0 0 0 0 0 0 0 0  0  1  0  0  0  0  0\n  Samut Songkhram          0 0 0 0 0 0 0 1 0  0  0  0  0  0  0  0\n  Saraburi                 0 0 0 0 0 0 0 0 0  1  0  0  0  0  0  0\n  Satun                    0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Sing Buri                0 0 0 0 0 0 0 0 0  0  0  1  0  0  0  0\n  Sisaket                  0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Songkhla                 0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Sukhothai                0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n  Suphan Buri              0 0 0 0 0 0 0 0 1  0  0  0  0  0  0  0\n  Surat Thani              0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Surin                    0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Tak                      0 1 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Trang                    0 0 0 1 0 0 0 0 0  0  0  0  0  0  0  0\n  Trat                     1 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Ubon Ratchathani         0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Udon Thani               0 0 0 0 1 0 0 0 0  0  0  0  0  0  0  0\n  Uthai Thani              0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n  Uttaradit                0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Yala                     0 0 1 0 0 0 0 0 0  0  0  0  0  0  0  0\n  Yasothon                 0 0 0 0 0 1 0 0 0  0  0  0  0  0  0  0\n\n\n\nn_comp &lt;- n.comp.nb(wm_d120000)\nn_comp$nc\n\n[1] 2\n\n\n\ntable(n_comp$comp.id)\n\n\n 1  2 \n63 14 \n\n\n\nplot(thailand$geometry, border=\"lightgrey\")\nplot(wm_d120000, coords, add=TRUE)\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\n\n\n\n\n\n\n\n\nFind neighbor list and weights for Phuket, First we identify the index of Phuket.\n\n# Find the index of Phuket\nphuket_index &lt;- which(wm_q$ADM1_EN == \"Phuket\")\nprint(phuket_index)\n\n[1] 48\n\n\nIdentify the neighbor list for Phuket, Based on the results, there 2 two neighbours.\n\n# Access the neighbor list for Phuket\nphuket_nb &lt;- wm_d120000[[phuket_index]]\nprint(phuket_nb)\n\n[1] 18 39\n\n\nWe modify Phuket weight matrix and neighbour list in wm_q. Since we are using row standardized W matrix, the weights would be 0.5.\nDefine Phuket’s neighbors (Krabi and Phang Nga) based on distance\n\nphuket_nb &lt;- c(18, 39)  # Neighbors: Krabi and Phang Nga\n\nDefine row-standardized weights (0.5 for each neighbor)\n\nphuket_wt &lt;- c(0.5, 0.5)  # Row-standardized weights for two neighbors\n\nUpdate the wm_q sf object with these neighbors and weights for Phuket\n\nwm_q$nb[[48]] &lt;- phuket_nb  # Assign the neighbors to Phuket\nwm_q$wt[[48]] &lt;- phuket_wt  # Assign the row-standardized weights\n\nVerify the updated values for Phuket\n\nprint(wm_q$nb[[48]])\n\n[1] 18 39\n\nprint(wm_q$wt[[48]])\n\n[1] 0.5 0.5\n\n\nCheck the structure of the neighbors list for the first few regions. It shows that ‘nb’ is integer vector of indices.\n\n# Check the structure of the neighbors list for the first few regions\nstr(wm_q$nb[1:5])\n\nList of 5\n $ : int [1:3] 25 72 77\n $ : int [1:4] 22 46 63 66\n $ : int [1:6] 6 27 36 37 57 58\n $ : int [1:3] 28 35 56\n $ : int [1:5] 17 24 29 55 68\n\n\nCheck the structure of the weights list for the first few regions. It shows that ‘wt’ is numeric vector of weights.\n\nstr(wm_q$wt[1:5])\n\nList of 5\n $ : num [1:3] 0.333 0.333 0.333\n $ : num [1:4] 0.25 0.25 0.25 0.25\n $ : num [1:6] 0.167 0.167 0.167 0.167 0.167 ...\n $ : num [1:3] 0.333 0.333 0.333\n $ : num [1:5] 0.2 0.2 0.2 0.2 0.2\n\n\nEnsure that ‘nb’ for Phuket is an integer vector of indices (neighbors) and ‘wt’ for Phuket is a numeric vector of weights\n\nwm_q$nb[[48]] &lt;- as.integer(c(18, 39))  \n\nwm_q$wt[[48]] &lt;- as.numeric(c(0.5, 0.5)) \n\n\n\nPerforming Global Moran’s I test\nPerform Global Moran’s I test for total_no_tourist_all\n\nglobal_moran_test(wm_q$total_no_tourist_all,\n                        wm_q$nb,\n                        wm_q$wt,\n              )\n\n\n    Moran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = 0.236, p-value = 0.4067\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.001656396      -0.013157895       0.002375215 \n\n\nHypotheses for Moran’s I test:\nNull Hypothesis (H0): There is no spatial autocorrelation. The spatial pattern of the variable is random.\nAlternative Hypothesis (H1): There is positive spatial autocorrelation. Neighboring regions have similar values.\nIn this case, the Moran’s I statistic is −0.001656396 which is very close to zero. This suggests that there is no significant spatial autocorrelation in the variable total_no_tourist_all\np-value: The p-value is 0.4067, which is greater than the typical significance level (0.05). This means we fail to reject the null hypothesis. In other words, there is no evidence of significant spatial autocorrelation in the data.\nPerform Global Moran’s I test for total_revenue_all\n\nglobal_moran_test(wm_q$total_revenue_all,\n                        wm_q$nb,\n                        wm_q$wt,\n              )\n\n\n    Moran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = -0.19016, p-value = 0.5754\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     -0.022433968      -0.013157895       0.002379562 \n\n\nHypotheses for Moran’s I test:\nNull Hypothesis (H0): There is no spatial autocorrelation. The spatial pattern of the variable is random.\nAlternative Hypothesis (H1): There is positive spatial autocorrelation. Neighboring regions have similar values.\nMoran’s I statistic: The Moran’s I value of −0.0224 is close to zero. This suggests that there is no significant spatial autocorrelation in the variable total_revenue_all, meaning that the values across different regions are distributed randomly.\np-value: The p-value is 0.5754, which is greater than the typical significance level (0.05). This means we fail to reject the null hypothesis. In other words, there is no evidence of significant spatial autocorrelation in the data.\nPerform Global Moran’s I permutation test for variable total_no_tourist_all\n\nset.seed(1234)\nglobal_moran_perm(wm_q$total_no_tourist_all,\n                        wm_q$nb,\n                        wm_q$wt,\n                  nsim = 99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = -0.0016564, observed rank = 68, p-value = 0.64\nalternative hypothesis: two.sided\n\n\nThe Monte-Carlo simulation of Moran’s I test confirms the previous result that there is no significant spatial autocorrelation in the total_no_tourist_all variable.\nPerform Global Moran’s I permutation test for variable total_revenue_all\n\nset.seed(1234)\nglobal_moran_perm(wm_q$total_revenue_all,\n                        wm_q$nb,\n                        wm_q$wt,\n                  nsim = 99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = -0.022434, observed rank = 65, p-value = 0.7\nalternative hypothesis: two.sided\n\n\nThe Monte-Carlo simulation of Moran’s I test confirms the previous result that there is no significant spatial autocorrelation in the total_revenue_all variable.\n##7 Local Spatial Autocorrelation\n\n\nLISA Map\nComputing local Moran’s I of variable total_no_tourist_all\n\nlisa_tourist &lt;- wm_q %&gt;%\n  mutate(local_moran=local_moran(\n    total_no_tourist_all, nb,wt,nsim=99),\n    .before = 1) %&gt;%\n  unnest(local_moran)\n\nComputing local Moran’s I of variable total_revenue_all\n\nlisa_revenue &lt;- wm_q %&gt;%\n  mutate(local_moran=local_moran(\n    total_revenue_all, nb,wt,nsim=99),\n    .before = 1) %&gt;%\n  unnest(local_moran)\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nVisualizing local Moran’s I statistics\n\nmap1 &lt;- tm_shape(lisa_tourist) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of total tourist\",\n    main.title.size = 0.8\n  )\n\nmap2 &lt;- tm_shape(lisa_revenue) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of total revenue\",\n    main.title.size = 0.8\n  )\ntmap_arrange(map1,map2,ncol=2)\n\n\n\n\n\n\n\n\nVisualizing p-value of local Moran’s I\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nmap1 &lt;- tm_shape(lisa_tourist) +\n  tm_fill(\"p_ii_sim\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"p-value of Moran's I of total tourist\",\n    main.title.size = 0.5\n  )\n\nmap2 &lt;- tm_shape(lisa_revenue) +\n  tm_fill(\"p_ii_sim\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"p-value of Moran's I of total revenue\",\n    main.title.size = 0.5\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\n\n\n\n\n\n\n\nVisualizing local Moran’s I and p-value of variable total_no_tourist_all\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nmap1 &lt;- tm_shape(lisa_tourist) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of total tourist\",\n    main.title.size = 1\n  )\n\nmap2 &lt;- tm_shape(lisa_tourist) +\n  tm_fill(\"p_ii\", breaks = c(0,0.001,0.01,0.05,1),labels = c(\"0.001\",\"0.01\",\"0.05\",\"Not Sig\")) +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"p-value of Moran's I of total tourist\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\n\n\n\n\n\n\n\nBangkok and its neighboring regions show significant negative spatial autocorrelation, meaning Bangkok’s total revenue is much higher than nearby provinces. This clustering is statistically significant.\nIn most other regions (in red on the p-value map), the spatial autocorrelation is not statistically significant, meaning that no strong clustering patterns of total revenue are detected in these areas.\nVisualizing local Moran’s I and p-value of variable total_revenue_all\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nmap1 &lt;- tm_shape(lisa_revenue) +\n  tm_fill(\"ii\") +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"local Moran's I of total revenue\",\n    main.title.size = 1\n  )\n\nmap2 &lt;- tm_shape(lisa_revenue) +\n  tm_fill(\"p_ii\", breaks = c(0,0.001,0.01,0.05,1),labels = c(\"0.001\",\"0.01\",\"0.05\",\"Not Sig\")) +\n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) + \n  tm_layout(\n    main.title = \"p-value of Moran's I of total revenue\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\n\n\n\n\n\n\n\nPlotting LISA map for both variable total_no_tourist_all and total_revenue_all\n\nlisa_tourist_sig &lt;- lisa_tourist  %&gt;%\n  filter(p_ii_sim &lt; 0.05)\n\n\nlisa_revenue_sig &lt;- lisa_revenue  %&gt;%\n  filter(p_ii_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nmap1 &lt;- tm_shape(lisa_tourist) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_tourist_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4) +\n    tm_layout(\n    main.title = \"LISA of total tourist\",\n    main.title.size = 1\n  )\n\nmap2 &lt;- tm_shape(lisa_revenue) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_revenue_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4) + tm_layout(\n    main.title = \"LISA of total revenue\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\n\n\n\n\n\n\n\nHigh-High (Red): These are areas where high values are surrounded by high values (spatial clustering of high values).\nLow-Low (Blue-Green): These areas have low values surrounded by other low values (spatial clustering of low values).\nLow-High (Pink): Areas with low values surrounded by high values (spatial outliers).\n\n\nHot Spot and Cold Spot Area Analysis (HCSA)\nComputing local GI* statistics\n\nwm_idw &lt;- thailand %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wts = st_inverse_distance(nb, \n                              geometry, \n                              scale = 1,\n                              alpha = 1),\n         .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\nComputing local GI* statistics of variable total_no_tourist_all\n\nHCSA_tourist &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    total_no_tourist_all, nb, wts, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA_tourist\n\nSimple feature collection with 77 features and 23 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 77 × 24\n   gi_star cluster     e_gi   var_gi std_dev p_value p_sim p_folded_sim skewness\n     &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1 -0.541  Low      5.11e-7 2.53e-13 -0.528  0.598    0.44         0.22    4.15 \n 2  0.208  Low      1.31e-6 1.65e-12  0.159  0.873    0.38         0.19    3.02 \n 3 -0.356  High     1.63e-6 5.60e-13 -0.261  0.794    0.98         0.49    0.916\n 4 -0.432  Low      4.80e-7 3.34e-13 -0.376  0.707    0.74         0.37    3.55 \n 5 -0.0869 Low      5.67e-7 1.72e-13 -0.0429 0.966    0.72         0.36    2.06 \n 6  2.48   High     1.19e-6 4.55e-13  3.08   0.00206  0.04         0.02    2.14 \n 7 -0.604  Low      9.41e-7 6.79e-13 -0.601  0.548    0.38         0.19    3.19 \n 8  0.432  Low      5.15e-7 1.69e-13  0.383  0.702    0.44         0.22    2.95 \n 9  0.693  Low      7.69e-7 3.41e-13  0.563  0.573    0.28         0.14    2.43 \n10 -0.585  High     5.85e-7 1.94e-13 -0.638  0.523    0.5          0.25    2.57 \n# ℹ 67 more rows\n# ℹ 15 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, Shape_Leng &lt;dbl&gt;,\n#   Shape_Area &lt;dbl&gt;, ADM1_EN &lt;chr&gt;, covid_period_no_tourist_all &lt;dbl&gt;,\n#   covid_period_revenue_all &lt;dbl&gt;, post_covid_no_tourist_all &lt;dbl&gt;,\n#   post_covid_revenue_all &lt;dbl&gt;, pre_covid_no_tourist_all &lt;dbl&gt;,\n#   pre_covid_revenue_all &lt;dbl&gt;, total_no_tourist_all &lt;dbl&gt;,\n#   total_revenue_all &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;\n\n\nComputing local GI* statistics of variable total_revenue\n\nHCSA_revenue &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    total_revenue_all, nb, wts, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA_revenue\n\nSimple feature collection with 77 features and 23 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 77 × 24\n   gi_star cluster     e_gi   var_gi std_dev p_value p_sim p_folded_sim skewness\n     &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;\n 1  -0.434 Low      5.50e-7 1.18e-12  -0.448  0.654   0.14         0.07     3.93\n 2  -0.387 Low      1.21e-6 4.98e-12  -0.371  0.711   0.74         0.37     4.68\n 3  -0.533 High     1.18e-6 1.72e-12  -0.647  0.518   0.32         0.16     2.14\n 4  -0.420 Low      5.54e-7 1.13e-12  -0.458  0.647   0.42         0.21     3.10\n 5  -0.416 Low      5.73e-7 8.79e-13  -0.406  0.685   0.8          0.4      2.98\n 6   2.40  Low      1.32e-6 2.72e-12   2.25   0.0243  0.16         0.08     2.20\n 7  -0.509 Low      7.25e-7 1.77e-12  -0.462  0.644   0.2          0.1      4.17\n 8  -0.291 Low      4.64e-7 6.96e-13  -0.265  0.791   0.78         0.39     3.17\n 9   0.440 Low      7.54e-7 1.80e-12   0.324  0.746   0.36         0.18     4.07\n10  -0.410 High     4.72e-7 5.88e-13  -0.361  0.718   0.9          0.45     3.51\n# ℹ 67 more rows\n# ℹ 15 more variables: kurtosis &lt;dbl&gt;, nb &lt;nb&gt;, wts &lt;list&gt;, Shape_Leng &lt;dbl&gt;,\n#   Shape_Area &lt;dbl&gt;, ADM1_EN &lt;chr&gt;, covid_period_no_tourist_all &lt;dbl&gt;,\n#   covid_period_revenue_all &lt;dbl&gt;, post_covid_no_tourist_all &lt;dbl&gt;,\n#   post_covid_revenue_all &lt;dbl&gt;, pre_covid_no_tourist_all &lt;dbl&gt;,\n#   pre_covid_revenue_all &lt;dbl&gt;, total_no_tourist_all &lt;dbl&gt;,\n#   total_revenue_all &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;\n\n\nVisualizing Gi*\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\n#| warning: false\n#| message: false\nmap1 &lt;- tm_shape(HCSA_tourist) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n    tm_borders(alpha = 0.4) + tm_layout(\n    main.title = \"Total tourist\",\n    main.title.size = 1\n  )\n\n\nmap2 &lt;- tm_shape(HCSA_revenue) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))+\n    tm_borders(alpha = 0.4) + tm_layout(\n    main.title = \"Total revenue\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nGi-star values range from low to high. High values indicate spatial clustering of high values (hot spots), and low values indicate spatial clustering of low values (cold spots).\nVisualizing p-value of HCSA\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\n#| warning: false\n#| message: false\nmap1 &lt;- tm_shape(HCSA_tourist) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n    tm_borders(alpha = 0.4) + tm_layout(\n    main.title = \"Total tourist\",\n    main.title.size = 1\n  )\n\n\nmap2 &lt;- tm_shape(HCSA_revenue) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))+\n    tm_borders(alpha = 0.4) + tm_layout(\n    main.title = \"Total revenue\",\n    main.title.size = 1\n  )\n\ntmap_arrange(map1,map2,ncol=2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n\nLow p-values indicating significant clustering of high or low values (either a hotspot or cold spot).\nVisualizing local HCSA\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nmap1 &lt;- tm_shape(HCSA_tourist) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"Gi* of total revenue\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(HCSA_tourist) +\n  tm_fill(\"p_value\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of Gi*\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n#| warning: false\n#| message: false\nmap1 &lt;- tm_shape(HCSA_revenue) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"Gi* of total revenue\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(HCSA_revenue) +\n  tm_fill(\"p_value\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of Gi*\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\nVisualizing hot spot and cold spot areas\n\nHCSA_sig_tourist &lt;- HCSA_tourist  %&gt;%\n  filter(p_sim &lt; 0.05)\n\n\nHCSA_sig_revenue &lt;- HCSA_revenue  %&gt;%\n  filter(p_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nmap1 &lt;- tm_shape(HCSA_tourist) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig_tourist) +\n  tm_fill(\"cluster\") + \n  tm_borders(alpha = 0.4) +\n  tm_layout(main.title = \"Hot spot and cold spot areas of tourist\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(HCSA_revenue) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig_revenue) +\n  tm_fill(\"cluster\") + \n  tm_borders(alpha = 0.4) +\n  tm_layout(main.title = \"Hot spot and cold spot areas of revenue\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\n\n\n\n\nThese regions represent coldspots. A coldspot indicates significant clustering of low values. These areas tend to have lower activity or lower values for the measured variable."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#emerging-hot-spot-analysis",
    "href": "Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html#emerging-hot-spot-analysis",
    "title": "Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics",
    "section": "8 Emerging Hot Spot Analysis",
    "text": "8 Emerging Hot Spot Analysis\n\npacman::p_load(sf, sfdep, tmap, plotly, tidyverse,Kendall)\n\n\nData Wrangling\nSegregate attribute data into 3 periods: Pre-covid, covid_period, post_covid\nChange the month_year in filtered_data as integer in the new column month_year_numeric\n\n# Create a new column with format 'YYYYMM' as an integer\nfiltered_data &lt;- filtered_data %&gt;%\n  mutate(month_year_numeric = as.integer(format(as.Date(month_year_date), \"%Y%m\")))\n\n# View the updated data\nhead(filtered_data)\n\n# A tibble: 6 × 9\n  province_eng        month_year variable  value month_year_date      year month\n  &lt;chr&gt;               &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;\n1 Bangkok             Jan-2019   no_tour… 5.96e6 2019-01-01 00:00:00  2019     1\n2 Lopburi             Jan-2019   no_tour… 2.69e5 2019-01-01 00:00:00  2019     1\n3 Phra Nakhon Si Ayu… Jan-2019   no_tour… 7.30e5 2019-01-01 00:00:00  2019     1\n4 Saraburi            Jan-2019   no_tour… 2.07e5 2019-01-01 00:00:00  2019     1\n5 Chainat             Jan-2019   no_tour… 7.91e4 2019-01-01 00:00:00  2019     1\n6 Nakhon Pathom       Jan-2019   no_tour… 2.96e5 2019-01-01 00:00:00  2019     1\n# ℹ 2 more variables: covid_period &lt;chr&gt;, month_year_numeric &lt;int&gt;\n\n\nRename the column province_eng to ADM1_EN\n\n# Rename 'province_eng' to 'ADM1_EN'\nfiltered_data &lt;- filtered_data %&gt;%\n  rename(ADM1_EN = province_eng)\n\n# View the updated dataset\nhead(filtered_data)\n\n# A tibble: 6 × 9\n  ADM1_EN             month_year variable  value month_year_date      year month\n  &lt;chr&gt;               &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;\n1 Bangkok             Jan-2019   no_tour… 5.96e6 2019-01-01 00:00:00  2019     1\n2 Lopburi             Jan-2019   no_tour… 2.69e5 2019-01-01 00:00:00  2019     1\n3 Phra Nakhon Si Ayu… Jan-2019   no_tour… 7.30e5 2019-01-01 00:00:00  2019     1\n4 Saraburi            Jan-2019   no_tour… 2.07e5 2019-01-01 00:00:00  2019     1\n5 Chainat             Jan-2019   no_tour… 7.91e4 2019-01-01 00:00:00  2019     1\n6 Nakhon Pathom       Jan-2019   no_tour… 2.96e5 2019-01-01 00:00:00  2019     1\n# ℹ 2 more variables: covid_period &lt;chr&gt;, month_year_numeric &lt;int&gt;\n\n\nFilter the data based on no_tourist_all and revenue_all Create the time series cube\n\ntourist_pre_covid &lt;- filtered_data %&gt;%\n  filter(variable == \"no_tourist_all\", covid_period == \"pre_covid\")\n\ntourist_covid_period &lt;- filtered_data %&gt;%\n  filter(variable == \"no_tourist_all\", covid_period == \"covid_period\")\n\ntourist_post_covid &lt;- filtered_data %&gt;%\n  filter(variable == \"no_tourist_all\", covid_period == \"post_covid\")\n\n# Revenue-related datasets\nrevenue_pre_covid &lt;- filtered_data %&gt;%\n  filter(variable == \"revenue_all\", covid_period == \"pre_covid\")\n\nrevenue_covid_period &lt;- filtered_data %&gt;%\n  filter(variable == \"revenue_all\", covid_period == \"covid_period\")\n\nrevenue_post_covid &lt;- filtered_data %&gt;%\n  filter(variable == \"revenue_all\", covid_period == \"post_covid\")\n\n\ntourist_pre_covid_st &lt;- spacetime(tourist_pre_covid, thailand_32647_sorted,\n                      .loc_col = \"ADM1_EN\",\n                      .time_col = \"month_year_numeric\")\n\ntourist_covid_period_st &lt;- spacetime(tourist_covid_period, thailand_32647_sorted,\n                      .loc_col = \"ADM1_EN\",\n                      .time_col = \"month_year_numeric\")\n\ntourist_post_covid_st &lt;- spacetime(tourist_post_covid, thailand_32647_sorted,\n                      .loc_col = \"ADM1_EN\",\n                      .time_col = \"month_year_numeric\")\n\nis_spacetime_cube(tourist_pre_covid_st)\n\n[1] TRUE\n\nis_spacetime_cube(tourist_covid_period_st)\n\n[1] TRUE\n\nis_spacetime_cube(tourist_post_covid_st)\n\n[1] TRUE\n\n\n\nrevenue_pre_covid_st &lt;- spacetime(revenue_pre_covid, thailand_32647_sorted,\n                      .loc_col = \"ADM1_EN\",\n                      .time_col = \"month_year_numeric\")\n\nrevenue_covid_period_st &lt;- spacetime(revenue_covid_period, thailand_32647_sorted,\n                      .loc_col = \"ADM1_EN\",\n                      .time_col = \"month_year_numeric\")\n\nrevenue_post_covid_st &lt;- spacetime(revenue_post_covid, thailand_32647_sorted,\n                      .loc_col = \"ADM1_EN\",\n                      .time_col = \"month_year_numeric\")\n\nis_spacetime_cube(revenue_pre_covid_st)\n\n[1] TRUE\n\nis_spacetime_cube(revenue_covid_period_st)\n\n[1] TRUE\n\nis_spacetime_cube(revenue_post_covid_st)\n\n[1] TRUE\n\n\n\n\nEmerging Hot Spot Analysis: Tourist Variable\nComputing Computing Gi*\nDeriving the spatial weights\n\ntourist_pre_covid_nb &lt;- tourist_pre_covid_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb, \n                             geometry, \n                             scale = 1,\n                             alpha = 1),\n    .before = 1) %&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\ntourist_covid_period_nb &lt;- tourist_covid_period_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb, \n                             geometry, \n                             scale = 1,\n                             alpha = 1),\n    .before = 1) %&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\ntourist_post_covid_nb &lt;- tourist_post_covid_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(\n    st_contiguity(geometry)),\n    wt = st_inverse_distance(nb, \n                             geometry, \n                             scale = 1,\n                             alpha = 1),\n    .before = 1) %&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\nManually calculate the local GI* for each location\n\ngi_stars_tourist_pre_covid &lt;- tourist_pre_covid_nb %&gt;% \n  group_by(month_year_numeric) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    value, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\ngi_stars_tourist_covid_period &lt;- tourist_covid_period_nb %&gt;% \n  group_by(month_year_numeric) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    value, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\ngi_stars_post_covid &lt;- tourist_post_covid_nb %&gt;% \n  group_by(month_year_numeric) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    value, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)\n\nEvaluate a location for a trend\n\ncbg_tourist_pre_covid &lt;- gi_stars_tourist_pre_covid %&gt;% \n  ungroup() %&gt;% #must ungroup because it is a cube\n  filter(ADM1_EN == \"Bangkok\") |&gt; #r version of %&gt;%  = |&gt;\n  dplyr::select(ADM1_EN, month_year_numeric, gi_star)\n\n\ncbg_tourist_covid_period &lt;- gi_stars_tourist_covid_period %&gt;% \n  ungroup() %&gt;% #must ungroup because it is a cube\n  filter(ADM1_EN == \"Bangkok\") |&gt; #r version of %&gt;%  = |&gt;\n  dplyr::select(ADM1_EN, month_year_numeric, gi_star)\n\ncbg_tourist_post_covid &lt;- gi_stars_post_covid %&gt;% \n  ungroup() %&gt;% #must ungroup because it is a cube\n  filter(ADM1_EN == \"Bangkok\") |&gt; #r version of %&gt;%  = |&gt;\n  dplyr::select(ADM1_EN, month_year_numeric, gi_star)\n\nPlot the result using ggplot2 functions\n\n#| warning: false\n#| message: false\nlibrary(patchwork)\n\n\nAttaching package: 'patchwork'\n\n\nThe following object is masked from 'package:spatstat.geom':\n\n    area\n\n\nThe following object is masked from 'package:raster':\n\n    area\n\n# Create the three ggplots\nplot1 &lt;- ggplot(data = cbg_tourist_pre_covid,\n                aes(x = month_year_numeric, y = gi_star)) +\n  geom_line() +\n  theme_light() +\n  labs(title = \"Pre-COVID\")\n\nplot2 &lt;- ggplot(data = cbg_tourist_covid_period,\n                aes(x = month_year_numeric, y = gi_star)) +\n  geom_line() +\n  theme_light() +\n  labs(title = \"COVID Period\")\n\nplot3 &lt;- ggplot(data = cbg_tourist_post_covid,\n                aes(x = month_year_numeric, y = gi_star)) +\n  geom_line() +\n  theme_light() +\n  labs(title = \"Post-COVID\")\n\n# Combine the three plots side by side using patchwork\n\n\nplot1 / plot2 / plot3\n\n\n\n\n\n\n\n\nPrinting Mann-Kendall test report\nNull Hypothesis (H₀): There is no trend in the data (no significant increase or decrease over time). Alternative Hypothesis (H₁): There is a trend in the data (either an increasing or decreasing trend over time).\n\ncbg_tourist_pre_covid %&gt;% \n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\n\n# A tibble: 1 × 5\n     tau    sl     S     D  varS\n   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 -0.152 0.537   -10  66.0  213.\n\n\np-value = 0.537: This means that the trend is not statistically significant. A high p-value suggests that the null hypothesis (no trend) cannot be rejected. Therefore, we conclude that the weak negative trend observed is likely due to chance.\n\ncbg_tourist_covid_period %&gt;% \n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\n\n# A tibble: 1 × 5\n     tau     sl     S     D  varS\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 -0.324 0.0431   -68   210 1097.\n\n\nSince the p-value is less than 0.05, this suggests that the trend is statistically significant. We can reject the null hypothesis of no trend and conclude that the negative trend observed in the data is statistically significant.\n\ncbg_tourist_post_covid %&gt;% \n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\n\n# A tibble: 1 × 5\n    tau       sl     S     D  varS\n  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.618 0.000629    84  136.  589.\n\n\nThe p-value is very small, well below 0.05, which indicates that the trend is highly statistically significant. We can confidently reject the null hypothesis of no trend and conclude that the positive trend observed in the data is statistically significant.\nApply the Mann-Kendall test for trend detection on the Gi* values for each province over time.\n\nehsa_tourist_pre_covid &lt;- gi_stars_tourist_pre_covid %&gt;% \n  group_by(ADM1_EN) %&gt;% #because 88 counties and observations\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr:: unnest_wider(mk)\nhead(ehsa_tourist_pre_covid)\n\n# A tibble: 6 × 6\n  ADM1_EN           tau     sl     S     D  varS\n  &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Amnat Charoen  0.0606 0.837      4  66.0  213.\n2 Ang Thong      0.364  0.115     24  66.0  213.\n3 Bangkok       -0.152  0.537    -10  66.0  213.\n4 Bueng Kan      0.0606 0.837      4  66.0  213.\n5 Buriram       -0.394  0.0865   -26  66.0  213.\n6 Chachoengsao  -0.273  0.244    -18  66.0  213.\n\n\nSort the data based on the statistical significance and the strength of trends\n\nemerging_tourist_pre_covid &lt;- ehsa_tourist_pre_covid %&gt;% \n  arrange(sl, abs(tau)) %&gt;% \n  slice(1:10)\nhead(emerging_tourist_pre_covid)\n\n# A tibble: 6 × 6\n  ADM1_EN            tau      sl     S     D  varS\n  &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Nong Bua Lamphu  0.727 0.00127    48  66.0  213.\n2 Suphan Buri      0.727 0.00127    48  66.0  213.\n3 Uthai Thani      0.727 0.00127    48  66.0  213.\n4 Kanchanaburi     0.667 0.00319    44  66.0  213.\n5 Samut Songkhram  0.667 0.00319    44  66.0  213.\n6 Surat Thani     -0.667 0.00319   -44  66.0  213.\n\n\nPerform Emerging hotspot analysis of tourist\n\nehsa_tourist_pre_covid &lt;- emerging_hotspot_analysis(\n  x = tourist_pre_covid_st,\n  .var = \"value\",\n  k = 1,\n  nsim = 99\n)\n\n\nehsa_tourist_covid_period &lt;- emerging_hotspot_analysis(\n  x = tourist_covid_period_st,\n  .var = \"value\",\n  k = 1,\n  nsim = 99\n)\n\n\nehsa_tourist_post_covid &lt;- emerging_hotspot_analysis(\n  x = tourist_post_covid_st,\n  .var = \"value\",\n  k = 1,\n  nsim = 99\n)\n\nPlot the classifications\n\nplot1 &lt;- ggplot(data=ehsa_tourist_pre_covid,\n       aes(x=classification)) +\n  geom_bar()+\n  theme_light() +\n  labs(title = \"Pre-COVID\")\n\nplot2 &lt;- ggplot(data=ehsa_tourist_covid_period,\n       aes(x=classification)) +\n  geom_bar()+\n  theme_light() +\n  labs(title = \"COVID Period\")\n\nplot3 &lt;- ggplot(data=ehsa_tourist_post_covid,\n       aes(x=classification)) +\n  geom_bar()+\n  theme_light() +\n  labs(title = \"Post COVID\")\n\n\nplot1 / plot2 / plot3\n\n\n\n\n\n\n\n\nJoin both thailand_32647_sorted and ehsa to visualize the geographic distribution of EHSA classes.\n\ntourist_pre_covid_ehsa &lt;- thailand_32647_sorted %&gt;% \n  left_join(ehsa_tourist_pre_covid,\n            by = join_by(ADM1_EN == location))\n\n\ntourist_covid_period_ehsa &lt;- thailand_32647_sorted %&gt;% \n  left_join(ehsa_tourist_covid_period,\n            by = join_by(ADM1_EN == location))\n\ntourist_post_covid_ehsa &lt;- thailand_32647_sorted %&gt;% \n  left_join(ehsa_tourist_post_covid,\n            by = join_by(ADM1_EN == location))\n\n\nehsa_tourist_pre_covid_sig &lt;- tourist_pre_covid_ehsa%&gt;%\n  filter(p_value &lt; 0.05)\n\nehsa_tourist_covid_period_sig &lt;- tourist_covid_period_ehsa%&gt;%\n  filter(p_value &lt; 0.05)\n\nehsa_tourist_post_covid_sig &lt;- tourist_post_covid_ehsa%&gt;%\n  filter(p_value &lt; 0.05)\n\ntmap_mode(\"plot\")\n\nVisualizing EHSA\n\nmap1 &lt;- tm_shape(tourist_pre_covid_ehsa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_tourist_pre_covid_sig) +\n  tm_fill(\"classification\")+\n  tm_borders(alpha = 0.4)+\n  tm_layout(main.title = \"Pre-covid\",\n            main.title.size = 0.8)\n  \nmap2 &lt;- tm_shape(tourist_covid_period_ehsa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_tourist_covid_period_sig) +\n  tm_fill(\"classification\") + \n  tm_borders(alpha = 0.4) + \n  tm_layout(main.title = \"Covid period\",\n            main.title.size = 0.8)\n\n\nmap3 &lt;- tm_shape(tourist_post_covid_ehsa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_tourist_post_covid_sig) +\n  tm_fill(\"classification\") + \n  tm_borders(alpha = 0.4) +\n  tm_layout(main.title = \"Post-covid\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2,map3, ncol = 3)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex07/Hands-on_ex07.html",
    "href": "Hands-on_exercise/Hands-on_ex07/Hands-on_ex07.html",
    "title": "Hands-on Exercise 07",
    "section": "",
    "text": "It fits a local regression model at each location rather than a global model for the entire dataset, enabling the model to capture spatial variations in the relationships between variables.\n\n\n\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary)\n\nURA Master Plan 2014’s planning subzone boundaries\n\nmpsz = st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex07/data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex07\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)\n\n\nst_crs(mpsz_svy21)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nst_bbox(mpsz_svy21) #view extent\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334 \n\n\n\ncondo_resale = read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex07/data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n\n\nhead(condo_resale$LONGITUDE) #see the data in XCOORD column\n\n[1] 103.7802 103.8123 103.7971 103.8247 103.9505 103.9386\n\n\nNorth side of equatorial\n\nhead(condo_resale$LATITUDE) #see the data in YCOORD column\n\n[1] 1.287145 1.328698 1.313727 1.308563 1.321437 1.314198\n\n\n\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05351   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_Of_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151710   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\nconverts condo_resale data frame into simple feature data frame by using st_as_sf() st_transform() to convert the coordinates from wgs84(crs=4326) to svy21(crs-3414)\n\ncondo_resale.sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs=4326) %&gt;%\n  st_transform(crs=3414)\n\nhead() is used to list the content of cond_resale.sf object\n\nhead(condo_resale.sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_Of_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;\n\n\n\n\n\nUse histogram to show the distribution of SELLING_PRICE\n\nggplot(data=condo_resale.sf, aes(x=`SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\n\n\n\n\nNormalize using log transformation\nDerive a new variable called LOG_SELLING_PRICE\n\ncondo_resale.sf &lt;- condo_resale.sf %&gt;%\n  mutate(`LOG_SELLING_PRICE` = log(SELLING_PRICE))\n\n\nggplot(data=condo_resale.sf, aes(x=`LOG_SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\n\n\n\n\nPlot small multiple histograms, also known as trellis plot\nggarrange() is used to organize these histogram\n\nAREA_SQM &lt;- ggplot(data=condo_resale.sf, aes(x= `AREA_SQM`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nAGE &lt;- ggplot(data=condo_resale.sf, aes(x= `AGE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CBD &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CBD`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CHILDCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CHILDCARE`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_ELDERLYCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_ELDERLYCARE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_URA_GROWTH_AREA &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_URA_GROWTH_AREA`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_HAWKER_MARKET &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_HAWKER_MARKET`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_KINDERGARTEN &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_KINDERGARTEN`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_MRT &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_MRT`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PARK &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PARK`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_TOP_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_TOP_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nggarrange(AREA_SQM, AGE, PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, \n          PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN, PROX_MRT,\n          PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH,  \n          ncol = 3, nrow = 4)\n\n\n\n\n\n\n\n\nDraw statistical point map\nReview the geospatial distribution condominium resale prices in Singapore\n\ntmap_mode(\"view\") #turn on the interactive mode of tmap\n\ntmap mode set to interactive viewing\n\n\n\ntm_shape(mpsz_svy21)+tmap_options(check.and.fix = TRUE)+\n  tm_polygons() +\ntm_shape(condo_resale.sf) +  \n  tm_dots(col = \"SELLING_PRICE\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\ntmap_mode(\"plot\") #turn R display into plot mode\n\ntmap mode set to plotting\n\n\n##Hedonic Pricing Modelling in R\n\n\n\ncondo.slr &lt;- lm(formula=SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf) #SELLING_PRICE = dependent variable, AREA SQM = independent variable\n\nlm returns an object of class ‘lm’ for multiple responses of class c(“mlm”,“lm”)\nANOVA test\n\nsummary(condo.slr) #Print the Analysis of variance table of the results\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n\nSelling price = -258121.1 if the predicted value of SELLING_PRICE when the AREA_SQM is 0\nFor each additional square meter, the selling price increases by an estimated 14,719 SGD\np-value = 2e-16, indicating that the area has a highly significant effect on the selling price.\nResidual standard error 942700 is in dollars, the measure units of the dependent variable. SGD942,700 on average, the actuall selling prices differ from the model’s predictions.\n\nggplot(data=condo_resale.sf,  \n       aes(x=`AREA_SQM`, y=`SELLING_PRICE`)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\n\n\nAvoid multicollinearity\n\ncorrplot(cor(condo_resale[, 5:23]), diag = FALSE, order = \"AOE\", #parameter order = AOE, angular order of the eigenvectors\n         tl.pos = \"td\", tl.cex = 0.5, method = \"number\", type = \"upper\")\n\n\n\n\n\n\n\n\nFreehold is highly correlated to LEASE_99YEAR. Exclude LEASE_99YEAR\n\ncondo.mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE    + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n                  PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                data=condo_resale.sf)\nsummary(condo.mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3475964  -293923   -23069   241043 12260381 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           481728.40  121441.01   3.967 7.65e-05 ***\nAREA_SQM               12708.32     369.59  34.385  &lt; 2e-16 ***\nAGE                   -24440.82    2763.16  -8.845  &lt; 2e-16 ***\nPROX_CBD              -78669.78    6768.97 -11.622  &lt; 2e-16 ***\nPROX_CHILDCARE       -351617.91  109467.25  -3.212  0.00135 ** \nPROX_ELDERLYCARE      171029.42   42110.51   4.061 5.14e-05 ***\nPROX_URA_GROWTH_AREA   38474.53   12523.57   3.072  0.00217 ** \nPROX_HAWKER_MARKET     23746.10   29299.76   0.810  0.41782    \nPROX_KINDERGARTEN     147468.99   82668.87   1.784  0.07466 .  \nPROX_MRT             -314599.68   57947.44  -5.429 6.66e-08 ***\nPROX_PARK             563280.50   66551.68   8.464  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      180186.08   65237.95   2.762  0.00582 ** \nPROX_TOP_PRIMARY_SCH    2280.04   20410.43   0.112  0.91107    \nPROX_SHOPPING_MALL   -206604.06   42840.60  -4.823 1.57e-06 ***\nPROX_SUPERMARKET      -44991.80   77082.64  -0.584  0.55953    \nPROX_BUS_STOP         683121.35  138353.28   4.938 8.85e-07 ***\nNO_Of_UNITS             -231.18      89.03  -2.597  0.00951 ** \nFAMILY_FRIENDLY       140340.77   47020.55   2.985  0.00289 ** \nFREEHOLD              359913.01   49220.22   7.312 4.38e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1417 degrees of freedom\nMultiple R-squared:  0.6518,    Adjusted R-squared:  0.6474 \nF-statistic: 147.4 on 18 and 1417 DF,  p-value: &lt; 2.2e-16\n\n\nRemove those variables which are not statistically significant\n\nPROX_TOP_PRIMARY_SCH\nPROX_SUPERMARKET\nPROX_HAWKER_MARKET\nPROX_KINDERGARTEN\n\n\ncondo.mlr1 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT  + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL    + PROX_BUS_STOP + \n                   NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD,\n                 data=condo_resale.sf)\nols_regress(condo.mlr1)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.591 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n-----------------------------------------------------------------------------------------------------------------\n\n\nPrepare publication quality table: gtsummary method\n\ntbl_regression(condo.mlr1, intercept = TRUE) #tbl_regression() is used to create a well formatted regression report.\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI1\np-value\n\n\n\n\n(Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n\n\nAREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n\n\nAGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n\n\nPROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n\n\nPROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n\n\nPROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n\n\nPROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n\n\nPROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n\n\nPROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n\n\nPROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n\n\nPROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n\n\nPROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n\n\nNO_Of_UNITS\n-245\n-418, -73\n0.005\n\n\nFAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n\n\nFREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n\n\n\n1 CI = Confidence Interval\n\n\n\n\n\n\n\n\nHow to add model statistics?\nuse add_glance_table() to append to the report table use add_glance_source_note() to add as a table source\n\ntbl_regression(condo.mlr1, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n\n\n\n  \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n    AREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n    AGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n    PROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n    PROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n    PROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n    PROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n    PROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n    PROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n    PROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n    PROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n    PROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n    NO_Of_UNITS\n-245\n-418, -73\n0.005\n    FAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n    FREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n  \n  \n    \n      R² = 0.651; Adjusted R² = 0.647; AIC = 42,967; Statistic = 189; p-value = &lt;0.001; σ = 755,957\n    \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\nUse olsrr to perform OLS regression\nols_vif_tol() to test multicollinearity\n\nols_vif_tol(condo.mlr1)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_Of_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\nLess than 10 = no sign of multicollinearity\nols_plot_resid_fit() to perform linearity assumption test\n\nols_plot_resid_fit(condo.mlr1)\n\n\n\n\n\n\n\n\nData points scattered around line 0 = dependent and independent variables are linear\nols_plot_resid_hist() to perform normality assumption test\n\nols_plot_resid_hist(condo.mlr1)\n\n\n\n\n\n\n\n\nResidual of the multiple linear regression model = normal distribution\nols_test_normality() to perform formal statistical test methods\n\nols_test_normality(condo.mlr1)\n\nWarning in ks.test.default(y, \"pnorm\", mean(y), sd(y)): ties should not be\npresent for the one-sample Kolmogorov-Smirnov test\n\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n\nVisual the residual of the hedonic pricing model\nConvert condo_resale.sf from sf data frame into a SpatialPointsDataFrame\nExport residual of the hedonic pricing model and save it as a data frame.\n\nmlr.output &lt;- as.data.frame(condo.mlr1$residuals)\n\nJoin the newly created data frame with condo_resale.sf\n\ncondo_resale.res.sf &lt;- cbind(condo_resale.sf, \n                        condo.mlr1$residuals) %&gt;%\nrename(`MLR_RES` = `condo.mlr1.residuals`)\n\nConvert condo_resale.res.sf from simple feature object into a SpatialPointsDataFrame\n\ncondo_resale.sp &lt;- as_Spatial(condo_resale.res.sf)\ncondo_resale.sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1436 \nextent      : 14940.85, 43352.45, 24765.67, 48382.81  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 23\nnames       : POSTCODE, SELLING_PRICE, AREA_SQM, AGE,    PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN,    PROX_MRT,   PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH, PROX_SHOPPING_MALL, ... \nmin values  :    18965,        540000,       34,   0, 0.386916393,    0.004927023,      0.054508623,          0.214539508,        0.051817113,       0.004927023, 0.052779424, 0.029064164,      0.077106132,          0.077106132,                  0, ... \nmax values  :   828833,       1.8e+07,      619,  37, 19.18042832,     3.46572633,      3.949157205,           9.15540001,        5.374348075,       2.229045366,  3.48037319,  2.16104919,      3.928989144,          6.748192062,        3.477433767, ... \n\n\nDisplay the distribution of the residuals\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\n\n\ntm_shape(mpsz_svy21)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale.res.sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nThe map reveal that there is a sign of spatial autocorrelation.\nPerform Moran’s I test to proof.\n\nnb &lt;- dnearneigh(coordinates(condo_resale.sp), 0, 1500, longlat = FALSE)\nsummary(nb)\n\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\n\n\nnb_lw &lt;- nb2listw(nb, style = 'W')\nsummary(nb_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\nWeights style: W \nWeights constants summary:\n     n      nn   S0       S1       S2\nW 1436 2062096 1436 94.81916 5798.341\n\n\nPerform Moran’I test for residual spatial autocorrelation.\n\nlm.morantest(condo.mlr1, nb_lw)\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD +\nPROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT +\nPROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP +\nNO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, data = condo_resale.sf)\nweights: nb_lw\n\nMoran I statistic standard deviate = 24.366, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nObserved Moran I      Expectation         Variance \n    1.438876e-01    -5.487594e-03     3.758259e-05 \n\n\np-value &lt; 0.05, reject the null hypothesis\n\n\n\nFixed Bandwidth\n\nbw.fixed &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                     PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                     PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                     PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                     FAMILY_FRIENDLY + FREEHOLD, \n                   data=condo_resale.sp, \n                   approach=\"CV\", \n                   kernel=\"gaussian\", \n                   adaptive=FALSE, \n                   longlat=FALSE)\n\nFixed bandwidth: 17660.96 CV score: 8.259118e+14 \nFixed bandwidth: 10917.26 CV score: 7.970454e+14 \nFixed bandwidth: 6749.419 CV score: 7.273273e+14 \nFixed bandwidth: 4173.553 CV score: 6.300006e+14 \nFixed bandwidth: 2581.58 CV score: 5.404958e+14 \nFixed bandwidth: 1597.687 CV score: 4.857515e+14 \nFixed bandwidth: 989.6077 CV score: 4.722431e+14 \nFixed bandwidth: 613.7939 CV score: 1.378294e+16 \nFixed bandwidth: 1221.873 CV score: 4.778717e+14 \nFixed bandwidth: 846.0596 CV score: 4.791629e+14 \nFixed bandwidth: 1078.325 CV score: 4.751406e+14 \nFixed bandwidth: 934.7772 CV score: 4.72518e+14 \nFixed bandwidth: 1023.495 CV score: 4.730305e+14 \nFixed bandwidth: 968.6643 CV score: 4.721317e+14 \nFixed bandwidth: 955.7206 CV score: 4.722072e+14 \nFixed bandwidth: 976.6639 CV score: 4.721387e+14 \nFixed bandwidth: 963.7202 CV score: 4.721484e+14 \nFixed bandwidth: 971.7199 CV score: 4.721293e+14 \nFixed bandwidth: 973.6083 CV score: 4.721309e+14 \nFixed bandwidth: 970.5527 CV score: 4.721295e+14 \nFixed bandwidth: 972.4412 CV score: 4.721296e+14 \nFixed bandwidth: 971.2741 CV score: 4.721292e+14 \nFixed bandwidth: 970.9985 CV score: 4.721293e+14 \nFixed bandwidth: 971.4443 CV score: 4.721292e+14 \nFixed bandwidth: 971.5496 CV score: 4.721293e+14 \nFixed bandwidth: 971.3793 CV score: 4.721292e+14 \nFixed bandwidth: 971.3391 CV score: 4.721292e+14 \nFixed bandwidth: 971.3143 CV score: 4.721292e+14 \nFixed bandwidth: 971.3545 CV score: 4.721292e+14 \nFixed bandwidth: 971.3296 CV score: 4.721292e+14 \nFixed bandwidth: 971.345 CV score: 4.721292e+14 \nFixed bandwidth: 971.3355 CV score: 4.721292e+14 \nFixed bandwidth: 971.3413 CV score: 4.721292e+14 \nFixed bandwidth: 971.3377 CV score: 4.721292e+14 \nFixed bandwidth: 971.34 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.3403 CV score: 4.721292e+14 \nFixed bandwidth: 971.3406 CV score: 4.721292e+14 \nFixed bandwidth: 971.3404 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \n\n\n\ngwr.fixed &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                         PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                         PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                         PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                         FAMILY_FRIENDLY + FREEHOLD, \n                       data=condo_resale.sp, \n                       bw=bw.fixed, \n                       kernel = 'gaussian', \n                       longlat = FALSE)\n\n\ngwr.fixed\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-16 20:41:51.120371 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3405 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4646e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9007e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5207e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793548\n   AREA_SQM                 21575\n   AGE                     434201\n   PROX_CBD               2704596\n   PROX_CHILDCARE         1654087\n   PROX_ELDERLYCARE      38867814\n   PROX_URA_GROWTH_AREA  78515730\n   PROX_MRT               3124316\n   PROX_PARK             18122425\n   PROX_PRIMARY_SCH       4637503\n   PROX_SHOPPING_MALL     1529952\n   PROX_BUS_STOP         11342182\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073636\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3804 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6196 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.53407e+14 \n   R-square value:  0.8909912 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2024-10-16 20:41:51.791013 \n\n\nBuild adaptive bandwidth GWR model\n\nbw.adaptive &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_SHOPPING_MALL   + PROX_BUS_STOP + \n                        NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                      data=condo_resale.sp, \n                      approach=\"CV\", \n                      kernel=\"gaussian\", \n                      adaptive=TRUE, \n                      longlat=FALSE)\n\nAdaptive bandwidth: 895 CV score: 7.952401e+14 \nAdaptive bandwidth: 561 CV score: 7.667364e+14 \nAdaptive bandwidth: 354 CV score: 6.953454e+14 \nAdaptive bandwidth: 226 CV score: 6.15223e+14 \nAdaptive bandwidth: 147 CV score: 5.674373e+14 \nAdaptive bandwidth: 98 CV score: 5.426745e+14 \nAdaptive bandwidth: 68 CV score: 5.168117e+14 \nAdaptive bandwidth: 49 CV score: 4.859631e+14 \nAdaptive bandwidth: 37 CV score: 4.646518e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \nAdaptive bandwidth: 25 CV score: 4.430816e+14 \nAdaptive bandwidth: 32 CV score: 4.505602e+14 \nAdaptive bandwidth: 27 CV score: 4.462172e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \n\n\n\ngwr.adaptive &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                            NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale.sp, bw=bw.adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE, \n                          longlat = FALSE)\n\n\ngwr.adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-16 20:41:56.730711 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 30 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -1.3487e+08 -2.4669e+05  7.7928e+05  1.6194e+06\n   AREA_SQM              3.3188e+03  5.6285e+03  7.7825e+03  1.2738e+04\n   AGE                  -9.6746e+04 -2.9288e+04 -1.4043e+04 -5.6119e+03\n   PROX_CBD             -2.5330e+06 -1.6256e+05 -7.7242e+04  2.6624e+03\n   PROX_CHILDCARE       -1.2790e+06 -2.0175e+05  8.7158e+03  3.7778e+05\n   PROX_ELDERLYCARE     -1.6212e+06 -9.2050e+04  6.1029e+04  2.8184e+05\n   PROX_URA_GROWTH_AREA -7.2686e+06 -3.0350e+04  4.5869e+04  2.4613e+05\n   PROX_MRT             -4.3781e+07 -6.7282e+05 -2.2115e+05 -7.4593e+04\n   PROX_PARK            -2.9020e+06 -1.6782e+05  1.1601e+05  4.6572e+05\n   PROX_PRIMARY_SCH     -8.6418e+05 -1.6627e+05 -7.7853e+03  4.3222e+05\n   PROX_SHOPPING_MALL   -1.8272e+06 -1.3175e+05 -1.4049e+04  1.3799e+05\n   PROX_BUS_STOP        -2.0579e+06 -7.1461e+04  4.1104e+05  1.2071e+06\n   NO_Of_UNITS          -2.1993e+03 -2.3685e+02 -3.4699e+01  1.1657e+02\n   FAMILY_FRIENDLY      -5.9879e+05 -5.0927e+04  2.6173e+04  2.2481e+05\n   FREEHOLD             -1.6340e+05  4.0765e+04  1.9023e+05  3.7960e+05\n                            Max.\n   Intercept            18758355\n   AREA_SQM                23064\n   AGE                     13303\n   PROX_CBD             11346650\n   PROX_CHILDCARE        2892127\n   PROX_ELDERLYCARE      2465671\n   PROX_URA_GROWTH_AREA  7384059\n   PROX_MRT              1186242\n   PROX_PARK             2588497\n   PROX_PRIMARY_SCH      3381462\n   PROX_SHOPPING_MALL   38038564\n   PROX_BUS_STOP        12081592\n   NO_Of_UNITS              1010\n   FAMILY_FRIENDLY       2072414\n   FREEHOLD              1813995\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 350.3088 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1085.691 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41982.22 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41546.74 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 41914.08 \n   Residual sum of squares: 2.528227e+14 \n   R-square value:  0.8912425 \n   Adjusted R-square value:  0.8561185 \n\n   ***********************************************************************\n   Program stops at: 2024-10-16 20:41:57.6104 \n\n\nconvert SDF into sf data.frame\nSDF = an object can contains fit.points, GWR coefficient estimates, y value, predicted values, coefficient standard errors and t-values\n\ncondo_resale.sf.adaptive &lt;- st_as_sf(gwr.adaptive$SDF) %&gt;%\n  st_transform(crs=3414)\n\n\ncondo_resale.sf.adaptive.svy21 &lt;- st_transform(condo_resale.sf.adaptive, 3414)\ncondo_resale.sf.adaptive.svy21  \n\nSimple feature collection with 1436 features and 51 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14940.85 ymin: 24765.67 xmax: 43352.45 ymax: 48382.81\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n    Intercept  AREA_SQM        AGE  PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n1   2050011.7  9561.892  -9514.634 -120681.9      319266.92       -393417.79\n2   1633128.2 16576.853 -58185.479 -149434.2      441102.18        325188.74\n3   3433608.2 13091.861 -26707.386 -259397.8     -120116.82        535855.81\n4    234358.9 20730.601 -93308.988 2426853.7      480825.28        314783.72\n5   2285804.9  6722.836 -17608.018 -316835.5       90764.78       -137384.61\n6  -3568877.4  6039.581 -26535.592  327306.1     -152531.19       -700392.85\n7  -2874842.4 16843.575 -59166.727 -983577.2     -177810.50       -122384.02\n8   2038086.0  6905.135 -17681.897 -285076.6       70259.40        -96012.78\n9   1718478.4  9580.703 -14401.128  105803.4     -657698.02       -123276.00\n10  3457054.0 14072.011 -31579.884 -234895.4       79961.45        548581.04\n   PROX_URA_GROWTH_AREA    PROX_MRT  PROX_PARK PROX_PRIMARY_SCH\n1            -159980.20  -299742.96 -172104.47        242668.03\n2            -142290.39 -2510522.23  523379.72       1106830.66\n3            -253621.21  -936853.28  209099.85        571462.33\n4           -2679297.89 -2039479.50 -759153.26       3127477.21\n5             303714.81   -44567.05  -10284.62         30413.56\n6             -28051.25   733566.47 1511488.92        320878.23\n7            1397676.38 -2745430.34  710114.74       1786570.95\n8             269368.71   -14552.99   73533.34         53359.73\n9            -361974.72  -476785.32 -132067.59        -40128.92\n10           -150024.38 -1503835.53  574155.47        108996.67\n   PROX_SHOPPING_MALL PROX_BUS_STOP  NO_Of_UNITS FAMILY_FRIENDLY  FREEHOLD\n1          300881.390     1210615.4  104.8290640       -9075.370  303955.6\n2          -87693.378     1843587.2 -288.3441183      310074.664  396221.3\n3         -126732.712     1411924.9   -9.5532945        5949.746  168821.7\n4          -29593.342     7225577.5 -161.3551620     1556178.531 1212515.6\n5           -7490.586      677577.0   42.2659674       58986.951  328175.2\n6          258583.881     1086012.6 -214.3671271      201992.641  471873.1\n7         -384251.210     5094060.5   -0.9212521      359659.512  408871.9\n8          -39634.902      735767.1   30.1741069       55602.506  347075.0\n9          276718.757     2815772.4  675.1615559      -30453.297  503872.8\n10        -454726.822     2123557.0  -21.3044311     -100935.586  213324.6\n         y    yhat    residual CV_Score Stud_residual Intercept_SE AREA_SQM_SE\n1  3000000 2886532   113468.16        0    0.38207013     516105.5    823.2860\n2  3880000 3466801   413198.52        0    1.01433140     488083.5    825.2380\n3  3325000 3616527  -291527.20        0   -0.83780678     963711.4    988.2240\n4  4250000 5435482 -1185481.63        0   -2.84614670     444185.5    617.4007\n5  1400000 1388166    11834.26        0    0.03404453    2119620.6   1376.2778\n6  1320000 1516702  -196701.94        0   -0.72065800   28572883.7   2348.0091\n7  3410000 3266881   143118.77        0    0.41291992     679546.6    893.5893\n8  1420000 1431955   -11955.27        0   -0.03033109    2217773.1   1415.2604\n9  2025000 1832799   192200.83        0    0.52018109     814281.8    943.8434\n10 2550000 2223364   326635.53        0    1.10559735    2410252.0   1271.4073\n      AGE_SE PROX_CBD_SE PROX_CHILDCARE_SE PROX_ELDERLYCARE_SE\n1   5889.782    37411.22          319111.1           120633.34\n2   6226.916    23615.06          299705.3            84546.69\n3   6510.236    56103.77          349128.5           129687.07\n4   6010.511   469337.41          304965.2           127150.69\n5   8180.361   410644.47          698720.6           327371.55\n6  14601.909  5272846.47         1141599.8          1653002.19\n7   8970.629   346164.20          530101.1           148598.71\n8   8661.309   438035.69          742532.8           399221.05\n9  11791.208    89148.35          704630.7           329683.30\n10  9941.980   173532.77          500976.2           281876.74\n   PROX_URA_GROWTH_AREA_SE PROX_MRT_SE PROX_PARK_SE PROX_PRIMARY_SCH_SE\n1                 56207.39    185181.3     205499.6            152400.7\n2                 76956.50    281133.9     229358.7            165150.7\n3                 95774.60    275483.7     314124.3            196662.6\n4                470762.12    279877.1     227249.4            240878.9\n5                474339.56    363830.0     364580.9            249087.7\n6               5496627.21    730453.2    1741712.0            683265.5\n7                371692.97    375511.9     297400.9            344602.8\n8                517977.91    423155.4     440984.4            261251.2\n9                153436.22    285325.4     304998.4            278258.5\n10               239182.57    571355.7     599131.8            331284.8\n   PROX_SHOPPING_MALL_SE PROX_BUS_STOP_SE NO_Of_UNITS_SE FAMILY_FRIENDLY_SE\n1               109268.8         600668.6       218.1258           131474.7\n2                98906.8         410222.1       208.9410           114989.1\n3               119913.3         464156.7       210.9828           146607.2\n4               177104.1         562810.8       361.7767           108726.6\n5               301032.9         740922.4       299.5034           160663.7\n6              2931208.6        1418333.3       602.5571           331727.0\n7               249969.5         821236.4       532.1978           129241.2\n8               351634.0         775038.4       338.6777           171895.1\n9               289872.7         850095.5       439.9037           220223.4\n10              265529.7         631399.2       259.0169           189125.5\n   FREEHOLD_SE Intercept_TV AREA_SQM_TV     AGE_TV PROX_CBD_TV\n1     115954.0    3.9720784   11.614302  -1.615447 -3.22582173\n2     130110.0    3.3460017   20.087361  -9.344188 -6.32792021\n3     141031.5    3.5629010   13.247868  -4.102368 -4.62353528\n4     138239.1    0.5276150   33.577223 -15.524302  5.17080808\n5     210641.1    1.0784029    4.884795  -2.152474 -0.77155660\n6     374347.3   -0.1249043    2.572214  -1.817269  0.06207388\n7     182216.9   -4.2305303   18.849348  -6.595605 -2.84136028\n8     216649.4    0.9189786    4.879056  -2.041481 -0.65080678\n9     220473.7    2.1104224   10.150733  -1.221345  1.18682383\n10    206346.2    1.4343123   11.068059  -3.176418 -1.35360852\n   PROX_CHILDCARE_TV PROX_ELDERLYCARE_TV PROX_URA_GROWTH_AREA_TV PROX_MRT_TV\n1         1.00048819          -3.2612693            -2.846248368 -1.61864578\n2         1.47178634           3.8462625            -1.848971738 -8.92998600\n3        -0.34404755           4.1319138            -2.648105057 -3.40075727\n4         1.57665606           2.4756745            -5.691404992 -7.28705261\n5         0.12990138          -0.4196596             0.640289855 -0.12249416\n6        -0.13361179          -0.4237096            -0.005103357  1.00426206\n7        -0.33542751          -0.8235874             3.760298131 -7.31116712\n8         0.09462126          -0.2405003             0.520038994 -0.03439159\n9        -0.93339393          -0.3739225            -2.359121712 -1.67102293\n10        0.15961128           1.9461735            -0.627237944 -2.63204802\n   PROX_PARK_TV PROX_PRIMARY_SCH_TV PROX_SHOPPING_MALL_TV PROX_BUS_STOP_TV\n1   -0.83749312           1.5923022            2.75358842        2.0154464\n2    2.28192684           6.7019454           -0.88662640        4.4941192\n3    0.66565951           2.9058009           -1.05686949        3.0419145\n4   -3.34061770          12.9836105           -0.16709578       12.8383775\n5   -0.02820944           0.1220998           -0.02488294        0.9145046\n6    0.86781794           0.4696245            0.08821750        0.7656963\n7    2.38773567           5.1844351           -1.53719231        6.2029165\n8    0.16674816           0.2042469           -0.11271635        0.9493299\n9   -0.43301073          -0.1442145            0.95462153        3.3123012\n10   0.95831249           0.3290120           -1.71252687        3.3632555\n   NO_Of_UNITS_TV FAMILY_FRIENDLY_TV FREEHOLD_TV  Local_R2\n1     0.480589953        -0.06902748    2.621347 0.8846744\n2    -1.380026395         2.69655779    3.045280 0.8899773\n3    -0.045279967         0.04058290    1.197050 0.8947007\n4    -0.446007570        14.31276425    8.771149 0.9073605\n5     0.141120178         0.36714544    1.557983 0.9510057\n6    -0.355762335         0.60891234    1.260522 0.9247586\n7    -0.001731033         2.78285441    2.243875 0.8310458\n8     0.089093858         0.32346758    1.602012 0.9463936\n9     1.534793921        -0.13828365    2.285410 0.8380365\n10   -0.082251138        -0.53369623    1.033819 0.9080753\n                    geometry\n1  POINT (22085.12 29951.54)\n2   POINT (25656.84 34546.2)\n3   POINT (23963.99 32890.8)\n4  POINT (27044.28 32319.77)\n5  POINT (41042.56 33743.64)\n6   POINT (39717.04 32943.1)\n7   POINT (28419.1 33513.37)\n8  POINT (40763.57 33879.61)\n9  POINT (23595.63 28884.78)\n10 POINT (24586.56 33194.31)\n\n\n\ngwr.adaptive.output &lt;- as.data.frame(gwr.adaptive$SDF)\ncondo_resale.sf.adaptive &lt;- cbind(condo_resale.res.sf, as.matrix(gwr.adaptive.output))\n\n\nglimpse(condo_resale.sf.adaptive)\n\nRows: 1,436\nColumns: 77\n$ POSTCODE                &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472…\n$ SELLING_PRICE           &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ AREA_SQM                &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 1…\n$ AGE                     &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22,…\n$ PROX_CBD                &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783…\n$ PROX_CHILDCARE          &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543…\n$ PROX_ELDERLYCARE        &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.…\n$ PROX_URA_GROWTH_AREA    &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.4106…\n$ PROX_HAWKER_MARKET      &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969…\n$ PROX_KINDERGARTEN       &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076…\n$ PROX_MRT                &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.…\n$ PROX_PARK               &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.…\n$ PROX_PRIMARY_SCH        &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.…\n$ PROX_TOP_PRIMARY_SCH    &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.…\n$ PROX_SHOPPING_MALL      &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.…\n$ PROX_SUPERMARKET        &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.…\n$ PROX_BUS_STOP           &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340…\n$ NO_Of_UNITS             &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34…\n$ FAMILY_FRIENDLY         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ LOG_SELLING_PRICE       &lt;dbl&gt; 14.91412, 15.17135, 15.01698, 15.26243, 14.151…\n$ MLR_RES                 &lt;dbl&gt; -1489099.55, 415494.57, 194129.69, 1088992.71,…\n$ Intercept               &lt;dbl&gt; 2050011.67, 1633128.24, 3433608.17, 234358.91,…\n$ AREA_SQM.1              &lt;dbl&gt; 9561.892, 16576.853, 13091.861, 20730.601, 672…\n$ AGE.1                   &lt;dbl&gt; -9514.634, -58185.479, -26707.386, -93308.988,…\n$ PROX_CBD.1              &lt;dbl&gt; -120681.94, -149434.22, -259397.77, 2426853.66…\n$ PROX_CHILDCARE.1        &lt;dbl&gt; 319266.925, 441102.177, -120116.816, 480825.28…\n$ PROX_ELDERLYCARE.1      &lt;dbl&gt; -393417.795, 325188.741, 535855.806, 314783.72…\n$ PROX_URA_GROWTH_AREA.1  &lt;dbl&gt; -159980.203, -142290.389, -253621.206, -267929…\n$ PROX_MRT.1              &lt;dbl&gt; -299742.96, -2510522.23, -936853.28, -2039479.…\n$ PROX_PARK.1             &lt;dbl&gt; -172104.47, 523379.72, 209099.85, -759153.26, …\n$ PROX_PRIMARY_SCH.1      &lt;dbl&gt; 242668.03, 1106830.66, 571462.33, 3127477.21, …\n$ PROX_SHOPPING_MALL.1    &lt;dbl&gt; 300881.390, -87693.378, -126732.712, -29593.34…\n$ PROX_BUS_STOP.1         &lt;dbl&gt; 1210615.44, 1843587.22, 1411924.90, 7225577.51…\n$ NO_Of_UNITS.1           &lt;dbl&gt; 104.8290640, -288.3441183, -9.5532945, -161.35…\n$ FAMILY_FRIENDLY.1       &lt;dbl&gt; -9075.370, 310074.664, 5949.746, 1556178.531, …\n$ FREEHOLD.1              &lt;dbl&gt; 303955.61, 396221.27, 168821.75, 1212515.58, 3…\n$ y                       &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ yhat                    &lt;dbl&gt; 2886531.8, 3466801.5, 3616527.2, 5435481.6, 13…\n$ residual                &lt;dbl&gt; 113468.16, 413198.52, -291527.20, -1185481.63,…\n$ CV_Score                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ Stud_residual           &lt;dbl&gt; 0.38207013, 1.01433140, -0.83780678, -2.846146…\n$ Intercept_SE            &lt;dbl&gt; 516105.5, 488083.5, 963711.4, 444185.5, 211962…\n$ AREA_SQM_SE             &lt;dbl&gt; 823.2860, 825.2380, 988.2240, 617.4007, 1376.2…\n$ AGE_SE                  &lt;dbl&gt; 5889.782, 6226.916, 6510.236, 6010.511, 8180.3…\n$ PROX_CBD_SE             &lt;dbl&gt; 37411.22, 23615.06, 56103.77, 469337.41, 41064…\n$ PROX_CHILDCARE_SE       &lt;dbl&gt; 319111.1, 299705.3, 349128.5, 304965.2, 698720…\n$ PROX_ELDERLYCARE_SE     &lt;dbl&gt; 120633.34, 84546.69, 129687.07, 127150.69, 327…\n$ PROX_URA_GROWTH_AREA_SE &lt;dbl&gt; 56207.39, 76956.50, 95774.60, 470762.12, 47433…\n$ PROX_MRT_SE             &lt;dbl&gt; 185181.3, 281133.9, 275483.7, 279877.1, 363830…\n$ PROX_PARK_SE            &lt;dbl&gt; 205499.6, 229358.7, 314124.3, 227249.4, 364580…\n$ PROX_PRIMARY_SCH_SE     &lt;dbl&gt; 152400.7, 165150.7, 196662.6, 240878.9, 249087…\n$ PROX_SHOPPING_MALL_SE   &lt;dbl&gt; 109268.8, 98906.8, 119913.3, 177104.1, 301032.…\n$ PROX_BUS_STOP_SE        &lt;dbl&gt; 600668.6, 410222.1, 464156.7, 562810.8, 740922…\n$ NO_Of_UNITS_SE          &lt;dbl&gt; 218.1258, 208.9410, 210.9828, 361.7767, 299.50…\n$ FAMILY_FRIENDLY_SE      &lt;dbl&gt; 131474.73, 114989.07, 146607.22, 108726.62, 16…\n$ FREEHOLD_SE             &lt;dbl&gt; 115954.0, 130110.0, 141031.5, 138239.1, 210641…\n$ Intercept_TV            &lt;dbl&gt; 3.9720784, 3.3460017, 3.5629010, 0.5276150, 1.…\n$ AREA_SQM_TV             &lt;dbl&gt; 11.614302, 20.087361, 13.247868, 33.577223, 4.…\n$ AGE_TV                  &lt;dbl&gt; -1.6154474, -9.3441881, -4.1023685, -15.524301…\n$ PROX_CBD_TV             &lt;dbl&gt; -3.22582173, -6.32792021, -4.62353528, 5.17080…\n$ PROX_CHILDCARE_TV       &lt;dbl&gt; 1.000488185, 1.471786337, -0.344047555, 1.5766…\n$ PROX_ELDERLYCARE_TV     &lt;dbl&gt; -3.26126929, 3.84626245, 4.13191383, 2.4756745…\n$ PROX_URA_GROWTH_AREA_TV &lt;dbl&gt; -2.846248368, -1.848971738, -2.648105057, -5.6…\n$ PROX_MRT_TV             &lt;dbl&gt; -1.61864578, -8.92998600, -3.40075727, -7.2870…\n$ PROX_PARK_TV            &lt;dbl&gt; -0.83749312, 2.28192684, 0.66565951, -3.340617…\n$ PROX_PRIMARY_SCH_TV     &lt;dbl&gt; 1.59230221, 6.70194543, 2.90580089, 12.9836104…\n$ PROX_SHOPPING_MALL_TV   &lt;dbl&gt; 2.753588422, -0.886626400, -1.056869486, -0.16…\n$ PROX_BUS_STOP_TV        &lt;dbl&gt; 2.0154464, 4.4941192, 3.0419145, 12.8383775, 0…\n$ NO_Of_UNITS_TV          &lt;dbl&gt; 0.480589953, -1.380026395, -0.045279967, -0.44…\n$ FAMILY_FRIENDLY_TV      &lt;dbl&gt; -0.06902748, 2.69655779, 0.04058290, 14.312764…\n$ FREEHOLD_TV             &lt;dbl&gt; 2.6213469, 3.0452799, 1.1970499, 8.7711485, 1.…\n$ Local_R2                &lt;dbl&gt; 0.8846744, 0.8899773, 0.8947007, 0.9073605, 0.…\n$ coords.x1               &lt;dbl&gt; 22085.12, 25656.84, 23963.99, 27044.28, 41042.…\n$ coords.x2               &lt;dbl&gt; 29951.54, 34546.20, 32890.80, 32319.77, 33743.…\n$ geometry                &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n\n\n\nsummary(gwr.adaptive$SDF$yhat)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n  171347  1102001  1385528  1751842  1982307 13887901 \n\n\nVisualizing local R2\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nVisualize coefficient estimates\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\nAREA_SQM_SE &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nAREA_SQM_TV &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\n\n\nURA Planning Region\n\ntm_shape(mpsz_svy21[mpsz_svy21$REGION_N==\"CENTRAL REGION\", ])+\n  tm_polygons()+\ntm_shape(condo_resale.sf.adaptive) + \n  tm_bubbles(col = \"Local_R2\",\n           size = 0.15,\n           border.col = \"gray60\",\n           border.lwd = 1)\n\nWarning: The shape mpsz_svy21[mpsz_svy21$REGION_N == \"CENTRAL REGION\", ] is\ninvalid (after reprojection). See sf::st_is_valid"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex07/Hands-on_ex07.html#exploratory-data-analysis-eda",
    "href": "Hands-on_exercise/Hands-on_ex07/Hands-on_ex07.html#exploratory-data-analysis-eda",
    "title": "Hands-on Exercise 07",
    "section": "",
    "text": "Use histogram to show the distribution of SELLING_PRICE\n\nggplot(data=condo_resale.sf, aes(x=`SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\n\n\n\n\nNormalize using log transformation\nDerive a new variable called LOG_SELLING_PRICE\n\ncondo_resale.sf &lt;- condo_resale.sf %&gt;%\n  mutate(`LOG_SELLING_PRICE` = log(SELLING_PRICE))\n\n\nggplot(data=condo_resale.sf, aes(x=`LOG_SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\n\n\n\n\nPlot small multiple histograms, also known as trellis plot\nggarrange() is used to organize these histogram\n\nAREA_SQM &lt;- ggplot(data=condo_resale.sf, aes(x= `AREA_SQM`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nAGE &lt;- ggplot(data=condo_resale.sf, aes(x= `AGE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CBD &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CBD`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CHILDCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CHILDCARE`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_ELDERLYCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_ELDERLYCARE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_URA_GROWTH_AREA &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_URA_GROWTH_AREA`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_HAWKER_MARKET &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_HAWKER_MARKET`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_KINDERGARTEN &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_KINDERGARTEN`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_MRT &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_MRT`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PARK &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PARK`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_TOP_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_TOP_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nggarrange(AREA_SQM, AGE, PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, \n          PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN, PROX_MRT,\n          PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH,  \n          ncol = 3, nrow = 4)\n\n\n\n\n\n\n\n\nDraw statistical point map\nReview the geospatial distribution condominium resale prices in Singapore\n\ntmap_mode(\"view\") #turn on the interactive mode of tmap\n\ntmap mode set to interactive viewing\n\n\n\ntm_shape(mpsz_svy21)+tmap_options(check.and.fix = TRUE)+\n  tm_polygons() +\ntm_shape(condo_resale.sf) +  \n  tm_dots(col = \"SELLING_PRICE\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\ntmap_mode(\"plot\") #turn R display into plot mode\n\ntmap mode set to plotting\n\n\n##Hedonic Pricing Modelling in R\n\n\n\ncondo.slr &lt;- lm(formula=SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf) #SELLING_PRICE = dependent variable, AREA SQM = independent variable\n\nlm returns an object of class ‘lm’ for multiple responses of class c(“mlm”,“lm”)\nANOVA test\n\nsummary(condo.slr) #Print the Analysis of variance table of the results\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n\nSelling price = -258121.1 if the predicted value of SELLING_PRICE when the AREA_SQM is 0\nFor each additional square meter, the selling price increases by an estimated 14,719 SGD\np-value = 2e-16, indicating that the area has a highly significant effect on the selling price.\nResidual standard error 942700 is in dollars, the measure units of the dependent variable. SGD942,700 on average, the actuall selling prices differ from the model’s predictions.\n\nggplot(data=condo_resale.sf,  \n       aes(x=`AREA_SQM`, y=`SELLING_PRICE`)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n\n\n\nAvoid multicollinearity\n\ncorrplot(cor(condo_resale[, 5:23]), diag = FALSE, order = \"AOE\", #parameter order = AOE, angular order of the eigenvectors\n         tl.pos = \"td\", tl.cex = 0.5, method = \"number\", type = \"upper\")\n\n\n\n\n\n\n\n\nFreehold is highly correlated to LEASE_99YEAR. Exclude LEASE_99YEAR\n\ncondo.mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE    + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n                  PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                data=condo_resale.sf)\nsummary(condo.mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3475964  -293923   -23069   241043 12260381 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           481728.40  121441.01   3.967 7.65e-05 ***\nAREA_SQM               12708.32     369.59  34.385  &lt; 2e-16 ***\nAGE                   -24440.82    2763.16  -8.845  &lt; 2e-16 ***\nPROX_CBD              -78669.78    6768.97 -11.622  &lt; 2e-16 ***\nPROX_CHILDCARE       -351617.91  109467.25  -3.212  0.00135 ** \nPROX_ELDERLYCARE      171029.42   42110.51   4.061 5.14e-05 ***\nPROX_URA_GROWTH_AREA   38474.53   12523.57   3.072  0.00217 ** \nPROX_HAWKER_MARKET     23746.10   29299.76   0.810  0.41782    \nPROX_KINDERGARTEN     147468.99   82668.87   1.784  0.07466 .  \nPROX_MRT             -314599.68   57947.44  -5.429 6.66e-08 ***\nPROX_PARK             563280.50   66551.68   8.464  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      180186.08   65237.95   2.762  0.00582 ** \nPROX_TOP_PRIMARY_SCH    2280.04   20410.43   0.112  0.91107    \nPROX_SHOPPING_MALL   -206604.06   42840.60  -4.823 1.57e-06 ***\nPROX_SUPERMARKET      -44991.80   77082.64  -0.584  0.55953    \nPROX_BUS_STOP         683121.35  138353.28   4.938 8.85e-07 ***\nNO_Of_UNITS             -231.18      89.03  -2.597  0.00951 ** \nFAMILY_FRIENDLY       140340.77   47020.55   2.985  0.00289 ** \nFREEHOLD              359913.01   49220.22   7.312 4.38e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1417 degrees of freedom\nMultiple R-squared:  0.6518,    Adjusted R-squared:  0.6474 \nF-statistic: 147.4 on 18 and 1417 DF,  p-value: &lt; 2.2e-16\n\n\nRemove those variables which are not statistically significant\n\nPROX_TOP_PRIMARY_SCH\nPROX_SUPERMARKET\nPROX_HAWKER_MARKET\nPROX_KINDERGARTEN\n\n\ncondo.mlr1 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT  + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL    + PROX_BUS_STOP + \n                   NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD,\n                 data=condo_resale.sf)\nols_regress(condo.mlr1)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     751998.679 \nR-Squared                    0.651       MSE                571471422208.591 \nAdj. R-Squared               0.647       Coef. Var                    43.168 \nPred R-Squared               0.638       AIC                       42966.758 \nMAE                     414819.628       SBC                       43051.072 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n-----------------------------------------------------------------------------------------------------------------\n\n\nPrepare publication quality table: gtsummary method\n\ntbl_regression(condo.mlr1, intercept = TRUE) #tbl_regression() is used to create a well formatted regression report.\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI1\np-value\n\n\n\n\n(Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n\n\nAREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n\n\nAGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n\n\nPROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n\n\nPROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n\n\nPROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n\n\nPROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n\n\nPROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n\n\nPROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n\n\nPROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n\n\nPROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n\n\nPROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n\n\nNO_Of_UNITS\n-245\n-418, -73\n0.005\n\n\nFAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n\n\nFREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n\n\n\n1 CI = Confidence Interval\n\n\n\n\n\n\n\n\nHow to add model statistics?\nuse add_glance_table() to append to the report table use add_glance_source_note() to add as a table source\n\ntbl_regression(condo.mlr1, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n\n\n\n  \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n    AREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n    AGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n    PROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n    PROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n    PROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n    PROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n    PROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n    PROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n    PROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n    PROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n    PROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n    NO_Of_UNITS\n-245\n-418, -73\n0.005\n    FAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n    FREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n  \n  \n    \n      R² = 0.651; Adjusted R² = 0.647; AIC = 42,967; Statistic = 189; p-value = &lt;0.001; σ = 755,957\n    \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\nUse olsrr to perform OLS regression\nols_vif_tol() to test multicollinearity\n\nols_vif_tol(condo.mlr1)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_Of_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\nLess than 10 = no sign of multicollinearity\nols_plot_resid_fit() to perform linearity assumption test\n\nols_plot_resid_fit(condo.mlr1)\n\n\n\n\n\n\n\n\nData points scattered around line 0 = dependent and independent variables are linear\nols_plot_resid_hist() to perform normality assumption test\n\nols_plot_resid_hist(condo.mlr1)\n\n\n\n\n\n\n\n\nResidual of the multiple linear regression model = normal distribution\nols_test_normality() to perform formal statistical test methods\n\nols_test_normality(condo.mlr1)\n\nWarning in ks.test.default(y, \"pnorm\", mean(y), sd(y)): ties should not be\npresent for the one-sample Kolmogorov-Smirnov test\n\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n\nVisual the residual of the hedonic pricing model\nConvert condo_resale.sf from sf data frame into a SpatialPointsDataFrame\nExport residual of the hedonic pricing model and save it as a data frame.\n\nmlr.output &lt;- as.data.frame(condo.mlr1$residuals)\n\nJoin the newly created data frame with condo_resale.sf\n\ncondo_resale.res.sf &lt;- cbind(condo_resale.sf, \n                        condo.mlr1$residuals) %&gt;%\nrename(`MLR_RES` = `condo.mlr1.residuals`)\n\nConvert condo_resale.res.sf from simple feature object into a SpatialPointsDataFrame\n\ncondo_resale.sp &lt;- as_Spatial(condo_resale.res.sf)\ncondo_resale.sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1436 \nextent      : 14940.85, 43352.45, 24765.67, 48382.81  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 23\nnames       : POSTCODE, SELLING_PRICE, AREA_SQM, AGE,    PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN,    PROX_MRT,   PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH, PROX_SHOPPING_MALL, ... \nmin values  :    18965,        540000,       34,   0, 0.386916393,    0.004927023,      0.054508623,          0.214539508,        0.051817113,       0.004927023, 0.052779424, 0.029064164,      0.077106132,          0.077106132,                  0, ... \nmax values  :   828833,       1.8e+07,      619,  37, 19.18042832,     3.46572633,      3.949157205,           9.15540001,        5.374348075,       2.229045366,  3.48037319,  2.16104919,      3.928989144,          6.748192062,        3.477433767, ... \n\n\nDisplay the distribution of the residuals\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\n\n\ntm_shape(mpsz_svy21)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale.res.sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nThe map reveal that there is a sign of spatial autocorrelation.\nPerform Moran’s I test to proof.\n\nnb &lt;- dnearneigh(coordinates(condo_resale.sp), 0, 1500, longlat = FALSE)\nsummary(nb)\n\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\n\n\nnb_lw &lt;- nb2listw(nb, style = 'W')\nsummary(nb_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\nWeights style: W \nWeights constants summary:\n     n      nn   S0       S1       S2\nW 1436 2062096 1436 94.81916 5798.341\n\n\nPerform Moran’I test for residual spatial autocorrelation.\n\nlm.morantest(condo.mlr1, nb_lw)\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD +\nPROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT +\nPROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP +\nNO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, data = condo_resale.sf)\nweights: nb_lw\n\nMoran I statistic standard deviate = 24.366, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nObserved Moran I      Expectation         Variance \n    1.438876e-01    -5.487594e-03     3.758259e-05 \n\n\np-value &lt; 0.05, reject the null hypothesis\n\n\n\nFixed Bandwidth\n\nbw.fixed &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                     PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                     PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                     PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                     FAMILY_FRIENDLY + FREEHOLD, \n                   data=condo_resale.sp, \n                   approach=\"CV\", \n                   kernel=\"gaussian\", \n                   adaptive=FALSE, \n                   longlat=FALSE)\n\nFixed bandwidth: 17660.96 CV score: 8.259118e+14 \nFixed bandwidth: 10917.26 CV score: 7.970454e+14 \nFixed bandwidth: 6749.419 CV score: 7.273273e+14 \nFixed bandwidth: 4173.553 CV score: 6.300006e+14 \nFixed bandwidth: 2581.58 CV score: 5.404958e+14 \nFixed bandwidth: 1597.687 CV score: 4.857515e+14 \nFixed bandwidth: 989.6077 CV score: 4.722431e+14 \nFixed bandwidth: 613.7939 CV score: 1.378294e+16 \nFixed bandwidth: 1221.873 CV score: 4.778717e+14 \nFixed bandwidth: 846.0596 CV score: 4.791629e+14 \nFixed bandwidth: 1078.325 CV score: 4.751406e+14 \nFixed bandwidth: 934.7772 CV score: 4.72518e+14 \nFixed bandwidth: 1023.495 CV score: 4.730305e+14 \nFixed bandwidth: 968.6643 CV score: 4.721317e+14 \nFixed bandwidth: 955.7206 CV score: 4.722072e+14 \nFixed bandwidth: 976.6639 CV score: 4.721387e+14 \nFixed bandwidth: 963.7202 CV score: 4.721484e+14 \nFixed bandwidth: 971.7199 CV score: 4.721293e+14 \nFixed bandwidth: 973.6083 CV score: 4.721309e+14 \nFixed bandwidth: 970.5527 CV score: 4.721295e+14 \nFixed bandwidth: 972.4412 CV score: 4.721296e+14 \nFixed bandwidth: 971.2741 CV score: 4.721292e+14 \nFixed bandwidth: 970.9985 CV score: 4.721293e+14 \nFixed bandwidth: 971.4443 CV score: 4.721292e+14 \nFixed bandwidth: 971.5496 CV score: 4.721293e+14 \nFixed bandwidth: 971.3793 CV score: 4.721292e+14 \nFixed bandwidth: 971.3391 CV score: 4.721292e+14 \nFixed bandwidth: 971.3143 CV score: 4.721292e+14 \nFixed bandwidth: 971.3545 CV score: 4.721292e+14 \nFixed bandwidth: 971.3296 CV score: 4.721292e+14 \nFixed bandwidth: 971.345 CV score: 4.721292e+14 \nFixed bandwidth: 971.3355 CV score: 4.721292e+14 \nFixed bandwidth: 971.3413 CV score: 4.721292e+14 \nFixed bandwidth: 971.3377 CV score: 4.721292e+14 \nFixed bandwidth: 971.34 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.3403 CV score: 4.721292e+14 \nFixed bandwidth: 971.3406 CV score: 4.721292e+14 \nFixed bandwidth: 971.3404 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \n\n\n\ngwr.fixed &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                         PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                         PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                         PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                         FAMILY_FRIENDLY + FREEHOLD, \n                       data=condo_resale.sp, \n                       bw=bw.fixed, \n                       kernel = 'gaussian', \n                       longlat = FALSE)\n\n\ngwr.fixed\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-16 20:41:51.120371 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3405 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4646e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9007e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5207e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793548\n   AREA_SQM                 21575\n   AGE                     434201\n   PROX_CBD               2704596\n   PROX_CHILDCARE         1654087\n   PROX_ELDERLYCARE      38867814\n   PROX_URA_GROWTH_AREA  78515730\n   PROX_MRT               3124316\n   PROX_PARK             18122425\n   PROX_PRIMARY_SCH       4637503\n   PROX_SHOPPING_MALL     1529952\n   PROX_BUS_STOP         11342182\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073636\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3804 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6196 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.53407e+14 \n   R-square value:  0.8909912 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2024-10-16 20:41:51.791013 \n\n\nBuild adaptive bandwidth GWR model\n\nbw.adaptive &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_SHOPPING_MALL   + PROX_BUS_STOP + \n                        NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                      data=condo_resale.sp, \n                      approach=\"CV\", \n                      kernel=\"gaussian\", \n                      adaptive=TRUE, \n                      longlat=FALSE)\n\nAdaptive bandwidth: 895 CV score: 7.952401e+14 \nAdaptive bandwidth: 561 CV score: 7.667364e+14 \nAdaptive bandwidth: 354 CV score: 6.953454e+14 \nAdaptive bandwidth: 226 CV score: 6.15223e+14 \nAdaptive bandwidth: 147 CV score: 5.674373e+14 \nAdaptive bandwidth: 98 CV score: 5.426745e+14 \nAdaptive bandwidth: 68 CV score: 5.168117e+14 \nAdaptive bandwidth: 49 CV score: 4.859631e+14 \nAdaptive bandwidth: 37 CV score: 4.646518e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \nAdaptive bandwidth: 25 CV score: 4.430816e+14 \nAdaptive bandwidth: 32 CV score: 4.505602e+14 \nAdaptive bandwidth: 27 CV score: 4.462172e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \n\n\n\ngwr.adaptive &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                            NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale.sp, bw=bw.adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE, \n                          longlat = FALSE)\n\n\ngwr.adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-16 20:41:56.730711 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 30 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -1.3487e+08 -2.4669e+05  7.7928e+05  1.6194e+06\n   AREA_SQM              3.3188e+03  5.6285e+03  7.7825e+03  1.2738e+04\n   AGE                  -9.6746e+04 -2.9288e+04 -1.4043e+04 -5.6119e+03\n   PROX_CBD             -2.5330e+06 -1.6256e+05 -7.7242e+04  2.6624e+03\n   PROX_CHILDCARE       -1.2790e+06 -2.0175e+05  8.7158e+03  3.7778e+05\n   PROX_ELDERLYCARE     -1.6212e+06 -9.2050e+04  6.1029e+04  2.8184e+05\n   PROX_URA_GROWTH_AREA -7.2686e+06 -3.0350e+04  4.5869e+04  2.4613e+05\n   PROX_MRT             -4.3781e+07 -6.7282e+05 -2.2115e+05 -7.4593e+04\n   PROX_PARK            -2.9020e+06 -1.6782e+05  1.1601e+05  4.6572e+05\n   PROX_PRIMARY_SCH     -8.6418e+05 -1.6627e+05 -7.7853e+03  4.3222e+05\n   PROX_SHOPPING_MALL   -1.8272e+06 -1.3175e+05 -1.4049e+04  1.3799e+05\n   PROX_BUS_STOP        -2.0579e+06 -7.1461e+04  4.1104e+05  1.2071e+06\n   NO_Of_UNITS          -2.1993e+03 -2.3685e+02 -3.4699e+01  1.1657e+02\n   FAMILY_FRIENDLY      -5.9879e+05 -5.0927e+04  2.6173e+04  2.2481e+05\n   FREEHOLD             -1.6340e+05  4.0765e+04  1.9023e+05  3.7960e+05\n                            Max.\n   Intercept            18758355\n   AREA_SQM                23064\n   AGE                     13303\n   PROX_CBD             11346650\n   PROX_CHILDCARE        2892127\n   PROX_ELDERLYCARE      2465671\n   PROX_URA_GROWTH_AREA  7384059\n   PROX_MRT              1186242\n   PROX_PARK             2588497\n   PROX_PRIMARY_SCH      3381462\n   PROX_SHOPPING_MALL   38038564\n   PROX_BUS_STOP        12081592\n   NO_Of_UNITS              1010\n   FAMILY_FRIENDLY       2072414\n   FREEHOLD              1813995\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 350.3088 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1085.691 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41982.22 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41546.74 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 41914.08 \n   Residual sum of squares: 2.528227e+14 \n   R-square value:  0.8912425 \n   Adjusted R-square value:  0.8561185 \n\n   ***********************************************************************\n   Program stops at: 2024-10-16 20:41:57.6104 \n\n\nconvert SDF into sf data.frame\nSDF = an object can contains fit.points, GWR coefficient estimates, y value, predicted values, coefficient standard errors and t-values\n\ncondo_resale.sf.adaptive &lt;- st_as_sf(gwr.adaptive$SDF) %&gt;%\n  st_transform(crs=3414)\n\n\ncondo_resale.sf.adaptive.svy21 &lt;- st_transform(condo_resale.sf.adaptive, 3414)\ncondo_resale.sf.adaptive.svy21  \n\nSimple feature collection with 1436 features and 51 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14940.85 ymin: 24765.67 xmax: 43352.45 ymax: 48382.81\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n    Intercept  AREA_SQM        AGE  PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n1   2050011.7  9561.892  -9514.634 -120681.9      319266.92       -393417.79\n2   1633128.2 16576.853 -58185.479 -149434.2      441102.18        325188.74\n3   3433608.2 13091.861 -26707.386 -259397.8     -120116.82        535855.81\n4    234358.9 20730.601 -93308.988 2426853.7      480825.28        314783.72\n5   2285804.9  6722.836 -17608.018 -316835.5       90764.78       -137384.61\n6  -3568877.4  6039.581 -26535.592  327306.1     -152531.19       -700392.85\n7  -2874842.4 16843.575 -59166.727 -983577.2     -177810.50       -122384.02\n8   2038086.0  6905.135 -17681.897 -285076.6       70259.40        -96012.78\n9   1718478.4  9580.703 -14401.128  105803.4     -657698.02       -123276.00\n10  3457054.0 14072.011 -31579.884 -234895.4       79961.45        548581.04\n   PROX_URA_GROWTH_AREA    PROX_MRT  PROX_PARK PROX_PRIMARY_SCH\n1            -159980.20  -299742.96 -172104.47        242668.03\n2            -142290.39 -2510522.23  523379.72       1106830.66\n3            -253621.21  -936853.28  209099.85        571462.33\n4           -2679297.89 -2039479.50 -759153.26       3127477.21\n5             303714.81   -44567.05  -10284.62         30413.56\n6             -28051.25   733566.47 1511488.92        320878.23\n7            1397676.38 -2745430.34  710114.74       1786570.95\n8             269368.71   -14552.99   73533.34         53359.73\n9            -361974.72  -476785.32 -132067.59        -40128.92\n10           -150024.38 -1503835.53  574155.47        108996.67\n   PROX_SHOPPING_MALL PROX_BUS_STOP  NO_Of_UNITS FAMILY_FRIENDLY  FREEHOLD\n1          300881.390     1210615.4  104.8290640       -9075.370  303955.6\n2          -87693.378     1843587.2 -288.3441183      310074.664  396221.3\n3         -126732.712     1411924.9   -9.5532945        5949.746  168821.7\n4          -29593.342     7225577.5 -161.3551620     1556178.531 1212515.6\n5           -7490.586      677577.0   42.2659674       58986.951  328175.2\n6          258583.881     1086012.6 -214.3671271      201992.641  471873.1\n7         -384251.210     5094060.5   -0.9212521      359659.512  408871.9\n8          -39634.902      735767.1   30.1741069       55602.506  347075.0\n9          276718.757     2815772.4  675.1615559      -30453.297  503872.8\n10        -454726.822     2123557.0  -21.3044311     -100935.586  213324.6\n         y    yhat    residual CV_Score Stud_residual Intercept_SE AREA_SQM_SE\n1  3000000 2886532   113468.16        0    0.38207013     516105.5    823.2860\n2  3880000 3466801   413198.52        0    1.01433140     488083.5    825.2380\n3  3325000 3616527  -291527.20        0   -0.83780678     963711.4    988.2240\n4  4250000 5435482 -1185481.63        0   -2.84614670     444185.5    617.4007\n5  1400000 1388166    11834.26        0    0.03404453    2119620.6   1376.2778\n6  1320000 1516702  -196701.94        0   -0.72065800   28572883.7   2348.0091\n7  3410000 3266881   143118.77        0    0.41291992     679546.6    893.5893\n8  1420000 1431955   -11955.27        0   -0.03033109    2217773.1   1415.2604\n9  2025000 1832799   192200.83        0    0.52018109     814281.8    943.8434\n10 2550000 2223364   326635.53        0    1.10559735    2410252.0   1271.4073\n      AGE_SE PROX_CBD_SE PROX_CHILDCARE_SE PROX_ELDERLYCARE_SE\n1   5889.782    37411.22          319111.1           120633.34\n2   6226.916    23615.06          299705.3            84546.69\n3   6510.236    56103.77          349128.5           129687.07\n4   6010.511   469337.41          304965.2           127150.69\n5   8180.361   410644.47          698720.6           327371.55\n6  14601.909  5272846.47         1141599.8          1653002.19\n7   8970.629   346164.20          530101.1           148598.71\n8   8661.309   438035.69          742532.8           399221.05\n9  11791.208    89148.35          704630.7           329683.30\n10  9941.980   173532.77          500976.2           281876.74\n   PROX_URA_GROWTH_AREA_SE PROX_MRT_SE PROX_PARK_SE PROX_PRIMARY_SCH_SE\n1                 56207.39    185181.3     205499.6            152400.7\n2                 76956.50    281133.9     229358.7            165150.7\n3                 95774.60    275483.7     314124.3            196662.6\n4                470762.12    279877.1     227249.4            240878.9\n5                474339.56    363830.0     364580.9            249087.7\n6               5496627.21    730453.2    1741712.0            683265.5\n7                371692.97    375511.9     297400.9            344602.8\n8                517977.91    423155.4     440984.4            261251.2\n9                153436.22    285325.4     304998.4            278258.5\n10               239182.57    571355.7     599131.8            331284.8\n   PROX_SHOPPING_MALL_SE PROX_BUS_STOP_SE NO_Of_UNITS_SE FAMILY_FRIENDLY_SE\n1               109268.8         600668.6       218.1258           131474.7\n2                98906.8         410222.1       208.9410           114989.1\n3               119913.3         464156.7       210.9828           146607.2\n4               177104.1         562810.8       361.7767           108726.6\n5               301032.9         740922.4       299.5034           160663.7\n6              2931208.6        1418333.3       602.5571           331727.0\n7               249969.5         821236.4       532.1978           129241.2\n8               351634.0         775038.4       338.6777           171895.1\n9               289872.7         850095.5       439.9037           220223.4\n10              265529.7         631399.2       259.0169           189125.5\n   FREEHOLD_SE Intercept_TV AREA_SQM_TV     AGE_TV PROX_CBD_TV\n1     115954.0    3.9720784   11.614302  -1.615447 -3.22582173\n2     130110.0    3.3460017   20.087361  -9.344188 -6.32792021\n3     141031.5    3.5629010   13.247868  -4.102368 -4.62353528\n4     138239.1    0.5276150   33.577223 -15.524302  5.17080808\n5     210641.1    1.0784029    4.884795  -2.152474 -0.77155660\n6     374347.3   -0.1249043    2.572214  -1.817269  0.06207388\n7     182216.9   -4.2305303   18.849348  -6.595605 -2.84136028\n8     216649.4    0.9189786    4.879056  -2.041481 -0.65080678\n9     220473.7    2.1104224   10.150733  -1.221345  1.18682383\n10    206346.2    1.4343123   11.068059  -3.176418 -1.35360852\n   PROX_CHILDCARE_TV PROX_ELDERLYCARE_TV PROX_URA_GROWTH_AREA_TV PROX_MRT_TV\n1         1.00048819          -3.2612693            -2.846248368 -1.61864578\n2         1.47178634           3.8462625            -1.848971738 -8.92998600\n3        -0.34404755           4.1319138            -2.648105057 -3.40075727\n4         1.57665606           2.4756745            -5.691404992 -7.28705261\n5         0.12990138          -0.4196596             0.640289855 -0.12249416\n6        -0.13361179          -0.4237096            -0.005103357  1.00426206\n7        -0.33542751          -0.8235874             3.760298131 -7.31116712\n8         0.09462126          -0.2405003             0.520038994 -0.03439159\n9        -0.93339393          -0.3739225            -2.359121712 -1.67102293\n10        0.15961128           1.9461735            -0.627237944 -2.63204802\n   PROX_PARK_TV PROX_PRIMARY_SCH_TV PROX_SHOPPING_MALL_TV PROX_BUS_STOP_TV\n1   -0.83749312           1.5923022            2.75358842        2.0154464\n2    2.28192684           6.7019454           -0.88662640        4.4941192\n3    0.66565951           2.9058009           -1.05686949        3.0419145\n4   -3.34061770          12.9836105           -0.16709578       12.8383775\n5   -0.02820944           0.1220998           -0.02488294        0.9145046\n6    0.86781794           0.4696245            0.08821750        0.7656963\n7    2.38773567           5.1844351           -1.53719231        6.2029165\n8    0.16674816           0.2042469           -0.11271635        0.9493299\n9   -0.43301073          -0.1442145            0.95462153        3.3123012\n10   0.95831249           0.3290120           -1.71252687        3.3632555\n   NO_Of_UNITS_TV FAMILY_FRIENDLY_TV FREEHOLD_TV  Local_R2\n1     0.480589953        -0.06902748    2.621347 0.8846744\n2    -1.380026395         2.69655779    3.045280 0.8899773\n3    -0.045279967         0.04058290    1.197050 0.8947007\n4    -0.446007570        14.31276425    8.771149 0.9073605\n5     0.141120178         0.36714544    1.557983 0.9510057\n6    -0.355762335         0.60891234    1.260522 0.9247586\n7    -0.001731033         2.78285441    2.243875 0.8310458\n8     0.089093858         0.32346758    1.602012 0.9463936\n9     1.534793921        -0.13828365    2.285410 0.8380365\n10   -0.082251138        -0.53369623    1.033819 0.9080753\n                    geometry\n1  POINT (22085.12 29951.54)\n2   POINT (25656.84 34546.2)\n3   POINT (23963.99 32890.8)\n4  POINT (27044.28 32319.77)\n5  POINT (41042.56 33743.64)\n6   POINT (39717.04 32943.1)\n7   POINT (28419.1 33513.37)\n8  POINT (40763.57 33879.61)\n9  POINT (23595.63 28884.78)\n10 POINT (24586.56 33194.31)\n\n\n\ngwr.adaptive.output &lt;- as.data.frame(gwr.adaptive$SDF)\ncondo_resale.sf.adaptive &lt;- cbind(condo_resale.res.sf, as.matrix(gwr.adaptive.output))\n\n\nglimpse(condo_resale.sf.adaptive)\n\nRows: 1,436\nColumns: 77\n$ POSTCODE                &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472…\n$ SELLING_PRICE           &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ AREA_SQM                &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 1…\n$ AGE                     &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22,…\n$ PROX_CBD                &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783…\n$ PROX_CHILDCARE          &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543…\n$ PROX_ELDERLYCARE        &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.…\n$ PROX_URA_GROWTH_AREA    &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.4106…\n$ PROX_HAWKER_MARKET      &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969…\n$ PROX_KINDERGARTEN       &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076…\n$ PROX_MRT                &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.…\n$ PROX_PARK               &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.…\n$ PROX_PRIMARY_SCH        &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.…\n$ PROX_TOP_PRIMARY_SCH    &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.…\n$ PROX_SHOPPING_MALL      &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.…\n$ PROX_SUPERMARKET        &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.…\n$ PROX_BUS_STOP           &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340…\n$ NO_Of_UNITS             &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34…\n$ FAMILY_FRIENDLY         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ LOG_SELLING_PRICE       &lt;dbl&gt; 14.91412, 15.17135, 15.01698, 15.26243, 14.151…\n$ MLR_RES                 &lt;dbl&gt; -1489099.55, 415494.57, 194129.69, 1088992.71,…\n$ Intercept               &lt;dbl&gt; 2050011.67, 1633128.24, 3433608.17, 234358.91,…\n$ AREA_SQM.1              &lt;dbl&gt; 9561.892, 16576.853, 13091.861, 20730.601, 672…\n$ AGE.1                   &lt;dbl&gt; -9514.634, -58185.479, -26707.386, -93308.988,…\n$ PROX_CBD.1              &lt;dbl&gt; -120681.94, -149434.22, -259397.77, 2426853.66…\n$ PROX_CHILDCARE.1        &lt;dbl&gt; 319266.925, 441102.177, -120116.816, 480825.28…\n$ PROX_ELDERLYCARE.1      &lt;dbl&gt; -393417.795, 325188.741, 535855.806, 314783.72…\n$ PROX_URA_GROWTH_AREA.1  &lt;dbl&gt; -159980.203, -142290.389, -253621.206, -267929…\n$ PROX_MRT.1              &lt;dbl&gt; -299742.96, -2510522.23, -936853.28, -2039479.…\n$ PROX_PARK.1             &lt;dbl&gt; -172104.47, 523379.72, 209099.85, -759153.26, …\n$ PROX_PRIMARY_SCH.1      &lt;dbl&gt; 242668.03, 1106830.66, 571462.33, 3127477.21, …\n$ PROX_SHOPPING_MALL.1    &lt;dbl&gt; 300881.390, -87693.378, -126732.712, -29593.34…\n$ PROX_BUS_STOP.1         &lt;dbl&gt; 1210615.44, 1843587.22, 1411924.90, 7225577.51…\n$ NO_Of_UNITS.1           &lt;dbl&gt; 104.8290640, -288.3441183, -9.5532945, -161.35…\n$ FAMILY_FRIENDLY.1       &lt;dbl&gt; -9075.370, 310074.664, 5949.746, 1556178.531, …\n$ FREEHOLD.1              &lt;dbl&gt; 303955.61, 396221.27, 168821.75, 1212515.58, 3…\n$ y                       &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ yhat                    &lt;dbl&gt; 2886531.8, 3466801.5, 3616527.2, 5435481.6, 13…\n$ residual                &lt;dbl&gt; 113468.16, 413198.52, -291527.20, -1185481.63,…\n$ CV_Score                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ Stud_residual           &lt;dbl&gt; 0.38207013, 1.01433140, -0.83780678, -2.846146…\n$ Intercept_SE            &lt;dbl&gt; 516105.5, 488083.5, 963711.4, 444185.5, 211962…\n$ AREA_SQM_SE             &lt;dbl&gt; 823.2860, 825.2380, 988.2240, 617.4007, 1376.2…\n$ AGE_SE                  &lt;dbl&gt; 5889.782, 6226.916, 6510.236, 6010.511, 8180.3…\n$ PROX_CBD_SE             &lt;dbl&gt; 37411.22, 23615.06, 56103.77, 469337.41, 41064…\n$ PROX_CHILDCARE_SE       &lt;dbl&gt; 319111.1, 299705.3, 349128.5, 304965.2, 698720…\n$ PROX_ELDERLYCARE_SE     &lt;dbl&gt; 120633.34, 84546.69, 129687.07, 127150.69, 327…\n$ PROX_URA_GROWTH_AREA_SE &lt;dbl&gt; 56207.39, 76956.50, 95774.60, 470762.12, 47433…\n$ PROX_MRT_SE             &lt;dbl&gt; 185181.3, 281133.9, 275483.7, 279877.1, 363830…\n$ PROX_PARK_SE            &lt;dbl&gt; 205499.6, 229358.7, 314124.3, 227249.4, 364580…\n$ PROX_PRIMARY_SCH_SE     &lt;dbl&gt; 152400.7, 165150.7, 196662.6, 240878.9, 249087…\n$ PROX_SHOPPING_MALL_SE   &lt;dbl&gt; 109268.8, 98906.8, 119913.3, 177104.1, 301032.…\n$ PROX_BUS_STOP_SE        &lt;dbl&gt; 600668.6, 410222.1, 464156.7, 562810.8, 740922…\n$ NO_Of_UNITS_SE          &lt;dbl&gt; 218.1258, 208.9410, 210.9828, 361.7767, 299.50…\n$ FAMILY_FRIENDLY_SE      &lt;dbl&gt; 131474.73, 114989.07, 146607.22, 108726.62, 16…\n$ FREEHOLD_SE             &lt;dbl&gt; 115954.0, 130110.0, 141031.5, 138239.1, 210641…\n$ Intercept_TV            &lt;dbl&gt; 3.9720784, 3.3460017, 3.5629010, 0.5276150, 1.…\n$ AREA_SQM_TV             &lt;dbl&gt; 11.614302, 20.087361, 13.247868, 33.577223, 4.…\n$ AGE_TV                  &lt;dbl&gt; -1.6154474, -9.3441881, -4.1023685, -15.524301…\n$ PROX_CBD_TV             &lt;dbl&gt; -3.22582173, -6.32792021, -4.62353528, 5.17080…\n$ PROX_CHILDCARE_TV       &lt;dbl&gt; 1.000488185, 1.471786337, -0.344047555, 1.5766…\n$ PROX_ELDERLYCARE_TV     &lt;dbl&gt; -3.26126929, 3.84626245, 4.13191383, 2.4756745…\n$ PROX_URA_GROWTH_AREA_TV &lt;dbl&gt; -2.846248368, -1.848971738, -2.648105057, -5.6…\n$ PROX_MRT_TV             &lt;dbl&gt; -1.61864578, -8.92998600, -3.40075727, -7.2870…\n$ PROX_PARK_TV            &lt;dbl&gt; -0.83749312, 2.28192684, 0.66565951, -3.340617…\n$ PROX_PRIMARY_SCH_TV     &lt;dbl&gt; 1.59230221, 6.70194543, 2.90580089, 12.9836104…\n$ PROX_SHOPPING_MALL_TV   &lt;dbl&gt; 2.753588422, -0.886626400, -1.056869486, -0.16…\n$ PROX_BUS_STOP_TV        &lt;dbl&gt; 2.0154464, 4.4941192, 3.0419145, 12.8383775, 0…\n$ NO_Of_UNITS_TV          &lt;dbl&gt; 0.480589953, -1.380026395, -0.045279967, -0.44…\n$ FAMILY_FRIENDLY_TV      &lt;dbl&gt; -0.06902748, 2.69655779, 0.04058290, 14.312764…\n$ FREEHOLD_TV             &lt;dbl&gt; 2.6213469, 3.0452799, 1.1970499, 8.7711485, 1.…\n$ Local_R2                &lt;dbl&gt; 0.8846744, 0.8899773, 0.8947007, 0.9073605, 0.…\n$ coords.x1               &lt;dbl&gt; 22085.12, 25656.84, 23963.99, 27044.28, 41042.…\n$ coords.x2               &lt;dbl&gt; 29951.54, 34546.20, 32890.80, 32319.77, 33743.…\n$ geometry                &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n\n\n\nsummary(gwr.adaptive$SDF$yhat)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n  171347  1102001  1385528  1751842  1982307 13887901 \n\n\nVisualizing local R2\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nVisualize coefficient estimates\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\nAREA_SQM_SE &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nAREA_SQM_TV &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\n\n\nURA Planning Region\n\ntm_shape(mpsz_svy21[mpsz_svy21$REGION_N==\"CENTRAL REGION\", ])+\n  tm_polygons()+\ntm_shape(condo_resale.sf.adaptive) + \n  tm_bubbles(col = \"Local_R2\",\n           size = 0.15,\n           border.col = \"gray60\",\n           border.lwd = 1)\n\nWarning: The shape mpsz_svy21[mpsz_svy21$REGION_N == \"CENTRAL REGION\", ] is\ninvalid (after reprojection). See sf::st_is_valid"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex07/In-class_Ex07.html",
    "href": "In-class_Ex/In-class_Ex07/In-class_Ex07.html",
    "title": "In-class Exercise 07",
    "section": "",
    "text": "Geographically Weighted Regression\n\n\n\npacman::p_load(olsrr, corrplot, ggpubr, sf, spdep, GWmodel, tmap, tidyverse, gtsummary,ggstatsplot)\n\nURA Master Plan 2014’s planning subzone boundaries\n\nmpsz = st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex07/data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex07\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)\n\n\nst_crs(mpsz_svy21)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nst_bbox(mpsz_svy21) #view extent\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334 \n\n\n\ncondo_resale = read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex07/data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n\n\nhead(condo_resale$LONGITUDE) #see the data in XCOORD column\n\n[1] 103.7802 103.8123 103.7971 103.8247 103.9505 103.9386\n\n\nNorth side of equatorial\n\nhead(condo_resale$LATITUDE) #see the data in YCOORD column\n\n[1] 1.287145 1.328698 1.313727 1.308563 1.321437 1.314198\n\n\n\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05351   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_Of_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151710   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\nneed to assign\n\ncondo_resale_sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs=4326) %&gt;%\n  st_transform(crs=3414)\n\n\nhead(condo_resale_sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_Of_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;\n\n\nIn hands-on exercise,we use corrplot to check multicollinearity, but it runs correlation first\nHere we use ggstatplot, only one line of code\n\nggcorrmat(condo_resale[,5:23])\n\n\n\n\n\n\n\n\nperform VIF to check multicollinearity\n\ncondo.mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE    + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n                  PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD+LEASEHOLD_99YR, \n                data=condo_resale_sf)\nsummary(condo.mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD + \n    LEASEHOLD_99YR, data = condo_resale_sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3471036  -286903   -22426   239412 12254549 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           543071.4   136210.9   3.987 7.03e-05 ***\nAREA_SQM               12688.7      370.1  34.283  &lt; 2e-16 ***\nAGE                   -24566.0     2766.0  -8.881  &lt; 2e-16 ***\nPROX_CBD              -78122.0     6791.4 -11.503  &lt; 2e-16 ***\nPROX_CHILDCARE       -333219.0   111020.3  -3.001 0.002734 ** \nPROX_ELDERLYCARE      170950.0    42110.8   4.060 5.19e-05 ***\nPROX_URA_GROWTH_AREA   38507.6    12523.7   3.075 0.002147 ** \nPROX_HAWKER_MARKET     23801.2    29299.9   0.812 0.416739    \nPROX_KINDERGARTEN     144098.0    82738.7   1.742 0.081795 .  \nPROX_MRT             -322775.9    58528.1  -5.515 4.14e-08 ***\nPROX_PARK             564487.9    66563.0   8.481  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      186170.5    65515.2   2.842 0.004553 ** \nPROX_TOP_PRIMARY_SCH    -477.1    20598.0  -0.023 0.981525    \nPROX_SHOPPING_MALL   -207721.5    42855.5  -4.847 1.39e-06 ***\nPROX_SUPERMARKET      -48074.7    77145.3  -0.623 0.533273    \nPROX_BUS_STOP         675755.0   138552.0   4.877 1.20e-06 ***\nNO_Of_UNITS             -216.2       90.3  -2.394 0.016797 *  \nFAMILY_FRIENDLY       142128.3    47055.1   3.020 0.002569 ** \nFREEHOLD              300646.5    77296.5   3.890 0.000105 ***\nLEASEHOLD_99YR        -77137.4    77570.9  -0.994 0.320192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1416 degrees of freedom\nMultiple R-squared:  0.652, Adjusted R-squared:  0.6474 \nF-statistic: 139.6 on 19 and 1416 DF,  p-value: &lt; 2.2e-16\n\n\nlm = object class in R fitted values = estimated selling price\nuse olsrr to perform regression model, can use to perform stepwise regression, directly consume lm object\n\nols_regress(condo.mlr)\n\n                                Model Summary                                 \n-----------------------------------------------------------------------------\nR                            0.807       RMSE                     750537.537 \nR-Squared                    0.652       MSE                571262902261.223 \nAdj. R-Squared               0.647       Coef. Var                    43.160 \nPred R-Squared               0.637       AIC                       42971.173 \nMAE                     412117.987       SBC                       43081.835 \n-----------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.515738e+15          19        7.977571e+13    139.648    0.0000 \nResidual      8.089083e+14        1416    571262902261.223                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     543071.420    136210.918                   3.987    0.000     275874.535     810268.305 \n            AREA_SQM      12688.669       370.119        0.579     34.283    0.000      11962.627      13414.710 \n                 AGE     -24566.001      2766.041       -0.166     -8.881    0.000     -29991.980     -19140.022 \n            PROX_CBD     -78121.985      6791.377       -0.267    -11.503    0.000     -91444.227     -64799.744 \n      PROX_CHILDCARE    -333219.036    111020.303       -0.087     -3.001    0.003    -551000.984    -115437.089 \n    PROX_ELDERLYCARE     170949.961     42110.748        0.083      4.060    0.000      88343.803     253556.120 \nPROX_URA_GROWTH_AREA      38507.622     12523.661        0.059      3.075    0.002      13940.700      63074.545 \n  PROX_HAWKER_MARKET      23801.197     29299.923        0.019      0.812    0.417     -33674.725      81277.120 \n   PROX_KINDERGARTEN     144097.972     82738.669        0.030      1.742    0.082     -18205.570     306401.514 \n            PROX_MRT    -322775.874     58528.079       -0.123     -5.515    0.000    -437586.937    -207964.811 \n           PROX_PARK     564487.876     66563.011        0.148      8.481    0.000     433915.162     695060.590 \n    PROX_PRIMARY_SCH     186170.524     65515.193        0.072      2.842    0.005      57653.253     314687.795 \nPROX_TOP_PRIMARY_SCH       -477.073     20597.972       -0.001     -0.023    0.982     -40882.894      39928.747 \n  PROX_SHOPPING_MALL    -207721.520     42855.500       -0.109     -4.847    0.000    -291788.613    -123654.427 \n    PROX_SUPERMARKET     -48074.679     77145.257       -0.012     -0.623    0.533    -199405.956     103256.599 \n       PROX_BUS_STOP     675755.044    138551.991        0.133      4.877    0.000     403965.817     947544.272 \n         NO_Of_UNITS       -216.180        90.302       -0.046     -2.394    0.017       -393.320        -39.040 \n     FAMILY_FRIENDLY     142128.272     47055.082        0.056      3.020    0.003      49823.107     234433.438 \n            FREEHOLD     300646.543     77296.529        0.117      3.890    0.000     149018.525     452274.561 \n      LEASEHOLD_99YR     -77137.375     77570.869       -0.030     -0.994    0.320    -229303.551      75028.801 \n-----------------------------------------------------------------------------------------------------------------\n\n\nshould perform this to exclude those not significant variable\n\nols_vif_tol(condo.mlr)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8601326 1.162611\n2                   AGE 0.7011585 1.426211\n3              PROX_CBD 0.4575471 2.185567\n4        PROX_CHILDCARE 0.2898233 3.450378\n5      PROX_ELDERLYCARE 0.5922238 1.688551\n6  PROX_URA_GROWTH_AREA 0.6614081 1.511926\n7    PROX_HAWKER_MARKET 0.4373874 2.286303\n8     PROX_KINDERGARTEN 0.8356793 1.196631\n9              PROX_MRT 0.4949877 2.020252\n10            PROX_PARK 0.8015728 1.247547\n11     PROX_PRIMARY_SCH 0.3823248 2.615577\n12 PROX_TOP_PRIMARY_SCH 0.4878620 2.049760\n13   PROX_SHOPPING_MALL 0.4903052 2.039546\n14     PROX_SUPERMARKET 0.6142127 1.628100\n15        PROX_BUS_STOP 0.3311024 3.020213\n16          NO_Of_UNITS 0.6543336 1.528272\n17      FAMILY_FRIENDLY 0.7191719 1.390488\n18             FREEHOLD 0.2728521 3.664990\n19       LEASEHOLD_99YR 0.2645988 3.779307\n\n\nonly few are greater than 0.5\nforward stepwise regression, put in 1 after 1\n\ncondo_fw_mlr &lt;- ols_step_forward_p(\n  condo.mlr,\n  p_val = 0.05,\n  details = FALSE\n)\n\n\nplot(condo_fw_mlr)\n\n\n\n\n\n\n\n\n\nggcoefstats(condo.mlr,\n            sort = \"ascending\")\n\nNumber of labels is greater than default palette color count.\n• Select another color `palette` (and/or `package`).\n\n\n\n\n\n\n\n\n\nbackward stepwise regression put in everything first, move out one after another\n\nols_plot_resid_fit(condo_fw_mlr$model)\n\n\n\n\n\n\n\n\nhover around the red line, conform the assumption, most\n\nols_plot_resid_hist(condo_fw_mlr$model)\n\n\n\n\n\n\n\n\n\nols_test_normality(condo_fw_mlr$model)\n\nWarning in ks.test.default(y, \"pnorm\", mean(y), sd(y)): ties should not be\npresent for the one-sample Kolmogorov-Smirnov test\n\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n\n\n\nTest for Spatial Autocorrelation\n\nmlr_output &lt;- as.data.frame(condo_fw_mlr$model$residuals) %&gt;% \n  rename('FW_MLR_RES'='condo_fw_mlr$model$residuals')\n\n\ncondo_resale_sf &lt;- cbind(condo_resale_sf,\n                         mlr_output$FW_MLR_RES) %&gt;% \n  rename('MLR_RES' = 'mlr_output.FW_MLR_RES')\n\n\ntmap_mode('view')\n\ntmap mode set to interactive viewing\n\ntm_shape(mpsz)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) + \ntm_shape(condo_resale_sf) +\n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.5,\n          style = \"quantile\")\n\nWarning: The shape mpsz is invalid (after reprojection). See sf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\n\nSpatial stationary test\n\nlibrary(sfdep)\ncondo_resale_sf &lt;- condo_resale_sf %&gt;% \n  mutate(nb=st_knn(geometry, k=6,\n                   longlat=FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n\n\nglobal_moran_perm(condo_resale_sf$MLR_RES,\n                  condo_resale_sf$nb,\n                  condo_resale_sf$wt,\n                  alternative = \"two.sided\",\n                  nsim=99)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 100 \n\nstatistic = 0.32254, observed rank = 100, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\n\n\n\n\nBuilding Fixed Bandwidth GWR model\n\nbw.fixed &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale_sf, \n                          kernel = 'gaussian', \n                          adaptive= FALSE, \n                          longlat = FALSE)\n\nFixed bandwidth: 17660.96 CV score: 8.259118e+14 \nFixed bandwidth: 10917.26 CV score: 7.970454e+14 \nFixed bandwidth: 6749.419 CV score: 7.273273e+14 \nFixed bandwidth: 4173.553 CV score: 6.300006e+14 \nFixed bandwidth: 2581.58 CV score: 5.404958e+14 \nFixed bandwidth: 1597.687 CV score: 4.857515e+14 \nFixed bandwidth: 989.6077 CV score: 4.722431e+14 \nFixed bandwidth: 613.7939 CV score: 1.378294e+16 \nFixed bandwidth: 1221.873 CV score: 4.778717e+14 \nFixed bandwidth: 846.0596 CV score: 4.791629e+14 \nFixed bandwidth: 1078.325 CV score: 4.751406e+14 \nFixed bandwidth: 934.7772 CV score: 4.72518e+14 \nFixed bandwidth: 1023.495 CV score: 4.730305e+14 \nFixed bandwidth: 968.6643 CV score: 4.721317e+14 \nFixed bandwidth: 955.7206 CV score: 4.722072e+14 \nFixed bandwidth: 976.6639 CV score: 4.721387e+14 \nFixed bandwidth: 963.7202 CV score: 4.721484e+14 \nFixed bandwidth: 971.7199 CV score: 4.721293e+14 \nFixed bandwidth: 973.6083 CV score: 4.721309e+14 \nFixed bandwidth: 970.5527 CV score: 4.721295e+14 \nFixed bandwidth: 972.4412 CV score: 4.721296e+14 \nFixed bandwidth: 971.2741 CV score: 4.721292e+14 \nFixed bandwidth: 970.9985 CV score: 4.721293e+14 \nFixed bandwidth: 971.4443 CV score: 4.721292e+14 \nFixed bandwidth: 971.5496 CV score: 4.721293e+14 \nFixed bandwidth: 971.3793 CV score: 4.721292e+14 \nFixed bandwidth: 971.3391 CV score: 4.721292e+14 \nFixed bandwidth: 971.3143 CV score: 4.721292e+14 \nFixed bandwidth: 971.3545 CV score: 4.721292e+14 \nFixed bandwidth: 971.3296 CV score: 4.721292e+14 \nFixed bandwidth: 971.345 CV score: 4.721292e+14 \nFixed bandwidth: 971.3355 CV score: 4.721292e+14 \nFixed bandwidth: 971.3413 CV score: 4.721292e+14 \nFixed bandwidth: 971.3377 CV score: 4.721292e+14 \nFixed bandwidth: 971.34 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.3403 CV score: 4.721292e+14 \nFixed bandwidth: 971.3406 CV score: 4.721292e+14 \nFixed bandwidth: 971.3404 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \n\n\n\ngwr_fixed &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + \n                         AGE    + PROX_CBD + PROX_CHILDCARE + \n                         PROX_ELDERLYCARE   +PROX_URA_GROWTH_AREA + \n                         PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH +\n                         PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                         NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                       data=condo_resale_sf, \n                       bw=bw.fixed, \n                       kernel = 'gaussian', \n                       longlat = FALSE)\n\n\ngwr_fixed\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-16 20:56:23.920384 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale_sf, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3405 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4646e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9007e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5207e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793548\n   AREA_SQM                 21575\n   AGE                     434201\n   PROX_CBD               2704596\n   PROX_CHILDCARE         1654087\n   PROX_ELDERLYCARE      38867814\n   PROX_URA_GROWTH_AREA  78515730\n   PROX_MRT               3124316\n   PROX_PARK             18122425\n   PROX_PRIMARY_SCH       4637503\n   PROX_SHOPPING_MALL     1529952\n   PROX_BUS_STOP         11342182\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073636\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3804 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6196 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.53407e+14 \n   R-square value:  0.8909912 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2024-10-16 20:56:24.703539 \n\n\nThe report shows that the AICc of the gwr is 42263.61 which is significantly smaller than the global multiple linear regression model of 42967.1.\n\n\nBuilding Adaptive Bandwidth GWR model\n\nbw_adaptive &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_SHOPPING_MALL   + PROX_BUS_STOP + \n                        NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                      data=condo_resale_sf, \n                      approach=\"CV\", \n                      kernel=\"gaussian\", \n                      adaptive=TRUE, \n                      longlat=FALSE)\n\nAdaptive bandwidth: 895 CV score: 7.952401e+14 \nAdaptive bandwidth: 561 CV score: 7.667364e+14 \nAdaptive bandwidth: 354 CV score: 6.953454e+14 \nAdaptive bandwidth: 226 CV score: 6.15223e+14 \nAdaptive bandwidth: 147 CV score: 5.674373e+14 \nAdaptive bandwidth: 98 CV score: 5.426745e+14 \nAdaptive bandwidth: 68 CV score: 5.168117e+14 \nAdaptive bandwidth: 49 CV score: 4.859631e+14 \nAdaptive bandwidth: 37 CV score: 4.646518e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \nAdaptive bandwidth: 25 CV score: 4.430816e+14 \nAdaptive bandwidth: 32 CV score: 4.505602e+14 \nAdaptive bandwidth: 27 CV score: 4.462172e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \n\n\n30 is the recommended data points to be used\n\ngwr.adaptive &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                            NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale_sf, bw=bw.fixed, \n                          kernel = 'gaussian', \n                          longlat = FALSE)\n\n\ngwr.adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-16 20:56:29.699087 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale_sf, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3405 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4646e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9007e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5207e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793548\n   AREA_SQM                 21575\n   AGE                     434201\n   PROX_CBD               2704596\n   PROX_CHILDCARE         1654087\n   PROX_ELDERLYCARE      38867814\n   PROX_URA_GROWTH_AREA  78515730\n   PROX_MRT               3124316\n   PROX_PARK             18122425\n   PROX_PRIMARY_SCH       4637503\n   PROX_SHOPPING_MALL     1529952\n   PROX_BUS_STOP         11342182\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073636\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3804 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6196 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.53407e+14 \n   R-square value:  0.8909912 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2024-10-16 20:56:30.37479 \n\n\nConverting SDF into sf data.frame\n\ngwr_adaptive_output &lt;- as.data.frame(\n  gwr.adaptive$SDF) %&gt;% \n  select(-c(2:15)\n)\n\n\ngwr_sf_adaptive &lt;- cbind(condo_resale_sf,\n                         gwr_adaptive_output)\n\n\nglimpse(gwr_sf_adaptive)\n\nRows: 1,436\nColumns: 63\n$ nb                      &lt;nb&gt; &lt;66, 77, 123, 238, 239, 343&gt;, &lt;21, 162, 163, 19…\n$ wt                      &lt;list&gt; &lt;0.1666667, 0.1666667, 0.1666667, 0.1666667, …\n$ POSTCODE                &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472…\n$ SELLING_PRICE           &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ AREA_SQM                &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 1…\n$ AGE                     &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22,…\n$ PROX_CBD                &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783…\n$ PROX_CHILDCARE          &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543…\n$ PROX_ELDERLYCARE        &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.…\n$ PROX_URA_GROWTH_AREA    &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.4106…\n$ PROX_HAWKER_MARKET      &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969…\n$ PROX_KINDERGARTEN       &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076…\n$ PROX_MRT                &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.…\n$ PROX_PARK               &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.…\n$ PROX_PRIMARY_SCH        &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.…\n$ PROX_TOP_PRIMARY_SCH    &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.…\n$ PROX_SHOPPING_MALL      &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.…\n$ PROX_SUPERMARKET        &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.…\n$ PROX_BUS_STOP           &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340…\n$ NO_Of_UNITS             &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34…\n$ FAMILY_FRIENDLY         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ MLR_RES                 &lt;dbl&gt; -1489099.55, 415494.57, 194129.69, 1088992.71,…\n$ Intercept               &lt;dbl&gt; 1580824.71, 1509406.28, 3583211.16, -444860.49…\n$ y                       &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ yhat                    &lt;dbl&gt; 2900355.0, 3499796.0, 3628135.3, 5359292.0, 13…\n$ residual                &lt;dbl&gt; 99644.96, 380204.01, -303135.30, -1109292.00, …\n$ CV_Score                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ Stud_residual           &lt;dbl&gt; 0.58164609, 1.00012683, -0.88571524, -2.513378…\n$ Intercept_SE            &lt;dbl&gt; 3395011.7, 1352467.0, 1339841.1, 370353.7, 242…\n$ AREA_SQM_SE             &lt;dbl&gt; 1580.6464, 1221.7304, 1119.0686, 616.3396, 154…\n$ AGE_SE                  &lt;dbl&gt; 15224.251, 9536.861, 7725.609, 5978.954, 9264.…\n$ PROX_CBD_SE             &lt;dbl&gt; 156762.55, 72009.21, 79937.75, 359165.60, 4780…\n$ PROX_CHILDCARE_SE       &lt;dbl&gt; 568613.2, 463408.9, 398867.7, 305347.0, 806691…\n$ PROX_ELDERLYCARE_SE     &lt;dbl&gt; 579655.1, 156842.5, 178208.6, 118670.9, 414128…\n$ PROX_URA_GROWTH_AREA_SE &lt;dbl&gt; 422324.6, 191103.4, 125333.4, 366726.0, 563178…\n$ PROX_MRT_SE             &lt;dbl&gt; 606123.6, 560744.6, 334275.1, 271991.5, 454983…\n$ PROX_PARK_SE            &lt;dbl&gt; 399605.9, 435453.7, 374942.3, 216766.2, 469595…\n$ PROX_PRIMARY_SCH_SE     &lt;dbl&gt; 512060.9, 268609.3, 238048.9, 226860.0, 278753…\n$ PROX_SHOPPING_MALL_SE   &lt;dbl&gt; 482696.6, 239509.0, 142155.9, 153273.0, 376752…\n$ PROX_BUS_STOP_SE        &lt;dbl&gt; 1508504.5, 636969.8, 518721.9, 543058.9, 81911…\n$ NO_Of_UNITS_SE          &lt;dbl&gt; 806.8444, 266.4264, 234.1108, 324.0807, 353.41…\n$ FAMILY_FRIENDLY_SE      &lt;dbl&gt; 251502.9, 162760.6, 173178.3, 107958.2, 182177…\n$ FREEHOLD_SE             &lt;dbl&gt; 370362.8, 205263.5, 165806.1, 134885.6, 237553…\n$ Intercept_TV            &lt;dbl&gt; 0.4656316, 1.1160393, 2.6743554, -1.2011773, 0…\n$ AREA_SQM_TV             &lt;dbl&gt; 6.162087, 12.196149, 11.585038, 32.977013, 4.3…\n$ AGE_TV                  &lt;dbl&gt; -0.62722500, -4.56438096, -3.26172325, -15.228…\n$ PROX_CBD_TV             &lt;dbl&gt; -0.26572481, -2.24375590, -3.39501541, 3.74802…\n$ PROX_CHILDCARE_TV       &lt;dbl&gt; 0.314199728, 0.596072954, -0.662701339, 1.8528…\n$ PROX_ELDERLYCARE_TV     &lt;dbl&gt; -0.61040359, 1.27422394, 3.26841613, 2.1260488…\n$ PROX_URA_GROWTH_AREA_TV &lt;dbl&gt; -0.51714116, 0.30511964, -2.01288530, -4.31616…\n$ PROX_MRT_TV             &lt;dbl&gt; -0.68841147, -4.18708291, -2.84832358, -6.7173…\n$ PROX_PARK_TV            &lt;dbl&gt; -0.54239001, 0.92304803, 0.76850923, -2.802534…\n$ PROX_PRIMARY_SCH_TV     &lt;dbl&gt; 0.5897363, 2.7676171, 2.3052085, 13.1016452, 0…\n$ PROX_SHOPPING_MALL_TV   &lt;dbl&gt; 0.72864945, -1.32424806, -1.12186305, -0.69972…\n$ PROX_BUS_STOP_TV        &lt;dbl&gt; 0.79146959, 2.90629848, 2.87414548, 11.7683749…\n$ NO_Of_UNITS_TV          &lt;dbl&gt; 0.59112146, -0.80578975, 0.18687430, -0.615698…\n$ FAMILY_FRIENDLY_TV      &lt;dbl&gt; 0.235784421, 0.665313652, -0.356298596, 13.572…\n$ FREEHOLD_TV             &lt;dbl&gt; 0.86274374, 1.82752304, 0.94991015, 8.41398102…\n$ Local_R2                &lt;dbl&gt; 0.9473297, 0.9136782, 0.8989196, 0.8994818, 0.…\n$ geometry                &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n$ geometry.1              &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n\n\n\nsummary(gwr.adaptive$SDF$yhat)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   25983  1102639  1368200  1749605  1958093 13778201 \n\n\n\n\nVisualize local R2\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(gwr_sf_adaptive) +  \n  tm_dots(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz is invalid (after reprojection). See sf::st_is_valid\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\n\nVisualizing coefficient estimates\n\ntmap_options(check.and.fix = TRUE)\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\nAREA_SQM_SE &lt;- tm_shape(mpsz)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(gwr_sf_adaptive) +  \n  tm_dots(col = \"AREA_SQM_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nAREA_SQM_TV &lt;- tm_shape(mpsz)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(gwr_sf_adaptive) +  \n  tm_dots(col = \"AREA_SQM_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n\nWarning: The shape mpsz is invalid (after reprojection). See sf::st_is_valid\nWarning: The shape mpsz is invalid (after reprojection). See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBy URA Planning Region\n\ntm_shape(mpsz[mpsz$REGION_N==\"CENTRAL REGION\", ])+\n  tm_polygons()+\ntm_shape(gwr_sf_adaptive) + \n  tm_bubbles(col = \"Local_R2\",\n           size = 0.15,\n           border.col = \"gray60\",\n           border.lwd = 1)\n\nWarning: The shape mpsz[mpsz$REGION_N == \"CENTRAL REGION\", ] is invalid (after\nreprojection). See sf::st_is_valid"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex08/Hands-on_ex08.html",
    "href": "Hands-on_exercise/Hands-on_ex08/Hands-on_ex08.html",
    "title": "Hands-on Exercise 08",
    "section": "",
    "text": "Predictive modelling uses statistical learning or machine learning techniques to predict outcomes.\nRandom forest method.\n\n\n\npacman::p_load(sf, spdep, GWmodel, SpatialML, \n               tmap, rsample, Metrics, tidyverse)\n\nRead the input data sets. It is in simple feature data frame.\n\nmdata &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/mdata.rds\")\n\n\nany(duplicated(mdata))\n\n[1] TRUE\n\n\n\nset.seed(1234)\nfor(i in 1:nrow(mdata)) {\n  coords &lt;- st_coordinates(mdata[i,])\n  jittered_coords &lt;- coords + runif(n=1, min = -0.1, max = 0.1)\n  mdata[i,]$geometry &lt;- st_sfc(st_point(c(jittered_coords),dim = \"XY\"),crs = 3414)\n}\n\n\nany(duplicated(mdata))\n\n[1] FALSE\n\n\nSplit into training and test data, 65% for training, 35% for test initial_split() of rsample\n\nset.seed(1234)\nresale_split &lt;- initial_split(mdata, \n                              prop = 6.5/10,)\ntrain_data &lt;- training(resale_split)\ntest_data &lt;- testing(resale_split)\n\n\nwrite_rds(train_data, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/train_data.rds\")\nwrite_rds(test_data, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/test_data.rds\")\n\n\n\n\n\nmdata_nogeo &lt;- mdata %&gt;%\n  st_drop_geometry()\ncorrplot::corrplot(cor(mdata_nogeo[, 2:17]), \n                   diag = FALSE, \n                   order = \"AOE\",\n                   tl.pos = \"td\", \n                   tl.cex = 0.5, \n                   method = \"number\", \n                   type = \"upper\")\n\n\n\n\n\n\n\n\nNo sign of multicolinearity, correlation value = 0.8\n\ntrain_data &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/train_data.rds\")\ntest_data &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/test_data.rds\")\n\n\n\n\n\nprice_mlr &lt;- lm(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                data=train_data)\nsummary(price_mlr)\n\n\nCall:\nlm(formula = resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths + \n    PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK + \n    PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + \n    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, \n    data = train_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-205193  -39120   -1930   36545  472355 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***\nfloor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***\nstorey_order              14299.298    339.115  42.167  &lt; 2e-16 ***\nremaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***\nPROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***\nPROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***\nPROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***\nPROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***\nPROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***\nPROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***\nPROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***\nWITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***\nWITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***\nWITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***\nWITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 61650 on 10320 degrees of freedom\nMultiple R-squared:  0.7373,    Adjusted R-squared:  0.737 \nF-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16\n\n\nResiduals = differences between the actual resale prices and the predicted resale prices by the model Median residual is close to 0, which suggests that the model doesnt have systematic bias in its predictions.\nEstimate = coefficient = 2780.70 SGD resale price increase for every additional square meter in floor area.\nResidual standard error: standard deviation of the residuals, on average, the model’s prediction is off by about SGD61,650\n\nwrite_rds(price_mlr, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/price_mlr.rds\" ) \n\n\n\n\nConvert sf to spatialpointdataframe\n\ntrain_data_sp &lt;- as_Spatial(train_data)\ntrain_data_sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 10335 \nextent      : 11597.38, 42623.68, 28217.3, 48741.06  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 17\nnames       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,          PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... \nmin values  :       218000,             74,            1,                  555, 0.999393538715878, 1.98943787433087e-08, 0.0333358643817954, 0.0220407324774434, 0.0441643212802781, 0.0652540365486641,                0, 6.20621206270077e-09, 1.21715176356525e-07,                        0,                     0, ... \nmax values  :      1186888,            133,           17,                 1164,  19.6500691667807,     3.30163731686804,   2.86763031236184,   2.13060636038504,   2.41313695915468,   10.6223726149914, 2.27100643784442,    0.808332738794272,     1.57131703651196,                        7,                    20, ... \n\n\nComputing adaptive bandwidth\n\nbw_adaptive &lt;- bw.gwr(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                  data=train_data_sp,\n                  approach=\"CV\",\n                  kernel=\"gaussian\",\n                  adaptive=TRUE,\n                  longlat=FALSE)\n\nTake a cup of tea and have a break, it will take a few minutes.\n          -----A kind suggestion from GWmodel development group\nAdaptive bandwidth: 6395 CV score: 3.60536e+13 \nAdaptive bandwidth: 3960 CV score: 3.320316e+13 \nAdaptive bandwidth: 2455 CV score: 2.928339e+13 \nAdaptive bandwidth: 1524 CV score: 2.550955e+13 \nAdaptive bandwidth: 950 CV score: 1.956318e+13 \nAdaptive bandwidth: 593 CV score: 1.583469e+13 \nAdaptive bandwidth: 375 CV score: 1.310038e+13 \nAdaptive bandwidth: 237 CV score: 1.113155e+13 \nAdaptive bandwidth: 155 CV score: 9.572071e+12 \nAdaptive bandwidth: 101 CV score: 8.456967e+12 \nAdaptive bandwidth: 71 CV score: 7.605093e+12 \nAdaptive bandwidth: 49 CV score: 6.965771e+12 \nAdaptive bandwidth: 38 CV score: 7.599357e+12 \nAdaptive bandwidth: 58 CV score: 7.275193e+12 \nAdaptive bandwidth: 45 CV score: 6.872956e+12 \nAdaptive bandwidth: 41 CV score: 6.793108e+12 \nAdaptive bandwidth: 40 CV score: 6.780886e+12 \nAdaptive bandwidth: 38 CV score: 7.599357e+12 \nAdaptive bandwidth: 40 CV score: 6.780886e+12 \n\n\n40 neighbour points = optimal\n\nwrite_rds(bw_adaptive, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/bw_adaptive.rds\")\n\nConstruct the adaptive bandwidth gwr model\n\nbw_adaptive &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/bw_adaptive.rds\")\n\n\ngwr_adaptive &lt;- gwr.basic(formula = resale_price ~\n                            floor_area_sqm + storey_order +\n                            remaining_lease_mths + PROX_CBD + \n                            PROX_ELDERLYCARE + PROX_HAWKER +\n                            PROX_MRT + PROX_PARK + PROX_MALL + \n                            PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                            WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                            WITHIN_1KM_PRISCH,\n                          data=train_data_sp,\n                          bw=bw_adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE,\n                          longlat = FALSE)\n\n\nwrite_rds(gwr_adaptive, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwr_adaptive.rds\")\n\nRetrieve gwr output object\n\ngwr_adaptive &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwr_adaptive.rds\")\n\n\ngwr_adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-20 20:36:40.473558 \n   Call:\n   gwr.basic(formula = resale_price ~ floor_area_sqm + storey_order + \n    remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + \n    PROX_MRT + PROX_PARK + PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + \n    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, \n    data = train_data_sp, bw = bw_adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  resale_price\n   Independent variables:  floor_area_sqm storey_order remaining_lease_mths PROX_CBD PROX_ELDERLYCARE PROX_HAWKER PROX_MRT PROX_PARK PROX_MALL PROX_SUPERMARKET WITHIN_350M_KINDERGARTEN WITHIN_350M_CHILDCARE WITHIN_350M_BUS WITHIN_1KM_PRISCH\n   Number of data points: 10335\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n    Min      1Q  Median      3Q     Max \n-205193  -39120   -1930   36545  472355 \n\n   Coefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***\n   floor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***\n   storey_order              14299.298    339.115  42.167  &lt; 2e-16 ***\n   remaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***\n   PROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***\n   PROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***\n   PROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***\n   PROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***\n   PROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***\n   PROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***\n   PROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***\n   WITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***\n   WITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***\n   WITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***\n   WITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 61650 on 10320 degrees of freedom\n   Multiple R-squared: 0.7373\n   Adjusted R-squared: 0.737 \n   F-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 3.922202e+13\n   Sigma(hat): 61610.08\n   AIC:  257320.2\n   AICc:  257320.3\n   BIC:  247249\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 40 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                                   Min.     1st Qu.      Median     3rd Qu.\n   Intercept                -3.6491e+08 -4.7734e+05 -8.2999e+03  5.5034e+05\n   floor_area_sqm           -2.8629e+04  1.4475e+03  2.2999e+03  3.3897e+03\n   storey_order              3.3187e+03  8.5905e+03  1.0826e+04  1.3396e+04\n   remaining_lease_mths     -1.4438e+03  2.6062e+02  3.9049e+02  5.2861e+02\n   PROX_CBD                 -1.0842e+07 -5.7712e+04 -1.3792e+04  2.6532e+04\n   PROX_ELDERLYCARE         -3.5472e+07 -4.0637e+04  1.0567e+04  6.1073e+04\n   PROX_HAWKER              -2.3968e+08 -5.1360e+04  2.9612e+03  6.4265e+04\n   PROX_MRT                 -1.2593e+07 -1.0489e+05 -4.9352e+04  5.0924e+03\n   PROX_PARK                -6.5948e+06 -4.8678e+04 -8.7189e+02  5.3407e+04\n   PROX_MALL                -1.8125e+07 -7.4216e+04 -1.3974e+04  4.9828e+04\n   PROX_SUPERMARKET         -4.5733e+06 -6.3446e+04 -1.7445e+04  3.5572e+04\n   WITHIN_350M_KINDERGARTEN -4.3835e+05 -6.0020e+03  9.1166e+01  4.7236e+03\n   WITHIN_350M_CHILDCARE    -1.0274e+05 -2.2353e+03  2.6660e+02  2.6409e+03\n   WITHIN_350M_BUS          -1.1794e+05 -1.4726e+03  1.1618e+02  1.7595e+03\n   WITHIN_1KM_PRISCH        -6.6487e+05 -5.5955e+03  2.6942e+02  5.7472e+03\n                                  Max.\n   Intercept                1.6501e+08\n   floor_area_sqm           5.1150e+04\n   storey_order             2.9540e+04\n   remaining_lease_mths     1.8122e+03\n   PROX_CBD                 2.5090e+07\n   PROX_ELDERLYCARE         8.2802e+07\n   PROX_HAWKER              5.9665e+06\n   PROX_MRT                 2.0174e+08\n   PROX_PARK                1.6454e+07\n   PROX_MALL                1.0485e+07\n   PROX_SUPERMARKET         3.8794e+06\n   WITHIN_350M_KINDERGARTEN 6.7207e+05\n   WITHIN_350M_CHILDCARE    1.0791e+05\n   WITHIN_350M_BUS          3.7317e+04\n   WITHIN_1KM_PRISCH        5.1300e+05\n   ************************Diagnostic information*************************\n   Number of data points: 10335 \n   Effective number of parameters (2trace(S) - trace(S'S)): 1730.083 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 8604.917 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 238871.9 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 237036.9 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 238209 \n   Residual sum of squares: 4.829219e+12 \n   R-square value:  0.9676568 \n   Adjusted R-square value:  0.9611532 \n\n   ***********************************************************************\n   Program stops at: 2024-10-20 20:37:40.981568 \n\n\nConvert the test data from sf data.frame to SpatialPointDataFrame\n\ntest_data_sp &lt;- as_Spatial(test_data)\ntest_data_sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 5566 \nextent      : 11597.25, 42623.72, 28287.71, 48669.68  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 17\nnames       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,         PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... \nmin values  :       230888,             74,            1,                  546, 1.00583660772922, 3.34897933104965e-07, 0.0474019664161957, 0.0414043955932523, 0.0502664084494264, 0.0907500295577619,                0, 4.55547870890763e-09, 1.21715176356525e-07,                        0,                     0, ... \nmax values  :      1050000,            138,           14,                 1151,  19.632402730488,     3.30163731686804,   2.83106651960209,   2.13060636038504,   2.41313695915468,   10.6169590126272, 2.26056404492346,     0.79249074802552,     1.53786629004208,                        7,                    16, ... \n\n\nComputing adaptive bandwidth for the test data\n\ngwr_bw_test_adaptive &lt;- bw.gwr(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                  data=test_data_sp,\n                  approach=\"CV\",\n                  kernel=\"gaussian\",\n                  adaptive=TRUE,\n                  longlat=FALSE)\n\nTake a cup of tea and have a break, it will take a few minutes.\n          -----A kind suggestion from GWmodel development group\nAdaptive bandwidth: 3447 CV score: 1.902156e+13 \nAdaptive bandwidth: 2138 CV score: 1.752645e+13 \nAdaptive bandwidth: 1328 CV score: 1.556298e+13 \nAdaptive bandwidth: 828 CV score: 1.357496e+13 \nAdaptive bandwidth: 518 CV score: 1.03075e+13 \nAdaptive bandwidth: 327 CV score: 8.348382e+12 \nAdaptive bandwidth: 208 CV score: 6.860524e+12 \nAdaptive bandwidth: 135 CV score: 5.969492e+12 \nAdaptive bandwidth: 89 CV score: 5.242263e+12 \nAdaptive bandwidth: 62 CV score: 4.742763e+12 \nAdaptive bandwidth: 43 CV score: 4.357877e+12 \nAdaptive bandwidth: 34 CV score: 4.125835e+12 \nAdaptive bandwidth: 25 CV score: 4.148839e+12 \nAdaptive bandwidth: 36 CV score: 4.165627e+12 \nAdaptive bandwidth: 29 CV score: 4.061362e+12 \nAdaptive bandwidth: 29 CV score: 4.061362e+12 \n\n\nComputing predicted values of the test data\n\n# gwr_pred &lt;- gwr.predict(formula = resale_price ~\n#                           floor_area_sqm + storey_order +\n#                           remaining_lease_mths + PROX_CBD + \n#                           PROX_ELDERLYCARE + PROX_HAWKER + \n#                           PROX_MRT + PROX_PARK + PROX_MALL + \n#                           PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n#                           WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + \n#                           WITHIN_1KM_PRISCH, \n#                         data=train_data_sp, \n#                         predictdata = test_data_sp,\n#                         p=2,\n#                         theta=0,\n#                         bw=40, \n#                         kernel = 'gaussian', \n#                         adaptive=TRUE, \n#                         longlat = FALSE)\n\n\n\n\nExtract the x,y coordinates of the full, training and test data sets.\n\ncoords &lt;- st_coordinates(mdata)\ncoords_train &lt;- st_coordinates(train_data)\ncoords_test &lt;- st_coordinates(test_data)\n\nWrite all the output into rds for future used\n\ncoords_train &lt;- write_rds(coords_train, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/coords_train.rds\" )\ncoords_test &lt;- write_rds(coords_test, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/coords_test.rds\" )\n\n\ntrain_data &lt;- train_data %&gt;% \n  st_drop_geometry()\n\nCalibrating random forest model using ranger package\n\nset.seed(1234)\nrf &lt;- ranger(resale_price ~ floor_area_sqm + storey_order + \n               remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + \n               PROX_HAWKER + PROX_MRT + PROX_PARK + PROX_MALL + \n               PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n               WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + \n               WITHIN_1KM_PRISCH,\n             data=train_data)\nrf\n\nRanger result\n\nCall:\n ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      10335 \nNumber of independent variables:  14 \nMtry:                             3 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       728602496 \nR squared (OOB):                  0.9495728 \n\n\n\nwrite_rds(rf, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/rf.rds\")\n\n\nrf &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/rf.rds\")\nrf\n\nRanger result\n\nCall:\n ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      10335 \nNumber of independent variables:  14 \nMtry:                             3 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       728602496 \nR squared (OOB):                  0.9495728 \n\n\nMtry = The number of predictor variables randomly chosen for consideration at each split in a tree. Mtry of 3 means that 3 variables are randomly selected at each split to determine the best split.\nTarget node size: 5, min number of observations allowed in a terminal node of a tree. Here it indicates that each final node in the tree will have at least 5 observations.\nvariance importance mode: no additional variable importance metrics are reported in this output.\nSplitrule: variance = reduce the overall variancce in the target variable\nOut-of-bad(OOB)Prediction Error (MSE): Means Squared Error = 728602496 based on the Out-of-Bag samples.\nR-squared (OOB) = explain 95% of the variance in the resale prices, which indicates a very strong fit.\n\n\n\n# set.seed(1234)\n# gwRF_adaptive &lt;- grf(formula = resale_price ~ floor_area_sqm + storey_order +\n#                        remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE +\n#                        PROX_HAWKER + PROX_MRT + PROX_PARK + PROX_MALL +\n#                        PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n#                        WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n#                        WITHIN_1KM_PRISCH,\n#                      dframe=train_data, \n#                      bw=55,\n#                      kernel=\"adaptive\",\n#                      coords=coords_train)\n\nSave the model output\n\n# write_rds(gwRF_adaptive, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwRF_adaptive.rds\")\n\nRetrieve the save model\n\n# gwRF_adaptive &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwRF_adaptive.rds\")\n\n\n\n\n\ntest_data &lt;- cbind(test_data, coords_test) %&gt;%\n  st_drop_geometry()\n\n\n# gwRF_pred &lt;- predict.grf(gwRF_adaptive, \n#                            test_data, \n#                            x.var.name=\"X\",\n#                            y.var.name=\"Y\", \n#                            local.w=1,\n#                            global.w=0)\n\nSave the output into rds file\n\n# GRF_pred &lt;- write_rds(gwRF_pred, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/GRF_pred.rds\")"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex08/Hands-on_ex08.html#gwr-predictive-method",
    "href": "Hands-on_exercise/Hands-on_ex08/Hands-on_ex08.html#gwr-predictive-method",
    "title": "Hands-on Exercise 08",
    "section": "",
    "text": "Convert sf to spatialpointdataframe\n\ntrain_data_sp &lt;- as_Spatial(train_data)\ntrain_data_sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 10335 \nextent      : 11597.38, 42623.68, 28217.3, 48741.06  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 17\nnames       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,          PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... \nmin values  :       218000,             74,            1,                  555, 0.999393538715878, 1.98943787433087e-08, 0.0333358643817954, 0.0220407324774434, 0.0441643212802781, 0.0652540365486641,                0, 6.20621206270077e-09, 1.21715176356525e-07,                        0,                     0, ... \nmax values  :      1186888,            133,           17,                 1164,  19.6500691667807,     3.30163731686804,   2.86763031236184,   2.13060636038504,   2.41313695915468,   10.6223726149914, 2.27100643784442,    0.808332738794272,     1.57131703651196,                        7,                    20, ... \n\n\nComputing adaptive bandwidth\n\nbw_adaptive &lt;- bw.gwr(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                  data=train_data_sp,\n                  approach=\"CV\",\n                  kernel=\"gaussian\",\n                  adaptive=TRUE,\n                  longlat=FALSE)\n\nTake a cup of tea and have a break, it will take a few minutes.\n          -----A kind suggestion from GWmodel development group\nAdaptive bandwidth: 6395 CV score: 3.60536e+13 \nAdaptive bandwidth: 3960 CV score: 3.320316e+13 \nAdaptive bandwidth: 2455 CV score: 2.928339e+13 \nAdaptive bandwidth: 1524 CV score: 2.550955e+13 \nAdaptive bandwidth: 950 CV score: 1.956318e+13 \nAdaptive bandwidth: 593 CV score: 1.583469e+13 \nAdaptive bandwidth: 375 CV score: 1.310038e+13 \nAdaptive bandwidth: 237 CV score: 1.113155e+13 \nAdaptive bandwidth: 155 CV score: 9.572071e+12 \nAdaptive bandwidth: 101 CV score: 8.456967e+12 \nAdaptive bandwidth: 71 CV score: 7.605093e+12 \nAdaptive bandwidth: 49 CV score: 6.965771e+12 \nAdaptive bandwidth: 38 CV score: 7.599357e+12 \nAdaptive bandwidth: 58 CV score: 7.275193e+12 \nAdaptive bandwidth: 45 CV score: 6.872956e+12 \nAdaptive bandwidth: 41 CV score: 6.793108e+12 \nAdaptive bandwidth: 40 CV score: 6.780886e+12 \nAdaptive bandwidth: 38 CV score: 7.599357e+12 \nAdaptive bandwidth: 40 CV score: 6.780886e+12 \n\n\n40 neighbour points = optimal\n\nwrite_rds(bw_adaptive, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/bw_adaptive.rds\")\n\nConstruct the adaptive bandwidth gwr model\n\nbw_adaptive &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/bw_adaptive.rds\")\n\n\ngwr_adaptive &lt;- gwr.basic(formula = resale_price ~\n                            floor_area_sqm + storey_order +\n                            remaining_lease_mths + PROX_CBD + \n                            PROX_ELDERLYCARE + PROX_HAWKER +\n                            PROX_MRT + PROX_PARK + PROX_MALL + \n                            PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                            WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                            WITHIN_1KM_PRISCH,\n                          data=train_data_sp,\n                          bw=bw_adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE,\n                          longlat = FALSE)\n\n\nwrite_rds(gwr_adaptive, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwr_adaptive.rds\")\n\nRetrieve gwr output object\n\ngwr_adaptive &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwr_adaptive.rds\")\n\n\ngwr_adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-10-20 20:36:40.473558 \n   Call:\n   gwr.basic(formula = resale_price ~ floor_area_sqm + storey_order + \n    remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + \n    PROX_MRT + PROX_PARK + PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN + \n    WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH, \n    data = train_data_sp, bw = bw_adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  resale_price\n   Independent variables:  floor_area_sqm storey_order remaining_lease_mths PROX_CBD PROX_ELDERLYCARE PROX_HAWKER PROX_MRT PROX_PARK PROX_MALL PROX_SUPERMARKET WITHIN_350M_KINDERGARTEN WITHIN_350M_CHILDCARE WITHIN_350M_BUS WITHIN_1KM_PRISCH\n   Number of data points: 10335\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n    Min      1Q  Median      3Q     Max \n-205193  -39120   -1930   36545  472355 \n\n   Coefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)              107601.073  10601.261  10.150  &lt; 2e-16 ***\n   floor_area_sqm             2780.698     90.579  30.699  &lt; 2e-16 ***\n   storey_order              14299.298    339.115  42.167  &lt; 2e-16 ***\n   remaining_lease_mths        344.490      4.592  75.027  &lt; 2e-16 ***\n   PROX_CBD                 -16930.196    201.254 -84.124  &lt; 2e-16 ***\n   PROX_ELDERLYCARE         -14441.025    994.867 -14.516  &lt; 2e-16 ***\n   PROX_HAWKER              -19265.648   1273.597 -15.127  &lt; 2e-16 ***\n   PROX_MRT                 -32564.272   1744.232 -18.670  &lt; 2e-16 ***\n   PROX_PARK                 -5712.625   1483.885  -3.850 0.000119 ***\n   PROX_MALL                -14717.388   2007.818  -7.330 2.47e-13 ***\n   PROX_SUPERMARKET         -26881.938   4189.624  -6.416 1.46e-10 ***\n   WITHIN_350M_KINDERGARTEN   8520.472    632.812  13.464  &lt; 2e-16 ***\n   WITHIN_350M_CHILDCARE     -4510.650    354.015 -12.741  &lt; 2e-16 ***\n   WITHIN_350M_BUS             813.493    222.574   3.655 0.000259 ***\n   WITHIN_1KM_PRISCH         -8010.834    491.512 -16.298  &lt; 2e-16 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 61650 on 10320 degrees of freedom\n   Multiple R-squared: 0.7373\n   Adjusted R-squared: 0.737 \n   F-statistic:  2069 on 14 and 10320 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 3.922202e+13\n   Sigma(hat): 61610.08\n   AIC:  257320.2\n   AICc:  257320.3\n   BIC:  247249\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 40 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                                   Min.     1st Qu.      Median     3rd Qu.\n   Intercept                -3.6491e+08 -4.7734e+05 -8.2999e+03  5.5034e+05\n   floor_area_sqm           -2.8629e+04  1.4475e+03  2.2999e+03  3.3897e+03\n   storey_order              3.3187e+03  8.5905e+03  1.0826e+04  1.3396e+04\n   remaining_lease_mths     -1.4438e+03  2.6062e+02  3.9049e+02  5.2861e+02\n   PROX_CBD                 -1.0842e+07 -5.7712e+04 -1.3792e+04  2.6532e+04\n   PROX_ELDERLYCARE         -3.5472e+07 -4.0637e+04  1.0567e+04  6.1073e+04\n   PROX_HAWKER              -2.3968e+08 -5.1360e+04  2.9612e+03  6.4265e+04\n   PROX_MRT                 -1.2593e+07 -1.0489e+05 -4.9352e+04  5.0924e+03\n   PROX_PARK                -6.5948e+06 -4.8678e+04 -8.7189e+02  5.3407e+04\n   PROX_MALL                -1.8125e+07 -7.4216e+04 -1.3974e+04  4.9828e+04\n   PROX_SUPERMARKET         -4.5733e+06 -6.3446e+04 -1.7445e+04  3.5572e+04\n   WITHIN_350M_KINDERGARTEN -4.3835e+05 -6.0020e+03  9.1166e+01  4.7236e+03\n   WITHIN_350M_CHILDCARE    -1.0274e+05 -2.2353e+03  2.6660e+02  2.6409e+03\n   WITHIN_350M_BUS          -1.1794e+05 -1.4726e+03  1.1618e+02  1.7595e+03\n   WITHIN_1KM_PRISCH        -6.6487e+05 -5.5955e+03  2.6942e+02  5.7472e+03\n                                  Max.\n   Intercept                1.6501e+08\n   floor_area_sqm           5.1150e+04\n   storey_order             2.9540e+04\n   remaining_lease_mths     1.8122e+03\n   PROX_CBD                 2.5090e+07\n   PROX_ELDERLYCARE         8.2802e+07\n   PROX_HAWKER              5.9665e+06\n   PROX_MRT                 2.0174e+08\n   PROX_PARK                1.6454e+07\n   PROX_MALL                1.0485e+07\n   PROX_SUPERMARKET         3.8794e+06\n   WITHIN_350M_KINDERGARTEN 6.7207e+05\n   WITHIN_350M_CHILDCARE    1.0791e+05\n   WITHIN_350M_BUS          3.7317e+04\n   WITHIN_1KM_PRISCH        5.1300e+05\n   ************************Diagnostic information*************************\n   Number of data points: 10335 \n   Effective number of parameters (2trace(S) - trace(S'S)): 1730.083 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 8604.917 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 238871.9 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 237036.9 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 238209 \n   Residual sum of squares: 4.829219e+12 \n   R-square value:  0.9676568 \n   Adjusted R-square value:  0.9611532 \n\n   ***********************************************************************\n   Program stops at: 2024-10-20 20:37:40.981568 \n\n\nConvert the test data from sf data.frame to SpatialPointDataFrame\n\ntest_data_sp &lt;- as_Spatial(test_data)\ntest_data_sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 5566 \nextent      : 11597.25, 42623.72, 28287.71, 48669.68  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 17\nnames       : resale_price, floor_area_sqm, storey_order, remaining_lease_mths,         PROX_CBD,     PROX_ELDERLYCARE,        PROX_HAWKER,           PROX_MRT,          PROX_PARK,   PROX_GOOD_PRISCH,        PROX_MALL,            PROX_CHAS,     PROX_SUPERMARKET, WITHIN_350M_KINDERGARTEN, WITHIN_350M_CHILDCARE, ... \nmin values  :       230888,             74,            1,                  546, 1.00583660772922, 3.34897933104965e-07, 0.0474019664161957, 0.0414043955932523, 0.0502664084494264, 0.0907500295577619,                0, 4.55547870890763e-09, 1.21715176356525e-07,                        0,                     0, ... \nmax values  :      1050000,            138,           14,                 1151,  19.632402730488,     3.30163731686804,   2.83106651960209,   2.13060636038504,   2.41313695915468,   10.6169590126272, 2.26056404492346,     0.79249074802552,     1.53786629004208,                        7,                    16, ... \n\n\nComputing adaptive bandwidth for the test data\n\ngwr_bw_test_adaptive &lt;- bw.gwr(resale_price ~ floor_area_sqm +\n                  storey_order + remaining_lease_mths +\n                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +\n                  PROX_MRT + PROX_PARK + PROX_MALL + \n                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n                  WITHIN_1KM_PRISCH,\n                  data=test_data_sp,\n                  approach=\"CV\",\n                  kernel=\"gaussian\",\n                  adaptive=TRUE,\n                  longlat=FALSE)\n\nTake a cup of tea and have a break, it will take a few minutes.\n          -----A kind suggestion from GWmodel development group\nAdaptive bandwidth: 3447 CV score: 1.902156e+13 \nAdaptive bandwidth: 2138 CV score: 1.752645e+13 \nAdaptive bandwidth: 1328 CV score: 1.556298e+13 \nAdaptive bandwidth: 828 CV score: 1.357496e+13 \nAdaptive bandwidth: 518 CV score: 1.03075e+13 \nAdaptive bandwidth: 327 CV score: 8.348382e+12 \nAdaptive bandwidth: 208 CV score: 6.860524e+12 \nAdaptive bandwidth: 135 CV score: 5.969492e+12 \nAdaptive bandwidth: 89 CV score: 5.242263e+12 \nAdaptive bandwidth: 62 CV score: 4.742763e+12 \nAdaptive bandwidth: 43 CV score: 4.357877e+12 \nAdaptive bandwidth: 34 CV score: 4.125835e+12 \nAdaptive bandwidth: 25 CV score: 4.148839e+12 \nAdaptive bandwidth: 36 CV score: 4.165627e+12 \nAdaptive bandwidth: 29 CV score: 4.061362e+12 \nAdaptive bandwidth: 29 CV score: 4.061362e+12 \n\n\nComputing predicted values of the test data\n\n# gwr_pred &lt;- gwr.predict(formula = resale_price ~\n#                           floor_area_sqm + storey_order +\n#                           remaining_lease_mths + PROX_CBD + \n#                           PROX_ELDERLYCARE + PROX_HAWKER + \n#                           PROX_MRT + PROX_PARK + PROX_MALL + \n#                           PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n#                           WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + \n#                           WITHIN_1KM_PRISCH, \n#                         data=train_data_sp, \n#                         predictdata = test_data_sp,\n#                         p=2,\n#                         theta=0,\n#                         bw=40, \n#                         kernel = 'gaussian', \n#                         adaptive=TRUE, \n#                         longlat = FALSE)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex08/Hands-on_ex08.html#preparing-coordinates-data",
    "href": "Hands-on_exercise/Hands-on_ex08/Hands-on_ex08.html#preparing-coordinates-data",
    "title": "Hands-on Exercise 08",
    "section": "",
    "text": "Extract the x,y coordinates of the full, training and test data sets.\n\ncoords &lt;- st_coordinates(mdata)\ncoords_train &lt;- st_coordinates(train_data)\ncoords_test &lt;- st_coordinates(test_data)\n\nWrite all the output into rds for future used\n\ncoords_train &lt;- write_rds(coords_train, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/coords_train.rds\" )\ncoords_test &lt;- write_rds(coords_test, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/coords_test.rds\" )\n\n\ntrain_data &lt;- train_data %&gt;% \n  st_drop_geometry()\n\nCalibrating random forest model using ranger package\n\nset.seed(1234)\nrf &lt;- ranger(resale_price ~ floor_area_sqm + storey_order + \n               remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE + \n               PROX_HAWKER + PROX_MRT + PROX_PARK + PROX_MALL + \n               PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n               WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + \n               WITHIN_1KM_PRISCH,\n             data=train_data)\nrf\n\nRanger result\n\nCall:\n ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      10335 \nNumber of independent variables:  14 \nMtry:                             3 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       728602496 \nR squared (OOB):                  0.9495728 \n\n\n\nwrite_rds(rf, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/rf.rds\")\n\n\nrf &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/rf.rds\")\nrf\n\nRanger result\n\nCall:\n ranger(resale_price ~ floor_area_sqm + storey_order + remaining_lease_mths +      PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER + PROX_MRT + PROX_PARK +      PROX_MALL + PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +      WITHIN_350M_CHILDCARE + WITHIN_350M_BUS + WITHIN_1KM_PRISCH,      data = train_data) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      10335 \nNumber of independent variables:  14 \nMtry:                             3 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       728602496 \nR squared (OOB):                  0.9495728 \n\n\nMtry = The number of predictor variables randomly chosen for consideration at each split in a tree. Mtry of 3 means that 3 variables are randomly selected at each split to determine the best split.\nTarget node size: 5, min number of observations allowed in a terminal node of a tree. Here it indicates that each final node in the tree will have at least 5 observations.\nvariance importance mode: no additional variable importance metrics are reported in this output.\nSplitrule: variance = reduce the overall variancce in the target variable\nOut-of-bad(OOB)Prediction Error (MSE): Means Squared Error = 728602496 based on the Out-of-Bag samples.\nR-squared (OOB) = explain 95% of the variance in the resale prices, which indicates a very strong fit.\n\n\n\n# set.seed(1234)\n# gwRF_adaptive &lt;- grf(formula = resale_price ~ floor_area_sqm + storey_order +\n#                        remaining_lease_mths + PROX_CBD + PROX_ELDERLYCARE +\n#                        PROX_HAWKER + PROX_MRT + PROX_PARK + PROX_MALL +\n#                        PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +\n#                        WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +\n#                        WITHIN_1KM_PRISCH,\n#                      dframe=train_data, \n#                      bw=55,\n#                      kernel=\"adaptive\",\n#                      coords=coords_train)\n\nSave the model output\n\n# write_rds(gwRF_adaptive, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwRF_adaptive.rds\")\n\nRetrieve the save model\n\n# gwRF_adaptive &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/gwRF_adaptive.rds\")\n\n\n\n\n\ntest_data &lt;- cbind(test_data, coords_test) %&gt;%\n  st_drop_geometry()\n\n\n# gwRF_pred &lt;- predict.grf(gwRF_adaptive, \n#                            test_data, \n#                            x.var.name=\"X\",\n#                            y.var.name=\"Y\", \n#                            local.w=1,\n#                            global.w=0)\n\nSave the output into rds file\n\n# GRF_pred &lt;- write_rds(gwRF_pred, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex08/data/GRF_pred.rds\")"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html",
    "title": "Hands-on Exercise 09",
    "section": "",
    "text": "The formula developed to measure accessibility is a variation of the gravitational principle and states that the accessibility to an activity is directly proportional to the size of the activity and inversely proportional to the distance to the location of the activity.\nQuantifying movement opportunity.\n\nDistance\nTime\nCost distance between 2 locations\n\nWhy Model Geography of Accessibility?\n\nWhich areas are underserved by healthcare facilities or schools?\nHow accessible are job opportunities from different residential areas?\nWhat is the impact of public transportation on accessibility?\n\nDistance friction\nAs the distance between two points increases, the likelihood of interaction between them decreases.\nThe Geographical Unit\nRegular-shaped geometries such as squares, hexagons, and triangles reduce bias, improve comparability, minimize edge effects, and facilitate efficient computation, making them ideal for spatial analysis tasks, especially when compared to irregular polygons.\n\n\n\n\n\n\n\n\nPotential Model: If you’re calculating accessibility to multiple hospitals in a city, you’d estimate the “potential” of each hospital’s influence based on its capacity (e.g., number of beds) and the distance from the person’s home to each hospital.\nModified Potential Formula: You modify the basic potential model by incorporating the difficulty of travel. For instance, hospitals located far away would have exponentially reduced influence due to longer travel times, which is captured by the distance friction coefficient.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2SFCA: Let’s say we are analyzing access to healthcare in a region. We first calculate the provider-to-population ratio for each hospital within a certain distance, then calculate accessibility at the population points based on the proximity to these hospitals.\nE2SFCA: If we want to improve the model, we apply a weight based on distance so that hospitals closer to a population are weighted more than farther ones.\nSAM: Finally, we can use SAM for a general accessibility measure with a continuous decay function that decreases the weight of more distant hospitals.\n\n\n\n\n\npacman::p_load(tmap, SpatialAcc, sf, \n               ggstatsplot, reshape2,\n               tidyverse)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#importing-geospatial-data",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#importing-geospatial-data",
    "title": "Hands-on Exercise 09",
    "section": "Importing geospatial data",
    "text": "Importing geospatial data\nImport MP14_SUBZONE_NO_SEA_PL\nhexagons = A 250m radius hexagons GIS data.\nELDERCARE = GIS data showing location of eldercare service.\n\nmpsz &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\", layer = \"MP14_SUBZONE_NO_SEA_PL\")\n\nReading layer `MP14_SUBZONE_NO_SEA_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nhexagons &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\", layer = \"hexagons\") \n\nReading layer `hexagons' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3125 features and 6 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 21506.33 xmax: 50010.26 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n\n\n\neldercare &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\", layer = \"ELDERCARE\") \n\nReading layer `ELDERCARE' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 120 features and 19 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21 / Singapore TM"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#updating-crs-information",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#updating-crs-information",
    "title": "Hands-on Exercise 09",
    "section": "Updating CRS information",
    "text": "Updating CRS information\n\nmpsz &lt;- st_transform(mpsz, 3414)\neldercare &lt;- st_transform(eldercare, 3414)\nhexagons &lt;- st_transform(hexagons, 3414)\n\nVerify the newly transformed mpsz_svy21\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#cleaning-and-updating-attribute-fields-of-the-geospatial-data",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#cleaning-and-updating-attribute-fields-of-the-geospatial-data",
    "title": "Hands-on Exercise 09",
    "section": "Cleaning and updating attribute fields of the geospatial data",
    "text": "Cleaning and updating attribute fields of the geospatial data\nAdd capacity field nto the data table of eldercare\n\neldercare &lt;- eldercare %&gt;%\n  select(fid, ADDRESSPOS) %&gt;%\n  mutate(capacity = 100)\n\nThe eldercare now contains: fid, ADDRESSPOS, geometry and capacity fields.\nAdd hexagons field into the data table of hexagons\n\nhexagons &lt;- hexagons %&gt;%\n  select(fid) %&gt;%\n  mutate(demand = 100)\n\nThe hexagons now contains: fid, geometry and demand fields.\n\n\n\n\n\n\nNote\n\n\n\nNotice that for the purpose of this hands-on exercise, a constant value of 100 is used. In practice, actual demand of the hexagon and capacity of the eldercare centre should be used."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#importing-distance-matrix",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#importing-distance-matrix",
    "title": "Hands-on Exercise 09",
    "section": "Importing Distance Matrix",
    "text": "Importing Distance Matrix\nODMatrix: a distance matrix in csv format. There are six fields 1. origin_id: unique id values of the origin. 2. destination_id: unique id values of the destination. 3. entry_cost: the perpendicular distance between the origins and the nearest road 4. network_cost: the actual network distance from the origins and destination. 5. exit_cost: the perpendicular distance between the destination and the nearest road 6. total_cost: the summation of entry_cost, network_cost, and exit_cost.\n\n\n\n\n\n\nNote\n\n\n\nAll the values of the cost related fields are in metres.\n\n\n\nODMatrix &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/aspatial/OD_Matrix.csv\", skip = 0)\n\nRows: 375000 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (6): origin_id, destination_id, entry_cost, network_cost, exit_cost, tot...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nTransform O-D matrix from a thin format into a fat format\n\ndistmat &lt;- ODMatrix %&gt;%\n  select(origin_id, destination_id, total_cost) %&gt;%\n  spread(destination_id, total_cost)%&gt;%\n  select(c(-c('origin_id')))\n\n\n\n\n\n\n\nNote\n\n\n\nCurrently, the distance is measured in metre because SVY21 projected coordinate system is used. The code chunk below will be used to convert the unit f measurement from metre to kilometre.\n\n\n\ndistmat_km &lt;- as.matrix(distmat/1000)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#computing-hansens-accessibility",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#computing-hansens-accessibility",
    "title": "Hands-on Exercise 09",
    "section": "Computing Hansen’s accessibility",
    "text": "Computing Hansen’s accessibility\nac(p, n, D, d0, power=2, family=“SAM”)\np = demand n = supply D = a matrix of quantity separating the demand from the supply\n\nacc_Hansen &lt;- data.frame(ac(hexagons$demand,\n                            eldercare$capacity,\n                            distmat_km, \n                            #d0 = 50,\n                            power = 2, \n                            family = \"Hansen\"))\n\nRename default field name to accHansen\n\ncolnames(acc_Hansen) &lt;- \"accHansen\"\n\n\nacc_Hansen &lt;- tibble::as_tibble(acc_Hansen)\n\n\nhexagon_Hansen &lt;- bind_cols(hexagons, acc_Hansen)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#extracting-map-extend",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#extracting-map-extend",
    "title": "Hands-on Exercise 09",
    "section": "Extracting map extend",
    "text": "Extracting map extend\nExtract the extend of hexagons sf data frame\n\nmapex &lt;- st_bbox(hexagons)\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hexagon_Hansen,\n         bbox = mapex) + \n  tm_fill(col = \"accHansen\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: Hansen method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nA high Hansen accessibility value indicates strong access to services or amenities within a region."
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#statistical-graphic-visualization",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#statistical-graphic-visualization",
    "title": "Hands-on Exercise 09",
    "section": "Statistical graphic visualization",
    "text": "Statistical graphic visualization\nAdd the planning region filed into hexagon_Hansen sf data frame\n\nhexagon_Hansen &lt;- st_join(hexagon_Hansen, mpsz, \n                          join = st_intersects)\n\n\nggplot(data=hexagon_Hansen, \n       aes(y = log(accHansen), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n\nWarning in geom_point(stat = \"summary\", fun.y = \"mean\", colour = \"red\", :\nIgnoring unknown parameters: `fun.y`\n\n\nNo summary function supplied, defaulting to `mean_se()`"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#computing-kd2sfcas-accessibility",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#computing-kd2sfcas-accessibility",
    "title": "Hands-on Exercise 09",
    "section": "Computing KD2SFCA’s accessibility",
    "text": "Computing KD2SFCA’s accessibility\n\nacc_KD2SFCA &lt;- data.frame(ac(hexagons$demand,\n                            eldercare$capacity,\n                            distmat_km, \n                            d0 = 50,\n                            power = 2, \n                            family = \"KD2SFCA\"))\n\ncolnames(acc_KD2SFCA) &lt;- \"accKD2SFCA\"\nacc_KD2SFCA &lt;- tibble::as_tibble(acc_KD2SFCA)\nhexagon_KD2SFCA &lt;- bind_cols(hexagons, acc_KD2SFCA)\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hexagon_KD2SFCA,\n         bbox = mapex) + \n  tm_fill(col = \"accKD2SFCA\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: KD2SFCA method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nA high value indicates better accessibility\n\n\n\nhexagon_KD2SFCA &lt;- st_join(hexagon_KD2SFCA, mpsz, \n                          join = st_intersects)\n\n\nggplot(data=hexagon_KD2SFCA, \n       aes(y = accKD2SFCA, \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n\nWarning in geom_point(stat = \"summary\", fun.y = \"mean\", colour = \"red\", :\nIgnoring unknown parameters: `fun.y`\n\n\nNo summary function supplied, defaulting to `mean_se()`"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#computing-sam-accessibility",
    "href": "Hands-on_exercise/Hands-on_ex09/Hands-on_ex09.html#computing-sam-accessibility",
    "title": "Hands-on Exercise 09",
    "section": "Computing SAM accessibility",
    "text": "Computing SAM accessibility\n\nacc_SAM &lt;- data.frame(ac(hexagons$demand,\n                         eldercare$capacity,\n                         distmat_km, \n                         d0 = 50,\n                         power = 2, \n                         family = \"SAM\"))\n\ncolnames(acc_SAM) &lt;- \"accSAM\"\nacc_SAM &lt;- tibble::as_tibble(acc_SAM)\nhexagon_SAM &lt;- bind_cols(hexagons, acc_SAM)\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hexagon_SAM,\n         bbox = mapex) + \n  tm_fill(col = \"accSAM\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: SAM method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 3),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\n\n\n\n\n\n\n\n\nhexagon_SAM &lt;- st_join(hexagon_SAM, mpsz, \n                       join = st_intersects)\n\n\nggplot(data=hexagon_SAM, \n       aes(y = accSAM, \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n\nWarning in geom_point(stat = \"summary\", fun.y = \"mean\", colour = \"red\", :\nIgnoring unknown parameters: `fun.y`\n\n\nNo summary function supplied, defaulting to `mean_se()`\n\n\n\n\n\n\n\n\n\n\nlibrary(gridExtra)\n\n\nAttaching package: 'gridExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\np1 &lt;- ggplot(data=hexagon_SAM, \n       aes(y = accSAM, x= REGION_N)) +\n       geom_boxplot() +\n       geom_point(stat=\"summary\", fun=\"mean\", colour =\"red\", size=2)\n\np2 &lt;- ggplot(data=hexagon_KD2SFCA, \n       aes(y = accKD2SFCA, x= REGION_N)) +\n       geom_boxplot() +\n       geom_point(stat=\"summary\", fun=\"mean\", colour =\"red\", size=2)\n\np3 &lt;- ggplot(data=hexagon_Hansen, \n       aes(y = log(accHansen), x= REGION_N)) +\n       geom_boxplot() +\n       geom_point(stat=\"summary\", fun=\"mean\", colour =\"red\", size=2)\n\ngrid.arrange(p1, p2, p3, ncol=3)\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(hexagon_SAM,\n         bbox = mapex) + \n  tm_fill(col = \"accSAM\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: SAM method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 3),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\n\nmap2 &lt;- tm_shape(hexagon_KD2SFCA,\n         bbox = mapex) + \n  tm_fill(col = \"accKD2SFCA\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: KD2SFCA method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\n\n\nmap3 &lt;-tm_shape(hexagon_Hansen,\n         bbox = mapex) + \n  tm_fill(col = \"accHansen\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: Hansen method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\ntmap_arrange(map1, map2, map3, ncol = 3)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html",
    "title": "In-class Exercise 09",
    "section": "",
    "text": "The formula developed to measure accessibility is a variation of the gravitational principle and states that the accessibility to an activity is directly proportional to the size of the activity and inversely proportional to the distance to the location of the activity.\nQuantifying movement opportunity.\n\nDistance\nTime\nCost distance between 2 locations\n\nWhy Model Geography of Accessibility?\n\nWhich areas are underserved by healthcare facilities or schools?\nHow accessible are job opportunities from different residential areas?\nWhat is the impact of public transportation on accessibility?\n\nDistance friction\nAs the distance between two points increases, the likelihood of interaction between them decreases.\nThe Geographical Unit\nRegular-shaped geometries such as squares, hexagons, and triangles reduce bias, improve comparability, minimize edge effects, and facilitate efficient computation, making them ideal for spatial analysis tasks, especially when compared to irregular polygons.\n\n\n\n\n\n\n\n\nPotential Model: If you’re calculating accessibility to multiple hospitals in a city, you’d estimate the “potential” of each hospital’s influence based on its capacity (e.g., number of beds) and the distance from the person’s home to each hospital.\nModified Potential Formula: You modify the basic potential model by incorporating the difficulty of travel. For instance, hospitals located far away would have exponentially reduced influence due to longer travel times, which is captured by the distance friction coefficient.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2SFCA: Let’s say we are analyzing access to healthcare in a region. We first calculate the provider-to-population ratio for each hospital within a certain distance, then calculate accessibility at the population points based on the proximity to these hospitals.\nE2SFCA: If we want to improve the model, we apply a weight based on distance so that hospitals closer to a population are weighted more than farther ones.\nSAM: Finally, we can use SAM for a general accessibility measure with a continuous decay function that decreases the weight of more distant hospitals.\n\n\n\n\n\npacman::p_load(SpatialAcc, sf, tidyverse, \n               tmap, ggstatsplot)\n\n\neldercare &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\",\n                     layer = \"ELDERCARE\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `ELDERCARE' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 120 features and 19 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21 / Singapore TM\n\n\n\nCHAS &lt;- st_read(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/aspatial/CHASClinics.kml\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MOH_CHAS_CLINICS' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\aspatial\\CHASClinics.kml' \n  using driver `KML'\nSimple feature collection with 1193 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.5818 ymin: 1.016264 xmax: 103.9903 ymax: 1.456037\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nNext, st_buffer() of sf package is used to create a buffer of 1km around each eldercare features\n\nbuffer_1km &lt;- st_buffer(eldercare, \n                        dist = 1000)\n\nThe code chunk below is used to plot the newly created buffers and the CHAS clinics.\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(buffer_1km) +\n  tm_polygons() +\ntm_shape(CHAS) +\n  tm_dots()\n\n\n\n\n\nLastly, the code chunk below is used to count the number of CHAS clinics with 1km of each eldercare centre.\n\nbuffer_1km$pts_count &lt;- lengths(\n  st_intersects(buffer_1km, CHAS))"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#importing-geospatial-data",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#importing-geospatial-data",
    "title": "In-class Exercise 09",
    "section": "Importing geospatial data",
    "text": "Importing geospatial data\nImport MP14_SUBZONE_NO_SEA_PL\nhexagons = A 250m radius hexagons GIS data.\nELDERCARE = GIS data showing location of eldercare service.\n\nmpsz &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\", layer = \"MP14_SUBZONE_NO_SEA_PL\")\n\nReading layer `MP14_SUBZONE_NO_SEA_PL' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nhexagons &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\", layer = \"hexagons\") \n\nReading layer `hexagons' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3125 features and 6 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 21506.33 xmax: 50010.26 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n\n\n\neldercare &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/geospatial\", layer = \"ELDERCARE\") \n\nReading layer `ELDERCARE' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 120 features and 19 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21 / Singapore TM"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#updating-crs-information",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#updating-crs-information",
    "title": "In-class Exercise 09",
    "section": "Updating CRS information",
    "text": "Updating CRS information\n\nmpsz &lt;- st_transform(mpsz, 3414)\neldercare &lt;- st_transform(eldercare, 3414)\nhexagons &lt;- st_transform(hexagons, 3414)\n\nVerify the newly transformed mpsz_svy21\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#cleaning-and-updating-attribute-fields-of-the-geospatial-data",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#cleaning-and-updating-attribute-fields-of-the-geospatial-data",
    "title": "In-class Exercise 09",
    "section": "Cleaning and updating attribute fields of the geospatial data",
    "text": "Cleaning and updating attribute fields of the geospatial data\nAdd capacity field nto the data table of eldercare\n\neldercare &lt;- eldercare %&gt;%\n  select(fid, ADDRESSPOS) %&gt;%\n  mutate(capacity = 100)\n\nThe eldercare now contains: fid, ADDRESSPOS, geometry and capacity fields.\nAdd hexagons field into the data table of hexagons\n\nhexagons &lt;- hexagons %&gt;%\n  select(fid) %&gt;%\n  mutate(demand = 100)\n\nThe hexagons now contains: fid, geometry and demand fields.\n\n\n\n\n\n\nNote\n\n\n\nNotice that for the purpose of this hands-on exercise, a constant value of 100 is used. In practice, actual demand of the hexagon and capacity of the eldercare centre should be used."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#importing-distance-matrix",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#importing-distance-matrix",
    "title": "In-class Exercise 09",
    "section": "Importing Distance Matrix",
    "text": "Importing Distance Matrix\nODMatrix: a distance matrix in csv format. There are six fields 1. origin_id: unique id values of the origin. 2. destination_id: unique id values of the destination. 3. entry_cost: the perpendicular distance between the origins and the nearest road 4. network_cost: the actual network distance from the origins and destination. 5. exit_cost: the perpendicular distance between the destination and the nearest road 6. total_cost: the summation of entry_cost, network_cost, and exit_cost.\n\n\n\n\n\n\nNote\n\n\n\nAll the values of the cost related fields are in metres.\n\n\n\nODMatrix &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex09/data/aspatial/OD_Matrix.csv\", skip = 0)\n\nRows: 375000 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (6): origin_id, destination_id, entry_cost, network_cost, exit_cost, tot...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nTransform O-D matrix from a thin format into a fat format\n\ndistmat &lt;- ODMatrix %&gt;%\n  select(origin_id, destination_id, total_cost) %&gt;%\n  spread(destination_id, total_cost)%&gt;%\n  select(c(-c('origin_id')))\n\n\n\n\n\n\n\nNote\n\n\n\nCurrently, the distance is measured in metre because SVY21 projected coordinate system is used. The code chunk below will be used to convert the unit f measurement from metre to kilometre.\n\n\n\ndistmat_km &lt;- as.matrix(distmat/1000)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#computing-hansens-accessibility",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#computing-hansens-accessibility",
    "title": "In-class Exercise 09",
    "section": "Computing Hansen’s accessibility",
    "text": "Computing Hansen’s accessibility\nac(p, n, D, d0, power=2, family=“SAM”)\np = demand n = supply D = a matrix of quantity separating the demand from the supply\n\nacc_Hansen &lt;- data.frame(ac(hexagons$demand,\n                            eldercare$capacity,\n                            distmat_km, \n                            #d0 = 50,\n                            power = 2, \n                            family = \"Hansen\"))\n\nRename default field name to accHansen\n\ncolnames(acc_Hansen) &lt;- \"accHansen\"\n\n\nacc_Hansen &lt;- tibble::as_tibble(acc_Hansen)\n\n\nhexagon_Hansen &lt;- bind_cols(hexagons, acc_Hansen)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#extracting-map-extend",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#extracting-map-extend",
    "title": "In-class Exercise 09",
    "section": "Extracting map extend",
    "text": "Extracting map extend\nExtract the extend of hexagons sf data frame\n\nmapex &lt;- st_bbox(hexagons)\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hexagon_Hansen,\n         bbox = mapex) + \n  tm_fill(col = \"accHansen\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(eldercare) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to eldercare: Hansen method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nA high Hansen accessibility value indicates strong access to services or amenities within a region."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#statistical-graphic-visualization",
    "href": "In-class_Ex/In-class_Ex09/In-class_Ex09.html#statistical-graphic-visualization",
    "title": "In-class Exercise 09",
    "section": "Statistical graphic visualization",
    "text": "Statistical graphic visualization\nAdd the planning region filed into hexagon_Hansen sf data frame\n\nhexagon_Hansen &lt;- st_join(hexagon_Hansen, mpsz, \n                          join = st_intersects)\n\n\nggbetweenstats(\n  data = hexagon_Hansen,\n  x = REGION_N,\n  y = accHansen,\n  type = \"p\")"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex10/Hands-on_ex10.html",
    "href": "Hands-on_exercise/Hands-on_ex10/Hands-on_ex10.html",
    "title": "Hands-on Exercise 10",
    "section": "",
    "text": "Build an OD matrix by using Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall.\n\n\n\npacman::p_load(tmap, sf, DT, stplanr, tidyverse)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_ex10/Hands-on_ex10.html#importing-the-od-data",
    "href": "Hands-on_exercise/Hands-on_ex10/Hands-on_ex10.html#importing-the-od-data",
    "title": "Hands-on Exercise 10",
    "section": "Importing the OD data",
    "text": "Importing the OD data\nImport Passenger Volume by Origin Destination Bus Stops\n\nodbus &lt;- read_csv(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/aspatial/origin_destination_bus_202210.csv\")\n\nRows: 5122925 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): YEAR_MONTH, DAY_TYPE, PT_TYPE\ndbl (4): TIME_PER_HOUR, ORIGIN_PT_CODE, DESTINATION_PT_CODE, TOTAL_TRIPS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nglimpse(odbus)\n\nRows: 5,122,925\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2022-10\", \"2022-10\", \"2022-10\", \"2022-10\", \"2022-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 10, 10, 7, 11, 16, 16, 20, 7, 7, 11, 11, 8, 11, 11…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;dbl&gt; 65239, 65239, 23519, 52509, 54349, 54349, 43371, 8…\n$ DESTINATION_PT_CODE &lt;dbl&gt; 65159, 65159, 23311, 42041, 53241, 53241, 14139, 9…\n$ TOTAL_TRIPS         &lt;dbl&gt; 2, 1, 2, 1, 1, 4, 1, 3, 1, 5, 2, 5, 15, 40, 1, 1, …\n\n\nConvert these data values from numeric data type into character data type\n\nodbus$ORIGIN_PT_CODE &lt;- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE &lt;- as.factor(odbus$DESTINATION_PT_CODE) \n\nExtracting the study data\nExtract commuting flows on weekday and between 6 and 9 o’clock.\n\nodbus6_9 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 6 &\n           TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE,\n           DESTINATION_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n`summarise()` has grouped output by 'ORIGIN_PT_CODE'. You can override using\nthe `.groups` argument.\n\n\n\ndatatable(odbus6_9)\n\nWarning in instance$preRenderHook(instance): It seems your data is too big for\nclient-side DataTables. You may consider server-side processing:\nhttps://rstudio.github.io/DT/server.html\n\n\n\n\n\n\nSave the output in rds format for future used.\n\nwrite_rds(odbus6_9, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/odbus6_9.rds\")\n\nThe code chunk below will be used to import the save odbus6_9.rds into R environment.\n\nodbus6_9 &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/odbus6_9.rds\")\n\nTwo geospatial data:\n\nBusStop: This data provides the location of bus stop as at last quarter of 2022\nMPSZ-2019: This data provides the sub-zone boundary of URA Master Plan 2019\n\n\nbusstop &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex10\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5159 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\n\nmpsz &lt;- st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/geospatial\",\n                   layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Hands-on_exercise\\Hands-on_ex10\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26...\n\n\n\nmpsz &lt;-  write_rds(mpsz, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/mpsz.rds\")\n\nCombine Busstip and mpsz\n\nbusstop_mpsz &lt;- st_intersection(busstop, mpsz) %&gt;%\n  select(BUS_STOP_N, SUBZONE_C) %&gt;%\n  st_drop_geometry()\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n\n\ndatatable(busstop_mpsz)\n\n\n\n\n\nSave the output into rds format\n\nwrite_rds(busstop_mpsz, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/busstop_mpsz.rds\")  \n\nAppend the planning subzone code from busstop_mpsz data frame onto odbus6_9 data frame.\n\nod_data &lt;- left_join(odbus6_9 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIGIN_BS = ORIGIN_PT_CODE,\n         ORIGIN_SZ = SUBZONE_C,\n         DESTIN_BS = DESTINATION_PT_CODE)\n\nWarning in left_join(odbus6_9, busstop_mpsz, by = c(ORIGIN_PT_CODE = \"BUS_STOP_N\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 55491 of `x` matches multiple rows in `y`.\nℹ Row 161 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nCheck for duplicating records\n\nduplicate &lt;- od_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nRetain the unique records if duplicate records are found\n\nod_data &lt;- unique(od_data)\n\nConfirm if the duplicating records issue has been addressed fully.\n\nod_data &lt;- left_join(od_data , busstop_mpsz,\n            by = c(\"DESTIN_BS\" = \"BUS_STOP_N\")) \n\nWarning in left_join(od_data, busstop_mpsz, by = c(DESTIN_BS = \"BUS_STOP_N\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 74 of `x` matches multiple rows in `y`.\nℹ Row 1379 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\n\nduplicate &lt;- od_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\nod_data &lt;- unique(od_data)\n\n\nod_data &lt;- od_data %&gt;%\n  rename(DESTIN_SZ = SUBZONE_C) %&gt;%\n  drop_na() %&gt;%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %&gt;%\n  summarise(MORNING_PEAK = sum(TRIPS))\n\n`summarise()` has grouped output by 'ORIGIN_SZ'. You can override using the\n`.groups` argument.\n\n\n\nwrite_rds(od_data, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/od_data_fii.rds\")\n\n\nod_data_fii &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/od_data.rds\")\n\nVisualizing Spatial Interaction\nremove intra-zonal flows\n\nod_data_fij &lt;- od_data[od_data$ORIGIN_SZ!=od_data$DESTIN_SZ,]\n\n\nwrite_rds(od_data_fij, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/od_data_fij.rds\")\n\n\nod_data_fij &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/od_data_fij.rds\")\n\nCreating desire lines\n\nflowLine &lt;- od2line(flow = od_data_fij, \n                    zones = mpsz,\n                    zone_code = \"SUBZONE_C\")\n\nCreating centroids representing desire line start and end points.\n\n\n\nwrite_rds(flowLine, \"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/flowLine.rds\")\n\n\nflowLine &lt;- read_rds(\"C:/ngmengye/ISSS626-GAA/Hands-on_exercise/Hands-on_ex10/data/rds/flowLine.rds\")\n\nVisualizing the desire lines\n\ntm_shape(mpsz) +\n  tm_polygons() +\nflowLine %&gt;%  \ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length\n\n\nLegend labels were too wide. Therefore, legend.text.size has been set to 0.66. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n\n\n\n\n\n\n\n\n\nThe flow data are very messy and highly skewed like the one shown above, it is wiser to focus on selected flows.\n\ntm_shape(mpsz) +\n  tm_polygons() +\nflowLine %&gt;%  \n  filter(MORNING_PEAK &gt;= 5000) %&gt;%\ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length\n\n\nLegend labels were too wide. Therefore, legend.text.size has been set to 0.66. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "",
    "text": "Financial inclusion is the availability and equality of opportunities to access financial services."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#overview",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#overview",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "",
    "text": "Financial inclusion is the availability and equality of opportunities to access financial services."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#getting-started",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#getting-started",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "2 Getting Started",
    "text": "2 Getting Started\n\nObjectives\nIn view of this, we need to build an explanatory model to determine factors affecting financial inclusion by using geographical weighted regression (GWR) methods.\n\n\nThe Study Area\nThe focus of this study would in the Uganda, at the district level."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#data-preparation",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#data-preparation",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "3 Data Preparation",
    "text": "3 Data Preparation\nSetting the analytical tools.\n\npacman::p_load(sp, sf, st, spdep, raster, spatstat, tmap, devtools,vtable, ggplot2, egg, corrplot, ggstats, ggstatsplot, GWmodel, tidyverse, gtsummary, olsrr, car, blorr,ISLR, klaR, rsample,kableExtra, performance,readxl,dplyr)\n\n\nData Preparation\n\ngeoBoundaries-UGA-ADM2, available publicly from geoBoundaries, is a geospatial dataset in SHP format that delineates the district-level boundaries of our study area, Uganda.\nFinScope Uganda 2023, available publicly from FinScope, is in XLSX format and includes survey data on financial inclusion among the adult population (aged 16 and above) in Uganda."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#data-wrangling",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#data-wrangling",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "4 Data Wrangling",
    "text": "4 Data Wrangling\n\nUganda Geospatial Data\nImporting Geospatial Data into R\nWe will import geoBoundaries-UGA-ADM3 shp file into RStudio and save the file into an R dataframe called uganda\n\nuganda &lt;-  st_read(dsn = \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/\",\n                 layer = \"geoBoundaries-UGA-ADM3\")\n\nReading layer `geoBoundaries-UGA-ADM3' from data source \n  `C:\\ngmengye\\ISSS626-GAA\\Take-home_Ex\\Take-home_Ex03\\Uganda\\data' \n  using driver `ESRI Shapefile'\nSimple feature collection with 137 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 29.58004 ymin: -1.473149 xmax: 34.99872 ymax: 4.215767\nGeodetic CRS:  WGS 84\n\n\nTransform CRS to WGS 84 / UTM zone 36N (EPSG: 32636)\n\nuganda_32636 &lt;- st_transform(uganda, crs = 32636)\n\nCheck the projected CRS is WGS 84 / UTM zone 36N\n\nst_geometry(uganda_32636)\n\nGeometry set for 137 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 119288.3 ymin: -163064.3 xmax: 722331.6 ymax: 466046.6\nProjected CRS: WGS 84 / UTM zone 36N\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((606355.5 63412.55, 606299.6 604...\n\n\nMULTIPOLYGON (((515621.1 -5590.729, 514660.1 -5...\n\n\nMULTIPOLYGON (((459354.1 -11931.64, 458353.1 -1...\n\n\nMULTIPOLYGON (((422822.7 -80611.78, 422322.4 -8...\n\n\nMULTIPOLYGON (((574326.2 -1988.703, 573396.7 -1...\n\n\nUse st_crs() to display the coordinate system of uganda_32636\n\nst_crs(uganda_32636)\n\nCoordinate Reference System:\n  User input: EPSG:32636 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 36N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 36N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",33,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 30°E and 36°E, northern hemisphere between equator and 84°N, onshore and offshore. Belarus. Cyprus. Egypt. Ethiopia. Finland. Israel. Jordan. Kenya. Lebanon. Moldova. Norway. Russian Federation. Saudi Arabia. Sudan. Syria. Türkiye (Turkey). Uganda. Ukraine.\"],\n        BBOX[0,30,84,36]],\n    ID[\"EPSG\",32636]]\n\n\nPlot the Uganda map\n\nplot(st_geometry(uganda_32636))\n\n\n\n\n\n\n\n\nBased on the plot, there are islands. Need to make sure that the point is not located on the small islands.\nConvert multipolygon to individual polygon\nCalculate the area of each polygon\n\nsf_polygon &lt;- uganda_32636 %&gt;% \n  st_cast(\"POLYGON\") %&gt;% \n  mutate(area = st_area(.))\n\nWarning in st_cast.sf(., \"POLYGON\"): repeating attributes for all\nsub-geometries for which they may not be constant\n\n\nGroup by the unique name and select the largest polygon by area\n\nuganda_modified &lt;- sf_polygon %&gt;% \n  group_by(shapeName) %&gt;% \n  filter(area == max(area)) \n\nview the resulting data frame\n\nuganda_modified\n\nSimple feature collection with 137 features and 6 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 119288.3 ymin: -163064.3 xmax: 722331.6 ymax: 466046.6\nProjected CRS: WGS 84 / UTM zone 36N\n# A tibble: 137 × 7\n# Groups:   shapeName [137]\n   shapeName shapeISO shapeID     shapeGroup shapeType                  geometry\n * &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;                 &lt;POLYGON [m]&gt;\n 1 Bugiri    &lt;NA&gt;     73843447B9… UGA        ADM3      ((606355.5 63412.55, 606…\n 2 Buvuma    &lt;NA&gt;     73843447B8… UGA        ADM3      ((541932.6 27135.92, 541…\n 3 Mukono    &lt;NA&gt;     73843447B3… UGA        ADM3      ((497298.8 61175.19, 493…\n 4 Kalanga   &lt;NA&gt;     73843447B5… UGA        ADM3      ((399077.2 -24220.9, 399…\n 5 Mayuge    &lt;NA&gt;     73843447B9… UGA        ADM3      ((568166.7 51876.42, 570…\n 6 Namayingo &lt;NA&gt;     73843447B5… UGA        ADM3      ((585945.7 35474.56, 591…\n 7 Moyo      &lt;NA&gt;     73843447B6… UGA        ADM3      ((390479.8 396399.7, 390…\n 8 Yumbe     &lt;NA&gt;     73843447B3… UGA        ADM3      ((334427.1 403900.8, 334…\n 9 Koboko    &lt;NA&gt;     73843447B3… UGA        ADM3      ((286271.7 411785, 28706…\n10 Maracha   &lt;NA&gt;     73843447B5… UGA        ADM3      ((282140.8 365831.3, 282…\n# ℹ 127 more rows\n# ℹ 1 more variable: area [m^2]\n\n\nPlot the uganda map\n\nplot(st_geometry(uganda_modified))\n\n\n\n\n\n\n\n\nFrom the plot, we can see that the Lake Victoria is included, this should be removed.\nView the list of district name\n\nunique(uganda_modified$shapeName)\n\n  [1] \"Bugiri\"        \"Buvuma\"        \"Mukono\"        \"Kalanga\"      \n  [5] \"Mayuge\"        \"Namayingo\"     \"Moyo\"          \"Yumbe\"        \n  [9] \"Koboko\"        \"Maracha\"       \"Terego\"        \"Arua\"         \n [13] \"Zombo\"         \"Obongi\"        \"Madi Okollo\"   \"Adjumani\"     \n [17] \"Nebbi\"         \"Pakwach\"       \"Amuru\"         \"Nwoya\"        \n [21] \"Buliisa\"       \"Hoima\"         \"Kikuube\"       \"Masindi\"      \n [25] \"Lamwo\"         \"Gulu\"          \"Omoro\"         \"Kiryandongo\"  \n [29] \"Bundibugyo\"    \"Bunyangabu\"    \"Ntoroko\"       \"Kabarole\"     \n [33] \"Kagadi\"        \"Oyam\"          \"Apac\"          \"Kwania\"       \n [37] \"Kole\"          \"Amolatar\"      \"Dokolo\"        \"Lira\"         \n [41] \"Alebtong\"      \"Kaberamaido\"   \"Kalaki\"        \"Otuke\"        \n [45] \"Pader\"         \"Kitgum\"        \"Agago\"         \"Karenga\"      \n [49] \"Kaabong\"       \"Abim\"          \"Kotido\"        \"Napak\"        \n [53] \"Moroto\"        \"Nabilatuk\"     \"Nakapiripirit\" \"Amudat\"       \n [57] \"Kisoro\"        \"Kyenjojo\"      \"Kasese\"        \"Rubirzi\"      \n [61] \"Kabale\"        \"Rubanda\"       \"Kanungu\"       \"Rukiga\"       \n [65] \"Rukungiri\"     \"Mitooma\"       \"Kibaale\"       \"Kakumiro\"     \n [69] \"Kyegegwa\"      \"Kamwenge\"      \"Bushenyi\"      \"Sheema\"       \n [73] \"Kitagwenga\"    \"Buhweju\"       \"Ibanda\"        \"Rwampara\"     \n [77] \"Ntungamo\"      \"Mbarara\"       \"Kiruhura\"      \"Kazo\"         \n [81] \"Isingiro\"      \"Bukwo\"         \"Kween\"         \"Kapchorwa\"    \n [85] \"Kumi\"          \"Bulambuli\"     \"Sironko\"       \"Bukedea\"      \n [89] \"Bududa\"        \"Namisindwa\"    \"Manafwa\"       \"Mbale\"        \n [93] \"Butebo\"        \"Kapelebyong\"   \"Amuria\"        \"Katakwi\"      \n [97] \"Soroti\"        \"Tororo\"        \"Budaka\"        \"Butaleja\"     \n[101] \"Kibuku\"        \"Ngora\"         \"Serere\"        \"Buyende\"      \n[105] \"Pallisa\"       \"Kaliro\"        \"Namutumba\"     \"Kamuli\"       \n[109] \"Luuka\"         \"Iganga\"        \"Bugweri\"       \"Nakasongola\"  \n[113] \"Kayunga\"       \"Kyankwanzi\"    \"Rakai\"         \"Lyantonde\"    \n[117] \"Mubende\"       \"Lwengo\"        \"Kassanda\"      \"Kiboga\"       \n[121] \"Nakaseke\"      \"Ssembabule\"    \"Bukomansimbi\"  \"Luwero\"       \n[125] \"Mityana\"       \"Kyotera\"       \"Gomba\"         \"Masaka\"       \n[129] \"Kalungu\"       \"Butambala\"     \"Mpigi\"         \"Wakiso\"       \n[133] \"Kampala\"       \"Buikwe\"        \"Jinja\"         \"Busia\"        \n[137] \"Lake Victoria\"\n\n\nRemove ‘Lake Victoria’ from the data frame.\n\nuganda_modified &lt;- uganda_modified %&gt;%\n  filter(shapeName != \"Lake Victoria\")\n\nVerify that ‘Lake Victoria’ is removed.\n\nunique(uganda_modified$shapeName)\n\n  [1] \"Bugiri\"        \"Buvuma\"        \"Mukono\"        \"Kalanga\"      \n  [5] \"Mayuge\"        \"Namayingo\"     \"Moyo\"          \"Yumbe\"        \n  [9] \"Koboko\"        \"Maracha\"       \"Terego\"        \"Arua\"         \n [13] \"Zombo\"         \"Obongi\"        \"Madi Okollo\"   \"Adjumani\"     \n [17] \"Nebbi\"         \"Pakwach\"       \"Amuru\"         \"Nwoya\"        \n [21] \"Buliisa\"       \"Hoima\"         \"Kikuube\"       \"Masindi\"      \n [25] \"Lamwo\"         \"Gulu\"          \"Omoro\"         \"Kiryandongo\"  \n [29] \"Bundibugyo\"    \"Bunyangabu\"    \"Ntoroko\"       \"Kabarole\"     \n [33] \"Kagadi\"        \"Oyam\"          \"Apac\"          \"Kwania\"       \n [37] \"Kole\"          \"Amolatar\"      \"Dokolo\"        \"Lira\"         \n [41] \"Alebtong\"      \"Kaberamaido\"   \"Kalaki\"        \"Otuke\"        \n [45] \"Pader\"         \"Kitgum\"        \"Agago\"         \"Karenga\"      \n [49] \"Kaabong\"       \"Abim\"          \"Kotido\"        \"Napak\"        \n [53] \"Moroto\"        \"Nabilatuk\"     \"Nakapiripirit\" \"Amudat\"       \n [57] \"Kisoro\"        \"Kyenjojo\"      \"Kasese\"        \"Rubirzi\"      \n [61] \"Kabale\"        \"Rubanda\"       \"Kanungu\"       \"Rukiga\"       \n [65] \"Rukungiri\"     \"Mitooma\"       \"Kibaale\"       \"Kakumiro\"     \n [69] \"Kyegegwa\"      \"Kamwenge\"      \"Bushenyi\"      \"Sheema\"       \n [73] \"Kitagwenga\"    \"Buhweju\"       \"Ibanda\"        \"Rwampara\"     \n [77] \"Ntungamo\"      \"Mbarara\"       \"Kiruhura\"      \"Kazo\"         \n [81] \"Isingiro\"      \"Bukwo\"         \"Kween\"         \"Kapchorwa\"    \n [85] \"Kumi\"          \"Bulambuli\"     \"Sironko\"       \"Bukedea\"      \n [89] \"Bududa\"        \"Namisindwa\"    \"Manafwa\"       \"Mbale\"        \n [93] \"Butebo\"        \"Kapelebyong\"   \"Amuria\"        \"Katakwi\"      \n [97] \"Soroti\"        \"Tororo\"        \"Budaka\"        \"Butaleja\"     \n[101] \"Kibuku\"        \"Ngora\"         \"Serere\"        \"Buyende\"      \n[105] \"Pallisa\"       \"Kaliro\"        \"Namutumba\"     \"Kamuli\"       \n[109] \"Luuka\"         \"Iganga\"        \"Bugweri\"       \"Nakasongola\"  \n[113] \"Kayunga\"       \"Kyankwanzi\"    \"Rakai\"         \"Lyantonde\"    \n[117] \"Mubende\"       \"Lwengo\"        \"Kassanda\"      \"Kiboga\"       \n[121] \"Nakaseke\"      \"Ssembabule\"    \"Bukomansimbi\"  \"Luwero\"       \n[125] \"Mityana\"       \"Kyotera\"       \"Gomba\"         \"Masaka\"       \n[129] \"Kalungu\"       \"Butambala\"     \"Mpigi\"         \"Wakiso\"       \n[133] \"Kampala\"       \"Buikwe\"        \"Jinja\"         \"Busia\"        \n\n\nPlot the map again\n\nplot(st_geometry(uganda_modified))\n\n\n\n\n\n\n\n\n\n\nFinScope Attribute Data\nImporting the attribute data from Finscope-2023_Dataset_Final.xlsx\n\nfinscope &lt;- read_excel(\"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/Finscope-2023_Dataset_Final.xlsx\",sheet = \"Final_Dataset\")\n\nDisplay the data structure\n\nglimpse(finscope)\n\nRows: 3,176\nColumns: 686\n$ HH_ID            &lt;chr&gt; \"001001\", \"001019\", \"001028\", \"001037\", \"001040\", \"00…\n$ Interview_ID     &lt;chr&gt; \"00100102\", \"00101905\", \"00102802\", \"00103701\", \"0010…\n$ ea_name          &lt;chr&gt; \"AYWEE MODERN\", \"AYWEE MODERN\", \"AYWEE MODERN\", \"AYWE…\n$ ea_code          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ age              &lt;dbl&gt; 32, 37, 25, 32, 40, 16, 33, 49, 28, 20, 24, 37, 34, 3…\n$ disabled         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ District         &lt;chr&gt; \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM…\n$ Region           &lt;chr&gt; \"NORTHERN\", \"NORTHERN\", \"NORTHERN\", \"NORTHERN\", \"NORT…\n$ Subregion        &lt;chr&gt; \"KARAMOJA\", \"KARAMOJA\", \"KARAMOJA\", \"KARAMOJA\", \"KARA…\n$ Rural_Urban      &lt;chr&gt; \"Urban\", \"Urban\", \"Urban\", \"Urban\", \"Urban\", \"Urban\",…\n$ Pweight          &lt;dbl&gt; 1533.4840, 1171.2970, 2883.8820, 3066.9680, 5614.5480…\n$ Lhhid            &lt;dbl&gt; 1, 19, 28, 37, 40, 47, 54, 61, 70, 72, 1, 2, 9, 17, 2…\n$ Enum_code        &lt;dbl&gt; 26, 27, 27, 27, 28, 28, 28, 30, 30, 30, 34, 34, 34, 3…\n$ InterviewDate    &lt;dbl&gt; 28072023, 28072023, 28072023, 28072023, 28072023, 280…\n$ starttime        &lt;dbl&gt; 1503, 1302, 1400, 1515, 1552, 1446, 1315, 1259, 1400,…\n$ endtime          &lt;dbl&gt; 1603, 1356, 1449, 1717, 1842, 1530, 1444, 1338, 1501,…\n$ namepid          &lt;dbl&gt; 2, 5, 2, 1, 1, 4, 1, 1, 1, 2, 4, 1, 2, 1, 1, 1, 1, 1,…\n$ c1               &lt;dbl&gt; 4, 4, 3, 4, 4, 1, 4, 5, 3, 2, 2, 4, 4, 4, 2, 4, 4, 2,…\n$ c2               &lt;dbl&gt; 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2,…\n$ c3               &lt;dbl&gt; 1, 2, 2, 1, 4, 6, 2, 1, 1, 6, 6, 2, 1, 2, 2, 1, 2, 2,…\n$ c4               &lt;dbl&gt; 6, 2, 1, 2, 3, 2, 3, 6, 2, 2, 3, 6, 1, 1, 2, 7, 1, 1,…\n$ c5               &lt;dbl&gt; 1, 5, 5, 1, 4, 9, 1, 7, 1, 5, 5, 4, 2, 2, 1, 4, 1, 1,…\n$ c6_1_1           &lt;dbl&gt; 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2,…\n$ c6_1_2           &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2,…\n$ c6_1_3           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c6_2_1           &lt;dbl&gt; 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ c6_2_2           &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2,…\n$ c6_2_3           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2,…\n$ c7_1_1           &lt;dbl&gt; 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2,…\n$ c7_1_2           &lt;dbl&gt; 1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,…\n$ c7_1_3           &lt;dbl&gt; 1, 1, NA, 1, NA, NA, 1, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2,…\n$ c7_1_4           &lt;dbl&gt; NA, 2, NA, NA, 2, NA, 2, NA, 2, 2, 2, 2, 2, 2, NA, 2,…\n$ c7_1_5           &lt;dbl&gt; NA, 2, NA, NA, 1, NA, 1, NA, 1, 1, 1, 1, 1, 1, NA, 1,…\n$ c7_1_6           &lt;dbl&gt; 3, NA, 1, 3, NA, 6, NA, 6, NA, NA, NA, NA, NA, NA, 3,…\n$ c8_1a            &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ c8_1b            &lt;dbl&gt; 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1c            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2,…\n$ c8_1d            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2,…\n$ c8_1e            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1f            &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1g            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1h            &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1i            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1j            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ c8_1k            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ d1_11            &lt;dbl&gt; 6, 6, 10, 5, 5, 6, 5, 4, 4, 4, 12, 9, 5, 9, 5, 8, 6, …\n$ d1_12            &lt;dbl&gt; 9, 5, 6, 10, 9, 5, 9, 5, 5, 5, 12, 12, 8, 5, 12, 4, 9…\n$ d1_13            &lt;dbl&gt; 5, 8, 8, 8, 13, 12, 12, 6, 10, 13, 12, 12, 13, 8, 12,…\n$ d1_2             &lt;dbl&gt; 2, 2, 1, 2, 5, NA, NA, 2, 3, 3, NA, NA, 1, 2, NA, 2, …\n$ d2_2_11          &lt;dbl&gt; 2, 2, 4, 2, 1, 10, 10, 2, 1, 4, 10, NA, 2, 2, NA, 1, …\n$ d2_2_12          &lt;dbl&gt; 11, 3, 3, 3, 4, 10, 10, 11, 2, 2, 10, NA, 11, 3, NA, …\n$ d2_2_13          &lt;dbl&gt; 11, 4, 2, 4, 11, 10, 10, 11, 11, 11, 10, NA, 11, 11, …\n$ d2_2_21          &lt;dbl&gt; 4, 2, 2, 3, 8, NA, NA, 6, 6, 6, NA, NA, 2, 1, NA, 3, …\n$ d2_2_22          &lt;dbl&gt; NA, 2, 8, 2, 7, NA, NA, NA, 7, 8, NA, NA, NA, 2, NA, …\n$ d2_2_23          &lt;dbl&gt; NA, 3, 4, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ d2_2_31          &lt;dbl&gt; 1, 1, 1, 1, 1, NA, NA, 1, 1, 1, NA, NA, 1, 1, NA, 1, …\n$ d2_2_32          &lt;dbl&gt; NA, 1, 1, 1, NA, NA, NA, NA, 1, 1, NA, NA, NA, NA, NA…\n$ d2_2_33          &lt;dbl&gt; NA, 1, 1, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ d3_31            &lt;dbl&gt; 2, 1, 1, 1, 1, NA, NA, 3, 1, 1, NA, NA, 1, 1, NA, 1, …\n$ d3_32            &lt;dbl&gt; NA, 1, 1, 1, 1, NA, NA, NA, 1, 1, NA, NA, NA, 8, NA, …\n$ d3_33            &lt;dbl&gt; NA, 1, 1, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ d4_4_1           &lt;dbl&gt; 2, 1, 1, 1, 1, NA, NA, 2, 1, 2, NA, NA, 1, 1, NA, 2, …\n$ D4_4_2           &lt;chr&gt; NA, \"ABI\", \"E\", \"A\", \"A\", NA, NA, NA, \"A\", NA, NA, NA…\n$ e1_1             &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ e2_1             &lt;dbl&gt; 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1,…\n$ e3_1             &lt;dbl&gt; 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2,…\n$ e3_2             &lt;dbl&gt; NA, NA, 4, 1, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, 3…\n$ e4_11            &lt;dbl&gt; 1, 1, NA, NA, NA, 1, 2, 1, 2, 2, 1, 1, 12, NA, NA, 9,…\n$ e4_12            &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 9, 13, 1, 13, 2, 2, 9, NA, NA, 2…\n$ e4_13            &lt;dbl&gt; 13, 12, NA, NA, NA, 13, 13, NA, 13, NA, 13, 13, 13, N…\n$ e5_11            &lt;dbl&gt; 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2,…\n$ e5_12            &lt;dbl&gt; 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 1,…\n$ e5_13            &lt;dbl&gt; 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1,…\n$ e5_14            &lt;dbl&gt; 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2,…\n$ e5_15            &lt;dbl&gt; 1, 2, 1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,…\n$ e5_16            &lt;dbl&gt; 1, 2, 2, 2, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 2, 1, 1, 1,…\n$ e5_17            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ e6_1             &lt;dbl&gt; 4, 3, 5, 3, 3, 5, 3, 3, 4, 3, 3, 3, 4, 3, 5, 3, 4, 4,…\n$ e7_1             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ e8_1             &lt;dbl&gt; 5, 4, 7, 7, 4, 4, 11, 11, 11, 11, 3, 5, 5, 1, 5, 1, 1…\n$ e8_2             &lt;dbl&gt; 3, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 2, 2, 2, 6, 6,…\n$ e9_1             &lt;dbl&gt; 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…\n$ e9_2             &lt;dbl&gt; 7, 4, 12, 12, 1, 6, 1, 9, 12, 9, 9, 3, 9, 9, 9, 12, 9…\n$ e10_1            &lt;dbl&gt; 2, 6, 6, 10, 4, 4, 4, 2, 4, 2, 2, 2, 4, 2, 6, 4, 2, 1…\n$ e10_2            &lt;dbl&gt; 4, 4, 4, NA, 7, 8, 2, 3, 8, 8, 8, 8, 2, 7, 3, 7, 3, N…\n$ f1_1_1           &lt;dbl&gt; 1, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2,…\n$ f1_1_2           &lt;dbl&gt; 1, 1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ f1_1_3           &lt;dbl&gt; 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 2,…\n$ f1_1_4           &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2,…\n$ f1_1_5           &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2,…\n$ f2_1             &lt;dbl&gt; 1, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 1, 2, 1, 1, 2,…\n$ f3_1_1           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 1, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_2           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_3           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_4           &lt;dbl&gt; 2, 1, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_5           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_6           &lt;dbl&gt; 1, 2, NA, NA, 2, NA, 1, 2, NA, 1, NA, NA, 1, 2, NA, 1…\n$ f3_1_7           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_8           &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, 2, NA, 2, NA, NA, 1, 1, NA, 1…\n$ f3_1_9           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_10          &lt;dbl&gt; 2, 1, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_11          &lt;dbl&gt; 1, 2, NA, NA, 2, NA, 1, 2, NA, 2, NA, NA, 1, 2, NA, 2…\n$ f3_1_12          &lt;dbl&gt; 1, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_13          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_14          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_15          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_16          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_17          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, NA, 2, NA, NA, 2, 2, NA, 2…\n$ f3_1_17_oth      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA…\n$ f3_2_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_4           &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_2_5           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_6           &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 3, NA, NA, 3, NA, NA, 3, NA, N…\n$ f3_2_7           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_8           &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, 1, NA,…\n$ f3_2_9           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_10          &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_2_11          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, 3, NA, …\n$ f3_2_12          &lt;dbl&gt; 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_2_13          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_14          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_15          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_16          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_2_173         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 3, NA, NA, NA, NA, NA, NA…\n$ f3_3_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_4           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_3_5           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_6           &lt;dbl&gt; 3, NA, NA, NA, NA, NA, 2, NA, NA, 5, NA, NA, 4, NA, N…\n$ f3_3_7           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_8           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 3, 2, NA,…\n$ f3_3_9           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_10          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_3_11          &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, 4, NA, …\n$ f3_3_12          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_3_13          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_14          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_15          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_16          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_3_174         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_4             &lt;dbl&gt; 8, 8, NA, NA, 8, NA, 8, 1, NA, 6, NA, NA, 8, 8, NA, 8…\n$ f3_5_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA…\n$ f3_5_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_4           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_5_5           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_6           &lt;dbl&gt; 5, NA, NA, NA, NA, NA, 2, NA, NA, 1, NA, NA, 4, NA, N…\n$ f3_5_7           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_8           &lt;dbl&gt; 1, 3, NA, NA, 4, NA, 2, NA, NA, NA, NA, NA, 6, 2, NA,…\n$ f3_5_9           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_10          &lt;dbl&gt; NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_5_11          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 4, NA, NA, NA, NA, NA, 6, NA, …\n$ f3_5_12          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f3_5_13          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_14          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_15          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_16          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_17          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f3_5_18          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f4_1             &lt;dbl&gt; 1, 2, NA, NA, 9, NA, 7, 1, NA, 1, NA, NA, 7, 4, NA, 1…\n$ f5_1             &lt;dbl&gt; 1, NA, NA, NA, NA, NA, NA, 2, NA, 2, NA, NA, NA, NA, …\n$ f5_2             &lt;dbl&gt; NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f5_3             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3, NA, NA, NA, NA, NA, 2, NA,…\n$ f5_4             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f6_1             &lt;dbl&gt; 4, 1, NA, NA, 1, NA, 1, 8, NA, 1, NA, NA, 1, 1, NA, 1…\n$ f7_1             &lt;dbl&gt; 2, 9, 2, 9, 2, 2, 2, 2, 2, 2, 2, 2, 9, 2, 2, 2, 2, 2,…\n$ f7_2             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f7_3             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f7_4             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f7_5             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f7_6             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ f8               &lt;dbl&gt; 3, NA, 5, NA, 1, 3, 3, 3, 3, 3, 3, 3, NA, 3, 3, 2, 1,…\n$ f9_1             &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1,…\n$ f9_2             &lt;dbl&gt; 2, 2, NA, NA, NA, NA, 3, NA, NA, NA, NA, NA, 2, NA, 2…\n$ f10_1            &lt;dbl&gt; 1, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2,…\n$ f10_2            &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2,…\n$ f10_3            &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 99, 99, 2, 99, 99, 99, …\n$ f11_1_1          &lt;dbl&gt; 2, 1, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f11_1_2          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f11_1_3          &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, NA, NA…\n$ f12_1            &lt;dbl&gt; 1, 4, NA, NA, 9, NA, 9, NA, NA, NA, NA, NA, 8, NA, NA…\n$ f12_2            &lt;dbl&gt; 5, 3, NA, NA, 4, NA, 4, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f13_1_1          &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, NA, NA…\n$ f13_1_2          &lt;dbl&gt; 2, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, NA, NA…\n$ f13_1_3          &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, NA, NA…\n$ f13_1_4          &lt;dbl&gt; 2, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f13_1_5          &lt;dbl&gt; 1, 1, NA, NA, 2, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f13_1_6          &lt;dbl&gt; 1, 2, NA, NA, 2, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f13_1_7          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f14_1_1          &lt;dbl&gt; 1, 2, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f14_1_2          &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, NA, NA…\n$ f14_1_3          &lt;dbl&gt; 1, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f14_1_4          &lt;dbl&gt; 2, 1, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f14_1_5          &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f14_1_6          &lt;dbl&gt; 1, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f14_1_7          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f14_1_8          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f14_1_9          &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f14_1_10         &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f14_1_11         &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 3, NA, NA…\n$ f15_1            &lt;dbl&gt; 2, 3, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 1, NA, NA…\n$ f16_1            &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f16_2            &lt;dbl&gt; 2, 1, NA, NA, 1, NA, 2, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f17_1            &lt;dbl&gt; 4, 3, NA, NA, 4, NA, 4, NA, NA, NA, NA, NA, 4, NA, NA…\n$ f17_2            &lt;dbl&gt; 4, 2, NA, NA, 2, NA, 3, NA, NA, NA, NA, NA, 997, NA, …\n$ f18_1            &lt;dbl&gt; 2, 1, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, 2, NA, NA…\n$ f18_2            &lt;dbl&gt; NA, 2, NA, NA, 2, NA, 2, NA, NA, NA, NA, NA, NA, NA, …\n$ f18_3            &lt;dbl&gt; NA, 3, NA, NA, 1, NA, 1, NA, NA, NA, NA, NA, NA, NA, …\n$ f19_1            &lt;dbl&gt; 99, 5, NA, NA, 5, NA, 5, NA, NA, NA, NA, NA, 99, 99, …\n$ f19_2            &lt;dbl&gt; NA, 4, NA, NA, 2, NA, 5, NA, NA, NA, NA, NA, NA, NA, …\n$ f19_3            &lt;chr&gt; NA, \"ACH\", NA, NA, \"B\", NA, \"ABG\", NA, NA, NA, NA, NA…\n$ f20              &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 2, 2, 1, 2, 2,…\n$ g1_1_1           &lt;dbl&gt; 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ g1_1_2           &lt;dbl&gt; 1, 1, 2, 2, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ g1_1_3           &lt;dbl&gt; 1, 2, 3, 1, 3, 3, 1, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2,…\n$ g1_1_4           &lt;dbl&gt; 1, 2, 3, 1, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1,…\n$ g1_1_5           &lt;dbl&gt; 1, 1, 2, 1, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 2, 1, 2, 2,…\n$ g1_1_6           &lt;dbl&gt; 1, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 3, 2, 2, 2, 1, 2, 2,…\n$ g1_1_7           &lt;dbl&gt; 2, 2, 2, 2, 1, 3, 1, 2, 3, 2, 1, 3, 1, 1, 2, 3, 1, 2,…\n$ g1_1_8           &lt;dbl&gt; 1, 1, 2, 2, 2, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 1, 3,…\n$ g1_1_9           &lt;dbl&gt; 1, 1, 2, 2, 2, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…\n$ g1_2             &lt;dbl&gt; 1, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2,…\n$ g2_11            &lt;dbl&gt; 6, 6, 8, 4, 6, 8, 6, 1, 8, 5, 6, 8, 8, 6, 8, 6, 6, 8,…\n$ g2_12            &lt;dbl&gt; 8, 8, 6, 6, 8, 5, 8, 9, 9, 9, 8, 9, 6, 8, 9, 9, 8, 9,…\n$ g2_13            &lt;dbl&gt; 9, 7, 4, 8, 9, 9, 9, 9, 9, 9, 5, 9, 9, 9, 9, 9, 9, 9,…\n$ g3_1             &lt;dbl&gt; 1, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2,…\n$ g3_2             &lt;dbl&gt; 1, 1, NA, NA, 2, NA, 2, NA, 2, NA, 1, NA, NA, 2, NA, …\n$ g3_3             &lt;dbl&gt; 2, 1, NA, NA, 1, NA, 2, NA, 1, NA, 1, NA, NA, 1, NA, …\n$ g4_1             &lt;dbl&gt; 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2,…\n$ g4_2             &lt;dbl&gt; 1, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2, 2, 2,…\n$ g5_1             &lt;dbl&gt; 2, 1, NA, NA, 2, NA, 2, 2, 2, 2, 1, 2, 2, 2, NA, NA, …\n$ g6_1_1           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA,…\n$ g6_1_2           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_3           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_4           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_5           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_6           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_7           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_8           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA,…\n$ g6_1_9           &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_10          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_11          &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_12          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA,…\n$ g6_1_13          &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_14          &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_15          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_16          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_1_17          &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g6_2             &lt;dbl&gt; NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, 12, NA, NA, N…\n$ g7_1             &lt;dbl&gt; NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA,…\n$ g8_1             &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g9_1             &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA,…\n$ g9_1_10          &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA,…\n$ g9_2             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ g9_3             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ g9_4             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ g10_1            &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 3, NA, NA, NA,…\n$ g11_1_1          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_2          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_3          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_4          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_5          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_6          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_7          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_8          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g11_1_9          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA…\n$ g12_1            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA…\n$ g12_2_1          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ g12_2_2          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ g13_1            &lt;dbl&gt; NA, 1, 2, 2, NA, 2, NA, NA, NA, NA, 2, NA, NA, NA, NA…\n$ g13_2            &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ g14_1            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ g14_2            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ g14_3            &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ g15_1            &lt;dbl&gt; NA, NA, 4, 3, NA, 2, NA, 1, NA, 1, NA, 3, 3, NA, 1, 3…\n$ h1_1_1           &lt;dbl&gt; 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 2, 2, 2, 1, 1, 1, 1, 2,…\n$ h1_1_2           &lt;dbl&gt; 1, 1, 1, 1, 1, 3, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 1, 1,…\n$ h1_1_3           &lt;dbl&gt; 1, 1, 2, 2, 1, 3, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ h1_1_4           &lt;dbl&gt; 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ h1_1_5           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1,…\n$ h1_1_6           &lt;dbl&gt; 1, 3, 1, 3, 3, 3, 1, 3, 2, 3, 3, 1, 3, 3, 3, 1, 3, 3,…\n$ h1_1_7           &lt;dbl&gt; 1, 3, 1, 3, 2, 1, 2, 1, 3, 2, 1, 2, 3, 1, 3, 3, 3, 3,…\n$ h1_1_8           &lt;dbl&gt; 1, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 1, 2, 3, 3, 3, 3, 3,…\n$ h1_1_9           &lt;dbl&gt; 1, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 1, 3, 3, 3, 1, 3, 3,…\n$ h1_1_10          &lt;dbl&gt; 1, 3, 3, 3, 2, 3, 1, 3, 3, 3, 3, 1, 2, 3, 3, 1, 3, 3,…\n$ h1_1_11          &lt;dbl&gt; 1, 3, 3, 3, 2, 3, 1, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 3,…\n$ h1_1_12          &lt;dbl&gt; 2, 3, 3, 3, 1, 3, 2, 3, 2, 3, 3, 2, 1, 3, 3, 3, 3, 3,…\n$ h1_1_13          &lt;dbl&gt; 1, 3, 2, 3, 2, 3, 2, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 3,…\n$ h1_1_14          &lt;dbl&gt; 1, 2, 2, 3, 2, 3, 1, 3, 3, 3, 3, 1, 2, 3, 3, 1, 3, 3,…\n$ h1_1_15          &lt;dbl&gt; 1, 2, 2, 3, 1, 3, 1, 3, 3, 3, 3, 1, 2, 3, 3, 3, 3, 3,…\n$ h1_1_16          &lt;dbl&gt; 2, 2, 3, 2, 2, 2, 3, 1, 3, 3, 2, 2, 2, 3, 3, 3, 3, 3,…\n$ h1_1_17          &lt;dbl&gt; 1, 1, 2, 3, 2, 1, 1, 3, 3, 3, 2, 1, 1, 3, 3, 3, 3, 3,…\n$ h1_1_18          &lt;dbl&gt; 1, 1, 2, 3, 2, 1, 2, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 3,…\n$ h1_1_19          &lt;dbl&gt; 1, 1, 3, 1, 2, 1, 2, 3, 3, 3, 3, 1, 1, 3, 1, 3, 3, 3,…\n$ h1_1_20          &lt;dbl&gt; 1, 1, 3, 1, 2, 1, 1, 3, 3, 3, 2, 1, 3, 3, 3, 3, 3, 3,…\n$ h2_1_1           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ h2_1_2           &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2,…\n$ h2_1_3           &lt;dbl&gt; 1, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ h2_1_4           &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2,…\n$ h2_1_5           &lt;dbl&gt; 1, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 2,…\n$ h2_1_6           &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2,…\n$ h2_1_7           &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2,…\n$ h2_1_8           &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 2, 2, 1, 1,…\n$ h2_1_9           &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2,…\n$ h2_2_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA, NA…\n$ h2_2_2           &lt;dbl&gt; NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, NA…\n$ h2_2_3           &lt;dbl&gt; 1, NA, NA, NA, 2, 2, 2, 2, NA, NA, NA, NA, NA, NA, NA…\n$ h2_2_4           &lt;dbl&gt; NA, NA, NA, NA, 2, 2, 2, 2, NA, NA, NA, NA, NA, 2, NA…\n$ h2_2_5           &lt;dbl&gt; 1, NA, NA, NA, 2, 2, 2, 2, NA, NA, NA, 1, NA, 2, NA, …\n$ h2_2_6           &lt;dbl&gt; NA, NA, NA, NA, NA, 2, NA, 2, NA, NA, NA, 1, NA, NA, …\n$ h2_2_7           &lt;dbl&gt; NA, NA, NA, NA, 2, 2, NA, NA, NA, NA, NA, 1, NA, NA, …\n$ h2_2_8           &lt;dbl&gt; NA, NA, NA, NA, 2, 2, NA, 1, 1, 1, NA, 1, 1, NA, NA, …\n$ h2_2_9           &lt;dbl&gt; NA, NA, NA, NA, 2, 2, 2, 2, NA, NA, NA, 2, NA, NA, NA…\n$ h2_2_10          &lt;dbl&gt; NA, 2, 2, 2, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, 2…\n$ h3_11            &lt;dbl&gt; 1, 1, 1, 5, 1, 1, 1, 1, 1, 1, NA, 99, 99, 99, 1, 99, …\n$ h3_12            &lt;dbl&gt; 2, 5, 7, 6, 2, 6, 2, 2, 2, 2, NA, 99, 99, 99, 6, 99, …\n$ h3_13            &lt;dbl&gt; 7, 7, 4, 7, 7, 14, 4, 7, 7, 7, NA, 99, 99, 99, 14, 99…\n$ h5_1             &lt;dbl&gt; NA, 1, 2, 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ h5_2             &lt;dbl&gt; NA, 1, 2, 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ hpp1_1           &lt;dbl&gt; 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1, 1, 2, 2, 1, 2, 2,…\n$ hpp2_1           &lt;chr&gt; \"B\", \"B\", NA, NA, \"B\", NA, \"B\", \"BD\", \"D\", NA, NA, \"D…\n$ hpp2_2_1         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_2_2         &lt;dbl&gt; 2, 1, NA, NA, 1, NA, 2, 2, NA, NA, NA, NA, 1, NA, NA,…\n$ hpp2_2_3         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_2_4         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, 1, NA, NA, 1, NA, NA, …\n$ hpp2_2_5         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA…\n$ hpp2_2_6         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_2_7         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_31          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_32          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_33          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_34          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_35          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_36          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_37          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp2_4           &lt;dbl&gt; 3, 3, NA, NA, 2, NA, 2, 1, 3, NA, NA, 99, 99, NA, NA,…\n$ hpp2_5           &lt;dbl&gt; 2, 3, NA, NA, 4, NA, 5, 5, 5, NA, NA, 5, 5, NA, NA, 5…\n$ hpp2_6           &lt;dbl&gt; 4, 4, NA, NA, 4, NA, 4, 1, 4, NA, NA, 4, 4, NA, NA, 4…\n$ hpp2_7           &lt;dbl&gt; 2, 2, NA, NA, 2, NA, 2, 2, 1, NA, NA, 2, 8, NA, NA, 2…\n$ hpp3_2           &lt;dbl&gt; 3, 1, NA, NA, 1, NA, 1, 2, 1, NA, NA, 1, 1, NA, NA, 1…\n$ hpp4_1           &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 2,…\n$ hpp5_1           &lt;chr&gt; \"A\", \"D\", NA, NA, NA, NA, NA, \"D\", \"G\", \"E\", \"E\", \"DF…\n$ hpp5_2_1         &lt;dbl&gt; 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ hpp5_2_2         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1, NA…\n$ hpp5_2_3         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_2_4         &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, 2, NA, NA, NA, 1, NA, NA, …\n$ hpp5_2_5         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2, 2, NA, 1, NA, …\n$ hpp5_2_6         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1, 1, NA,…\n$ hpp5_2_7         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA…\n$ hpp5_31          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_32          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_33          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_34          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_35          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_36          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_37          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hpp5_4           &lt;dbl&gt; 2, 2, NA, NA, NA, NA, NA, 1, 3, 3, 3, 3, 3, NA, NA, N…\n$ hpp5_5           &lt;dbl&gt; 3, 4, NA, NA, NA, NA, NA, 3, 3, 4, 4, 2, 3, NA, NA, N…\n$ hpp5_6           &lt;dbl&gt; 4, 4, NA, NA, NA, NA, NA, 1, 4, 4, 4, 4, 4, NA, NA, N…\n$ hpp5_7           &lt;dbl&gt; 2, 1, NA, NA, NA, NA, NA, 1, 1, 1, 1, 1, 4, NA, NA, N…\n$ hpp6_1           &lt;dbl&gt; 3, 5, NA, NA, NA, NA, NA, 4, 4, 4, 2, 1, 4, NA, NA, N…\n$ hpp6_2           &lt;dbl&gt; 1, 1, NA, NA, NA, NA, NA, 997, 1, 1, 1, 1, 1, NA, NA,…\n$ hpb1_1           &lt;chr&gt; \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\"…\n$ hpb1_2           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ hpb21            &lt;dbl&gt; 2, 2, 4, 3, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 2, 1, 1,…\n$ hpb22            &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,…\n$ hpb23            &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,…\n$ hpb24            &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,…\n$ hpb25            &lt;dbl&gt; 5, 5, 5, 6, 5, 5, 5, 3, 4, 5, 5, 5, 3, 5, 5, 4, 5, 5,…\n$ hpb26            &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,…\n$ hgp1_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp1_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_1         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_2         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_3         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_4         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_5         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_6         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_7         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ hgp2_1_8         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ h6               &lt;chr&gt; \"A\", \"E\", \"E\", \"E\", \"H\", \"H\", \"G\", \"F\", \"F\", \"F\", \"E\"…\n$ j1               &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ j2_1_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_4           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_5           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_6           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_7           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_8           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_9           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_10          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_11          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_12          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_1_13          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_4           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_5           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_6           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_7           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_8           &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_9           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_10          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_11          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_2_12          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_2           &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_4           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_5           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_6           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_7           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_8           &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_9           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_10          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_11          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j2_3_12          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j3_1             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j3_2             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j4_1             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j4_2             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j6_11            &lt;dbl&gt; 4, 1, 11, 1, 7, 8, 1, 5, 1, 1, 7, 7, 4, 7, 4, 4, 4, 4…\n$ j6_12            &lt;dbl&gt; 5, 5, 10, 4, 13, 13, 4, 7, 5, 2, 4, 13, 13, 5, 7, 7, …\n$ j6_13            &lt;dbl&gt; 7, 4, 4, 7, 13, 13, 13, 13, 7, 7, 13, 13, 13, 4, 13, …\n$ j7_1             &lt;chr&gt; \"BCD\", \"DF\", \"D\", \"F\", \"A\", \"Z\", \"BCF\", \"D\", \"D\", \"D\"…\n$ j7_2             &lt;dbl&gt; 2, 2, 2, 2, 2, 99, 2, 2, 2, 2, 2, 3, 2, 3, 2, 2, 1, 1…\n$ j8_1             &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 1,…\n$ j9_1_1           &lt;dbl&gt; 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1,…\n$ j9_1_2           &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 1, 1, 2, 1, 2, 2, 2,…\n$ j9_1_3           &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 2,…\n$ j9_1_4           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2,…\n$ j10_1            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ j10_2            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ k1_1_1           &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ k1_1_2           &lt;dbl&gt; 2, 2, 2, 3, 1, 1, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ k1_1_3           &lt;dbl&gt; 2, 2, 2, 4, 1, 1, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ k1_1_4           &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 3, 4, 2, 3, 4, 4, 4, 4,…\n$ k1_1_5           &lt;dbl&gt; 2, 2, 2, 4, 1, 1, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ k1_1_6           &lt;dbl&gt; 2, 2, 2, 4, 1, 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ k1_1_7           &lt;dbl&gt; 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, 3, 2, 2, 4, 4, 4, 4, 4,…\n$ k1_1_8           &lt;dbl&gt; 2, 2, 2, 4, 1, 1, 1, 2, 2, 2, 4, 4, 4, 3, 4, 4, 4, 4,…\n$ k1_1_9           &lt;dbl&gt; 1, 2, 3, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 4, 4, 4, 2,…\n$ k1_1_10          &lt;dbl&gt; 2, 2, 2, 4, 4, 1, 4, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4,…\n$ k1_1_11          &lt;dbl&gt; 1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 3, 4, 2, 1, 1,…\n$ k1_1_12          &lt;dbl&gt; 2, 1, 2, 1, 1, 1, 1, 2, 2, 2, 3, 2, 2, 4, 4, 1, 4, 2,…\n$ k2_2_1           &lt;dbl&gt; 2, 2, 4, 2, 1, 1, 1, 5, 5, 5, 4, 4, 4, 4, 5, 4, 4, 4,…\n$ k2_2_2           &lt;dbl&gt; 2, 2, 4, 4, 1, 1, 1, 5, 5, 5, 4, 4, 4, 4, 5, 4, 4, 4,…\n$ k2_2_3           &lt;dbl&gt; 2, 2, 4, 4, 1, 1, 1, 5, 5, 5, 4, 4, 4, 4, 5, 3, 4, 4,…\n$ k2_2_4           &lt;dbl&gt; 2, 2, 2, 1, 1, 1, 1, 5, 5, 5, 4, 4, 2, 4, 5, 3, 4, 4,…\n$ k2_2_5           &lt;dbl&gt; 2, 2, 4, 4, 1, 1, 1, 5, 5, 5, 4, 4, 4, 4, 5, 4, 4, 4,…\n$ k2_2_6           &lt;dbl&gt; 2, 1, 2, 4, 2, 1, 1, 5, 5, 5, 4, 5, 5, 4, 5, 4, 5, 4,…\n$ k2_2_7           &lt;dbl&gt; 2, 1, 2, 2, 1, 1, 1, 5, 5, 5, 3, 2, 2, 4, 5, 4, 4, 4,…\n$ k2_2_8           &lt;dbl&gt; 2, 2, 4, 4, 1, 1, 1, 5, 5, 5, 4, 4, 5, 4, 5, 4, 4, 4,…\n$ k2_2_9           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 2, 4, 2, 3, 5, 3, 2, 2,…\n$ k2_2_10          &lt;dbl&gt; 2, 2, 4, 4, 5, 4, 4, 5, 5, 5, 4, 5, 5, 4, 5, 4, 4, 4,…\n$ k2_2_11          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 2, 2, 1, 3, 5, 2, 1, 1,…\n$ k2_2_12          &lt;dbl&gt; 2, 1, 1, 1, 2, 1, 2, 5, 5, 5, 2, 2, 2, 4, 5, 4, 5, 4,…\n$ k3_3_1           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_2           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_3           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_4           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_5           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_6           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_7           &lt;dbl&gt; 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2,…\n$ k3_3_8           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_9           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ k3_3_10          &lt;dbl&gt; 1, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2,…\n$ k3_3_11          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ kcb1_1_1         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb1_1_2         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb1_1_3         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb1_1_4         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb1_1_5         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb3_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb3_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb4_1           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb4_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb5_1_1         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA…\n$ kcb5_1_2         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA…\n$ kcb5_1_3         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA…\n$ kcb5_1_4         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA…\n$ kcb5_1_5         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA…\n$ kcb5_1_6         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA…\n$ kcb5_2_1         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb5_2_2         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA…\n$ kcb5_2_3         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb5_2_4         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb5_2_5         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb5_2_6         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kcb6_11          &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, NA, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1…\n$ kcb6_12          &lt;dbl&gt; 16, 2, 2, 5, 16, 7, 2, NA, 16, 16, 2, 4, 4, 1, 16, 5,…\n$ kcb6_13          &lt;dbl&gt; 16, 5, 5, 2, 2, 16, 5, NA, 16, 16, 4, 16, 8, 16, 16, …\n$ kmfi1_1          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi2_11         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi2_12         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi2_13         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi3_1_1        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi3_1_2        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi3_1_3        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi3_1_4        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi3_3          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi3_4          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi4_1          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi5_1          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kmfi6_11         &lt;dbl&gt; 5, 1, 1, 1, 2, 1, 4, 2, 1, 1, 2, 2, 1, 1, 5, 5, 1, 1,…\n$ kmfi6_12         &lt;dbl&gt; 15, 3, 5, 3, 11, 15, 6, 15, 15, 15, 3, 15, 5, 2, 1, 6…\n$ kmfi6_13         &lt;dbl&gt; 15, 9, 7, 9, 7, 13, 7, 15, 15, 15, 5, 15, 9, 15, 15, …\n$ ks1_11           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks1_12           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks1_13           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_1            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_2            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_3            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_4            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_5            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_6            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_7            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_8            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_9            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks2_10           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks3_1            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_1          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_2          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_3          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_4          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_5          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_6          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_7          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_8          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_9          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_10         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_11         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_12         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks4_1_13         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ks5_1            &lt;dbl&gt; 2, 1, 5, 6, 8, 8, 8, 8, 8, 8, 6, 6, 1, 1, 2, 2, 1, 1,…\n$ km1_1_1          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 3,…\n$ km1_1_2          &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3,…\n$ km1_1_3          &lt;dbl&gt; 1, 2, 2, 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 1, 3, 1, 3, 3,…\n$ km1_1_4          &lt;dbl&gt; 1, 2, 2, 2, 1, 1, 2, 2, 2, 3, 3, 2, 1, 1, 3, 1, 2, 3,…\n$ km1_1_5          &lt;dbl&gt; 2, 2, 2, 3, 1, 1, 1, 3, 1, 2, 3, 1, 1, 1, 3, 1, 2, 3,…\n$ km1_1_6          &lt;dbl&gt; 1, 3, 2, 3, 1, 1, 1, 3, 3, 2, 2, 2, 3, 3, 3, 1, 3, 3,…\n$ km1_1_7          &lt;dbl&gt; 1, 3, 3, 3, 3, 1, 1, 3, 1, 1, 1, 1, 3, 1, 3, 3, 1, 3,…\n$ km2_11           &lt;dbl&gt; NA, NA, NA, NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA…\n$ km2_12           &lt;dbl&gt; NA, NA, NA, NA, NA, 18, NA, NA, NA, NA, NA, NA, NA, N…\n$ km2_13           &lt;dbl&gt; NA, NA, NA, NA, NA, 6, NA, NA, NA, NA, NA, NA, NA, NA…\n$ km3_11           &lt;dbl&gt; NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, NA…\n$ km3_12           &lt;dbl&gt; NA, NA, NA, NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, N…\n$ km3_13           &lt;dbl&gt; NA, NA, NA, NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, N…\n$ km4_1_1          &lt;dbl&gt; 3, 4, 4, 4, 3, 1, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 3, 4,…\n$ km4_1_21         &lt;dbl&gt; NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, NA…\n$ km4_1_22         &lt;dbl&gt; NA, NA, NA, NA, NA, 10, NA, NA, NA, NA, NA, NA, NA, N…\n$ km4_1_23         &lt;dbl&gt; NA, NA, NA, NA, NA, 10, NA, NA, NA, NA, NA, NA, NA, N…\n$ km5_1            &lt;dbl&gt; NA, NA, NA, NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA…\n$ km6_11           &lt;dbl&gt; 1, 13, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 1, 1, 1, 1…\n$ km6_12           &lt;dbl&gt; 4, 9, 9, 4, 4, 4, 2, 2, 13, 13, 13, 4, 6, 5, 4, 5, 4,…\n$ km6_13           &lt;dbl&gt; 13, 13, 13, 13, 8, 8, 4, 13, 13, 13, 4, 5, 1, 8, 13, …\n$ km6_21           &lt;dbl&gt; 13, NA, NA, NA, 1, 4, 1, 1, 1, 1, 4, 1, 4, 1, NA, 1, …\n$ km6_22           &lt;dbl&gt; 1, NA, NA, NA, 4, 4, 4, 2, 13, 13, 13, 4, 1, 4, NA, 4…\n$ km6_23           &lt;dbl&gt; 4, NA, NA, NA, 8, 5, 8, 13, 13, 13, 8, 5, 6, 5, NA, 5…\n$ km7_11           &lt;dbl&gt; 1, NA, NA, NA, NA, NA, NA, 1, 4, 4, 4, NA, NA, NA, NA…\n$ km7_12           &lt;dbl&gt; 3, NA, NA, NA, NA, NA, NA, 4, 5, 5, 5, NA, NA, NA, NA…\n$ km7_13           &lt;dbl&gt; 4, NA, NA, NA, NA, NA, NA, 5, 16, 16, 16, NA, NA, NA,…\n$ km8_1            &lt;dbl&gt; NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, NA…\n$ km9_1_1          &lt;dbl&gt; 1, NA, NA, NA, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, NA, 1, 1…\n$ km9_1_2          &lt;dbl&gt; 1, NA, NA, NA, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, NA, 1, 1…\n$ km9_1_3          &lt;dbl&gt; 1, NA, NA, NA, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, NA, 2, 1…\n$ km9_1_4          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, NA, 2, 2…\n$ km9_1_5          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2…\n$ km9_1_6          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2…\n$ km9_1_7          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2…\n$ km9_1_8          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2…\n$ km9_1_9          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2…\n$ km9_2_1          &lt;dbl&gt; 1, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 2, 2, 2, NA, …\n$ km9_2_2          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 1, 1, 2, NA, …\n$ km9_2_3          &lt;dbl&gt; 2, NA, NA, NA, 1, 1, 1, NA, NA, NA, NA, 2, 2, 1, NA, …\n$ km9_2_4          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 2, 2, 2, NA, …\n$ km9_2_5          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 2, 1, 2, NA, …\n$ km9_2_6          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 2, 2, 2, NA, …\n$ km9_2_7          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 2, 2, 2, NA, …\n$ km9_2_8          &lt;dbl&gt; 2, NA, NA, NA, 2, 2, 2, NA, NA, NA, NA, 2, 2, 2, NA, …\n$ km9_3            &lt;dbl&gt; 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1, 1, NA, …\n$ km10_1           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 3, 2, 2, 2, 2, 2,…\n$ km10_2           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 4, NA, NA, NA, NA, NA…\n$ km10_3           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 5, NA, NA, NA, NA, NA…\n$ km11_11          &lt;dbl&gt; 4, 2, 2, 2, 2, 3, 3, 2, NA, 2, 4, 2, NA, 2, 1, 2, 2, …\n$ km11_12          &lt;dbl&gt; 7, 3, 4, 5, 3, 2, 4, 7, NA, 5, 2, 7, NA, 3, 3, 3, 6, …\n$ km11_13          &lt;dbl&gt; 7, 6, 6, 6, 7, 7, 3, 2, NA, 6, 7, 7, NA, 7, 7, 7, 7, …\n$ kml1_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kml2_1           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ m1_1_1           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2,…\n$ m1_1_2           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1,…\n$ m1_1_3           &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ m1_1_4           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1,…\n$ m1_1_5           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1,…\n$ m1_1_6           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1, 1,…\n$ m1_1_7           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2,…\n$ m1_1_8           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2,…\n$ m1_1_9           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2,…\n$ m2_1             &lt;chr&gt; \"B\", \"BC\", \"D\", \"D\", \"AB\", \"AB\", \"AB\", NA, NA, NA, NA…\n$ m3_1             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, NA, NA, NA, NA, NA, 2, NA, NA, 1…\n$ m4_11            &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1,…\n$ m4_12            &lt;dbl&gt; 2, 2, 3, 4, 2, 3, 2, 2, 3, 2, 3, 1, 1, 2, 2, 3, 8, 7,…\n$ m4_13            &lt;dbl&gt; 8, 5, 4, 3, 8, 5, 3, 8, 8, 8, 8, 8, 7, 3, 8, 3, 8, 8,…\n$ m5_11            &lt;dbl&gt; 2, 2, 7, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3,…\n$ m5_12            &lt;dbl&gt; 5, 7, 2, 1, 2, 2, 2, 2, 2, 6, 2, 7, 4, 5, 2, 2, 2, 5,…\n$ m5_13            &lt;dbl&gt; 1, 5, 1, 7, 9, 9, 9, 9, 9, 9, 5, 6, 5, 2, 9, 5, 9, 9,…\n$ m6_1             &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 2, 2,…\n$ m7_1_1           &lt;dbl&gt; 2, 2, 2, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_1_2           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_1_3           &lt;dbl&gt; 1, 1, 2, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 1, 1, …\n$ m7_1_4           &lt;dbl&gt; 1, 1, 2, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 1, …\n$ m7_1_5           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_1_6           &lt;dbl&gt; 1, 1, 1, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 1, 2, …\n$ m7_1_7           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_1_8           &lt;dbl&gt; 1, 1, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 1, NA, 2, 2, …\n$ m7_1_9           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 1, NA, 2, 2, …\n$ m7_1_10          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_1           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 1, …\n$ m7_2_2           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_3           &lt;dbl&gt; 1, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_4           &lt;dbl&gt; 1, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 1, …\n$ m7_2_5           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_6           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_7           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_8           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_9           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m7_2_10          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_1             &lt;chr&gt; \"ABCFG\", \"ABC\", \"ABC\", \"ABC\", NA, NA, \"ABC\", \"AC\", \"C…\n$ m8_2_1           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_2           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_3           &lt;dbl&gt; 1, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_4           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_5           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_6           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_7           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_8           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_9           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_10          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_11          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_12          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_13          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_14          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m8_2_15          &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_1_1           &lt;dbl&gt; 1, 1, 2, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_1_2           &lt;dbl&gt; 2, 1, 2, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_1_3           &lt;dbl&gt; 2, 1, 1, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_1_4           &lt;dbl&gt; 2, 1, 2, 1, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_2_1           &lt;dbl&gt; 1, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_2_2           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_2_3           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m9_2_4           &lt;dbl&gt; 2, 2, 2, 2, NA, NA, 2, 2, 2, 2, NA, NA, 2, NA, 2, 2, …\n$ m10_1            &lt;chr&gt; \"A\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ m11_1            &lt;chr&gt; \"A\", \"A\", \"B\", \"E\", NA, NA, \"A\", \"A\", \"A\", \"A\", NA, N…\n$ n1_1             &lt;dbl&gt; 3, 3, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 3, 2, 1, 2, 2, 1,…\n$ n3_1             &lt;dbl&gt; 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 2, 2,…\n$ n4_1             &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1,…\n$ n5_1             &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1,…\n$ n6_1             &lt;dbl&gt; 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2,…\n$ n7_1             &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1,…\n$ n8_1             &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, 2, 2, 1, 2,…\n$ n9_1             &lt;dbl&gt; 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2,…\n$ n10_1            &lt;dbl&gt; 1, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2,…\n$ ab1              &lt;dbl&gt; 28072023, 28072023, 28072023, 28072023, 28072023, 280…\n$ ab2              &lt;dbl&gt; 1503, 1302, 1400, 1515, 1552, 1446, 1315, 1259, 1400,…\n$ ab3              &lt;dbl&gt; 1603, 1356, 1449, 1717, 1842, 1530, 1444, 1338, 1501,…\n$ ab5              &lt;dbl&gt; 26, 27, 27, 27, 28, 28, 28, 30, 30, 30, 34, 34, 34, 3…\n$ ab7              &lt;dbl&gt; 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 31, 31, 31, 3…\n$ ab8              &lt;dbl&gt; 1, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1,…\n$ consent          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ hh_gps_latitude  &lt;dbl&gt; 2.677662, 2.675690, 2.673339, 2.671343, 2.671923, 2.6…\n$ hh_gps_longitude &lt;dbl&gt; 33.65414, 33.65328, 33.65403, 33.65586, 33.65472, 33.…\n$ s1aq1a           &lt;dbl&gt; 314, 314, 314, 314, 314, 314, 314, 314, 314, 314, 324…\n$ s1aq1b           &lt;chr&gt; \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM…\n$ s1aq2a           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ s1aq2b           &lt;chr&gt; \"LABWOR\", \"LABWOR\", \"LABWOR\", \"LABWOR\", \"LABWOR\", \"LA…\n$ s1aq3a           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n$ s1aq3b           &lt;chr&gt; \"ABIM TOWN COUNCIL\", \"ABIM TOWN COUNCIL\", \"ABIM TOWN …\n$ s1aq4a           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3,…\n$ s1aq4b           &lt;chr&gt; \"KALAKALA\", \"KALAKALA\", \"KALAKALA\", \"KALAKALA\", \"KALA…\n$ s1aq5a           &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ s1aq5b           &lt;chr&gt; \"AYWEE MODERN\", \"AYWEE MODERN\", \"AYWEE MODERN\", \"AYWE…\n\n\nSee the data in XCOORD column\n\nhead(finscope$hh_gps_longitude) #see the data in XCOORD column\n\n[1] 33.65414 33.65328 33.65403 33.65586 33.65472 33.65549\n\n\nSee the data in YCOORD column\n\nhead(finscope$hh_gps_latitude) #see the data in XCOORD column\n\n[1] 2.677662 2.675690 2.673339 2.671343 2.671923 2.672423\n\n\nRemove rows with empty longitude or latitude\n\nfinscope &lt;- finscope %&gt;%\n  filter(hh_gps_longitude != 0, hh_gps_latitude != 0)\n\nConvert aspatial data frame into a sf object\n\nfinscope.sf &lt;- st_as_sf(finscope,\n                            coords = c(\"hh_gps_longitude\", \"hh_gps_latitude\"),\n                            crs=4326) %&gt;%\n  st_transform(crs=32636)\n\nList the content of finscope.sf\n\nhead(finscope.sf)\n\nSimple feature collection with 6 features and 684 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 572616.1 ymin: 295285.3 xmax: 572903.6 ymax: 295983.7\nProjected CRS: WGS 84 / UTM zone 36N\n# A tibble: 6 × 685\n  HH_ID  Interview_ID ea_name   ea_code   age disabled District Region Subregion\n  &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    \n1 001001 00100102     AYWEE MO…       1    32        2 ABIM     NORTH… KARAMOJA \n2 001019 00101905     AYWEE MO…       1    37        2 ABIM     NORTH… KARAMOJA \n3 001028 00102802     AYWEE MO…       1    25        2 ABIM     NORTH… KARAMOJA \n4 001037 00103701     AYWEE MO…       1    32        2 ABIM     NORTH… KARAMOJA \n5 001040 00104001     AYWEE MO…       1    40        2 ABIM     NORTH… KARAMOJA \n6 001047 00104704     AYWEE MO…       1    16        2 ABIM     NORTH… KARAMOJA \n# ℹ 676 more variables: Rural_Urban &lt;chr&gt;, Pweight &lt;dbl&gt;, Lhhid &lt;dbl&gt;,\n#   Enum_code &lt;dbl&gt;, InterviewDate &lt;dbl&gt;, starttime &lt;dbl&gt;, endtime &lt;dbl&gt;,\n#   namepid &lt;dbl&gt;, c1 &lt;dbl&gt;, c2 &lt;dbl&gt;, c3 &lt;dbl&gt;, c4 &lt;dbl&gt;, c5 &lt;dbl&gt;,\n#   c6_1_1 &lt;dbl&gt;, c6_1_2 &lt;dbl&gt;, c6_1_3 &lt;dbl&gt;, c6_2_1 &lt;dbl&gt;, c6_2_2 &lt;dbl&gt;,\n#   c6_2_3 &lt;dbl&gt;, c7_1_1 &lt;dbl&gt;, c7_1_2 &lt;dbl&gt;, c7_1_3 &lt;dbl&gt;, c7_1_4 &lt;dbl&gt;,\n#   c7_1_5 &lt;dbl&gt;, c7_1_6 &lt;dbl&gt;, c8_1a &lt;dbl&gt;, c8_1b &lt;dbl&gt;, c8_1c &lt;dbl&gt;,\n#   c8_1d &lt;dbl&gt;, c8_1e &lt;dbl&gt;, c8_1f &lt;dbl&gt;, c8_1g &lt;dbl&gt;, c8_1h &lt;dbl&gt;, …\n\n\nShow the distinct value of district\n\nunique(finscope.sf$District)\n\n  [1] \"ABIM\"          \"AMUDAT\"        \"KAABONG\"       \"NABILATUK\"    \n  [5] \"DOKOLO\"        \"ALEBTONG\"      \"SOROTI\"        \"AMURIA\"       \n  [9] \"KOTIDO\"        \"MOROTO\"        \"NAKAPIRIPIRIT\" \"NAPAK\"        \n [13] \"KABERAMAIDO\"   \"NGORA\"         \"BUKEDEA\"       \"SERERE\"       \n [17] \"BUIKWE\"        \"KAYUNGA\"       \"WAKISO\"        \"KAMPALA\"      \n [21] \"MUKONO\"        \"ADJUMANI\"      \"MOYO\"          \"YUMBE\"        \n [25] \"KOBOKO\"        \"ZOMBO\"         \"PAKWACH\"       \"ARUA\"         \n [29] \"NEBBI\"         \"MARACHA\"       \"KITGUM\"        \"PADER\"        \n [33] \"NWOYA\"         \"AMURU\"         \"APAC\"          \"LIRA\"         \n [37] \"KWANIA\"        \"GULU\"          \"AGAGO\"         \"LAMWO\"        \n [41] \"OMORO\"         \"AMOLATAR\"      \"OYAM\"          \"KOLE\"         \n [45] \"OTUKE\"         \"BUSIA\"         \"PALLISA\"       \"TORORO\"       \n [49] \"BUDAKA\"        \"BUTALEJA\"      \"KALIRO\"        \"BUYENDE\"      \n [53] \"NAMAYINGO\"     \"BUGWERI\"       \"BUGIRI\"        \"IGANGA\"       \n [57] \"JINJA\"         \"KAMULI\"        \"MAYUGE\"        \"NAMUTUMBA\"    \n [61] \"LUUKA\"         \"BUVUMA\"        \"KIBUKU\"        \"BUTEBO\"       \n [65] \"KAPCHORWA\"     \"MBALE\"         \"SIRONKO\"       \"MANAFWA\"      \n [69] \"BUDUDA\"        \"BULAMBULI\"     \"KWEEN\"         \"NAMISINDWA\"   \n [73] \"KATAKWI\"       \"KAPELEBYONG\"   \"KAKUMIRO\"      \"MITYANA\"      \n [77] \"MPIGI\"         \"LWENGO\"        \"MASAKA\"        \"RAKAI\"        \n [81] \"SSEMBABULE\"    \"BUKOMANSIMBI\"  \"GOMBA\"         \"KALUNGU\"      \n [85] \"KYOTERA\"       \"NTUNGAMO\"      \"RUBIRIZI\"      \"RUKIGA\"       \n [89] \"KABALE\"        \"KISORO\"        \"RUKUNGIRI\"     \"KANUNGU\"      \n [93] \"RUBANDA\"       \"BUSHENYI\"      \"MBARARA\"       \"IBANDA\"       \n [97] \"KIRUHURA\"      \"SHEEMA\"        \"ISINGIRO\"      \"BUHWEJU\"      \n[101] \"MITOOMA\"       \"LYANTONDE\"     \"KAMWENGE\"      \"HOIMA\"        \n[105] \"MASINDI\"       \"KIRYANDONGO\"   \"BULIISA\"       \"KIKUUBE\"      \n[109] \"LUWERO\"        \"NAKASEKE\"      \"KIBOGA\"        \"KYANKWANZI\"   \n[113] \"KIBAALE\"       \"KAGADI\"        \"KASSANDA\"      \"MUBENDE\"      \n[117] \"KABAROLE\"      \"KASESE\"        \"KYENJOJO\"      \"BUNYANGABU\"   \n[121] \"BUNDIBUGYO\"    \"KYEGEGWA\"     \n\n\nChange to title case\n\nlibrary(stringr)\nfinscope.sf$District &lt;- str_to_title(finscope$District)\n\nView the changes\n\nunique(finscope.sf$District)\n\n  [1] \"Abim\"          \"Amudat\"        \"Kaabong\"       \"Nabilatuk\"    \n  [5] \"Dokolo\"        \"Alebtong\"      \"Soroti\"        \"Amuria\"       \n  [9] \"Kotido\"        \"Moroto\"        \"Nakapiripirit\" \"Napak\"        \n [13] \"Kaberamaido\"   \"Ngora\"         \"Bukedea\"       \"Serere\"       \n [17] \"Buikwe\"        \"Kayunga\"       \"Wakiso\"        \"Kampala\"      \n [21] \"Mukono\"        \"Adjumani\"      \"Moyo\"          \"Yumbe\"        \n [25] \"Koboko\"        \"Zombo\"         \"Pakwach\"       \"Arua\"         \n [29] \"Nebbi\"         \"Maracha\"       \"Kitgum\"        \"Pader\"        \n [33] \"Nwoya\"         \"Amuru\"         \"Apac\"          \"Lira\"         \n [37] \"Kwania\"        \"Gulu\"          \"Agago\"         \"Lamwo\"        \n [41] \"Omoro\"         \"Amolatar\"      \"Oyam\"          \"Kole\"         \n [45] \"Otuke\"         \"Busia\"         \"Pallisa\"       \"Tororo\"       \n [49] \"Budaka\"        \"Butaleja\"      \"Kaliro\"        \"Buyende\"      \n [53] \"Namayingo\"     \"Bugweri\"       \"Bugiri\"        \"Iganga\"       \n [57] \"Jinja\"         \"Kamuli\"        \"Mayuge\"        \"Namutumba\"    \n [61] \"Luuka\"         \"Buvuma\"        \"Kibuku\"        \"Butebo\"       \n [65] \"Kapchorwa\"     \"Mbale\"         \"Sironko\"       \"Manafwa\"      \n [69] \"Bududa\"        \"Bulambuli\"     \"Kween\"         \"Namisindwa\"   \n [73] \"Katakwi\"       \"Kapelebyong\"   \"Kakumiro\"      \"Mityana\"      \n [77] \"Mpigi\"         \"Lwengo\"        \"Masaka\"        \"Rakai\"        \n [81] \"Ssembabule\"    \"Bukomansimbi\"  \"Gomba\"         \"Kalungu\"      \n [85] \"Kyotera\"       \"Ntungamo\"      \"Rubirizi\"      \"Rukiga\"       \n [89] \"Kabale\"        \"Kisoro\"        \"Rukungiri\"     \"Kanungu\"      \n [93] \"Rubanda\"       \"Bushenyi\"      \"Mbarara\"       \"Ibanda\"       \n [97] \"Kiruhura\"      \"Sheema\"        \"Isingiro\"      \"Buhweju\"      \n[101] \"Mitooma\"       \"Lyantonde\"     \"Kamwenge\"      \"Hoima\"        \n[105] \"Masindi\"       \"Kiryandongo\"   \"Buliisa\"       \"Kikuube\"      \n[109] \"Luwero\"        \"Nakaseke\"      \"Kiboga\"        \"Kyankwanzi\"   \n[113] \"Kibaale\"       \"Kagadi\"        \"Kassanda\"      \"Mubende\"      \n[117] \"Kabarole\"      \"Kasese\"        \"Kyenjojo\"      \"Bunyangabu\"   \n[121] \"Bundibugyo\"    \"Kyegegwa\"     \n\n\nExtract the district list from finscope\n\ndistrict_list &lt;- finscope.sf %&gt;%\n  distinct(District) %&gt;%               \n  mutate(District = str_to_title(District)) %&gt;%  \n  arrange(District)                    \n\nExtract the district list from uganda_modified\n\ndistrict_list2 &lt;- uganda_modified %&gt;%\n  distinct(shapeName) %&gt;%               \n  arrange(shapeName) \n\nCombine both list together\n\nmerged_list &lt;- district_list2 %&gt;%\n  left_join(district_list %&gt;% mutate(In_List = TRUE), by = c(\"shapeName\" = \"District\")) %&gt;%\n  mutate(In_List = ifelse(is.na(In_List), FALSE, TRUE))\n\nView the district with no data collected in finscope\n\nfalse_districts &lt;- merged_list %&gt;%\n  filter(In_List == FALSE)\n\nprint(false_districts$shapeName)\n\n [1] \"Bukwo\"       \"Butambala\"   \"Kalaki\"      \"Kalanga\"     \"Karenga\"    \n [6] \"Kazo\"        \"Kitagwenga\"  \"Kumi\"        \"Madi Okollo\" \"Nakasongola\"\n[11] \"Ntoroko\"     \"Obongi\"      \"Rubirzi\"     \"Rwampara\"    \"Terego\"     \n\n\nHightlight the district in the map\n\nhighlight_districts &lt;- merged_list %&gt;%\n  filter(In_List == FALSE) %&gt;%\n  pull(shapeName)\n\nhighlighted_map &lt;- uganda_modified %&gt;%\n  filter(shapeName %in% highlight_districts)\n\nplot(st_geometry(uganda_modified), col = \"lightgray\", main = \"Districts with no data in Finscope in Uganda\", border = \"black\")\n\nplot(st_geometry(highlighted_map), col = \"red\", add = TRUE, border = \"black\")\n\ntext(st_coordinates(st_centroid(st_geometry(highlighted_map))), \n     labels = highlighted_map$shapeName, \n     cex = 0.7, pos = 3, col = \"black\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#data-preparation-for-gwlr-model",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#data-preparation-for-gwlr-model",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "Data Preparation for GWLR Model",
    "text": "Data Preparation for GWLR Model\nConvert finscope.sf to spatial data\n\nfinscope.sp &lt;- as_Spatial(finscope_mobile_money)\n\nCalculating distance matrix to fit the GWLR model\n\ndistMAT &lt;- gw.dist(dp.locat = coordinates(finscope.sp))\n\n\ndim(distMAT)\n\n[1] 1094 1094\n\n\nComputing Adaptive Bandwidth with dependent variable = Mobile Money / E-money Wallets Usage Independent variable = Sex\n\nbw.adaptive &lt;- bw.ggwr(formula = h2_2_8 ~ c2, \n                       family = \"binomial\", \n                       data = finscope_mobile_money, \n                       approach = \"CV\", \n                       kernel = \"gaussian\", \n                       adaptive = TRUE, \n                       longlat = FALSE, \n                       p = 2, \n                       theta = 0, \n                       dMat = distMAT)\n\n Iteration    Log-Likelihood:(With bandwidth:  683 )\n=========================\n       0       -673.4 \n       1       -674.5 \n       2       -674.9 \n       3       -674.9 \nAdaptive bandwidth: 683 CV score: 232.7282 \n Iteration    Log-Likelihood:(With bandwidth:  430 )\n=========================\n       0         -672 \n       1       -673.4 \n       2         -675 \n       3       -680.4 \n       4       -698.1 \n       5       -713.4 \n       6       -716.8 \n       7       -714.1 \n       8       -712.5 \n       9       -713.8 \n      10       -714.6 \n      11       -713.9 \n      12       -713.6 \n      13       -713.9 \n      14       -714.1 \n      15       -713.9 \n      16       -713.8 \n      17       -713.9 \n      18       -713.9 \n      19       -713.9 \nAdaptive bandwidth: 430 CV score: 232.9232 \n Iteration    Log-Likelihood:(With bandwidth:  840 )\n=========================\n       0       -673.8 \n       1       -674.8 \n       2       -675.1 \n       3       -675.1 \n       4         -675 \n       5         -675 \nAdaptive bandwidth: 840 CV score: 232.7489 \n Iteration    Log-Likelihood:(With bandwidth:  586 )\n=========================\n       0         -673 \n       1       -674.1 \n       2       -674.7 \n       3       -674.8 \n       4       -674.9 \n       5         -675 \n       6       -675.1 \n       7       -675.1 \n       8       -675.2 \n       9       -675.2 \n      10       -675.3 \n      11       -675.4 \n      12       -675.4 \n      13       -675.5 \n      14       -675.6 \n      15       -675.6 \n      16       -675.7 \n      17       -675.8 \n      18         -676 \n      19       -676.2 \nAdaptive bandwidth: 586 CV score: 232.8694 \n Iteration    Log-Likelihood:(With bandwidth:  743 )\n=========================\n       0       -673.6 \n       1       -674.6 \n       2       -675.1 \n       3         -675 \n       4       -674.9 \n       5       -674.9 \n       6       -674.9 \nAdaptive bandwidth: 743 CV score: 232.7295 \n Iteration    Log-Likelihood:(With bandwidth:  646 )\n=========================\n       0       -673.3 \n       1       -674.4 \n       2       -674.8 \n       3       -674.9 \n       4       -674.8 \n       5       -674.8 \n       6       -674.8 \nAdaptive bandwidth: 646 CV score: 232.6792 \n Iteration    Log-Likelihood:(With bandwidth:  623 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 623 CV score: 232.6544 \n Iteration    Log-Likelihood:(With bandwidth:  609 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.8 \n       3       -674.9 \n       4       -674.9 \nAdaptive bandwidth: 609 CV score: 232.7141 \n Iteration    Log-Likelihood:(With bandwidth:  632 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.8 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 632 CV score: 232.6517 \n Iteration    Log-Likelihood:(With bandwidth:  637 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.8 \n       3       -674.8 \n       4       -674.8 \n       5       -674.8 \n       6       -674.8 \n       7       -674.8 \nAdaptive bandwidth: 637 CV score: 232.6621 \n Iteration    Log-Likelihood:(With bandwidth:  628 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 628 CV score: 232.6507 \n Iteration    Log-Likelihood:(With bandwidth:  626 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.7 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 626 CV score: 232.6485 \n Iteration    Log-Likelihood:(With bandwidth:  624 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 624 CV score: 232.6507 \n Iteration    Log-Likelihood:(With bandwidth:  626 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.7 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 626 CV score: 232.6485 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe resulting adaptive bandwdith value is 626, represent the number of nearest neighbours.\n\n\n\nFitting GWLR model\nPlot the distribution of the variables\n\nplot_categorical &lt;- function(data, column, title) {\n  ggplot(data, aes(x = !!sym(column))) +\n    geom_bar(fill = \"skyblue\") +\n    labs(title = title, x = column, y = \"Count\") +\n    theme_minimal()\n}\n\n\nplot_education &lt;- plot_categorical(finscope_mobile_money, \"c4\", \"Education Level\")\nplot_mobile &lt;- plot_categorical(finscope_mobile_money, \"c7_1_1\", \"Own a Mobile Phone?\")\nplot_internet &lt;- plot_categorical(finscope_mobile_money, \"c6_1_2\", \"Internet Access\")\nplot_sex &lt;- plot_categorical(finscope_mobile_money, \"c2\", \"Sex\")\nplot_marital &lt;- plot_categorical(finscope_mobile_money, \"c3\", \"Marital Status\")\nplot_age &lt;- plot_categorical(finscope_mobile_money, \"age_group\", \"Age_group\")\n\n\n# Arrange and display independent variable plots\nindependent_plots &lt;- ggarrange(\n  plot_education, plot_mobile, plot_internet, plot_age, plot_sex, plot_marital,\n  ncol = 2, nrow = 3)\nindependent_plots \n\n\n\n\n\n\n\n\nSet bw parameter to 626. The family parameter is set to “binomial” due to the binary nature of the Mobile Money/E-money wallets usage variable.\n\ngwlr &lt;- ggwr.basic(h2_2_8 ~ age_group + c7_1_1 + c6_1_2 + c3,\n                   data = finscope_mobile_money, \n                   bw = 626, \n                   family = \"binomial\", \n                   kernel = \"gaussian\", \n                   adaptive = TRUE, \n                   cv = T, \n                   tol = 1e-05, \n                   maxiter = 20, \n                   p = 2, \n                   theta = 0, \n                   longlat = FALSE, \n                   dMat = distMAT)\n\n Iteration    Log-Likelihood\n=========================\n       0       -624.5 \n       1       -622.3 \n       2       -621.9 \n       3       -621.9 \n       4       -621.9 \n\n\n\ngwlr\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-11-09 21:15:51.43953 \n   Call:\n   ggwr.basic(formula = h2_2_8 ~ age_group + c7_1_1 + c6_1_2 + c3, \n    data = finscope_mobile_money, bw = 626, family = \"binomial\", \n    kernel = \"gaussian\", adaptive = TRUE, cv = T, tol = 1e-05, \n    maxiter = 20, p = 2, theta = 0, longlat = FALSE, dMat = distMAT)\n\n   Dependent (y) variable:  h2_2_8\n   Independent variables:  age_group c7_1_1 c6_1_2 c3\n   Number of data points: 1094\n   Used family: binomial\n   ***********************************************************************\n   *              Results of Generalized linear Regression               *\n   ***********************************************************************\n\nCall:\nNULL\n\nCoefficients:\n                              Estimate Std. Error z value Pr(&gt;|z|)    \nIntercept                    8.182e-01  3.701e-01   2.211  0.02705 *  \nage_groupYoung Adults        5.921e-01  3.281e-01   1.805  0.07109 .  \nage_groupAdults              2.992e-01  3.571e-01   0.838  0.40204    \nage_groupMiddle-aged Adults  3.056e-01  3.594e-01   0.850  0.39511    \nage_groupSeniors             4.907e-01  4.212e-01   1.165  0.24403    \nage_groupElderly            -1.458e+00  1.200e+00  -1.215  0.22434    \nc7_1_12                     -1.480e+00  1.914e-01  -7.731 1.07e-14 ***\nc6_1_22                     -7.248e-05  1.563e-01   0.000  0.99963    \nc32                          1.960e-01  2.962e-01   0.662  0.50820    \nc33                          2.073e-02  2.752e-01   0.075  0.93995    \nc34                         -7.006e-01  2.592e-01  -2.703  0.00687 ** \nc35                         -2.501e-01  2.614e-01  -0.957  0.33866    \nc36                         -4.147e-01  2.062e-01  -2.011  0.04436 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1362.3  on 1093  degrees of freedom\nResidual deviance: 1263.2  on 1081  degrees of freedom\nAIC: 1289.2\n\nNumber of Fisher Scoring iterations: 4\n\n\n AICc:  1289.525\n Pseudo R-square value:  0.07273189\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 626 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: A distance matrix is specified for this model calibration.\n\n   ************Summary of Generalized GWR coefficient estimates:**********\n                                    Min.   1st Qu.    Median   3rd Qu.    Max.\n   Intercept                    0.737191  0.784762  0.815918  0.929452  1.0312\n   age_groupYoung Adults        0.424141  0.538825  0.669435  0.751911  0.8550\n   age_groupAdults              0.185400  0.243294  0.346853  0.430027  0.5659\n   age_groupMiddle-aged Adults  0.225340  0.269932  0.356858  0.404514  0.4832\n   age_groupSeniors             0.338275  0.443224  0.607646  0.710800  0.8379\n   age_groupElderly            -2.718340 -2.125125 -1.701922 -1.319734 -1.0628\n   c7_1_12                     -1.525668 -1.510242 -1.459310 -1.361642 -1.3402\n   c6_1_22                     -0.173193 -0.129051 -0.040104 -0.016925  0.0593\n   c32                          0.033796  0.152809  0.226779  0.280353  0.3761\n   c33                         -0.091835 -0.024837  0.051218  0.129453  0.2149\n   c34                         -0.750512 -0.722375 -0.688880 -0.625325 -0.5748\n   c35                         -0.430247 -0.365775 -0.293357 -0.200435 -0.1231\n   c36                         -0.437908 -0.404562 -0.375320 -0.338154 -0.3130\n   ************************Diagnostic information*************************\n   Number of data points: 1094 \n   GW Deviance: 1243.724 \n   AIC : 1283.614 \n   AICc : 1284.393 \n   Pseudo R-square value:  0.08702015 \n\n   ***********************************************************************\n   Program stops at: 2024-11-09 21:16:10.035156 \n\n\n\n\n\n\n\n\nNote\n\n\n\nPseudo R-square (0.087): This value is relatively low, suggesting that the model explains around 8.7% of the variation in Mobile Money / E-money Wallets Usage\nThe decrease in AIC from the global model’s AIC(1289.2) suggests that the GWLR model provides a slightly better fit due to spatial variation.\nc7_1_1 (Owns a Mobile Phone - Yes): Strongly significant and negative (-1.480, p &lt; 0.001). Not owning a mobile phone is associated with much lower odds of using mobile money/e-money wallets.\nc6_1_2 (Internet Access): Not significant (p = 0.99963), indicating no strong association between internet access and mobile money/e-money usage.\nEducation Level (c3): Only some levels of c3 (e.g., c34) are significant, indicating that education level might affect usage, though the impact varies across levels.\n\n\nVisualize GWR Output\nconverting SDF into sf data.frame\n\nmobilemoney.sf.adaptive &lt;- st_as_sf(gwlr$SDF) %&gt;% \n  st_transform(crs=32636)\n\n\nmobilemoney.sf.adaptive.UTM36N &lt;- st_transform(mobilemoney.sf.adaptive, 32636)\nmobilemoney.sf.adaptive.UTM36N  \n\nSimple feature collection with 1094 features and 42 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 128007.7 ymin: -156374.4 xmax: 717586.7 ymax: 407771.6\nProjected CRS: WGS 84 / UTM zone 36N\nFirst 10 features:\n   Intercept age_groupYoung Adults age_groupAdults age_groupMiddle-aged Adults\n1  0.8593362             0.7724220       0.4561738                   0.4082956\n2  0.8593144             0.7724121       0.4561611                   0.4082835\n3  0.8595688             0.7721147       0.4557890                   0.4080476\n4  0.8594936             0.7721628       0.4558490                   0.4080811\n5  0.8594918             0.7721703       0.4558585                   0.4080877\n6  0.7691724             0.8110754       0.5081904                   0.4392421\n7  0.7689157             0.8110997       0.5082326                   0.4392761\n8  0.7687264             0.8112805       0.5084495                   0.4394226\n9  0.7687198             0.8112900       0.5084607                   0.4394301\n10 0.8473324             0.7797525       0.4657468                   0.4139539\n   age_groupSeniors age_groupElderly   c7_1_12     c6_1_22        c32       c33\n1         0.6792598        -2.284245 -1.505381 -0.11003031 0.13654299 0.1588270\n2         0.6792655        -2.283928 -1.505375 -0.11000703 0.13650309 0.1587919\n3         0.6788943        -2.282713 -1.505469 -0.11008850 0.13668429 0.1586387\n4         0.6789745        -2.282602 -1.505443 -0.11004624 0.13660371 0.1586300\n5         0.6789811        -2.282675 -1.505442 -0.11004814 0.13660608 0.1586384\n6         0.7711003        -2.025091 -1.452758 -0.05286960 0.05015751 0.1269358\n7         0.7713060        -2.023665 -1.452533 -0.05267099 0.04994245 0.1267483\n8         0.7716127        -2.024129 -1.452389 -0.05260694 0.04977988 0.1268006\n9         0.7716264        -2.024175 -1.452384 -0.05260637 0.04977423 0.1268062\n10        0.6924125        -2.270193 -1.499822 -0.10316383 0.12521130 0.1572915\n          c34        c35        c36 y      yhat   residual Intercept_SE\n1  -0.6755898 -0.3183350 -0.4002689 0 0.6182228 -0.6182228    0.4304049\n2  -0.6755757 -0.3183284 -0.4002750 0 0.2599294 -0.2599294    0.4303957\n3  -0.6756584 -0.3180012 -0.4004300 1 0.4138818  0.5861182    0.4303311\n4  -0.6756262 -0.3180590 -0.4004060 1 0.8207755  0.1792245    0.4303336\n5  -0.6756267 -0.3180667 -0.4004019 1 0.7542135  0.2457865    0.4303364\n6  -0.6237080 -0.3782436 -0.3647071 1 0.7904302  0.2095698    0.4334619\n7  -0.6235258 -0.3783653 -0.3646104 1 0.7728505  0.2271495    0.4334647\n8  -0.6233863 -0.3785570 -0.3644821 1 0.7814863  0.2185137    0.4335252\n9  -0.6233814 -0.3785657 -0.3644765 0 0.5311579 -0.5311579    0.4335285\n10 -0.6699862 -0.3282295 -0.3951662 0 0.7013919 -0.7013919    0.4308865\n   age_groupYoung Adults_SE age_groupAdults_SE age_groupMiddle-aged Adults_SE\n1                 0.3788360          0.4196215                      0.4164668\n2                 0.3788274          0.4196126                      0.4164586\n3                 0.3787642          0.4195431                      0.4163923\n4                 0.3787672          0.4195471                      0.4163963\n5                 0.3787698          0.4195498                      0.4163989\n6                 0.3820993          0.4240743                      0.4196673\n7                 0.3820998          0.4240774                      0.4196646\n8                 0.3821580          0.4241422                      0.4197244\n9                 0.3821612          0.4241457                      0.4197277\n10                0.3793988          0.4203257                      0.4170616\n   age_groupSeniors_SE age_groupElderly_SE c7_1_12_SE c6_1_22_SE    c32_SE\n1            0.4903310            1.091284  0.2243186  0.1679192 0.3305210\n2            0.4903197            1.091249  0.2243150  0.1679162 0.3305170\n3            0.4902454            1.091050  0.2242873  0.1678957 0.3304780\n4            0.4902474            1.091051  0.2242888  0.1678965 0.3304814\n5            0.4902507            1.091060  0.2242899  0.1678974 0.3304828\n6            0.4914859            1.104315  0.2268172  0.1694223 0.3326122\n7            0.4914766            1.104437  0.2268236  0.1694268 0.3326073\n8            0.4915418            1.104557  0.2268517  0.1694478 0.3326369\n9            0.4915455            1.104562  0.2268531  0.1694488 0.3326386\n10           0.4907023            1.092046  0.2246072  0.1680821 0.3309112\n      c33_SE    c34_SE    c35_SE    c36_SE Intercept_TV\n1  0.2944943 0.3040755 0.3061114 0.2285432     1.996576\n2  0.2944895 0.3040701 0.3061035 0.2285400     1.996568\n3  0.2944649 0.3040348 0.3060453 0.2285191     1.997459\n4  0.2944644 0.3040358 0.3060481 0.2285196     1.997273\n5  0.2944657 0.3040374 0.3060505 0.2285206     1.997256\n6  0.2922745 0.3049058 0.3086083 0.2289726     1.774487\n7  0.2922632 0.3049023 0.3086052 0.2289723     1.773883\n8  0.2922855 0.3049347 0.3086530 0.2289949     1.773199\n9  0.2922868 0.3049365 0.3086557 0.2289962     1.773170\n10 0.2942723 0.3042295 0.3066451 0.2285647     1.966486\n   age_groupYoung Adults_TV age_groupAdults_TV age_groupMiddle-aged Adults_TV\n1                  2.038935           1.087108                      0.9803796\n2                  2.038955           1.087101                      0.9803699\n3                  2.038510           1.086394                      0.9799595\n4                  2.038621           1.086526                      0.9800304\n5                  2.038627           1.086542                      0.9800402\n6                  2.122682           1.198352                      1.0466436\n7                  2.122743           1.198443                      1.0467315\n8                  2.122893           1.198771                      1.0469314\n9                  2.122900           1.198788                      1.0469410\n10                 2.055232           1.108062                      0.9925486\n   age_groupSeniors_TV age_groupElderly_TV c7_1_12_TV c6_1_22_TV    c32_TV\n1             1.385309           -2.093172  -6.710907 -0.6552576 0.4131145\n2             1.385352           -2.092949  -6.710986 -0.6551304 0.4129987\n3             1.384805           -2.092217  -6.712233 -0.6556956 0.4135958\n4             1.384963           -2.092113  -6.712073 -0.6554408 0.4133477\n5             1.384967           -2.092162  -6.712036 -0.6554487 0.4133531\n6             1.568916           -1.833799  -6.404972 -0.3120580 0.1507988\n7             1.569365           -1.832304  -6.403799 -0.3108776 0.1501544\n8             1.569780           -1.832525  -6.402373 -0.3104611 0.1496523\n9             1.569796           -1.832559  -6.402312 -0.3104558 0.1496345\n10            1.411064           -2.078844  -6.677534 -0.6137703 0.3783834\n      c33_TV    c34_TV    c35_TV    c36_TV                  geometry\n1  0.5393212 -2.221783 -1.039932 -1.751393 POINT (572776.5 295349.3)\n2  0.5392106 -2.221776 -1.039937 -1.751444 POINT (572862.9 295404.6)\n3  0.5387356 -2.222306 -1.039066 -1.752282 POINT (572827.8 295794.7)\n4  0.5387067 -2.222193 -1.039245 -1.752173 POINT (572931.4 295778.9)\n5  0.5387332 -2.222183 -1.039262 -1.752148 POINT (572918.9 295762.6)\n6  0.4343034 -2.045576 -1.225643 -1.592798 POINT (716962.8 214083.6)\n7  0.4336785 -2.045002 -1.226049 -1.592378 POINT (717586.7 213596.5)\n8  0.4338245 -2.044327 -1.226481 -1.591660     POINT (717473 213283)\n9  0.4338417 -2.044299 -1.226498 -1.591627   POINT (717457.4 213273)\n10 0.5345101 -2.202240 -1.070389 -1.728903   POINT (585445 287247.7)\n\n\n\ngwlr.output &lt;- as.data.frame(gwlr$SDF)\nmobilemoney.sf.adaptive &lt;- cbind(finscope_mobile_money, as.matrix(gwlr.output))\n\n\nglimpse(mobilemoney.sf.adaptive)\n\nRows: 1,094\nColumns: 729\n$ HH_ID                          &lt;chr&gt; \"001040\", \"001047\", \"001061\", \"001070\",…\n$ Interview_ID                   &lt;chr&gt; \"00104001\", \"00104704\", \"00106101\", \"00…\n$ ea_name                        &lt;chr&gt; \"AYWEE MODERN\", \"AYWEE MODERN\", \"AYWEE …\n$ ea_code                        &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 5, 7, 7, …\n$ age                            &lt;dbl&gt; 40, 16, 49, 28, 20, 37, 34, 32, 20, 27,…\n$ disabled                       &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ District                       &lt;chr&gt; \"Abim\", \"Abim\", \"Abim\", \"Abim\", \"Abim\",…\n$ Region                         &lt;chr&gt; \"NORTHERN\", \"NORTHERN\", \"NORTHERN\", \"NO…\n$ Subregion                      &lt;chr&gt; \"KARAMOJA\", \"KARAMOJA\", \"KARAMOJA\", \"KA…\n$ Rural_Urban                    &lt;chr&gt; \"Urban\", \"Urban\", \"Urban\", \"Urban\", \"Ur…\n$ Pweight                        &lt;dbl&gt; 5614.5480, 3367.0150, 727.2480, 2883.88…\n$ Lhhid                          &lt;dbl&gt; 40, 47, 61, 70, 72, 2, 9, 42, 43, 115, …\n$ Enum_code                      &lt;dbl&gt; 28, 28, 30, 30, 30, 34, 34, 32, 32, 30,…\n$ InterviewDate                  &lt;dbl&gt; 28072023, 28072023, 28072023, 28072023,…\n$ starttime                      &lt;dbl&gt; 1552, 1446, 1259, 1400, 1502, 1624, 141…\n$ endtime                        &lt;dbl&gt; 1842, 1530, 1338, 1501, 1522, 1705, 150…\n$ namepid                        &lt;dbl&gt; 1, 4, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, …\n$ c1                             &lt;dbl&gt; 4, 1, 5, 3, 2, 4, 4, 4, 2, 3, 3, 2, 2, …\n$ c2                             &lt;fct&gt; Middle-aged Adults, Teenagers, Middle-a…\n$ c3                             &lt;fct&gt; 4, 6, 1, 1, 6, 2, 1, 2, 2, 4, 1, 1, 1, …\n$ c4                             &lt;fct&gt; 3, 2, 6, 2, 2, 6, 1, 1, 1, 3, 2, 2, 1, …\n$ c5                             &lt;dbl&gt; 4, 9, 7, 1, 5, 4, 2, 1, 1, 5, 1, 5, 1, …\n$ c6_1_1                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, …\n$ c6_1_2                         &lt;fct&gt; 2, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ c6_1_3                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c6_2_1                         &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, …\n$ c6_2_2                         &lt;dbl&gt; 2, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ c6_2_3                         &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ c7_1_1                         &lt;fct&gt; 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, …\n$ c7_1_2                         &lt;dbl&gt; 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, …\n$ c7_1_3                         &lt;dbl&gt; NA, NA, 1, 1, 2, 2, 2, 2, NA, 1, 1, NA,…\n$ c7_1_4                         &lt;dbl&gt; 2, NA, NA, 2, 2, 2, 2, 2, NA, 2, NA, NA…\n$ c7_1_5                         &lt;dbl&gt; 1, NA, NA, 1, 1, 1, 1, 1, NA, 1, NA, NA…\n$ c7_1_6                         &lt;dbl&gt; NA, 6, 6, NA, NA, NA, NA, NA, 3, NA, 3,…\n$ c8_1a                          &lt;dbl&gt; 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, …\n$ c8_1b                          &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1c                          &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1d                          &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1e                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1f                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1g                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1h                          &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1i                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1j                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ c8_1k                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ d1_11                          &lt;dbl&gt; 5, 6, 4, 4, 4, 9, 5, 6, 5, 4, 5, 9, 5, …\n$ d1_12                          &lt;dbl&gt; 9, 5, 5, 5, 5, 12, 8, 9, 13, 5, 8, 12, …\n$ d1_13                          &lt;dbl&gt; 13, 12, 6, 10, 13, 12, 13, 10, 13, 13, …\n$ d1_2                           &lt;dbl&gt; 5, NA, 2, 3, 3, NA, 1, 3, 3, 3, 2, NA, …\n$ d2_2_11                        &lt;dbl&gt; 1, 10, 2, 1, 4, NA, 2, 2, 2, 2, 2, NA, …\n$ d2_2_12                        &lt;dbl&gt; 4, 10, 11, 2, 2, NA, 11, 4, 4, 11, 11, …\n$ d2_2_13                        &lt;dbl&gt; 11, 10, 11, 11, 11, NA, 11, 11, 11, 11,…\n$ d2_2_21                        &lt;dbl&gt; 8, NA, 6, 6, 6, NA, 2, 6, 6, 1, 2, NA, …\n$ d2_2_22                        &lt;dbl&gt; 7, NA, NA, 7, 8, NA, NA, 9, 9, NA, NA, …\n$ d2_2_23                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ d2_2_31                        &lt;dbl&gt; 1, NA, 1, 1, 1, NA, 1, 1, 1, 1, 1, NA, …\n$ d2_2_32                        &lt;dbl&gt; NA, NA, NA, 1, 1, NA, NA, 1, NA, NA, NA…\n$ d2_2_33                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ d3_31                          &lt;dbl&gt; 1, NA, 3, 1, 1, NA, 1, 4, 1, 1, 2, NA, …\n$ d3_32                          &lt;dbl&gt; 1, NA, NA, 1, 1, NA, NA, 1, 1, NA, NA, …\n$ d3_33                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ d4_4_1                         &lt;dbl&gt; 1, NA, 2, 1, 2, NA, 1, 1, 1, 2, 1, NA, …\n$ D4_4_2                         &lt;chr&gt; \"A\", NA, NA, \"A\", NA, NA, \"D\", \"ACI\", \"…\n$ e1_1                           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ e2_1                           &lt;dbl&gt; 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, …\n$ e3_1                           &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, …\n$ e3_2                           &lt;dbl&gt; 2, NA, NA, NA, NA, NA, NA, NA, 2, NA, N…\n$ e4_11                          &lt;dbl&gt; NA, 1, 1, 2, 2, 1, 12, 1, NA, 2, 1, 1, …\n$ e4_12                          &lt;dbl&gt; NA, 2, 13, 1, 13, 2, 9, 2, NA, 13, 13, …\n$ e4_13                          &lt;dbl&gt; NA, 13, NA, 13, NA, 13, 13, 13, NA, NA,…\n$ e5_11                          &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 1, 1, 2, …\n$ e5_12                          &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 1, 1, 1, …\n$ e5_13                          &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, …\n$ e5_14                          &lt;dbl&gt; 2, 2, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, …\n$ e5_15                          &lt;dbl&gt; 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, …\n$ e5_16                          &lt;dbl&gt; 1, 2, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 2, …\n$ e5_17                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ e6_1                           &lt;dbl&gt; 3, 5, 3, 4, 3, 3, 4, 4, 4, 4, 3, 4, 5, …\n$ e7_1                           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ e8_1                           &lt;dbl&gt; 4, 4, 11, 11, 11, 5, 5, 11, 11, 11, 3, …\n$ e8_2                           &lt;dbl&gt; 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 3, 2, 6, …\n$ e9_1                           &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …\n$ e9_2                           &lt;dbl&gt; 1, 6, 9, 12, 9, 3, 9, 9, 9, 6, 9, 9, 9,…\n$ e10_1                          &lt;dbl&gt; 4, 4, 2, 4, 2, 2, 4, 2, 10, 4, 2, 2, 2,…\n$ e10_2                          &lt;dbl&gt; 7, 8, 3, 8, 8, 8, 2, 3, NA, 8, 3, 3, 3,…\n$ f1_1_1                         &lt;dbl&gt; 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2, …\n$ f1_1_2                         &lt;dbl&gt; 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, …\n$ f1_1_3                         &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, …\n$ f1_1_4                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ f1_1_5                         &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 1, 1, 2, 2, 1, 2, 1, …\n$ f2_1                           &lt;dbl&gt; 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 2, 2, …\n$ f3_1_1                         &lt;dbl&gt; 2, NA, 1, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_2                         &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_3                         &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_4                         &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_5                         &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_6                         &lt;dbl&gt; 2, NA, 2, NA, 1, NA, 1, 2, NA, 2, NA, N…\n$ f3_1_7                         &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_8                         &lt;dbl&gt; 1, NA, 2, NA, 2, NA, 1, 2, NA, 1, NA, N…\n$ f3_1_9                         &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_10                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_11                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 1, 1, NA, 2, NA, N…\n$ f3_1_12                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_13                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_14                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_15                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_16                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_17                        &lt;dbl&gt; 2, NA, 2, NA, 2, NA, 2, 2, NA, 2, NA, N…\n$ f3_1_17_oth                    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_1                         &lt;dbl&gt; NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, …\n$ f3_2_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_6                         &lt;dbl&gt; NA, NA, NA, NA, 3, NA, 3, NA, NA, NA, N…\n$ f3_2_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_8                         &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, NA, NA, 3, NA…\n$ f3_2_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_11                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3, 3, NA, NA, N…\n$ f3_2_12                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_13                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_14                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_15                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_16                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_2_173                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_1                         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, …\n$ f3_3_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_6                         &lt;dbl&gt; NA, NA, NA, NA, 5, NA, 4, NA, NA, NA, N…\n$ f3_3_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_8                         &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 3, NA, NA, 3, NA…\n$ f3_3_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_11                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 4, 4, NA, NA, N…\n$ f3_3_12                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_13                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_14                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_15                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_16                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_3_174                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_4                           &lt;dbl&gt; 8, NA, 1, NA, 6, NA, 8, 8, NA, 8, NA, N…\n$ f3_5_1                         &lt;dbl&gt; NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, …\n$ f3_5_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_6                         &lt;dbl&gt; NA, NA, NA, NA, 1, NA, 4, NA, NA, NA, N…\n$ f3_5_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_8                         &lt;dbl&gt; 4, NA, NA, NA, NA, NA, 6, NA, NA, 5, NA…\n$ f3_5_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_11                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 6, 3, NA, NA, N…\n$ f3_5_12                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_13                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_14                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_15                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_16                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_17                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f3_5_18                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f4_1                           &lt;dbl&gt; 9, NA, 1, NA, 1, NA, 7, 1, NA, 1, NA, N…\n$ f5_1                           &lt;dbl&gt; NA, NA, 2, NA, 2, NA, NA, 2, NA, 2, NA,…\n$ f5_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f5_3                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, …\n$ f5_4                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f6_1                           &lt;dbl&gt; 1, NA, 8, NA, 1, NA, 1, 1, NA, 1, NA, N…\n$ f7_1                           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 9, 2, 2, 2, 2, 9, 2, …\n$ f7_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f7_3                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f7_4                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f7_5                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f7_6                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ f8                             &lt;dbl&gt; 1, 3, 3, 3, 3, 3, NA, 1, 1, 3, 1, NA, 1…\n$ f9_1                           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 1, 1, 2, 1, 2, 1, …\n$ f9_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2, 2, 2, NA, 2,…\n$ f10_1                          &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, …\n$ f10_2                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ f10_3                          &lt;dbl&gt; 2, 2, 2, 2, 2, 99, 2, 2, 99, 2, 99, 99,…\n$ f11_1_1                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f11_1_2                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f11_1_3                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, 1, NA, 1, NA,…\n$ f12_1                          &lt;dbl&gt; 9, NA, NA, NA, NA, NA, 8, 1, NA, 10, NA…\n$ f12_2                          &lt;dbl&gt; 4, NA, NA, NA, NA, NA, 3, 2, NA, 3, NA,…\n$ f13_1_1                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, 1, NA, 1, NA,…\n$ f13_1_2                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, 2, NA, 2, NA,…\n$ f13_1_3                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, 1, NA, 1, NA,…\n$ f13_1_4                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f13_1_5                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 1, NA,…\n$ f13_1_6                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 1, NA,…\n$ f13_1_7                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f14_1_1                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f14_1_2                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, 2, NA, 2, NA,…\n$ f14_1_3                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f14_1_4                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 3, 2, NA, 2, NA,…\n$ f14_1_5                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 3, 2, NA, 1, NA,…\n$ f14_1_6                        &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 3, 2, NA, 1, NA,…\n$ f14_1_7                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 3, 2, NA, 1, NA,…\n$ f14_1_8                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 3, 2, NA, 1, NA,…\n$ f14_1_9                        &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 1, NA,…\n$ f14_1_10                       &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 3, 2, NA, 2, NA,…\n$ f14_1_11                       &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 3, 2, NA, 2, NA,…\n$ f15_1                          &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, 1, NA, 1, NA,…\n$ f16_1                          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f16_2                          &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 2, 2, NA, 2, NA,…\n$ f17_1                          &lt;dbl&gt; 4, NA, NA, NA, NA, NA, 4, 4, NA, 4, NA,…\n$ f17_2                          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, 997, 3, NA, 2, N…\n$ f18_1                          &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 2, NA, NA, 2, NA…\n$ f18_2                          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ f18_3                          &lt;dbl&gt; 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ f19_1                          &lt;dbl&gt; 5, NA, NA, NA, NA, NA, 99, 1, NA, 99, N…\n$ f19_2                          &lt;dbl&gt; 2, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ f19_3                          &lt;chr&gt; \"B\", NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ f20                            &lt;dbl&gt; 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ g1_1_1                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, …\n$ g1_1_2                         &lt;dbl&gt; 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, …\n$ g1_1_3                         &lt;dbl&gt; 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, …\n$ g1_1_4                         &lt;dbl&gt; 1, 3, 2, 2, 2, 2, 2, 1, 1, 2, 3, 2, 1, …\n$ g1_1_5                         &lt;dbl&gt; 2, 3, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ g1_1_6                         &lt;dbl&gt; 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, …\n$ g1_1_7                         &lt;dbl&gt; 1, 3, 2, 3, 2, 3, 1, 1, 2, 2, 2, 1, 2, …\n$ g1_1_8                         &lt;dbl&gt; 2, 3, 2, 3, 3, 3, 3, 1, 3, 3, 3, 3, 3, …\n$ g1_1_9                         &lt;dbl&gt; 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …\n$ g1_2                           &lt;dbl&gt; 1, 2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ g2_11                          &lt;dbl&gt; 6, 8, 1, 8, 5, 8, 8, 6, 8, 6, 8, 8, 8, …\n$ g2_12                          &lt;dbl&gt; 8, 5, 9, 9, 9, 9, 6, 8, 9, 8, 9, 9, 9, …\n$ g2_13                          &lt;dbl&gt; 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, …\n$ g3_1                           &lt;dbl&gt; 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, …\n$ g3_2                           &lt;dbl&gt; 2, NA, NA, 2, NA, NA, NA, NA, NA, 1, 1,…\n$ g3_3                           &lt;dbl&gt; 1, NA, NA, 1, NA, NA, NA, NA, NA, 1, 1,…\n$ g4_1                           &lt;dbl&gt; 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 1, 2, 2, …\n$ g4_2                           &lt;dbl&gt; 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, …\n$ g5_1                           &lt;dbl&gt; 2, NA, 2, 2, 2, 2, 2, 2, NA, 2, 2, NA, …\n$ g6_1_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_6                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_8                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_11                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_12                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_13                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_14                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_15                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_16                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_1_17                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g6_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g7_1                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g8_1                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g9_1                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g9_1_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g9_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g9_3                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g9_4                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g10_1                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_1                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_2                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_3                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_4                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_5                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_6                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_7                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_8                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g11_1_9                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g12_1                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g12_2_1                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g12_2_2                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g13_1                          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ g13_2                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ g14_1                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ g14_2                          &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ g14_3                          &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ g15_1                          &lt;dbl&gt; NA, 2, 1, NA, 1, 3, 3, 12, 3, NA, NA, 1…\n$ h1_1_1                         &lt;dbl&gt; 1, 3, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, …\n$ h1_1_2                         &lt;dbl&gt; 1, 3, 2, 2, 2, 1, 1, 1, 1, 1, 3, 1, 1, …\n$ h1_1_3                         &lt;dbl&gt; 1, 3, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ h1_1_4                         &lt;dbl&gt; 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 3, 1, 1, …\n$ h1_1_5                         &lt;dbl&gt; 1, 1, 2, 3, 2, 1, 1, 1, 1, 2, 3, 1, 1, …\n$ h1_1_6                         &lt;dbl&gt; 3, 3, 3, 2, 3, 1, 3, 3, 3, 3, 3, 1, 3, …\n$ h1_1_7                         &lt;dbl&gt; 2, 1, 1, 3, 2, 2, 3, 3, 3, 3, 3, 2, 3, …\n$ h1_1_8                         &lt;dbl&gt; 3, 1, 3, 3, 3, 1, 2, 3, 3, 3, 3, 1, 3, …\n$ h1_1_9                         &lt;dbl&gt; 3, 1, 3, 3, 3, 1, 3, 3, 3, 3, 3, 1, 3, …\n$ h1_1_10                        &lt;dbl&gt; 2, 3, 3, 3, 3, 1, 2, 3, 3, 3, 3, 1, 3, …\n$ h1_1_11                        &lt;dbl&gt; 2, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 1, 3, …\n$ h1_1_12                        &lt;dbl&gt; 1, 3, 3, 2, 3, 2, 1, 3, 3, 3, 3, 3, 3, …\n$ h1_1_13                        &lt;dbl&gt; 2, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 3, 3, …\n$ h1_1_14                        &lt;dbl&gt; 2, 3, 3, 3, 3, 1, 2, 3, 3, 3, 3, 3, 3, …\n$ h1_1_15                        &lt;dbl&gt; 1, 3, 3, 3, 3, 1, 2, 3, 3, 3, 3, 3, 3, …\n$ h1_1_16                        &lt;dbl&gt; 2, 2, 1, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, …\n$ h1_1_17                        &lt;dbl&gt; 2, 1, 3, 3, 3, 1, 1, 3, 3, 3, 1, 1, 1, …\n$ h1_1_18                        &lt;dbl&gt; 2, 1, 3, 3, 3, 1, 1, 3, 3, 3, 3, 1, 3, …\n$ h1_1_19                        &lt;dbl&gt; 2, 1, 3, 3, 3, 1, 1, 3, 3, 3, 3, 1, 1, …\n$ h1_1_20                        &lt;dbl&gt; 2, 1, 3, 3, 3, 1, 3, 3, 3, 1, 3, 1, 1, …\n$ h2_1_1                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_2                         &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_3                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_4                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_5                         &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_6                         &lt;dbl&gt; 2, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_7                         &lt;dbl&gt; 1, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_1_8                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ h2_1_9                         &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ h2_2_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ h2_2_2                         &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ h2_2_3                         &lt;dbl&gt; 2, 2, 2, NA, NA, NA, NA, NA, NA, NA, NA…\n$ h2_2_4                         &lt;dbl&gt; 2, 2, 2, NA, NA, NA, NA, NA, NA, NA, NA…\n$ h2_2_5                         &lt;dbl&gt; 2, 2, 2, NA, NA, 1, NA, NA, NA, NA, NA,…\n$ h2_2_6                         &lt;dbl&gt; NA, 2, 2, NA, NA, 1, NA, NA, NA, NA, NA…\n$ h2_2_7                         &lt;dbl&gt; 2, 2, NA, NA, NA, 1, NA, NA, NA, NA, NA…\n$ h2_2_8                         &lt;dbl&gt; 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, …\n$ h2_2_9                         &lt;dbl&gt; 2, 2, 2, NA, NA, 2, NA, NA, NA, NA, NA,…\n$ h2_2_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ h3_11                          &lt;dbl&gt; 1, 1, 1, 1, 1, 99, 99, 99, 99, 1, 99, 9…\n$ h3_12                          &lt;dbl&gt; 2, 6, 2, 2, 2, 99, 99, 99, 99, 2, 99, 9…\n$ h3_13                          &lt;dbl&gt; 7, 14, 7, 7, 7, 99, 99, 99, 99, 7, 99, …\n$ h5_1                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ h5_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp1_1                         &lt;dbl&gt; 1, 2, 1, 1, 2, 1, 1, 2, 2, 2, 1, 2, 2, …\n$ hpp2_1                         &lt;chr&gt; \"B\", NA, \"BD\", \"D\", NA, \"D\", \"BE\", NA, …\n$ hpp2_2_1                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_2_2                       &lt;dbl&gt; 1, NA, 2, NA, NA, NA, 1, NA, NA, NA, NA…\n$ hpp2_2_3                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_2_4                       &lt;dbl&gt; NA, NA, 2, 1, NA, 1, NA, NA, NA, NA, NA…\n$ hpp2_2_5                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, …\n$ hpp2_2_6                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_2_7                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_31                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_32                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_33                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_34                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_35                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_36                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_37                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp2_4                         &lt;dbl&gt; 2, NA, 1, 3, NA, 99, 99, NA, NA, NA, 3,…\n$ hpp2_5                         &lt;dbl&gt; 4, NA, 5, 5, NA, 5, 5, NA, NA, NA, 5, N…\n$ hpp2_6                         &lt;dbl&gt; 4, NA, 1, 4, NA, 4, 4, NA, NA, NA, 4, N…\n$ hpp2_7                         &lt;dbl&gt; 2, NA, 2, 1, NA, 2, 8, NA, NA, NA, 1, N…\n$ hpp3_2                         &lt;dbl&gt; 1, NA, 2, 1, NA, 1, 1, NA, NA, NA, 997,…\n$ hpp4_1                         &lt;dbl&gt; 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, …\n$ hpp5_1                         &lt;chr&gt; NA, NA, \"D\", \"G\", \"E\", \"DF\", \"BEF\", \"E\"…\n$ hpp5_2_1                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_2_2                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, …\n$ hpp5_2_3                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_2_4                       &lt;dbl&gt; NA, NA, 2, NA, NA, 1, NA, NA, NA, 2, 1,…\n$ hpp5_2_5                       &lt;dbl&gt; NA, NA, NA, NA, 2, NA, 1, 1, NA, NA, NA…\n$ hpp5_2_6                       &lt;dbl&gt; NA, NA, NA, NA, NA, 1, 1, NA, NA, NA, N…\n$ hpp5_2_7                       &lt;dbl&gt; NA, NA, NA, 1, NA, NA, NA, NA, NA, NA, …\n$ hpp5_31                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_32                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_33                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_34                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_35                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_36                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_37                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hpp5_4                         &lt;dbl&gt; NA, NA, 1, 3, 3, 3, 3, 3, NA, 2, 3, NA,…\n$ hpp5_5                         &lt;dbl&gt; NA, NA, 3, 3, 4, 2, 3, 4, NA, 4, 3, NA,…\n$ hpp5_6                         &lt;dbl&gt; NA, NA, 1, 4, 4, 4, 4, 4, NA, 4, 4, NA,…\n$ hpp5_7                         &lt;dbl&gt; NA, NA, 1, 1, 1, 1, 4, 3, NA, 1, 1, NA,…\n$ hpp6_1                         &lt;dbl&gt; NA, NA, 4, 4, 4, 1, 4, 5, NA, 4, 4, NA,…\n$ hpp6_2                         &lt;dbl&gt; NA, NA, 997, 1, 1, 1, 1, 1, NA, 1, 997,…\n$ hpb1_1                         &lt;chr&gt; \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"AH\", \"A\"…\n$ hpb1_2                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ hpb21                          &lt;dbl&gt; 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 1, …\n$ hpb22                          &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …\n$ hpb23                          &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …\n$ hpb24                          &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …\n$ hpb25                          &lt;dbl&gt; 5, 5, 3, 4, 5, 5, 3, 5, 5, 4, 5, 5, 5, …\n$ hpb26                          &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …\n$ hgp1_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp1_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_1                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_2                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_3                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_4                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_5                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_6                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_7                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hgp2_1_8                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ h6                             &lt;chr&gt; \"H\", \"H\", \"F\", \"F\", \"F\", \"B\", \"ABDE\", \"…\n$ j1                             &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ j2_1_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_6                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_8                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_11                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_12                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_1_13                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_6                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_8                         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_10                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_11                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_2_12                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_2                         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_3                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_4                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_5                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_6                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_7                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_8                         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_9                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_10                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_11                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j2_3_12                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j3_1                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j3_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j4_1                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j4_2                           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j6_11                          &lt;dbl&gt; 7, 8, 5, 1, 1, 7, 4, 4, 4, 1, 4, 4, 4, …\n$ j6_12                          &lt;dbl&gt; 13, 13, 7, 5, 2, 13, 13, 6, 7, 5, 12, 1…\n$ j6_13                          &lt;dbl&gt; 13, 13, 13, 7, 7, 13, 13, 13, 13, 7, 13…\n$ j7_1                           &lt;chr&gt; \"A\", \"Z\", \"D\", \"D\", \"D\", \"L\", \"BI\", \"BD…\n$ j7_2                           &lt;dbl&gt; 2, 99, 2, 2, 2, 3, 2, 1, 1, 2, 2, 1, 2,…\n$ j8_1                           &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, …\n$ j9_1_1                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, …\n$ j9_1_2                         &lt;dbl&gt; 2, 2, 3, 3, 2, 1, 1, 2, 2, 2, 2, 2, 2, …\n$ j9_1_3                         &lt;dbl&gt; 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, …\n$ j9_1_4                         &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, …\n$ j10_1                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ j10_2                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ k1_1_1                         &lt;dbl&gt; 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, …\n$ k1_1_2                         &lt;dbl&gt; 1, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, …\n$ k1_1_3                         &lt;dbl&gt; 1, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, …\n$ k1_1_4                         &lt;dbl&gt; 1, 1, 2, 2, 2, 4, 2, 4, 4, 4, 4, 4, 4, …\n$ k1_1_5                         &lt;dbl&gt; 1, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, …\n$ k1_1_6                         &lt;dbl&gt; 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 3, 4, 4, …\n$ k1_1_7                         &lt;dbl&gt; 1, 1, 2, 1, 2, 2, 2, 4, 4, 2, 2, 4, 3, …\n$ k1_1_8                         &lt;dbl&gt; 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, …\n$ k1_1_9                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 4, 2, 2, 2, 4, 2, …\n$ k1_1_10                        &lt;dbl&gt; 4, 1, 4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, …\n$ k1_1_11                        &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 1, 1, …\n$ k1_1_12                        &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 4, 2, 2, 2, 4, 2, …\n$ k2_2_1                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 4, 4, 4, 4, 4, 5, 4, …\n$ k2_2_2                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 4, 4, 4, 4, 4, 5, 4, …\n$ k2_2_3                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 4, 4, 4, 4, 4, 5, 4, …\n$ k2_2_4                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 2, 4, 4, 4, 4, 5, 4, …\n$ k2_2_5                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 4, 4, 4, 4, 4, 5, 4, …\n$ k2_2_6                         &lt;dbl&gt; 2, 1, 5, 5, 5, 5, 5, 5, 4, 4, 4, 5, 4, …\n$ k2_2_7                         &lt;dbl&gt; 1, 1, 5, 5, 5, 2, 2, 4, 4, 2, 2, 5, 4, …\n$ k2_2_8                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 5, 4, 4, 4, 5, 5, 4, …\n$ k2_2_9                         &lt;dbl&gt; 1, 1, 5, 5, 5, 4, 2, 2, 2, 2, 2, 4, 2, …\n$ k2_2_10                        &lt;dbl&gt; 5, 4, 5, 5, 5, 5, 5, 4, 4, 4, 5, 5, 4, …\n$ k2_2_11                        &lt;dbl&gt; 1, 1, 5, 5, 5, 2, 1, 1, 1, 2, 5, 1, 1, …\n$ k2_2_12                        &lt;dbl&gt; 2, 1, 5, 5, 5, 2, 2, 5, 4, 2, 2, 5, 2, …\n$ k3_3_1                         &lt;dbl&gt; 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_2                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_3                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_4                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_5                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_6                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_7                         &lt;dbl&gt; 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, …\n$ k3_3_8                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_9                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ k3_3_10                        &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 2, 2, 2, …\n$ k3_3_11                        &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ kcb1_1_1                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb1_1_2                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb1_1_3                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb1_1_4                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb1_1_5                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb3_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb3_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb4_1                         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb4_2                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb5_1_1                       &lt;dbl&gt; NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_1_2                       &lt;dbl&gt; NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_1_3                       &lt;dbl&gt; NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_1_4                       &lt;dbl&gt; NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_1_5                       &lt;dbl&gt; NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_1_6                       &lt;dbl&gt; NA, NA, 2, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_2_1                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb5_2_2                       &lt;dbl&gt; NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, …\n$ kcb5_2_3                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb5_2_4                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb5_2_5                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb5_2_6                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kcb6_11                        &lt;dbl&gt; 1, 1, NA, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ kcb6_12                        &lt;dbl&gt; 16, 7, NA, 16, 16, 4, 4, 16, 16, 16, 16…\n$ kcb6_13                        &lt;dbl&gt; 2, 16, NA, 16, 16, 16, 8, 16, 16, 16, 1…\n$ kmfi1_1                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi2_11                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi2_12                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi2_13                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi3_1_1                      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi3_1_2                      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi3_1_3                      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi3_1_4                      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi3_3                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi3_4                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi4_1                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi5_1                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kmfi6_11                       &lt;dbl&gt; 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, …\n$ kmfi6_12                       &lt;dbl&gt; 11, 15, 15, 15, 15, 15, 5, 15, 15, 15, …\n$ kmfi6_13                       &lt;dbl&gt; 7, 13, 15, 15, 15, 15, 9, 15, 15, 15, 1…\n$ ks1_11                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks1_12                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks1_13                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_1                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_2                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_3                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_4                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_5                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_6                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_7                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_8                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_9                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks2_10                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks3_1                          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_1                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_2                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_3                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_4                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_5                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_6                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_7                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_8                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_9                        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_10                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_11                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_12                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks4_1_13                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ks5_1                          &lt;dbl&gt; 8, 8, 8, 8, 8, 6, 1, 1, 1, 8, 8, 2, 1, …\n$ km1_1_1                        &lt;dbl&gt; 1, 1, 2, 2, 2, 1, 1, 1, 3, 2, 2, 1, 3, …\n$ km1_1_2                        &lt;dbl&gt; 1, 2, 1, 1, 1, 1, 1, 1, 3, 2, 3, 1, 3, …\n$ km1_1_3                        &lt;dbl&gt; 1, 1, 1, 2, 3, 1, 1, 3, 3, 3, 3, 3, 3, …\n$ km1_1_4                        &lt;dbl&gt; 1, 1, 2, 2, 3, 2, 1, 2, 3, 3, 3, 3, 3, …\n$ km1_1_5                        &lt;dbl&gt; 1, 1, 3, 1, 2, 1, 1, 2, 3, 3, 3, 3, 3, …\n$ km1_1_6                        &lt;dbl&gt; 1, 1, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, …\n$ km1_1_7                        &lt;dbl&gt; 3, 1, 3, 1, 1, 1, 3, 1, 3, 1, 3, 3, 3, …\n$ km2_11                         &lt;dbl&gt; NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ km2_12                         &lt;dbl&gt; NA, 18, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ km2_13                         &lt;dbl&gt; NA, 6, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ km3_11                         &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ km3_12                         &lt;dbl&gt; NA, 17, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ km3_13                         &lt;dbl&gt; NA, 17, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ km4_1_1                        &lt;dbl&gt; 3, 1, 3, 3, 3, 3, 3, 3, 4, 3, 3, 4, 4, …\n$ km4_1_21                       &lt;dbl&gt; NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ km4_1_22                       &lt;dbl&gt; NA, 10, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ km4_1_23                       &lt;dbl&gt; NA, 10, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ km5_1                          &lt;dbl&gt; NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ km6_11                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, …\n$ km6_12                         &lt;dbl&gt; 4, 4, 2, 13, 13, 4, 6, 4, 4, 13, 13, 4,…\n$ km6_13                         &lt;dbl&gt; 8, 8, 13, 13, 13, 5, 1, 13, 13, 13, 13,…\n$ km6_21                         &lt;dbl&gt; 1, 4, 1, 1, 1, 1, 4, 1, NA, 1, 1, NA, N…\n$ km6_22                         &lt;dbl&gt; 4, 4, 2, 13, 13, 4, 1, 4, NA, 13, 13, N…\n$ km6_23                         &lt;dbl&gt; 8, 5, 13, 13, 13, 5, 6, 13, NA, 13, 13,…\n$ km7_11                         &lt;dbl&gt; NA, NA, 1, 4, 4, NA, NA, 1, NA, 4, 3, N…\n$ km7_12                         &lt;dbl&gt; NA, NA, 4, 5, 5, NA, NA, 4, NA, 5, 4, N…\n$ km7_13                         &lt;dbl&gt; NA, NA, 5, 16, 16, NA, NA, 16, NA, 7, 9…\n$ km8_1                          &lt;dbl&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ km9_1_1                        &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 1, NA, 2, 1, NA, N…\n$ km9_1_2                        &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 1, NA, 2, 1, NA, N…\n$ km9_1_3                        &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 1, NA, 2, 2, NA, N…\n$ km9_1_4                        &lt;dbl&gt; 2, 2, 2, 2, 2, 1, 2, 2, NA, 2, 2, NA, N…\n$ km9_1_5                        &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2, NA, N…\n$ km9_1_6                        &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2, NA, N…\n$ km9_1_7                        &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2, NA, N…\n$ km9_1_8                        &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2, NA, N…\n$ km9_1_9                        &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2, NA, N…\n$ km9_2_1                        &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 2, 2, NA, NA, 1, N…\n$ km9_2_2                        &lt;dbl&gt; 2, 2, NA, NA, NA, 1, 1, 2, NA, NA, 2, N…\n$ km9_2_3                        &lt;dbl&gt; 1, 1, NA, NA, NA, 2, 2, 1, NA, NA, 2, N…\n$ km9_2_4                        &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 2, 2, NA, NA, 2, N…\n$ km9_2_5                        &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 1, 2, NA, NA, 1, N…\n$ km9_2_6                        &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 2, 2, NA, NA, 2, N…\n$ km9_2_7                        &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 2, 2, NA, NA, 2, N…\n$ km9_2_8                        &lt;dbl&gt; 2, 2, NA, NA, NA, 2, 2, 2, NA, NA, 2, N…\n$ km9_3                          &lt;dbl&gt; NA, NA, NA, NA, NA, 1, 1, NA, NA, NA, 1…\n$ km10_1                         &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 3, 2, 2, 2, 2, 2, 2, …\n$ km10_2                         &lt;dbl&gt; NA, NA, NA, 4, NA, NA, NA, NA, NA, NA, …\n$ km10_3                         &lt;dbl&gt; NA, NA, NA, 5, NA, NA, NA, NA, NA, NA, …\n$ km11_11                        &lt;dbl&gt; 2, 3, 2, NA, 2, 2, NA, 2, 1, 2, 5, 1, 1…\n$ km11_12                        &lt;dbl&gt; 3, 2, 7, NA, 5, 7, NA, 6, 7, 4, 7, 7, 7…\n$ km11_13                        &lt;dbl&gt; 7, 7, 2, NA, 6, 7, NA, 7, 7, 7, 7, 7, 7…\n$ kml1_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ kml2_1                         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ m1_1_1                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, …\n$ m1_1_2                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, …\n$ m1_1_3                         &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ m1_1_4                         &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, 1, 1, …\n$ m1_1_5                         &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, …\n$ m1_1_6                         &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 1, 1, …\n$ m1_1_7                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, …\n$ m1_1_8                         &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, …\n$ m1_1_9                         &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, …\n$ m2_1                           &lt;chr&gt; \"AB\", \"AB\", NA, NA, NA, NA, NA, \"ABD\", …\n$ m3_1                           &lt;dbl&gt; 1, 1, NA, NA, NA, NA, 2, 1, 1, NA, NA, …\n$ m4_11                          &lt;dbl&gt; 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 3, 3, 1, …\n$ m4_12                          &lt;dbl&gt; 2, 3, 2, 3, 2, 1, 1, 8, 7, 2, 6, 1, 8, …\n$ m4_13                          &lt;dbl&gt; 8, 5, 8, 8, 8, 8, 7, 8, 8, 8, 8, 5, 8, …\n$ m5_11                          &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 2, 1, 3, 1, 2, 1, 1, …\n$ m5_12                          &lt;dbl&gt; 2, 2, 2, 2, 6, 7, 4, 2, 5, 2, 6, 7, 2, …\n$ m5_13                          &lt;dbl&gt; 9, 9, 9, 9, 9, 6, 5, 9, 9, 9, 9, 2, 9, …\n$ m6_1                           &lt;dbl&gt; 2, 2, 1, 1, 1, 2, 1, 2, 2, 1, 1, 2, 2, …\n$ m7_1_1                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_2                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_3                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_4                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_5                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_6                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_7                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_1_8                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 1, NA, NA, 2, 2, N…\n$ m7_1_9                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 1, NA, NA, 2, 2, N…\n$ m7_1_10                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_1                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_2                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_3                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_4                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_5                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_6                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_7                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_8                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_9                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m7_2_10                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_1                           &lt;chr&gt; NA, NA, \"AC\", \"C\", \"C\", NA, \"A\", NA, NA…\n$ m8_2_1                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 1, N…\n$ m8_2_2                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_3                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_4                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_5                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_6                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_7                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_8                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_9                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_10                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_11                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_12                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_13                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_14                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m8_2_15                        &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_1_1                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_1_2                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_1_3                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_1_4                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_2_1                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_2_2                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_2_3                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m9_2_4                         &lt;dbl&gt; NA, NA, 2, 2, 2, NA, 2, NA, NA, 2, 2, N…\n$ m10_1                          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ m11_1                          &lt;chr&gt; NA, NA, \"A\", \"A\", \"A\", NA, \"AE\", NA, NA…\n$ n1_1                           &lt;dbl&gt; 1, 2, 2, 1, 2, 1, 3, 2, 1, 2, 2, 2, 1, …\n$ n3_1                           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 2, 2, …\n$ n4_1                           &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, …\n$ n5_1                           &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, …\n$ n6_1                           &lt;dbl&gt; 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ n7_1                           &lt;dbl&gt; 1, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, …\n$ n8_1                           &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, …\n$ n9_1                           &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 1, …\n$ n10_1                          &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, …\n$ ab1                            &lt;dbl&gt; 28072023, 28072023, 28072023, 28072023,…\n$ ab2                            &lt;dbl&gt; 1552, 1446, 1259, 1400, 1502, 1624, 141…\n$ ab3                            &lt;dbl&gt; 1842, 1530, 1338, 1501, 1522, 1705, 150…\n$ ab5                            &lt;dbl&gt; 28, 28, 30, 30, 30, 34, 34, 32, 32, 30,…\n$ ab7                            &lt;dbl&gt; 26, 26, 26, 26, 26, 31, 31, 31, 31, 26,…\n$ ab8                            &lt;dbl&gt; 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ consent                        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ s1aq1a                         &lt;dbl&gt; 314, 314, 314, 314, 314, 324, 324, 324,…\n$ s1aq1b                         &lt;chr&gt; \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\", \"ABIM\",…\n$ s1aq2a                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ s1aq2b                         &lt;chr&gt; \"LABWOR\", \"LABWOR\", \"LABWOR\", \"LABWOR\",…\n$ s1aq3a                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 9, 3, 3, …\n$ s1aq3b                         &lt;chr&gt; \"ABIM TOWN COUNCIL\", \"ABIM TOWN COUNCIL…\n$ s1aq4a                         &lt;dbl&gt; 1, 1, 1, 1, 1, 3, 3, 3, 3, 4, 4, 3, 3, …\n$ s1aq4b                         &lt;chr&gt; \"KALAKALA\", \"KALAKALA\", \"KALAKALA\", \"KA…\n$ s1aq5a                         &lt;dbl&gt; 4, 4, 4, 4, 4, 1, 1, 1, 1, 11, 6, 2, 2,…\n$ s1aq5b                         &lt;chr&gt; \"AYWEE MODERN\", \"AYWEE MODERN\", \"AYWEE …\n$ age_group                      &lt;fct&gt; Middle-aged Adults, Teenagers, Middle-a…\n$ Intercept                      &lt;named list&gt; 0.8593362, 0.8593144, 0.8595688,…\n$ age_groupYoung.Adults          &lt;named list&gt; 0.772422, 0.7724121, 0.7721147, …\n$ age_groupAdults                &lt;named list&gt; 0.4561738, 0.4561611, 0.455789, …\n$ age_groupMiddle.aged.Adults    &lt;named list&gt; 0.4082956, 0.4082835, 0.4080476,…\n$ age_groupSeniors               &lt;named list&gt; 0.6792598, 0.6792655, 0.6788943,…\n$ age_groupElderly               &lt;named list&gt; -2.284245, -2.283928, -2.282713,…\n$ c7_1_12                        &lt;named list&gt; -1.505381, -1.505375, -1.505469,…\n$ c6_1_22                        &lt;named list&gt; -0.1100303, -0.110007, -0.110088…\n$ c32                            &lt;named list&gt; 0.136543, 0.1365031, 0.1366843, …\n$ c33                            &lt;named list&gt; 0.158827, 0.1587919, 0.1586387, …\n$ c34                            &lt;named list&gt; -0.6755898, -0.6755757, -0.67565…\n$ c35                            &lt;named list&gt; -0.318335, -0.3183284, -0.318001…\n$ c36                            &lt;named list&gt; -0.4002689, -0.400275, -0.40043,…\n$ y                              &lt;named list&gt; 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1,…\n$ yhat                           &lt;named list&gt; 0.6182228, 0.2599294, 0.4138818,…\n$ residual                       &lt;named list&gt; -0.6182228, -0.2599294, 0.586118…\n$ Intercept_SE                   &lt;named list&gt; 0.4304049, 0.4303957, 0.4303311,…\n$ age_groupYoung.Adults_SE       &lt;named list&gt; 0.378836, 0.3788274, 0.3787642, …\n$ age_groupAdults_SE             &lt;named list&gt; 0.4196215, 0.4196126, 0.4195431,…\n$ age_groupMiddle.aged.Adults_SE &lt;named list&gt; 0.4164668, 0.4164586, 0.4163923,…\n$ age_groupSeniors_SE            &lt;named list&gt; 0.490331, 0.4903197, 0.4902454, …\n$ age_groupElderly_SE            &lt;named list&gt; 1.091284, 1.091249, 1.09105, 1.0…\n$ c7_1_12_SE                     &lt;named list&gt; 0.2243186, 0.224315, 0.2242873, …\n$ c6_1_22_SE                     &lt;named list&gt; 0.1679192, 0.1679162, 0.1678957,…\n$ c32_SE                         &lt;named list&gt; 0.330521, 0.330517, 0.330478, 0.…\n$ c33_SE                         &lt;named list&gt; 0.2944943, 0.2944895, 0.2944649,…\n$ c34_SE                         &lt;named list&gt; 0.3040755, 0.3040701, 0.3040348,…\n$ c35_SE                         &lt;named list&gt; 0.3061114, 0.3061035, 0.3060453,…\n$ c36_SE                         &lt;named list&gt; 0.2285432, 0.22854, 0.2285191, 0…\n$ Intercept_TV                   &lt;named list&gt; 1.996576, 1.996568, 1.997459, 1.…\n$ age_groupYoung.Adults_TV       &lt;named list&gt; 2.038935, 2.038955, 2.03851, 2.0…\n$ age_groupAdults_TV             &lt;named list&gt; 1.087108, 1.087101, 1.086394, 1.…\n$ age_groupMiddle.aged.Adults_TV &lt;named list&gt; 0.9803796, 0.9803699, 0.9799595,…\n$ age_groupSeniors_TV            &lt;named list&gt; 1.385309, 1.385352, 1.384805, 1.…\n$ age_groupElderly_TV            &lt;named list&gt; -2.093172, -2.092949, -2.092217,…\n$ c7_1_12_TV                     &lt;named list&gt; -6.710907, -6.710986, -6.712233,…\n$ c6_1_22_TV                     &lt;named list&gt; -0.6552576, -0.6551304, -0.65569…\n$ c32_TV                         &lt;named list&gt; 0.4131145, 0.4129987, 0.4135958,…\n$ c33_TV                         &lt;named list&gt; 0.5393212, 0.5392106, 0.5387356,…\n$ c34_TV                         &lt;named list&gt; -2.221783, -2.221776, -2.222306,…\n$ c35_TV                         &lt;named list&gt; -1.039932, -1.039937, -1.039066,…\n$ c36_TV                         &lt;named list&gt; -1.751393, -1.751444, -1.752282,…\n$ geometry.1                     &lt;named list&gt; &lt;POINT (572776.5 295349.3)&gt;, &lt;PO…\n$ geometry                       &lt;POINT [m]&gt; POINT (572776.5 295349.3), POINT …\n\n\n\nsummary(gwlr$SDF$yhat)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n0.03193 0.68389 0.75654 0.69744 0.77673 0.86108 \n\n\nCalculate local pseudo R² for each observation.\n\n# Step 1: Calculate the null deviance from a null model (intercept-only model)\nnull_model &lt;- glm(h2_2_8 ~ 1, data = finscope_mobile_money, family = \"binomial\")\nnull_deviance &lt;- deviance(null_model)\n\n# Step 2: Extract local fitted values and residuals, converting to numeric if necessary\nlocal_fitted_values &lt;- as.numeric(mobilemoney.sf.adaptive$yhat)\nlocal_residuals &lt;- as.numeric(mobilemoney.sf.adaptive$residual)\n\n# Step 3: Calculate Local Pseudo R² for each observation\nmobilemoney.sf.adaptive$local_pseudo_r2 &lt;- 1 - (local_residuals^2 / null_deviance)\n\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(uganda_modified)+ \n  tm_polygons(alpha = 0.1) +\ntm_shape(mobilemoney.sf.adaptive) +  \n  tm_dots(col = \"local_pseudo_r2\", \n          border.col = \"gray60\",\n          border.lwd = 1)\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIn logistic regression (and similarly in geographically weighted logistic regression), a pseudo R² is an approximation of the proportion of variance in the dependent variable (in this case, mobile money/e-money wallet usage) explained by the model.\nHigher Pseudo R² Values indicate areas where the model fits well.\nLower Pseudo R² Values (Lighter Colors)indicate areas where the model explains less of the variability in mobile money usage"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#exploratory-data-analysis-eda",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#exploratory-data-analysis-eda",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "5 Exploratory Data Analysis (EDA)",
    "text": "5 Exploratory Data Analysis (EDA)\nCategorize Age, one of the independent variables\n\nfinscope.sf &lt;- finscope.sf %&gt;%\n  mutate(age_group = cut(\n    age,\n    breaks = c(15, 19, 29, 39, 59, 79, 100),  # Start with 15 to include age 16\n    labels = c(\"Teenagers\", \"Young Adults\", \"Adults\", \"Middle-aged Adults\", \"Seniors\", \"Elderly\"),\n    right = TRUE,  # Includes the right boundary in each interval\n    include.lowest = TRUE  # Ensures the lowest value (16) is included\n  ))\n\nPlot the distribution of dependent variables and independent variables\n\nlibrary(ggpubr)\n\n\nAttaching package: 'ggpubr'\n\n\nThe following object is masked from 'package:egg':\n\n    ggarrange\n\n\nThe following objects are masked from 'package:spatstat.geom':\n\n    border, rotate\n\n\nThe following object is masked from 'package:raster':\n\n    rotate\n\nplot_categorical &lt;- function(data, column, title) {\n  ggplot(data, aes(x = !!sym(column))) +\n    geom_bar(fill = \"skyblue\") +\n    labs(title = title, x = column, y = \"Count\") +\n    theme_minimal()\n}\n\nplot_payment_wallets &lt;- plot_categorical(finscope.sf, \"h2_2_8\", \"Mobile Money / E-money Wallets Usage\")\nplot_insurance &lt;- plot_categorical(finscope.sf, \"j1\", \"Existing Insurance Policy\")\nplot_payment_bank &lt;- plot_categorical(finscope.sf, \"h2_2_5\", \"Mobile / Internet Banking Usage\")\n\nplot_education &lt;- plot_categorical(finscope.sf, \"c4\", \"Education Level\")\nplot_mobile &lt;- plot_categorical(finscope.sf, \"c7_1_1\", \"Own a Mobile Phone?\")\nplot_internet &lt;- plot_categorical(finscope.sf, \"c6_1_2\", \"Internet Access\")\nplot_sex &lt;- plot_categorical(finscope.sf, \"c2\", \"Sex\")\nplot_marital &lt;- plot_categorical(finscope.sf, \"c3\", \"Marital Status\")\nplot_age &lt;- plot_categorical(finscope.sf, \"age_group\", \"Age_group\")\n\nDependent variables\n\n# Arrange and display dependent variable plots\ndependent_plots &lt;- ggarrange(\n  plot_payment_wallets, plot_insurance, plot_payment_bank,\n  ncol = 1, nrow = 3)\n\nWarning: Removed 2006 rows containing non-finite outside the scale range\n(`stat_count()`).\n\n\nWarning: Removed 2390 rows containing non-finite outside the scale range\n(`stat_count()`).\n\ndependent_plots  # Display the dependent variable plots\n\n\n\n\n\n\n\n\nIndependent variable\n\n# Arrange and display independent variable plots\nindependent_plots &lt;- ggarrange(\n  plot_education, plot_mobile, plot_internet, plot_age, plot_sex, plot_marital,\n  ncol = 2, nrow = 3)\nindependent_plots"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#geographically-weighted-logistic-regression",
    "href": "Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html#geographically-weighted-logistic-regression",
    "title": "Take-home Exercise 3a: Modelling Geography of Financial Inclusion with Geographically Weighted Methods",
    "section": "6 Geographically Weighted Logistic Regression",
    "text": "6 Geographically Weighted Logistic Regression\n\nDependent variable: Mobile Money / E-money Wallets Usage\nRemove empty values in h2_2_8 field which represents the Mobile Money / E-money Wallets Usage\n\nfinscope_mobile_money &lt;- finscope.sf %&gt;%\n  filter(!is.na(h2_2_8) & h2_2_8 != \"\")\n\nRecode Mobile Money / E-money Wallets Usage to 1 and 0\n\nfinscope_mobile_money$h2_2_8 &lt;- ifelse(finscope_mobile_money$h2_2_8 == 1, 1, 0)\n\nIndependent variable = Education level, Own a mobile phone?, internet access, age_group, sex, and marital status\nConvert Categorical Variables to Factors\n\n# Convert categorical variables to factors if they are not already\nfinscope_mobile_money$c2 &lt;- as.factor(finscope_mobile_money$age_group)     \nfinscope_mobile_money$c2 &lt;- as.factor(finscope_mobile_money$c2)           # sex\nfinscope_mobile_money$c3 &lt;- as.factor(finscope_mobile_money$c3)           # marital status\nfinscope_mobile_money$c4 &lt;- as.factor(finscope_mobile_money$c4)           # education level\nfinscope_mobile_money$c7_1_1 &lt;- as.factor(finscope_mobile_money$c7_1_1)   # own a mobile phone?\nfinscope_mobile_money$c6_1_2 &lt;- as.factor(finscope_mobile_money$c6_1_2)   # internet access\n\n\n# Fit the logistic regression model\nmodel &lt;- glm(h2_2_8 ~ age_group + c2 + c3 + c4 + c6_1_2 + c7_1_1, \n             family = \"binomial\", data = finscope_mobile_money)\n\nExplanation of the Model\n\nsummary(model)\n\n\nCall:\nglm(formula = h2_2_8 ~ age_group + c2 + c3 + c4 + c6_1_2 + c7_1_1, \n    family = \"binomial\", data = finscope_mobile_money)\n\nCoefficients: (5 not defined because of singularities)\n                            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  0.70671    0.47167   1.498  0.13405    \nage_groupYoung Adults        0.59418    0.32982   1.802  0.07162 .  \nage_groupAdults              0.30616    0.35970   0.851  0.39468    \nage_groupMiddle-aged Adults  0.32740    0.36262   0.903  0.36658    \nage_groupSeniors             0.49995    0.42896   1.165  0.24382    \nage_groupElderly            -1.41744    1.21673  -1.165  0.24404    \nc2Young Adults                    NA         NA      NA       NA    \nc2Adults                          NA         NA      NA       NA    \nc2Middle-aged Adults              NA         NA      NA       NA    \nc2Seniors                         NA         NA      NA       NA    \nc2Elderly                         NA         NA      NA       NA    \nc32                          0.14857    0.30115   0.493  0.62176    \nc33                          0.01579    0.27784   0.057  0.95468    \nc34                         -0.68966    0.26094  -2.643  0.00822 ** \nc35                         -0.25247    0.26719  -0.945  0.34472    \nc36                         -0.42886    0.20721  -2.070  0.03848 *  \nc42                          0.42786    0.26204   1.633  0.10251    \nc43                         -0.02067    0.29161  -0.071  0.94350    \nc44                          0.32934    0.28514   1.155  0.24810    \nc45                         -0.05549    0.36680  -0.151  0.87975    \nc46                         -0.06816    0.37986  -0.179  0.85760    \nc47                          0.09678    0.39189   0.247  0.80495    \nc48                         -0.01431    0.39092  -0.037  0.97080    \nc49                         -0.12182    1.53837  -0.079  0.93689    \nc6_1_22                     -0.10363    0.18951  -0.547  0.58450    \nc7_1_12                     -1.47896    0.20193  -7.324 2.41e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1362.3  on 1093  degrees of freedom\nResidual deviance: 1255.1  on 1073  degrees of freedom\nAIC: 1297.1\n\nNumber of Fisher Scoring iterations: 4\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe intercept represents the log-odds of the outcome (using mobile money/e-money wallets) when all predictors are at their reference levels.\nage_group The reference level for age_group is likely Teenagers (since it’s not listed), and the other age groups are compared to this reference level.\nage_group Young Adults (Estimate = 0.60199, p ≈ 0.068): Young adults have higher log-odds (0.60199) of using mobile money/e-money wallets compared to teenagers. Odds Ratio: exp(0.60199) ≈ 1.825, suggesting that young adults have approximately 1.83 times higher odds of using mobile money/e-money wallets than teenagers.\nage_group Adults, age_group Middle-aged Adults, age_group Seniors: None of these age groups have statistically significant coefficients (p &gt; 0.05), meaning there’s no strong evidence of a difference in usage between these age groups and teenagers.\nage_group Elderly (Estimate = -1.33603, p = 0.273): Elderly individuals have lower log-odds of using mobile money/e-money wallets compared to teenagers, but this result is not statistically significant.\nSex (c2) c22 Male vs. Female: The coefficient for males (0.11156) is not statistically significant (p = 0.454), suggesting that there is no strong evidence of a difference in usage between males and females.\nMarital Status c32, c33: None of the levels of marital status are statistically significant, indicating no clear association between marital status and the likelihood of using mobile money/e-money wallets.\nEducation Level Reference Group: The baseline group is “Never went to school”. All other education levels are compared to this group. Some primary completed (not P7):\nSlightly higher odds of using mobile money/e-money wallets compared to those who never went to school. Odds Ratio: 1.55 (about 55% higher odds), but the result is only marginally significant. Completed P7, Some secondary completed (not S6), Completed S6, Specialized training/certificate, Specialized training or diploma, and Completed degree and above:\nNo significant difference in mobile money/e-money wallet usage compared to those who never went to school. “Don’t know” (education level not specified):\nAlso shows no significant difference in usage compared to those who never went to school.\nInternet Access\nc6_1_22 (Internet Access = Yes): The coefficient is -0.11348 and is not statistically significant (p = 0.550), indicating no strong evidence that internet access influences the likelihood of using mobile money/e-money wallets in this dataset.\nOwn a mobile phone c7_1_12 (Own a Mobile Phone = Yes, Estimate = -1.49183, p &lt; 0.001): This coefficient is statistically significant and negative, suggesting that individuals who do not own a mobile phone have much lower odds of using mobile money/e-money wallets compared to those who do own a mobile phone. Odds Ratio: exp(-1.49183) ≈ 0.225, meaning that not owning a mobile phone is associated with approximately 0.23 times the odds (or a 77% reduction in odds) of using mobile money/e-money wallets, compared to those who own a mobile phone.\n\n\n\nData Preparation for GWLR Model\nConvert finscope.sf to spatial data\n\nfinscope.sp &lt;- as_Spatial(finscope_mobile_money)\n\nCalculating distance matrix to fit the GWLR model\n\ndistMAT &lt;- gw.dist(dp.locat = coordinates(finscope.sp))\n\n\ndim(distMAT)\n\n[1] 1094 1094\n\n\nComputing Adaptive Bandwidth with dependent variable = Mobile Money / E-money Wallets Usage Independent variable = Sex\n\nbw.adaptive &lt;- bw.ggwr(formula = h2_2_8 ~ c2, \n                       family = \"binomial\", \n                       data = finscope_mobile_money, \n                       approach = \"CV\", \n                       kernel = \"gaussian\", \n                       adaptive = TRUE, \n                       longlat = FALSE, \n                       p = 2, \n                       theta = 0, \n                       dMat = distMAT)\n\n Iteration    Log-Likelihood:(With bandwidth:  683 )\n=========================\n       0       -673.4 \n       1       -674.5 \n       2       -674.9 \n       3       -674.9 \nAdaptive bandwidth: 683 CV score: 232.7282 \n Iteration    Log-Likelihood:(With bandwidth:  430 )\n=========================\n       0         -672 \n       1       -673.4 \n       2         -675 \n       3       -680.4 \n       4       -698.1 \n       5       -713.4 \n       6       -716.8 \n       7       -714.1 \n       8       -712.5 \n       9       -713.8 \n      10       -714.6 \n      11       -713.9 \n      12       -713.6 \n      13       -713.9 \n      14       -714.1 \n      15       -713.9 \n      16       -713.8 \n      17       -713.9 \n      18       -713.9 \n      19       -713.9 \nAdaptive bandwidth: 430 CV score: 232.9232 \n Iteration    Log-Likelihood:(With bandwidth:  840 )\n=========================\n       0       -673.8 \n       1       -674.8 \n       2       -675.1 \n       3       -675.1 \n       4         -675 \n       5         -675 \nAdaptive bandwidth: 840 CV score: 232.7489 \n Iteration    Log-Likelihood:(With bandwidth:  586 )\n=========================\n       0         -673 \n       1       -674.1 \n       2       -674.7 \n       3       -674.8 \n       4       -674.9 \n       5         -675 \n       6       -675.1 \n       7       -675.1 \n       8       -675.2 \n       9       -675.2 \n      10       -675.3 \n      11       -675.4 \n      12       -675.4 \n      13       -675.5 \n      14       -675.6 \n      15       -675.6 \n      16       -675.7 \n      17       -675.8 \n      18         -676 \n      19       -676.2 \nAdaptive bandwidth: 586 CV score: 232.8694 \n Iteration    Log-Likelihood:(With bandwidth:  743 )\n=========================\n       0       -673.6 \n       1       -674.6 \n       2       -675.1 \n       3         -675 \n       4       -674.9 \n       5       -674.9 \n       6       -674.9 \nAdaptive bandwidth: 743 CV score: 232.7295 \n Iteration    Log-Likelihood:(With bandwidth:  646 )\n=========================\n       0       -673.3 \n       1       -674.4 \n       2       -674.8 \n       3       -674.9 \n       4       -674.8 \n       5       -674.8 \n       6       -674.8 \nAdaptive bandwidth: 646 CV score: 232.6792 \n Iteration    Log-Likelihood:(With bandwidth:  623 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 623 CV score: 232.6544 \n Iteration    Log-Likelihood:(With bandwidth:  609 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.8 \n       3       -674.9 \n       4       -674.9 \nAdaptive bandwidth: 609 CV score: 232.7141 \n Iteration    Log-Likelihood:(With bandwidth:  632 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.8 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 632 CV score: 232.6517 \n Iteration    Log-Likelihood:(With bandwidth:  637 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.8 \n       3       -674.8 \n       4       -674.8 \n       5       -674.8 \n       6       -674.8 \n       7       -674.8 \nAdaptive bandwidth: 637 CV score: 232.6621 \n Iteration    Log-Likelihood:(With bandwidth:  628 )\n=========================\n       0       -673.2 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 628 CV score: 232.6507 \n Iteration    Log-Likelihood:(With bandwidth:  626 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.7 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 626 CV score: 232.6485 \n Iteration    Log-Likelihood:(With bandwidth:  624 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.8 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 624 CV score: 232.6507 \n Iteration    Log-Likelihood:(With bandwidth:  626 )\n=========================\n       0       -673.1 \n       1       -674.3 \n       2       -674.7 \n       3       -674.8 \n       4       -674.7 \n       5       -674.7 \n       6       -674.7 \n       7       -674.7 \nAdaptive bandwidth: 626 CV score: 232.6485 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe resulting adaptive bandwdith value is 626, represent the number of nearest neighbours.\n\n\n\n\nFitting GWLR model\nSet bw parameter to 626. The family parameter is set to “binomial” due to the binary nature of the Mobile Money/E-money wallets usage variable.\n\ngwlr &lt;- ggwr.basic(h2_2_8 ~ age_group + c7_1_1 + c6_1_2 + c3,\n                   data = finscope_mobile_money, \n                   bw = 626, \n                   family = \"binomial\", \n                   kernel = \"gaussian\", \n                   adaptive = TRUE, \n                   cv = T, \n                   tol = 1e-05, \n                   maxiter = 20, \n                   p = 2, \n                   theta = 0, \n                   longlat = FALSE, \n                   dMat = distMAT)\n\n Iteration    Log-Likelihood\n=========================\n       0       -624.5 \n       1       -622.3 \n       2       -621.9 \n       3       -621.9 \n       4       -621.9 \n\n\n\ngwlr\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-11-10 11:36:42.458682 \n   Call:\n   ggwr.basic(formula = h2_2_8 ~ age_group + c7_1_1 + c6_1_2 + c3, \n    data = finscope_mobile_money, bw = 626, family = \"binomial\", \n    kernel = \"gaussian\", adaptive = TRUE, cv = T, tol = 1e-05, \n    maxiter = 20, p = 2, theta = 0, longlat = FALSE, dMat = distMAT)\n\n   Dependent (y) variable:  h2_2_8\n   Independent variables:  age_group c7_1_1 c6_1_2 c3\n   Number of data points: 1094\n   Used family: binomial\n   ***********************************************************************\n   *              Results of Generalized linear Regression               *\n   ***********************************************************************\n\nCall:\nNULL\n\nCoefficients:\n                              Estimate Std. Error z value Pr(&gt;|z|)    \nIntercept                    8.182e-01  3.701e-01   2.211  0.02705 *  \nage_groupYoung Adults        5.921e-01  3.281e-01   1.805  0.07109 .  \nage_groupAdults              2.992e-01  3.571e-01   0.838  0.40204    \nage_groupMiddle-aged Adults  3.056e-01  3.594e-01   0.850  0.39511    \nage_groupSeniors             4.907e-01  4.212e-01   1.165  0.24403    \nage_groupElderly            -1.458e+00  1.200e+00  -1.215  0.22434    \nc7_1_12                     -1.480e+00  1.914e-01  -7.731 1.07e-14 ***\nc6_1_22                     -7.248e-05  1.563e-01   0.000  0.99963    \nc32                          1.960e-01  2.962e-01   0.662  0.50820    \nc33                          2.073e-02  2.752e-01   0.075  0.93995    \nc34                         -7.006e-01  2.592e-01  -2.703  0.00687 ** \nc35                         -2.501e-01  2.614e-01  -0.957  0.33866    \nc36                         -4.147e-01  2.062e-01  -2.011  0.04436 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1362.3  on 1093  degrees of freedom\nResidual deviance: 1263.2  on 1081  degrees of freedom\nAIC: 1289.2\n\nNumber of Fisher Scoring iterations: 4\n\n\n AICc:  1289.525\n Pseudo R-square value:  0.07273189\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 626 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: A distance matrix is specified for this model calibration.\n\n   ************Summary of Generalized GWR coefficient estimates:**********\n                                    Min.   1st Qu.    Median   3rd Qu.    Max.\n   Intercept                    0.737191  0.784762  0.815918  0.929452  1.0312\n   age_groupYoung Adults        0.424141  0.538825  0.669435  0.751911  0.8550\n   age_groupAdults              0.185400  0.243294  0.346853  0.430027  0.5659\n   age_groupMiddle-aged Adults  0.225340  0.269932  0.356858  0.404514  0.4832\n   age_groupSeniors             0.338275  0.443224  0.607646  0.710800  0.8379\n   age_groupElderly            -2.718340 -2.125125 -1.701922 -1.319734 -1.0628\n   c7_1_12                     -1.525668 -1.510242 -1.459310 -1.361642 -1.3402\n   c6_1_22                     -0.173193 -0.129051 -0.040104 -0.016925  0.0593\n   c32                          0.033796  0.152809  0.226779  0.280353  0.3761\n   c33                         -0.091835 -0.024837  0.051218  0.129453  0.2149\n   c34                         -0.750512 -0.722375 -0.688880 -0.625325 -0.5748\n   c35                         -0.430247 -0.365775 -0.293357 -0.200435 -0.1231\n   c36                         -0.437908 -0.404562 -0.375320 -0.338154 -0.3130\n   ************************Diagnostic information*************************\n   Number of data points: 1094 \n   GW Deviance: 1243.724 \n   AIC : 1283.614 \n   AICc : 1284.393 \n   Pseudo R-square value:  0.08702015 \n\n   ***********************************************************************\n   Program stops at: 2024-11-10 11:36:58.791639 \n\n\n\n\n\n\n\n\nNote\n\n\n\nPseudo R-square (0.087): This value is relatively low, suggesting that the model explains around 8.7% of the variation in Mobile Money / E-money Wallets Usage\nThe decrease in AIC from the global model’s AIC(1289.2) suggests that the GWLR model provides a slightly better fit due to spatial variation.\nc7_1_1 (Owns a Mobile Phone - Yes): Strongly significant and negative (-1.480, p &lt; 0.001). Not owning a mobile phone is associated with much lower odds of using mobile money/e-money wallets.\nc6_1_2 (Internet Access): Not significant (p = 0.99963), indicating no strong association between internet access and mobile money/e-money usage.\nEducation Level (c3): Only some levels of c3 (e.g., c34) are significant, indicating that education level might affect usage, though the impact varies across levels.\n\n\n\n\nVisualize GWR Output\nconverting SDF into sf data.frame\n\nmobilemoney.sf.adaptive &lt;- st_as_sf(gwlr$SDF) %&gt;% \n  st_transform(crs=32636)\n\n\nmobilemoney.sf.adaptive.UTM36N &lt;- st_transform(mobilemoney.sf.adaptive, 32636)\nmobilemoney.sf.adaptive.UTM36N  \n\nSimple feature collection with 1094 features and 42 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 128007.7 ymin: -156374.4 xmax: 717586.7 ymax: 407771.6\nProjected CRS: WGS 84 / UTM zone 36N\nFirst 10 features:\n   Intercept age_groupYoung Adults age_groupAdults age_groupMiddle-aged Adults\n1  0.8593362             0.7724220       0.4561738                   0.4082956\n2  0.8593144             0.7724121       0.4561611                   0.4082835\n3  0.8595688             0.7721147       0.4557890                   0.4080476\n4  0.8594936             0.7721628       0.4558490                   0.4080811\n5  0.8594918             0.7721703       0.4558585                   0.4080877\n6  0.7691724             0.8110754       0.5081904                   0.4392421\n7  0.7689157             0.8110997       0.5082326                   0.4392761\n8  0.7687264             0.8112805       0.5084495                   0.4394226\n9  0.7687198             0.8112900       0.5084607                   0.4394301\n10 0.8473324             0.7797525       0.4657468                   0.4139539\n   age_groupSeniors age_groupElderly   c7_1_12     c6_1_22        c32       c33\n1         0.6792598        -2.284245 -1.505381 -0.11003031 0.13654299 0.1588270\n2         0.6792655        -2.283928 -1.505375 -0.11000703 0.13650309 0.1587919\n3         0.6788943        -2.282713 -1.505469 -0.11008850 0.13668429 0.1586387\n4         0.6789745        -2.282602 -1.505443 -0.11004624 0.13660371 0.1586300\n5         0.6789811        -2.282675 -1.505442 -0.11004814 0.13660608 0.1586384\n6         0.7711003        -2.025091 -1.452758 -0.05286960 0.05015751 0.1269358\n7         0.7713060        -2.023665 -1.452533 -0.05267099 0.04994245 0.1267483\n8         0.7716127        -2.024129 -1.452389 -0.05260694 0.04977988 0.1268006\n9         0.7716264        -2.024175 -1.452384 -0.05260637 0.04977423 0.1268062\n10        0.6924125        -2.270193 -1.499822 -0.10316383 0.12521130 0.1572915\n          c34        c35        c36 y      yhat   residual Intercept_SE\n1  -0.6755898 -0.3183350 -0.4002689 0 0.6182228 -0.6182228    0.4304049\n2  -0.6755757 -0.3183284 -0.4002750 0 0.2599294 -0.2599294    0.4303957\n3  -0.6756584 -0.3180012 -0.4004300 1 0.4138818  0.5861182    0.4303311\n4  -0.6756262 -0.3180590 -0.4004060 1 0.8207755  0.1792245    0.4303336\n5  -0.6756267 -0.3180667 -0.4004019 1 0.7542135  0.2457865    0.4303364\n6  -0.6237080 -0.3782436 -0.3647071 1 0.7904302  0.2095698    0.4334619\n7  -0.6235258 -0.3783653 -0.3646104 1 0.7728505  0.2271495    0.4334647\n8  -0.6233863 -0.3785570 -0.3644821 1 0.7814863  0.2185137    0.4335252\n9  -0.6233814 -0.3785657 -0.3644765 0 0.5311579 -0.5311579    0.4335285\n10 -0.6699862 -0.3282295 -0.3951662 0 0.7013919 -0.7013919    0.4308865\n   age_groupYoung Adults_SE age_groupAdults_SE age_groupMiddle-aged Adults_SE\n1                 0.3788360          0.4196215                      0.4164668\n2                 0.3788274          0.4196126                      0.4164586\n3                 0.3787642          0.4195431                      0.4163923\n4                 0.3787672          0.4195471                      0.4163963\n5                 0.3787698          0.4195498                      0.4163989\n6                 0.3820993          0.4240743                      0.4196673\n7                 0.3820998          0.4240774                      0.4196646\n8                 0.3821580          0.4241422                      0.4197244\n9                 0.3821612          0.4241457                      0.4197277\n10                0.3793988          0.4203257                      0.4170616\n   age_groupSeniors_SE age_groupElderly_SE c7_1_12_SE c6_1_22_SE    c32_SE\n1            0.4903310            1.091284  0.2243186  0.1679192 0.3305210\n2            0.4903197            1.091249  0.2243150  0.1679162 0.3305170\n3            0.4902454            1.091050  0.2242873  0.1678957 0.3304780\n4            0.4902474            1.091051  0.2242888  0.1678965 0.3304814\n5            0.4902507            1.091060  0.2242899  0.1678974 0.3304828\n6            0.4914859            1.104315  0.2268172  0.1694223 0.3326122\n7            0.4914766            1.104437  0.2268236  0.1694268 0.3326073\n8            0.4915418            1.104557  0.2268517  0.1694478 0.3326369\n9            0.4915455            1.104562  0.2268531  0.1694488 0.3326386\n10           0.4907023            1.092046  0.2246072  0.1680821 0.3309112\n      c33_SE    c34_SE    c35_SE    c36_SE Intercept_TV\n1  0.2944943 0.3040755 0.3061114 0.2285432     1.996576\n2  0.2944895 0.3040701 0.3061035 0.2285400     1.996568\n3  0.2944649 0.3040348 0.3060453 0.2285191     1.997459\n4  0.2944644 0.3040358 0.3060481 0.2285196     1.997273\n5  0.2944657 0.3040374 0.3060505 0.2285206     1.997256\n6  0.2922745 0.3049058 0.3086083 0.2289726     1.774487\n7  0.2922632 0.3049023 0.3086052 0.2289723     1.773883\n8  0.2922855 0.3049347 0.3086530 0.2289949     1.773199\n9  0.2922868 0.3049365 0.3086557 0.2289962     1.773170\n10 0.2942723 0.3042295 0.3066451 0.2285647     1.966486\n   age_groupYoung Adults_TV age_groupAdults_TV age_groupMiddle-aged Adults_TV\n1                  2.038935           1.087108                      0.9803796\n2                  2.038955           1.087101                      0.9803699\n3                  2.038510           1.086394                      0.9799595\n4                  2.038621           1.086526                      0.9800304\n5                  2.038627           1.086542                      0.9800402\n6                  2.122682           1.198352                      1.0466436\n7                  2.122743           1.198443                      1.0467315\n8                  2.122893           1.198771                      1.0469314\n9                  2.122900           1.198788                      1.0469410\n10                 2.055232           1.108062                      0.9925486\n   age_groupSeniors_TV age_groupElderly_TV c7_1_12_TV c6_1_22_TV    c32_TV\n1             1.385309           -2.093172  -6.710907 -0.6552576 0.4131145\n2             1.385352           -2.092949  -6.710986 -0.6551304 0.4129987\n3             1.384805           -2.092217  -6.712233 -0.6556956 0.4135958\n4             1.384963           -2.092113  -6.712073 -0.6554408 0.4133477\n5             1.384967           -2.092162  -6.712036 -0.6554487 0.4133531\n6             1.568916           -1.833799  -6.404972 -0.3120580 0.1507988\n7             1.569365           -1.832304  -6.403799 -0.3108776 0.1501544\n8             1.569780           -1.832525  -6.402373 -0.3104611 0.1496523\n9             1.569796           -1.832559  -6.402312 -0.3104558 0.1496345\n10            1.411064           -2.078844  -6.677534 -0.6137703 0.3783834\n      c33_TV    c34_TV    c35_TV    c36_TV                  geometry\n1  0.5393212 -2.221783 -1.039932 -1.751393 POINT (572776.5 295349.3)\n2  0.5392106 -2.221776 -1.039937 -1.751444 POINT (572862.9 295404.6)\n3  0.5387356 -2.222306 -1.039066 -1.752282 POINT (572827.8 295794.7)\n4  0.5387067 -2.222193 -1.039245 -1.752173 POINT (572931.4 295778.9)\n5  0.5387332 -2.222183 -1.039262 -1.752148 POINT (572918.9 295762.6)\n6  0.4343034 -2.045576 -1.225643 -1.592798 POINT (716962.8 214083.6)\n7  0.4336785 -2.045002 -1.226049 -1.592378 POINT (717586.7 213596.5)\n8  0.4338245 -2.044327 -1.226481 -1.591660     POINT (717473 213283)\n9  0.4338417 -2.044299 -1.226498 -1.591627   POINT (717457.4 213273)\n10 0.5345101 -2.202240 -1.070389 -1.728903   POINT (585445 287247.7)\n\n\n\ngwlr.output &lt;- as.data.frame(gwlr$SDF)\nmobilemoney.sf.adaptive &lt;- cbind(finscope_mobile_money, as.matrix(gwlr.output))\n\nCalculate local pseudo R² for each observation.\n\n# Step 1: Calculate the null deviance from a null model (intercept-only model)\nnull_model &lt;- glm(h2_2_8 ~ 1, data = finscope_mobile_money, family = \"binomial\")\nnull_deviance &lt;- deviance(null_model)\n\n# Step 2: Extract local fitted values and residuals, converting to numeric if necessary\nlocal_fitted_values &lt;- as.numeric(mobilemoney.sf.adaptive$yhat)\nlocal_residuals &lt;- as.numeric(mobilemoney.sf.adaptive$residual)\n\n# Step 3: Calculate Local Pseudo R² for each observation\nmobilemoney.sf.adaptive$local_pseudo_r2 &lt;- 1 - (local_residuals^2 / null_deviance)\n\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(uganda_modified)+ \n  tm_polygons(alpha = 0.1) +\ntm_shape(mobilemoney.sf.adaptive) +  \n  tm_dots(col = \"local_pseudo_r2\", \n          border.col = \"gray60\",\n          border.lwd = 1)\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIn logistic regression (and similarly in geographically weighted logistic regression), a pseudo R² is an approximation of the proportion of variance in the dependent variable (in this case, mobile money/e-money wallet usage) explained by the model.\nHigher Pseudo R² Values indicate areas where the model fits well.\nLower Pseudo R² Values (Lighter Colors)indicate areas where the model explains less of the variability in mobile money usage\n\n\n\n\n\nDependent variable: Mobile / Internet Banking Usage\nRemove empty values in h2_2_5 field which represents the Mobile Money / E-money Wallets Usage\n\nfinscope_internet_banking &lt;- finscope.sf %&gt;%\n  filter(!is.na(h2_2_5) & h2_2_5 != \"\")\n\nRecode Mobile / Internet Banking Usage to 1 and 0\n\nfinscope_internet_banking$h2_2_5 &lt;- ifelse(finscope_internet_banking$h2_2_5 == 1, 1, 0)\n\nIndependent variable = Education level, Own a mobile phone?, internet access, age_group, sex, and marital status\nConvert Categorical Variables to Factors\n\nfinscope_internet_banking$c2 &lt;- as.factor(finscope_internet_banking$age_group)     \nfinscope_internet_banking$c2 &lt;- as.factor(finscope_internet_banking$c2)           # sex\nfinscope_internet_banking$c3 &lt;- as.factor(finscope_internet_banking$c3)           # marital status\nfinscope_internet_banking$c4 &lt;- as.factor(finscope_internet_banking$c4)           # education level\nfinscope_internet_banking$c7_1_1 &lt;- as.factor(finscope_internet_banking$c7_1_1)   # own a mobile phone?\nfinscope_internet_banking$c6_1_2 &lt;- as.factor(finscope_internet_banking$c6_1_2)   # internet access\n\nFit the logistic regression model using glm\n\nmodel_2 &lt;- glm(h2_2_5 ~ age_group + c2 + c3 + c4 + c6_1_2 + c7_1_1, \n             family = \"binomial\", data = finscope_internet_banking)\n\nExplanation of the Model\n\nsummary(model_2)\n\n\nCall:\nglm(formula = h2_2_5 ~ age_group + c2 + c3 + c4 + c6_1_2 + c7_1_1, \n    family = \"binomial\", data = finscope_internet_banking)\n\nCoefficients: (5 not defined because of singularities)\n                             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  -0.06445    0.64449  -0.100 0.920348    \nage_groupYoung Adults        -0.22343    0.45500  -0.491 0.623396    \nage_groupAdults              -0.05397    0.48717  -0.111 0.911786    \nage_groupMiddle-aged Adults   0.13588    0.49785   0.273 0.784906    \nage_groupSeniors             -0.33075    0.59586  -0.555 0.578833    \nage_groupElderly             14.33136  535.41142   0.027 0.978646    \nc2Young Adults                     NA         NA      NA       NA    \nc2Adults                           NA         NA      NA       NA    \nc2Middle-aged Adults               NA         NA      NA       NA    \nc2Seniors                          NA         NA      NA       NA    \nc2Elderly                          NA         NA      NA       NA    \nc32                           0.14578    0.36479   0.400 0.689423    \nc33                          -0.07232    0.32693  -0.221 0.824935    \nc34                           0.62012    0.32247   1.923 0.054477 .  \nc35                          -0.07509    0.34589  -0.217 0.828144    \nc36                           0.05302    0.24766   0.214 0.830469    \nc42                           0.03888    0.42626   0.091 0.927332    \nc43                          -0.29196    0.43934  -0.665 0.506342    \nc44                          -0.26251    0.42140  -0.623 0.533314    \nc45                          -0.09597    0.46732  -0.205 0.837281    \nc46                           0.20253    0.47031   0.431 0.666735    \nc47                           0.77181    0.47571   1.622 0.104710    \nc48                           0.79987    0.47509   1.684 0.092258 .  \nc49                           1.17773    1.63044   0.722 0.470088    \nc6_1_22                      -0.73972    0.19776  -3.740 0.000184 ***\nc7_1_12                      -0.98568    0.41073  -2.400 0.016403 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 957.27  on 709  degrees of freedom\nResidual deviance: 872.09  on 689  degrees of freedom\nAIC: 914.09\n\nNumber of Fisher Scoring iterations: 12\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe logistic regression model assesses the likelihood of using internet or mobile banking based on demographic and behavioral factors. Most variables, including age groups, are not significant, suggesting limited predictive power for these factors individually. However, education level (specifically, category c34) is borderline significant (p ≈ 0.054), hinting that higher education may slightly increase the likelihood of internet banking usage. Internet access (c6_1_22) and mobile phone ownership (c7_1_12) are significant predictors, with negative coefficients, indicating that lacking internet access or a mobile phone significantly reduces the likelihood of using internet or mobile banking. The model has a modest fit, with a pseudo R² around 8.9% (Null deviance vs. Residual deviance), and an AIC of 914.09, suggesting room for additional or alternative predictors. Five levels of c2 (sex) were omitted due to singularities, indicating redundancy or perfect multicollinearity.\n\n\n\nData Preparation for GWLR Model\nConvert finscope_internet_banking to spatial data\n\nfinscope_internet_banking.sp &lt;- as_Spatial(finscope_internet_banking)\n\nCalculating distance matrix to fit the GWLR model\n\ndistMAT_internet_banking &lt;- gw.dist(dp.locat = coordinates(finscope_internet_banking.sp))\n\n\ndim(distMAT_internet_banking)\n\n[1] 710 710\n\n\nComputing Adaptive Bandwidth\n\nbw.adaptive_internet_banking &lt;- bw.ggwr(formula = h2_2_5 ~ c3, \n                       family = \"binomial\", \n                       data = finscope_internet_banking, \n                       approach = \"CV\", \n                       kernel = \"gaussian\", \n                       adaptive = TRUE, \n                       longlat = FALSE, \n                       p = 2, \n                       theta = 0, \n                       dMat = distMAT_internet_banking)\n\n Iteration    Log-Likelihood:(With bandwidth:  446 )\n=========================\n       0       -483.1 \n       1       -483.4 \n       2       -483.4 \n       3       -483.4 \nAdaptive bandwidth: 446 CV score: 173.0369 \n Iteration    Log-Likelihood:(With bandwidth:  284 )\n=========================\n       0       -483.5 \n       1       -483.9 \n       2       -483.9 \n       3       -483.9 \nAdaptive bandwidth: 284 CV score: 173.2539 \n Iteration    Log-Likelihood:(With bandwidth:  548 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 548 CV score: 172.9839 \n Iteration    Log-Likelihood:(With bandwidth:  609 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 609 CV score: 172.9853 \n Iteration    Log-Likelihood:(With bandwidth:  508 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.4 \n       3       -483.4 \nAdaptive bandwidth: 508 CV score: 173.005 \n Iteration    Log-Likelihood:(With bandwidth:  570 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 570 CV score: 172.9934 \n Iteration    Log-Likelihood:(With bandwidth:  531 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 531 CV score: 172.988 \n Iteration    Log-Likelihood:(With bandwidth:  555 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 555 CV score: 172.9763 \n Iteration    Log-Likelihood:(With bandwidth:  563 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 563 CV score: 172.9847 \n Iteration    Log-Likelihood:(With bandwidth:  553 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 553 CV score: 172.9776 \n Iteration    Log-Likelihood:(With bandwidth:  559 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 559 CV score: 172.982 \n Iteration    Log-Likelihood:(With bandwidth:  555 )\n=========================\n       0         -483 \n       1       -483.3 \n       2       -483.3 \n       3       -483.3 \nAdaptive bandwidth: 555 CV score: 172.9763 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe resulting adaptive bandwdith value is 555, represent the number of nearest neighbours.\n\n\n\n\nFitting GWLR model\nSet bw parameter to 555. The family parameter is set to “binomial” due to the binary nature of the Mobile / Internet Banking Usage variable.\n\ngwlr_internet_banking &lt;- ggwr.basic(h2_2_5 ~ c3 + c6_1_2 + c7_1_1,\n                   data = finscope_internet_banking, \n                   bw = 555, \n                   family = \"binomial\", \n                   kernel = \"gaussian\", \n                   adaptive = TRUE, \n                   cv = T, \n                   tol = 1e-05, \n                   maxiter = 20, \n                   p = 2, \n                   theta = 0, \n                   longlat = FALSE, \n                   dMat = distMAT_internet_banking)\n\n Iteration    Log-Likelihood\n=========================\n       0       -449.1 \n       1         -448 \n       2       -447.9 \n       3       -447.9 \n       4       -447.9 \n\n\n\ngwlr_internet_banking\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-11-10 11:37:22.142624 \n   Call:\n   ggwr.basic(formula = h2_2_5 ~ c3 + c6_1_2 + c7_1_1, data = finscope_internet_banking, \n    bw = 555, family = \"binomial\", kernel = \"gaussian\", adaptive = TRUE, \n    cv = T, tol = 1e-05, maxiter = 20, p = 2, theta = 0, longlat = FALSE, \n    dMat = distMAT_internet_banking)\n\n   Dependent (y) variable:  h2_2_5\n   Independent variables:  c3 c6_1_2 c7_1_1\n   Number of data points: 710\n   Used family: binomial\n   ***********************************************************************\n   *              Results of Generalized linear Regression               *\n   ***********************************************************************\n\nCall:\nNULL\n\nCoefficients:\n          Estimate Std. Error z value Pr(&gt;|z|)    \nIntercept  0.13035    0.13862   0.940  0.34704    \nc32        0.11567    0.35236   0.328  0.74271    \nc33       -0.30355    0.30879  -0.983  0.32559    \nc34        0.50646    0.31404   1.613  0.10680    \nc35       -0.06995    0.32147  -0.218  0.82775    \nc36       -0.15259    0.19916  -0.766  0.44357    \nc6_1_22   -0.94513    0.16995  -5.561 2.68e-08 ***\nc7_1_12   -1.05721    0.38075  -2.777  0.00549 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 957.27  on 709  degrees of freedom\nResidual deviance: 899.72  on 702  degrees of freedom\nAIC: 915.72\n\nNumber of Fisher Scoring iterations: 4\n\n\n AICc:  915.9294\n Pseudo R-square value:  0.06011958\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 555 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: A distance matrix is specified for this model calibration.\n\n   ************Summary of Generalized GWR coefficient estimates:**********\n                   Min.    1st Qu.     Median    3rd Qu.    Max.\n   Intercept  0.1117922  0.1437215  0.1725326  0.1879193  0.1961\n   c32       -0.0863615 -0.0155553 -0.0044517  0.0350849  0.1232\n   c33       -0.3883973 -0.3634341 -0.3505071 -0.3101230 -0.2672\n   c34        0.5172363  0.5306306  0.5415275  0.5608783  0.5758\n   c35       -0.1032417 -0.0854309 -0.0737287 -0.0041647  0.0348\n   c36       -0.1557597 -0.1327494 -0.1223793 -0.1171639 -0.0897\n   c6_1_22   -0.9748223 -0.9675138 -0.9564033 -0.9474889 -0.9297\n   c7_1_12   -1.2592962 -1.2000837 -1.1305564 -0.9832365 -0.9006\n   ************************Diagnostic information*************************\n   Number of data points: 710 \n   GW Deviance: 895.7733 \n   AIC : 916.8798 \n   AICc : 917.229 \n   Pseudo R-square value:  0.06424658 \n\n   ***********************************************************************\n   Program stops at: 2024-11-10 11:37:26.042645 \n\n\n\n\n\n\n\n\nNote\n\n\n\nInternet Access (c6_1_22): The local coefficients for internet access are consistently negative across locations, ranging from -0.975 to -0.930, indicating a uniformly strong negative effect on usage.\nMobile Phone Ownership (c7_1_12): The effect of mobile phone ownership also varies, ranging from -1.26 to -0.90, with stronger negative effects in some areas, suggesting that lack of mobile phone access has a more significant impact in certain regions.\nEducation Levels (c3 series): These variables show varying effects, but their median and quartile values suggest limited impact overall, as indicated by the global results.\nAIC (916.88) and Pseudo R² (0.064) for the GWLR model indicate a slightly improved fit over the global model, capturing spatial heterogeneity but still explaining only a modest portion of the variance.\n\n\n\n\nVisualize GWR Output\n\ninternetbanking.sf.adaptive &lt;- st_as_sf(gwlr_internet_banking$SDF) %&gt;% \n  st_transform(crs=32636)\n\n\ninternetbanking.sf.adaptive.UTM36N &lt;- st_transform(internetbanking.sf.adaptive, 32636)\ninternetbanking.sf.adaptive.UTM36N  \n\nSimple feature collection with 710 features and 27 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 128442.2 ymin: -156374.4 xmax: 717918.8 ymax: 406192.4\nProjected CRS: WGS 84 / UTM zone 36N\nFirst 10 features:\n   Intercept         c32        c33       c34          c35        c36\n1  0.1698587 0.004419996 -0.3780707 0.5231075  0.003508562 -0.1411293\n2  0.1699622 0.004250450 -0.3781384 0.5231377  0.003359679 -0.1411506\n3  0.1699579 0.004307609 -0.3781228 0.5231295  0.003335167 -0.1411632\n4  0.1699330 0.004306113 -0.3781173 0.5231281  0.003396849 -0.1411467\n5  0.1698945 0.004413750 -0.3780807 0.5231107  0.003425000 -0.1411508\n6  0.1747150 0.045156381 -0.3615709 0.5202870 -0.048210708 -0.1557170\n7  0.1746718 0.045379606 -0.3614143 0.5202868 -0.048451520 -0.1557514\n8  0.1746625 0.045446067 -0.3613487 0.5202975 -0.048568203 -0.1557597\n9  0.1718565 0.007520629 -0.3776545 0.5228328 -0.003372919 -0.1432561\n10 0.1718421 0.007487223 -0.3776612 0.5228361 -0.003315312 -0.1432377\n      c6_1_22    c7_1_12 y      yhat   residual Intercept_SE    c32_SE\n1  -0.9685057 -0.9119779 1 0.1530827  0.8469173    0.1558665 0.3709254\n2  -0.9685071 -0.9122286 0 0.4315801 -0.4315801    0.1558633 0.3709139\n3  -0.9685023 -0.9122470 0 0.2924629 -0.2924629    0.1558605 0.3709127\n4  -0.9685059 -0.9121624 0 0.3112532 -0.3112532    0.1558638 0.3709169\n5  -0.9685012 -0.9120947 0 0.1530728 -0.1530728    0.1558624 0.3709196\n6  -0.9612319 -0.9857328 1 0.5547475  0.4452525    0.1519743 0.3680525\n7  -0.9611746 -0.9861927 0 0.3227586 -0.3227586    0.1519514 0.3680334\n8  -0.9611497 -0.9864361 1 0.3129234  0.6870766    0.1519412 0.3680229\n9  -0.9679176 -0.9207613 0 0.1522809 -0.1522809    0.1554335 0.3705017\n10 -0.9679230 -0.9206886 0 0.1522877 -0.1522877    0.1554372 0.3705050\n      c33_SE    c34_SE    c35_SE    c36_SE c6_1_22_SE c7_1_12_SE Intercept_TV\n1  0.3321187 0.3431138 0.3309282 0.2161781  0.1819354  0.3271985     1.089770\n2  0.3321020 0.3431093 0.3309296 0.2161783  0.1819376  0.3271914     1.090456\n3  0.3320985 0.3431051 0.3309240 0.2161752  0.1819355  0.3271885     1.090449\n4  0.3321061 0.3431099 0.3309283 0.2161777  0.1819367  0.3271929     1.090266\n5  0.3321086 0.3431077 0.3309229 0.2161750  0.1819340  0.3271927     1.090029\n6  0.3256784 0.3364244 0.3244061 0.2125124  0.1794042  0.3203411     1.149635\n7  0.3256434 0.3363805 0.3243667 0.2124895  0.1793849  0.3202852     1.149524\n8  0.3256267 0.3363601 0.3243502 0.2124798  0.1793765  0.3202574     1.149541\n9  0.3312782 0.3424599 0.3302606 0.2158006  0.1817208  0.3266258     1.105660\n10 0.3312851 0.3424657 0.3302666 0.2158040  0.1817227  0.3266309     1.105540\n       c32_TV    c33_TV   c34_TV      c35_TV     c36_TV c6_1_22_TV c7_1_12_TV\n1  0.01191613 -1.138360 1.524589  0.01060219 -0.6528380  -5.323348  -2.787231\n2  0.01145940 -1.138621 1.524697  0.01015225 -0.6529362  -5.323292  -2.788058\n3  0.01161354 -1.138586 1.524692  0.01007835 -0.6530038  -5.323328  -2.788139\n4  0.01160938 -1.138544 1.524666  0.01026461 -0.6529198  -5.323313  -2.787843\n5  0.01189948 -1.138425 1.524625  0.01034984 -0.6529469  -5.323364  -2.787638\n6  0.12269006 -1.110208 1.546520 -0.14861222 -0.7327431  -5.357913  -3.077135\n7  0.12330296 -1.109847 1.546721 -0.14937267 -0.7329839  -5.358168  -3.079108\n8  0.12348707 -1.109702 1.546846 -0.14974001 -0.7330567  -5.358280  -3.080136\n9  0.02029850 -1.139992 1.526698 -0.01021290 -0.6638353  -5.326401  -2.819009\n10 0.02020815 -1.139989 1.526681 -0.01003829 -0.6637399  -5.326373  -2.818743\n                    geometry\n1  POINT (572712.4 295983.7)\n2  POINT (572776.5 295349.3)\n3  POINT (572862.9 295404.6)\n4  POINT (572772.5 295532.6)\n5  POINT (572827.8 295794.7)\n6  POINT (716962.8 214083.6)\n7  POINT (717749.1 213260.3)\n8  POINT (717918.8 212759.4)\n9  POINT (585576.6 286749.1)\n10 POINT (585459.8 286816.7)\n\n\n\ngwlr_internet_banking.output &lt;- as.data.frame(gwlr_internet_banking$SDF)\ninternetbanking.sf.adaptive &lt;- cbind(finscope_internet_banking, as.matrix(gwlr_internet_banking.output))\n\nCalculate local pseudo R² for each observation.\n\nnull_model_ib &lt;- glm(h2_2_5 ~ 1, data = finscope_internet_banking, family = \"binomial\")\nnull_deviance_ib &lt;- deviance(null_model)\n\nlocal_fitted_values_ib &lt;- as.numeric(internetbanking.sf.adaptive$yhat)\nlocal_residuals_ib &lt;- as.numeric(internetbanking.sf.adaptive$residual)\n\ninternetbanking.sf.adaptive$local_pseudo_r2 &lt;- 1 - (local_residuals_ib^2 / null_deviance_ib)\n\nPlot the map\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(uganda_modified)+ \n  tm_polygons(alpha = 0.1) +\ntm_shape(internetbanking.sf.adaptive) +  \n  tm_dots(col = \"local_pseudo_r2\", \n          border.col = \"gray60\",\n          border.lwd = 1)\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nHigher Pseudo R² Values indicate areas where the model fits well.\nLower Pseudo R² Values (Lighter Colors)indicate areas where the model explains less of the variability in mobile money usage\nKampala’s location in the central region likely influences the results, as urban settings tend to have better infrastructure, making predictors like mobile phone and internet access more uniformly available. This can affect the local pseudo R² values and how well the model fits for internet/mobile banking usage patterns.\n\n\n\n\n\nDependent variable: Existing Insurance Policy\nRemove empty values in j1 field which represents the Insurance Policy ownership\n\nfinscope_insurance &lt;- finscope.sf %&gt;%\n  filter(!is.na(j1) & j1 != \"\")\n\nRecode Existing Insurance Policy to 1 and 0\n\nfinscope_insurance$j1 &lt;- ifelse(finscope_insurance$j1 == 1, 1, 0)\n\nIndependent variable = Education level, Own a mobile phone?, internet access, age_group, sex, and marital status\nConvert Categorical Variables to Factors\n\nfinscope_insurance$c2 &lt;- as.factor(finscope_insurance$age_group)     \nfinscope_insurance$c2 &lt;- as.factor(finscope_insurance$c2)           # sex\nfinscope_insurance$c3 &lt;- as.factor(finscope_insurance$c3)           # marital status\nfinscope_insurance$c4 &lt;- as.factor(finscope_insurance$c4)           # education level\nfinscope_insurance$c7_1_1 &lt;- as.factor(finscope_insurance$c7_1_1)   # own a mobile phone?\nfinscope_insurance$c6_1_2 &lt;- as.factor(finscope_insurance$c6_1_2)   # internet access\n\nFit the logistic regression model using glm\n\nmodel_3 &lt;- glm(j1 ~ age_group + c2 + c3 + c4 + c6_1_2 + c7_1_1, \n             family = \"binomial\", data = finscope_insurance)\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\n\nExplanation of the Model\n\nsummary(model_3)\n\n\nCall:\nglm(formula = j1 ~ age_group + c2 + c3 + c4 + c6_1_2 + c7_1_1, \n    family = \"binomial\", data = finscope_insurance)\n\nCoefficients: (5 not defined because of singularities)\n                              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                  -34.36107 1315.02291  -0.026 0.979154    \nage_groupYoung Adults         14.78865 1083.09333   0.014 0.989106    \nage_groupAdults               15.21256 1083.09336   0.014 0.988794    \nage_groupMiddle-aged Adults   16.02199 1083.09336   0.015 0.988197    \nage_groupSeniors              15.06252 1083.09348   0.014 0.988904    \nage_groupElderly              17.19948 1083.09397   0.016 0.987330    \nc2Young Adults                      NA         NA      NA       NA    \nc2Adults                            NA         NA      NA       NA    \nc2Middle-aged Adults                NA         NA      NA       NA    \nc2Seniors                           NA         NA      NA       NA    \nc2Elderly                           NA         NA      NA       NA    \nc32                           -0.04546    0.58445  -0.078 0.938008    \nc33                           -0.15091    0.51670  -0.292 0.770237    \nc34                            0.15350    0.48300   0.318 0.750633    \nc35                            0.10535    0.48434   0.218 0.827812    \nc36                           -0.56252    0.41980  -1.340 0.180257    \nc42                           14.26592  745.78432   0.019 0.984738    \nc43                           16.21259  745.78410   0.022 0.982656    \nc44                           15.56310  745.78413   0.021 0.983351    \nc45                           16.88379  745.78414   0.023 0.981938    \nc46                           16.46114  745.78418   0.022 0.982390    \nc47                           17.25694  745.78414   0.023 0.981539    \nc48                           18.47829  745.78413   0.025 0.980233    \nc49                            0.12433 6996.86623   0.000 0.999986    \nc6_1_22                       -1.26544    0.33551  -3.772 0.000162 ***\nc7_1_12                       -1.18741    1.05036  -1.130 0.258276    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 764.73  on 3099  degrees of freedom\nResidual deviance: 511.88  on 3079  degrees of freedom\nAIC: 553.88\n\nNumber of Fisher Scoring iterations: 19\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe model suggests that lack of internet access is associated with lower likelihood of having insurance, which may reflect barriers in accessing information and services related to insurance. Other predictors, including age and mobile phone ownership, do not appear to have a statistically significant effect on insurance ownership in this dataset. The singularities in certain categories highlight potential multicollinearity issues, which could be further explored to refine the model.\n\n\n\nData Preparation for GWLR Model\nConvert finscope_insurance to spatial data\n\nfinscope_insurance.sp &lt;- as_Spatial(finscope_insurance)\n\nCalculating distance matrix to fit the GWLR model\n\ndistMAT_insurance &lt;- gw.dist(dp.locat = coordinates(finscope_insurance.sp))\n\n\ndim(distMAT_insurance)\n\n[1] 3100 3100\n\n\nComputing Adaptive Bandwidth\n\nbw.adaptive_insurance &lt;- bw.ggwr(formula = j1 ~ c6_1_2, \n                       family = \"binomial\", \n                       data = finscope_insurance, \n                       approach = \"CV\", \n                       kernel = \"gaussian\", \n                       adaptive = TRUE, \n                       longlat = FALSE, \n                       p = 2, \n                       theta = 0, \n                       dMat = distMAT_insurance)\n\nTake a cup of tea and have a break, it will take a few minutes.\n          -----A kind suggestion from GWmodel development group\n Iteration    Log-Likelihood:(With bandwidth:  1923 )\n=========================\n       0       -581.3 \n       1       -385.6 \n       2       -336.4 \n       3       -325.8 \n       4       -324.8 \n       5       -324.9 \n       6       -324.9 \n       7       -324.9 \n       8       -324.9 \nAdaptive bandwidth: 1923 CV score: 77.19115 \n Iteration    Log-Likelihood:(With bandwidth:  1196 )\n=========================\n       0       -581.2 \n       1       -385.2 \n       2       -335.7 \n       3       -325.1 \n       4         -324 \n       5         -324 \n       6         -324 \n       7         -324 \n       8         -324 \nAdaptive bandwidth: 1196 CV score: 77.12915 \n Iteration    Log-Likelihood:(With bandwidth:  746 )\n=========================\n       0       -580.9 \n       1       -384.5 \n       2       -334.7 \n       3       -323.9 \n       4       -322.6 \n       5       -322.6 \n       6       -322.6 \n       7       -322.6 \n       8       -322.6 \nAdaptive bandwidth: 746 CV score: 76.98 \n Iteration    Log-Likelihood:(With bandwidth:  468 )\n=========================\n       0       -580.3 \n       1       -383.6 \n       2       -333.8 \n       3       -322.8 \n       4       -321.3 \n       5       -321.2 \n       6       -321.3 \n       7       -321.3 \nAdaptive bandwidth: 468 CV score: 76.83362 \n Iteration    Log-Likelihood:(With bandwidth:  296 )\n=========================\n       0         -580 \n       1       -383.3 \n       2       -333.8 \n       3       -322.7 \n       4       -321.1 \n       5       -321.1 \nAdaptive bandwidth: 296 CV score: 76.84538 \n Iteration    Log-Likelihood:(With bandwidth:  574 )\n=========================\n       0       -580.6 \n       1       -383.9 \n       2       -334.1 \n       3       -323.1 \n       4       -321.7 \n       5       -321.7 \n       6       -321.7 \n       7       -321.7 \n       8       -321.7 \nAdaptive bandwidth: 574 CV score: 76.87878 \n Iteration    Log-Likelihood:(With bandwidth:  402 )\n=========================\n       0       -580.1 \n       1       -383.4 \n       2       -333.6 \n       3       -322.6 \n       4         -321 \n       5       -321.1 \n       6       -321.1 \n       7       -321.1 \nAdaptive bandwidth: 402 CV score: 76.80464 \n Iteration    Log-Likelihood:(With bandwidth:  361 )\n=========================\n       0         -580 \n       1       -383.3 \n       2       -333.6 \n       3       -322.6 \n       4         -321 \n       5         -321 \n       6       -321.1 \n       7       -321.1 \nAdaptive bandwidth: 361 CV score: 76.81024 \n Iteration    Log-Likelihood:(With bandwidth:  427 )\n=========================\n       0       -580.2 \n       1       -383.4 \n       2       -333.7 \n       3       -322.6 \n       4       -321.1 \n       5       -321.1 \n       6       -321.1 \n       7       -321.1 \nAdaptive bandwidth: 427 CV score: 76.81322 \n Iteration    Log-Likelihood:(With bandwidth:  386 )\n=========================\n       0         -580 \n       1       -383.3 \n       2       -333.5 \n       3       -322.5 \n       4       -320.9 \n       5       -320.9 \n       6         -321 \n       7         -321 \nAdaptive bandwidth: 386 CV score: 76.78708 \n Iteration    Log-Likelihood:(With bandwidth:  376 )\n=========================\n       0       -580.1 \n       1       -383.3 \n       2       -333.6 \n       3       -322.5 \n       4         -321 \n       5         -321 \n       6       -321.1 \n       7       -321.1 \nAdaptive bandwidth: 376 CV score: 76.80268 \n Iteration    Log-Likelihood:(With bandwidth:  391 )\n=========================\n       0       -580.1 \n       1       -383.3 \n       2       -333.6 \n       3       -322.5 \n       4       -320.9 \n       5         -321 \n       6         -321 \n       7         -321 \nAdaptive bandwidth: 391 CV score: 76.79038 \n Iteration    Log-Likelihood:(With bandwidth:  381 )\n=========================\n       0         -580 \n       1       -383.3 \n       2       -333.5 \n       3       -322.5 \n       4       -320.9 \n       5       -320.9 \n       6         -321 \n       7         -321 \nAdaptive bandwidth: 381 CV score: 76.79073 \n Iteration    Log-Likelihood:(With bandwidth:  387 )\n=========================\n       0         -580 \n       1       -383.2 \n       2       -333.5 \n       3       -322.4 \n       4       -320.9 \n       5       -320.9 \n       6         -321 \n       7         -321 \nAdaptive bandwidth: 387 CV score: 76.78508 \n Iteration    Log-Likelihood:(With bandwidth:  390 )\n=========================\n       0       -580.1 \n       1       -383.3 \n       2       -333.6 \n       3       -322.5 \n       4         -321 \n       5         -321 \n       6         -321 \n       7         -321 \nAdaptive bandwidth: 390 CV score: 76.79051 \n Iteration    Log-Likelihood:(With bandwidth:  387 )\n=========================\n       0         -580 \n       1       -383.2 \n       2       -333.5 \n       3       -322.4 \n       4       -320.9 \n       5       -320.9 \n       6         -321 \n       7         -321 \nAdaptive bandwidth: 387 CV score: 76.78508 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe resulting adaptive bandwdith value is 387, represent the number of nearest neighbours.\n\n\n\n\nFitting GWLR model\nSet bw parameter to 387. The family parameter is set to “binomial” due to the binary nature of the Existing Insurance Policy variable.\n\ngwlr_insurance &lt;- ggwr.basic(j1 ~ c3 + c6_1_2 + c7_1_1 + c2 + c3 + c4,\n                   data = finscope_insurance, \n                   bw = 387, \n                   family = \"binomial\", \n                   kernel = \"gaussian\", \n                   adaptive = TRUE, \n                   cv = T, \n                   tol = 1e-05, \n                   maxiter = 20, \n                   p = 2, \n                   theta = 0, \n                   longlat = FALSE, \n                   dMat = distMAT_insurance)\n\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n\n\n Iteration    Log-Likelihood\n=========================\n       0       -544.8 \n       1       -320.3 \n       2       -249.6 \n       3       -224.8 \n       4         -215 \n       5       -211.4 \n       6       -210.5 \n       7       -210.3 \n       8       -210.3 \n       9       -210.2 \n      10       -210.2 \n      11       -210.2 \n      12       -210.2 \n      13       -210.2 \n      14       -210.2 \n\n\n\ngwlr_insurance\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2024-11-10 13:08:03.495004 \n   Call:\n   ggwr.basic(formula = j1 ~ c3 + c6_1_2 + c7_1_1 + c2 + c3 + c4, \n    data = finscope_insurance, bw = 387, family = \"binomial\", \n    kernel = \"gaussian\", adaptive = TRUE, cv = T, tol = 1e-05, \n    maxiter = 20, p = 2, theta = 0, longlat = FALSE, dMat = distMAT_insurance)\n\n   Dependent (y) variable:  j1\n   Independent variables:  c3 c6_1_2 c7_1_1 c2 c4\n   Number of data points: 3100\n   Used family: binomial\n   ***********************************************************************\n   *              Results of Generalized linear Regression               *\n   ***********************************************************************\n\nCall:\nNULL\n\nCoefficients:\n                       Estimate Std. Error z value Pr(&gt;|z|)    \nIntercept             -34.36107 1315.02291  -0.026 0.979154    \nc32                    -0.04546    0.58445  -0.078 0.938008    \nc33                    -0.15091    0.51670  -0.292 0.770237    \nc34                     0.15350    0.48300   0.318 0.750633    \nc35                     0.10535    0.48434   0.218 0.827812    \nc36                    -0.56252    0.41980  -1.340 0.180257    \nc6_1_22                -1.26544    0.33551  -3.772 0.000162 ***\nc7_1_12                -1.18741    1.05036  -1.130 0.258276    \nc2Young Adults         14.78865 1083.09333   0.014 0.989106    \nc2Adults               15.21256 1083.09336   0.014 0.988794    \nc2Middle-aged Adults   16.02199 1083.09336   0.015 0.988197    \nc2Seniors              15.06252 1083.09347   0.014 0.988904    \nc2Elderly              17.19948 1083.09397   0.016 0.987330    \nc42                    14.26592  745.78432   0.019 0.984738    \nc43                    16.21259  745.78410   0.022 0.982656    \nc44                    15.56310  745.78413   0.021 0.983351    \nc45                    16.88379  745.78414   0.023 0.981938    \nc46                    16.46114  745.78418   0.022 0.982390    \nc47                    17.25694  745.78414   0.023 0.981539    \nc48                    18.47829  745.78413   0.025 0.980233    \nc49                     0.12433 6996.86623   0.000 0.999986    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 764.73  on 3099  degrees of freedom\nResidual deviance: 511.88  on 3079  degrees of freedom\nAIC: 553.88\n\nNumber of Fisher Scoring iterations: 19\n\n\n AICc:  554.1795\n Pseudo R-square value:  0.3306407\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 387 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: A distance matrix is specified for this model calibration.\n\n   ************Summary of Generalized GWR coefficient estimates:**********\n                              Min.    1st Qu.     Median    3rd Qu.     Max.\n   Intercept            -24.424266 -23.112438 -22.508496 -21.910468 -19.8316\n   c32                   -2.915758  -0.783149  -0.117818   0.449208   1.8178\n   c33                   -1.867832  -1.049214  -0.768118   0.397808   1.2592\n   c34                   -0.841051  -0.137163   0.206922   0.345726   0.5762\n   c35                   -0.553364   0.046800   0.208665   0.347356   0.6505\n   c36                   -2.570259  -1.909294  -0.392780   0.018648   0.4975\n   c6_1_22               -1.838434  -1.496794  -1.329780  -1.158972  -0.0624\n   c7_1_12               -4.054138  -2.872678  -1.865208  -0.755861   0.3328\n   c2Young Adults         7.417800   9.040477   9.513889   9.955569  11.1609\n   c2Adults               7.414915   8.816388   9.889671  10.641941  11.1919\n   c2Middle-aged Adults   8.103494  10.009364  10.728239  11.172245  11.9589\n   c2Seniors              8.909423   9.400541   9.726991   9.991535  10.7699\n   c2Elderly              8.008389  11.367762  12.408291  13.244534  14.4918\n   c42                    5.327991   7.048088   8.222808   8.674603   9.5080\n   c43                    8.259950   9.444915   9.707152  10.275304  10.9559\n   c44                    7.045025   8.039010   9.204741   9.588898  10.5031\n   c45                    8.290876   9.075606  10.602577  11.119432  11.8541\n   c46                    7.890197   9.242778   9.774182  10.388727  10.9915\n   c47                    9.425633  10.027152  11.041684  11.358739  11.7636\n   c48                   10.476003  11.876012  12.420648  12.620353  12.9689\n   c49                   -4.232406  -2.976466  -2.611421  -1.395468  -1.0094\n   ************************Diagnostic information*************************\n   Number of data points: 3100 \n   GW Deviance: 420.378 \n   AIC : 602.4627 \n   AICc : 608.0344 \n   Pseudo R-square value:  0.4502924 \n\n   ***********************************************************************\n   Program stops at: 2024-11-10 13:16:37.582969 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe GWR model’s pseudo R² is approximately 45%, a notable improvement over the global model’s fit, suggesting that the GWR model captures significant spatial variation in the predictors’ effects.\nAIC for GWR is 602.46, indicating a slightly higher AIC than the global model, likely due to the additional complexity introduced by modeling spatial variability.\nInternet Access and Mobile Phone Ownership appear to have strong, location-dependent impacts on insurance ownership, indicating that these factors are crucial for facilitating access to insurance in certain regions. Policy Implications: Regions with strong negative impacts from lack of internet or mobile phone access might benefit from policies aimed at improving digital infrastructure or providing digital literacy programs to enhance awareness and accessibility of insurance products.\nVariable Influence by Region: The variability in coefficients suggests that the predictors’ influence on insurance adoption may depend on local characteristics, such as urbanization, socioeconomic factors, or access to insurance providers.\n\n\n\n\nVisualize GWR Output\n\ninsurance.sf.adaptive &lt;- st_as_sf(gwlr_insurance$SDF) %&gt;% \n  st_transform(crs=32636)\n\n\ninsurance.sf.adaptive.UTM36N &lt;- st_transform(insurance.sf.adaptive, 32636)\ninsurance.sf.adaptive.UTM36N  \n\nSimple feature collection with 3100 features and 66 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 128007.7 ymin: -156374.4 xmax: 718004.1 ymax: 407771.6\nProjected CRS: WGS 84 / UTM zone 36N\nFirst 10 features:\n   Intercept        c32      c33       c34       c35       c36   c6_1_22\n1  -23.06814 -0.9718613 1.158814 0.3184768 0.5001964 0.4962421 -1.756384\n2  -23.06658 -0.9727646 1.159656 0.3182723 0.5002256 0.4974691 -1.757149\n3  -23.06455 -0.9729029 1.158583 0.3177796 0.4994146 0.4962934 -1.757382\n4  -23.06271 -0.9723952 1.156275 0.3172000 0.4981692 0.4935113 -1.757121\n5  -23.06330 -0.9728616 1.157655 0.3174498 0.4988140 0.4952235 -1.757428\n6  -23.06365 -0.9723438 1.156801 0.3174295 0.4985522 0.4940988 -1.757027\n7  -23.06469 -0.9725072 1.157847 0.3177315 0.4991572 0.4953396 -1.757082\n8  -23.06662 -0.9717080 1.157476 0.3180559 0.4993842 0.4946824 -1.756374\n9  -23.06642 -0.9712504 1.156387 0.3179069 0.4989220 0.4933097 -1.756055\n10 -23.06630 -0.9713432 1.156504 0.3178977 0.4989459 0.4934699 -1.756130\n      c7_1_12 c2Young Adults c2Adults c2Middle-aged Adults c2Seniors c2Elderly\n1  -0.8722896       9.797435 8.888241             10.52760  10.49450  12.55136\n2  -0.8724445       9.796473 8.885385             10.52584  10.49388  12.55041\n3  -0.8738693       9.794902 8.884844             10.52404  10.49453  12.55050\n4  -0.8759093       9.793280 8.886302             10.52270  10.49599  12.55138\n5  -0.8748939       9.793896 8.884899             10.52299  10.49510  12.55071\n6  -0.8752375       9.794012 8.886515             10.52353  10.49568  12.55133\n7  -0.8742286       9.794893 8.886073             10.52434  10.49503  12.55099\n8  -0.8736595       9.796184 8.888629             10.52637  10.49534  12.55176\n9  -0.8743558       9.795881 8.890010             10.52642  10.49606  12.55237\n10 -0.8743357       9.795820 8.889722             10.52627  10.49598  12.55226\n        c42      c43      c44      c45      c46      c47      c48       c49 y\n1  8.141756 9.489591 9.624884 11.30879 8.844654 11.04991 12.63430 -3.006902 0\n2  8.140340 9.487755 9.623438 11.30810 8.842275 11.04798 12.63477 -3.007151 0\n3  8.139760 9.487768 9.622706 11.30646 8.842556 11.04649 12.63520 -3.007459 0\n4  8.140015 9.489260 9.622753 11.30454 8.844889 11.04579 12.63547 -3.007718 0\n5  8.139560 9.488073 9.622398 11.30537 8.843145 11.04570 12.63544 -3.007643 0\n6  8.140265 9.489222 9.623078 11.30530 8.844714 11.04645 12.63528 -3.007581 0\n7  8.140274 9.488667 9.623191 11.30630 8.843800 11.04698 12.63510 -3.007431 0\n8  8.141637 9.490197 9.624627 11.30739 8.845700 11.04905 12.63457 -3.007128 0\n9  8.142150 9.491285 9.625073 11.30689 8.847258 11.04937 12.63453 -3.007147 0\n10 8.142015 9.491091 9.624939 11.30686 8.846998 11.04920 12.63457 -3.007167 0\n           yhat      residual Intercept_SE   c32_SE   c33_SE   c34_SE   c35_SE\n1  3.476670e-04 -3.476670e-04     16652.82 666.6995 4104.781 1386.404 1667.250\n2  1.551800e-04 -1.551800e-04     16663.87 667.3100 4098.433 1385.261 1665.008\n3  4.696788e-08 -4.696788e-08     16685.88 666.6135 4092.007 1384.623 1663.116\n4  1.717291e-04 -1.717291e-04     16710.31 665.0719 4087.347 1384.568 1662.039\n5  1.107181e-02 -1.107181e-02     16700.26 666.0041 4088.296 1384.337 1662.084\n6  2.255960e-07 -2.255960e-07     16700.16 665.4103 4090.277 1384.851 1662.894\n7  5.990653e-04 -5.990653e-04     16687.21 666.1047 4093.147 1384.986 1663.631\n8  1.788513e-03 -1.788513e-03     16671.22 665.8093 4100.425 1386.133 1666.080\n9  1.022543e-03 -1.022543e-03     16676.85 665.0661 4100.598 1386.441 1666.343\n10 1.673558e-03 -1.673558e-03     16677.46 665.1485 4100.094 1386.339 1666.156\n     c36_SE c6_1_22_SE c7_1_12_SE c2Young Adults_SE c2Adults_SE\n1  905.6798   552.4832   3444.772          303.3861    696.4184\n2  902.7983   553.1299   3449.252          303.6708    696.7755\n3  903.3470   553.3046   3450.384          303.5036    697.3456\n4  906.5029   553.0503   3448.506          303.0232    697.9186\n5  904.2150   553.3294   3450.497          303.3351    697.7071\n6  906.1908   552.9788   3448.049          303.1067    697.6557\n7  904.9230   553.0420   3448.543          303.3141    697.3422\n8  907.1668   552.4475   3444.453          303.1282    696.8684\n9  909.1800   552.1628   3442.444          302.8690    696.9735\n10 908.8591   552.2267   3442.888          302.9033    696.9961\n   c2Middle-aged Adults_SE c2Seniors_SE c2Elderly_SE   c42_SE   c43_SE   c44_SE\n1                 374.3253     3687.393     4090.820 793.7454 1269.165 897.7408\n2                 374.1533     3700.097     4086.742 792.1763 1269.781 897.1431\n3                 373.9369     3702.280     4090.774 791.3140 1272.057 897.1993\n4                 373.7479     3695.386     4100.159 791.2554 1275.018 897.7693\n5                 373.8056     3701.844     4094.396 790.9306 1273.636 897.3364\n6                 373.8464     3694.576     4098.185 791.6363 1273.950 897.7318\n7                 373.9547     3696.739     4093.994 791.8119 1272.449 897.5095\n8                 374.1652     3685.462     4096.155 793.3859 1271.228 897.9973\n9                 374.1479     3679.207     4100.776 793.8283 1272.119 898.3918\n10                374.1350     3680.490     4100.243 793.6847 1272.126 898.3251\n     c45_SE   c46_SE   c47_SE   c48_SE   c49_SE Intercept_TV       c32_TV\n1  861.2422 1502.909 7543.061 714.2601 1039.367 -0.001385239 -0.001457720\n2  860.2210 1502.615 7546.218 714.1785 1039.925 -0.001384227 -0.001457740\n3  860.5879 1501.649 7541.142 715.3068 1040.188 -0.001382280 -0.001459471\n4  861.9780 1500.416 7530.906 717.0896 1040.139 -0.001380148 -0.001462090\n5  861.0249 1500.982 7536.900 716.1517 1040.293 -0.001381015 -0.001460744\n6  861.7822 1500.872 7533.362 716.5529 1040.022 -0.001381043 -0.001461269\n7  861.2005 1501.501 7538.057 715.6914 1039.993 -0.001382178 -0.001459992\n8  861.9439 1502.049 7536.974 715.4128 1039.445 -0.001383620 -0.001459439\n9  862.7586 1501.691 7532.290 716.0883 1039.260 -0.001383140 -0.001460382\n10 862.6397 1501.685 7532.758 716.0502 1039.312 -0.001383083 -0.001460340\n         c33_TV       c34_TV       c35_TV       c36_TV   c6_1_22_TV\n1  0.0002823084 0.0002297142 0.0003000129 0.0005479222 -0.003179072\n2  0.0002829510 0.0002297562 0.0003004342 0.0005510302 -0.003176739\n3  0.0002831332 0.0002295061 0.0003002885 0.0005493939 -0.003176156\n4  0.0002828914 0.0002290968 0.0002997338 0.0005444122 -0.003177145\n5  0.0002831633 0.0002293153 0.0003001137 0.0005476834 -0.003176097\n6  0.0002828172 0.0002292157 0.0002998100 0.0005452481 -0.003177385\n7  0.0002828745 0.0002294113 0.0003000409 0.0005473832 -0.003177122\n8  0.0002822820 0.0002294556 0.0002997360 0.0005453048 -0.003179260\n9  0.0002820045 0.0002292970 0.0002994113 0.0005425875 -0.003180322\n10 0.0002820677 0.0002293073 0.0002994592 0.0005429553 -0.003180089\n      c7_1_12_TV c2Young Adults_TV c2Adults_TV c2Middle-aged Adults_TV\n1  -0.0002532213        0.03229362  0.01276279              0.02812420\n2  -0.0002529373        0.03226018  0.01275215              0.02813242\n3  -0.0002532673        0.03227278  0.01274095              0.02814388\n4  -0.0002539967        0.03231858  0.01273258              0.02815455\n5  -0.0002535559        0.03228738  0.01273443              0.02815096\n6  -0.0002538355        0.03231209  0.01273768              0.02814934\n7  -0.0002535067        0.03229290  0.01274277              0.02814337\n8  -0.0002536424        0.03231697  0.01275510              0.02813296\n9  -0.0002539927        0.03234362  0.01275516              0.02813437\n10 -0.0002539541        0.03233975  0.01275433              0.02813496\n   c2Seniors_TV c2Elderly_TV     c42_TV      c43_TV     c44_TV     c45_TV\n1   0.002846048  0.003068176 0.01025739 0.007477037 0.01072123 0.01313079\n2   0.002836110  0.003071006 0.01027592 0.007471965 0.01072676 0.01314557\n3   0.002834613  0.003068001 0.01028638 0.007458602 0.01072527 0.01313807\n4   0.002840295  0.003061193 0.01028747 0.007442449 0.01071851 0.01311465\n5   0.002835101  0.003065339 0.01029112 0.007449593 0.01072329 0.01313013\n6   0.002840835  0.003062656 0.01028284 0.007448661 0.01071932 0.01311851\n7   0.002838997  0.003065707 0.01028057 0.007457013 0.01072210 0.01312854\n8   0.002847769  0.003064278 0.01026189 0.007465377 0.01071788 0.01311847\n9   0.002852806  0.003060974 0.01025682 0.007461007 0.01071367 0.01310551\n10  0.002851789  0.003061347 0.01025850 0.007460809 0.01071432 0.01310728\n        c46_TV      c47_TV     c48_TV       c49_TV                  geometry\n1  0.005885022 0.001464911 0.01768865 -0.002893011 POINT (572712.4 295983.7)\n2  0.005884593 0.001464042 0.01769133 -0.002891701 POINT (572616.1 295765.6)\n3  0.005888563 0.001464830 0.01766403 -0.002891265 POINT (572699.8 295505.8)\n4  0.005894959 0.001466727 0.01762049 -0.002891651 POINT (572903.6 295285.3)\n5  0.005891572 0.001465550 0.01764353 -0.002891149 POINT (572776.5 295349.3)\n6  0.005893050 0.001466338 0.01763342 -0.002891843 POINT (572862.9 295404.6)\n7  0.005889973 0.001465494 0.01765440 -0.002891779 POINT (572772.5 295532.6)\n8  0.005889090 0.001465980 0.01766053 -0.002893014 POINT (572827.8 295794.7)\n9  0.005891528 0.001466934 0.01764382 -0.002893546 POINT (572931.4 295778.9)\n10 0.005891382 0.001466820 0.01764481 -0.002893419 POINT (572918.9 295762.6)\n\n\n\ngwlr_insurance.output &lt;- as.data.frame(gwlr_insurance$SDF)\ninsurance.sf.adaptive &lt;- cbind(finscope_insurance, as.matrix(gwlr_insurance.output))\n\nCalculate local pseudo R² for each observation.\n\nnull_model_in &lt;- glm(j1 ~ 1, data = finscope_insurance, family = \"binomial\")\nnull_deviance_in &lt;- deviance(null_model)\n\nlocal_fitted_values_in &lt;- as.numeric(insurance.sf.adaptive$yhat)\nlocal_residuals_in &lt;- as.numeric(insurance.sf.adaptive$residual)\n\ninsurance.sf.adaptive$local_pseudo_r2 &lt;- 1 - (local_residuals_in^2 / null_deviance_in)\n\nPlot the map\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(uganda_modified)+ \n  tm_polygons(alpha = 0.1) +\ntm_shape(insurance.sf.adaptive) +  \n  tm_dots(col = \"local_pseudo_r2\", \n          border.col = \"gray60\",\n          border.lwd = 1)\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe prevalence of darker colors suggests a strong and consistent fit of the GWLR model across Uganda, indicating that the selected predictors are likely important and relevant factors for insurance ownership nationwide. This offers confidence in the model’s results and provides useful insights for policies targeting these factors across different regions.\n\n\n\nwrite_rds(uganda_32636, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/uganda_32636.rds\")\nwrite_rds(uganda_modified, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/uganda_modified.rds\")\nwrite_rds(finscope_insurance, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/finscope_insurance.rds\")\nwrite_rds(finscope_internet_banking, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/finscope_internet_banking.rds\")\nwrite_rds(finscope_mobile_money, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/finscope_mobile_money.rds\")\nwrite_rds(model, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/model.rds\")\nwrite_rds(model_2, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/model_2.rds\")\nwrite_rds(model_3, \"C:/ngmengye/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/Uganda/data/rds/model_3.rds\")"
  }
]